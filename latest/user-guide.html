<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.15">
<meta name="description" content="A modern, JVM-based, full stack framework designed to develop distributed reactive applications that use a microservice architecture.">
<meta name="keywords" content="rx, rxmicro, reactive java, reactive jvm, microservice java, reactive microservice, micro service java, reactive micro service">
<meta name="author" content="nedis">
<title>RxMicro User Guide</title>
<link rel="stylesheet" href="styles/rxmicro-doc.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body id="index-section" class="article toc2 toc-left">
<div id="header">
<h1>RxMicro User Guide</h1>
<div class="details">
<span id="author" class="author">nedis</span><br>
<span id="email" class="email"><a href="mailto:rxmicro.io@gmail.com">rxmicro.io@gmail.com</a></span><br>
<span id="revnumber">version 0.11,</span>
<span id="revdate">2022-12-14 20:00:09 UTC</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction-section">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#rxmicro_features">1.1. RxMicro Features</a></li>
<li><a href="#rxmicro_benefits">1.2. RxMicro Benefits</a></li>
<li><a href="#requirements">1.3. Requirements</a></li>
</ul>
</li>
<li><a href="#microservice-section">2. What are Microservices?</a></li>
<li><a href="#quick-start-section">3. Quick Start</a>
<ul class="sectlevel2">
<li><a href="#creating_a_project">3.1. Creating a Project</a>
<ul class="sectlevel3">
<li><a href="#using_the_intellij_idea">3.1.1. Using the <code>IntelliJ IDEA</code></a></li>
<li><a href="#using_the_terminal">3.1.2. Using the Terminal</a></li>
<li><a href="#using_other_ide">3.1.3. Using Other IDE</a></li>
</ul>
</li>
<li><a href="#configuring_the_project">3.2. Configuring the Project</a>
<ul class="sectlevel3">
<li><a href="#definition_the_versions_of_the_used_libraries">3.2.1. Definition the Versions of the Used Libraries</a></li>
<li><a href="#adding_the_required_dependencies">3.2.2. Adding the Required Dependencies</a></li>
<li><a href="#quick-start-maven-compiler-plugin-settings-section">3.2.3. Configuring the <code>maven-compiler-plugin</code></a></li>
<li><a href="#the_final_version_of_pom_xml_file">3.2.4. The Final Version of <code>pom.xml</code> File</a></li>
</ul>
</li>
<li><a href="#creating_the_source_code">3.3. Creating the Source Code</a>
<ul class="sectlevel3">
<li><a href="#a_module_info_java_descriptor">3.3.1. A <code>module-info.java</code> Descriptor</a></li>
<li><a href="#an_http_response_model_class">3.3.2. An HTTP Response Model Class</a></li>
<li><a href="#a_rest_based_microservice_class">3.3.3. A REST-Based Microservice Class</a></li>
<li><a href="#a_structure_of_the_microservice_project">3.3.4. A Structure of the Microservice Project</a></li>
</ul>
</li>
<li><a href="#compiling_the_project">3.4. Compiling the Project</a>
<ul class="sectlevel3">
<li><a href="#using_the_maven">3.4.1. Using the <code>maven</code></a></li>
<li><a href="#using_the_intellij_idea_2">3.4.2. Using the <code>IntelliJ IDEA</code></a></li>
</ul>
</li>
<li><a href="#starting_the_microservice">3.5. Starting the Microservice</a>
<ul class="sectlevel3">
<li><a href="#using_the_ide">3.5.1. Using the IDE:</a></li>
<li><a href="#using_the_terminal_2">3.5.2. Using the Terminal:</a></li>
</ul>
</li>
<li><a href="#verifying_the_microservice">3.6. Verifying the Microservice</a></li>
<li><a href="#automated_test">3.7. Automated Test</a>
<ul class="sectlevel3">
<li><a href="#configuring_the_project_2">3.7.1. Configuring the Project</a></li>
<li><a href="#creating_a_test_class">3.7.2. Creating a Test Class</a></li>
<li><a href="#starting_the_test_class">3.7.3. Starting the Test Class</a></li>
</ul>
</li>
<li><a href="#the_project_at_the_github">3.8. The Project at the Github</a></li>
</ul>
</li>
<li><a href="#core-section">4. Core Concepts</a>
<ul class="sectlevel2">
<li><a href="#core-how-it-works-section">4.1. How It Works?</a>
<ul class="sectlevel3">
<li><a href="#core-how-it-works-core-schema">4.1.1. A Common Work Schema</a></li>
<li><a href="#generating_of_additional_classes">4.1.2. Generating of Additional Classes.</a></li>
<li><a href="#using_the_debug_mode">4.1.3. Using the Debug Mode</a></li>
</ul>
</li>
<li><a href="#rxmicro-annotation-processor-options-section">4.2. <code>RxMicro Annotation Processor</code> Options</a></li>
<li><a href="#core-dont-block-current-thread">4.3. Don&#8217;t Block Current Thread!</a>
<ul class="sectlevel3">
<li><a href="#prohibited_operations">4.3.1. Prohibited Operations</a></li>
<li><a href="#recommended_approach">4.3.2. Recommended Approach</a></li>
</ul>
</li>
<li><a href="#core-reactive-libraries-support">4.4. Reactive Libraries Support</a>
<ul class="sectlevel3">
<li><a href="#core-reactive-bussiness-process-result-types-section">4.4.1. Expected Business Process Results</a></li>
<li><a href="#recommendations_for_choosing_a_library">4.4.2. Recommendations for Choosing a Library</a></li>
</ul>
</li>
<li><a href="#base_model">4.5. Base Model</a></li>
<li><a href="#strings_formatting">4.6. Strings Formatting</a></li>
<li><a href="#core-encapsulation">4.7. Encapsulation</a>
<ul class="sectlevel3">
<li><a href="#a_private_modifier_usage">4.7.1. A <code>private</code> Modifier Usage</a></li>
<li><a href="#a_separate_package_usage">4.7.2. A Separate Package Usage</a></li>
<li><a href="#a_getters_usage">4.7.3. A <code>getters</code> Usage</a></li>
<li><a href="#performance_comparison">4.7.4. Performance Comparison</a></li>
<li><a href="#approach_selection_recommendations">4.7.5. Approach Selection Recommendations</a></li>
</ul>
</li>
<li><a href="#configuration-section">4.8. Configuration</a>
<ul class="sectlevel3">
<li><a href="#configuration-basic-structure-section">4.8.1. Basic Structure of the Config Module</a></li>
<li><a href="#core-config-types">4.8.2. Configuration Types</a></li>
<li><a href="#config_sources_setting">4.8.3. Config Sources Setting</a></li>
<li><a href="#dynamic_configuration">4.8.4. Dynamic Configuration</a></li>
<li><a href="#core-config-user-defined-config">4.8.5. User Defined Configurations</a></li>
<li><a href="#supported_parameter_types">4.8.6. Supported Parameter Types</a></li>
<li><a href="#configuration_verifiers">4.8.7. Configuration Verifiers</a></li>
</ul>
</li>
<li><a href="#logger">4.9. Logger</a>
<ul class="sectlevel3">
<li><a href="#logger_configuration">4.9.1. Logger Configuration</a></li>
<li><a href="#logger_handler">4.9.2. Logger Handler</a></li>
<li><a href="#pattern_formatter">4.9.3. Pattern Formatter</a></li>
<li><a href="#custom_log_event">4.9.4. Custom Log Event</a></li>
<li><a href="#multiline_logs_issue_for_docker_environment">4.9.5. Multiline Logs Issue For Docker Environment</a></li>
</ul>
</li>
<li><a href="#core-rx-micro-json-section">4.10. JSON</a>
<ul class="sectlevel3">
<li><a href="#core-json-type-mapping">4.10.1. A Mapping Between JSON and Java Types</a></li>
<li><a href="#core-json-rxmicro-json-module-usage">4.10.2. <code>rxmicro.json</code> Module Usage</a></li>
<li><a href="#core-json-rxmicro-json-wrappers">4.10.3. Json Wrappers</a></li>
</ul>
</li>
<li><a href="#native_transports">4.11. Native Transports</a></li>
</ul>
</li>
<li><a href="#rest-controller-section">5. REST Controller</a>
<ul class="sectlevel2">
<li><a href="#rest_controller_implementation_requirements">5.1. REST Controller Implementation Requirements.</a>
<ul class="sectlevel3">
<li><a href="#rest_controller_class_requirements">5.1.1. REST Controller Class Requirements.</a></li>
<li><a href="#http_request_handler_requirements">5.1.2. HTTP Request Handler Requirements.</a></li>
</ul>
</li>
<li><a href="#rest-controller-annotations-section">5.2. <code>RxMicro Annotations</code></a></li>
<li><a href="#return_types">5.3. Return Types</a>
<ul class="sectlevel3">
<li><a href="#supported_return_types_for_http_response_without_body">5.3.1. Supported Return Types for HTTP Response without Body</a></li>
<li><a href="#supported_return_types_for_http_response_with_body">5.3.2. Supported Return Types for HTTP Response with Body</a></li>
</ul>
</li>
<li><a href="#routing_of_requests">5.4. Routing of Requests</a>
<ul class="sectlevel3">
<li><a href="#routing_of_requests_based_on_http_method">5.4.1. Routing of Requests Based on HTTP Method</a></li>
<li><a href="#routing_of_requests_based_on_url_path">5.4.2. Routing of Requests Based on URL Path</a></li>
<li><a href="#routing_of_requests_based_on_http_body">5.4.3. Routing of Requests Based on HTTP Body</a></li>
</ul>
</li>
<li><a href="#rest-controller-not-found-section">5.5. <code>Not Found</code> Logic</a></li>
<li><a href="#rest-controller-errors-section">5.6. Exceptions Usage</a>
<ul class="sectlevel3">
<li><a href="#basic_class_of_exceptions">5.6.1. Basic Class of Exceptions</a></li>
<li><a href="#using_the_user_defined_exceptions">5.6.2. Using the User Defined Exceptions</a></li>
<li><a href="#error_signal_generation_methods">5.6.3. Error Signal Generation Methods</a></li>
<li><a href="#predefined_classes_of_exceptions">5.6.4. Predefined Classes of Exceptions</a></li>
</ul>
</li>
<li><a href="#rest-controller-set-status-code-section">5.7. Overriding the Status Code</a></li>
<li><a href="#rest-controller-redirect-section">5.8. Redirecting of Requests</a></li>
<li><a href="#rest-controller-headers-basic">5.9. HTTP Headers Support</a>
<ul class="sectlevel3">
<li><a href="#basic_rules">5.9.1. Basic Rules</a></li>
<li><a href="#supported_data_types">5.9.2. Supported Data Types</a></li>
<li><a href="#rest-controller-headers-static">5.9.3. Static HTTP headers</a></li>
<li><a href="#rest-controller-headers-repeating">5.9.4. Repeating HTTP headers</a></li>
</ul>
</li>
<li><a href="#rest-controller-params-basic">5.10. HTTP Parameters Handling</a>
<ul class="sectlevel3">
<li><a href="#basic_rules_2">5.10.1. Basic Rules</a></li>
<li><a href="#supported_data_types_2">5.10.2. Supported Data Types</a></li>
<li><a href="#complex_model_support">5.10.3. Complex Model Support</a></li>
</ul>
</li>
<li><a href="#rest-controller-path-variables-basic">5.11. The <code>path variables</code> Support</a>
<ul class="sectlevel3">
<li><a href="#basic_rules_3">5.11.1. Basic Rules</a></li>
<li><a href="#supported_data_types_3">5.11.2. Supported Data Types</a></li>
</ul>
</li>
<li><a href="#rest-controller-internals-basic-section">5.12. Support of Internal Data Types</a>
<ul class="sectlevel3">
<li><a href="#basic_rules_4">5.12.1. Basic Rules</a></li>
<li><a href="#supported_internal_data_types">5.12.2. Supported Internal Data Types</a></li>
</ul>
</li>
<li><a href="#rest-controller-versioning-section">5.13. Versioning of REST Controllers</a>
<ul class="sectlevel3">
<li><a href="#versioning_based_on_http_header_analysis">5.13.1. Versioning Based on HTTP Header Analysis</a></li>
<li><a href="#versioning_based_on_url_path_fragment_analysis">5.13.2. Versioning Based on URL Path Fragment Analysis</a></li>
</ul>
</li>
<li><a href="#rest-controller-base-url-path-section">5.14. Base URL Path for All Handlers</a></li>
<li><a href="#rest-controller-cors-section">5.15. <code>CORS</code> Support</a></li>
<li><a href="#rest-controller-request-id-section">5.16. Request ID</a></li>
<li><a href="#rest-controller-rest-server-generator-config-section">5.17. Configuring the Code Generation Process</a></li>
</ul>
</li>
<li><a href="#rest-client-section">6. REST Client</a>
<ul class="sectlevel2">
<li><a href="#rest_client_implementation_requirements">6.1. REST Client Implementation Requirements</a>
<ul class="sectlevel3">
<li><a href="#rest_client_interface_requirements">6.1.1. REST Client Interface Requirements</a></li>
<li><a href="#http_request_handler_requirements_2">6.1.2. HTTP Request Handler Requirements</a></li>
</ul>
</li>
<li><a href="#rest-client-annotations-section">6.2. <code>RxMicro Annotations</code></a></li>
<li><a href="#http_request_handler_return_types">6.3. HTTP Request Handler Return Types</a>
<ul class="sectlevel3">
<li><a href="#supported_return_result_types_for_http_response_without_body">6.3.1. Supported Return Result Types for HTTP Response without Body</a></li>
<li><a href="#supported_return_result_types_for_http_response_with_body">6.3.2. Supported Return Result Types for HTTP Response with Body</a></li>
</ul>
</li>
<li><a href="#rest-client-headers-basic">6.4. HTTP Headers Handling</a>
<ul class="sectlevel3">
<li><a href="#basic_rules_5">6.4.1. Basic Rules</a></li>
<li><a href="#supported_data_types_4">6.4.2. Supported Data Types</a></li>
<li><a href="#rest-client-headers-static">6.4.3. Static HTTP Headers</a></li>
<li><a href="#rest-client-headers-repeating">6.4.4. Repeating HTTP Headers</a></li>
</ul>
</li>
<li><a href="#rest-client-params-basic">6.5. HTTP Parameters Handling</a>
<ul class="sectlevel3">
<li><a href="#basic_rules_6">6.5.1. Basic Rules</a></li>
<li><a href="#supported_data_types_5">6.5.2. Supported Data Types</a></li>
<li><a href="#complex_model_support_2">6.5.3. Complex Model Support</a></li>
<li><a href="#rest-client-query-params-static">6.5.4. Static Query Parameters</a></li>
<li><a href="#rest-client-query-params-repeating">6.5.5. Repeating Query Parameters</a></li>
</ul>
</li>
<li><a href="#rest-client-path-variables-basic">6.6. The <code>path variables</code> Support</a>
<ul class="sectlevel3">
<li><a href="#basic_rules_7">6.6.1. Basic Rules</a></li>
<li><a href="#supported_data_types_6">6.6.2. Supported Data Types</a></li>
</ul>
</li>
<li><a href="#rest-client-internals-basic-section">6.7. Support of Internal Data Types</a>
<ul class="sectlevel3">
<li><a href="#basic_rules_8">6.7.1. Basic Rules</a></li>
<li><a href="#supported_internal_data_types_2">6.7.2. Supported Internal Data Types</a></li>
</ul>
</li>
<li><a href="#rest-client-versioning-section">6.8. Versioning of REST Clients</a>
<ul class="sectlevel3">
<li><a href="#versioning_based_on_http_header_analysis_2">6.8.1. Versioning Based on HTTP Header Analysis</a></li>
<li><a href="#versioning_based_on_url_path_fragment_analysis_2">6.8.2. Versioning Based on URL Path Fragment Analysis</a></li>
</ul>
</li>
<li><a href="#rest-client-base-url-path-section">6.9. Base URL Path for All Handlers</a></li>
<li><a href="#rest-client-expressions-section">6.10. Expressions</a></li>
<li><a href="#rest-controller-request-id-section">6.11. Request ID</a></li>
<li><a href="#rest-client-partial-implementation-section">6.12. Partial Implementation</a></li>
<li><a href="#rest-client-rest-client-generator-config-section">6.13. Configuring the Code Generation Process</a></li>
</ul>
</li>
<li><a href="#validation-section">7. Validation</a>
<ul class="sectlevel2">
<li><a href="#validation-prepare-section">7.1. Preparatory Steps</a>
<ul class="sectlevel3">
<li><a href="#adding_the_required_dependencies_3">7.1.1. Adding the Required Dependencies:</a></li>
<li><a href="#adding_the_rxmicro_validation_module_to_module_info_java">7.1.2. Adding the <code>rxmicro.validation</code> Module to <code>module-info.java</code></a></li>
</ul>
</li>
<li><a href="#validation-std-constraints-section">7.2. Built-in Constraints.</a></li>
<li><a href="#http_requests_server_validation">7.3. HTTP Requests Server Validation</a></li>
<li><a href="#validation-response-section">7.4. HTTP Responses Server Validation</a></li>
<li><a href="#http_responses_client_validation">7.5. HTTP Responses Client Validation</a></li>
<li><a href="#http_requests_client_validation">7.6. HTTP Requests Client Validation</a></li>
<li><a href="#creating_custom_constraints">7.7. Creating Custom Constraints</a></li>
<li><a href="#validation-disable-section">7.8. Disabling Validation</a>
<ul class="sectlevel3">
<li><a href="#removing_the_rxmicro_validation_module">7.8.1. Removing the <code>rxmicro.validation</code> Module</a></li>
<li><a href="#using_generateoption_disabled_option">7.8.2. Using <code>GenerateOption.DISABLED</code> Option</a></li>
<li><a href="#using_disablevalidation_annotation">7.8.3. Using <code>@DisableValidation</code> Annotation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#project-documentation-section">8. REST-based Microservice Documentation</a>
<ul class="sectlevel2">
<li><a href="#project-documentation-basic-usage-section">8.1. Basic Usage</a>
<ul class="sectlevel3">
<li><a href="#min_settings">8.1.1. Min Settings</a></li>
<li><a href="#asciidoctor_maven_plugin_settings">8.1.2. <code>Asciidoctor-maven-plugin</code> Settings</a></li>
<li><a href="#project-documentation-basic-usage-maven-dependency-plugin">8.1.3. <code>Asciidoctor-dependency-plugin</code> Settings</a></li>
</ul>
</li>
<li><a href="#project-documentation-annotations-section">8.2. <code>RxMicro Annotations</code></a></li>
<li><a href="#project-documentation-example-description-section">8.3. <code>@Example</code> and <code>@Description</code> Usage</a></li>
<li><a href="#project-documentation-section-customization-section">8.4. Sections Customization</a></li>
<li><a href="#project-documentation-validation-section">8.5. Integration with <code>rxmicro.validation</code> Module</a></li>
<li><a href="#rest_based_microservice_metadata_configuration">8.6. REST-based Microservice Metadata Configuration</a>
<ul class="sectlevel3">
<li><a href="#project-documentation-metadata-pomxml-section">8.6.1. Using <code>pom.xml</code></a></li>
<li><a href="#project-documentation-metadata-annotations-section">8.6.2. Using Annotations</a></li>
</ul>
</li>
<li><a href="#project-documentation-errors-section">8.7. Error Documentation</a></li>
</ul>
</li>
<li><a href="#data-postgresql-section">9. Postgre SQL Data Repositories</a>
<ul class="sectlevel2">
<li><a href="#data-postgresql-basic-section">9.1. Basic Usage</a></li>
<li><a href="#data-postgresql-annotations-section">9.2. <code>RxMicro Annotations</code></a></li>
<li><a href="#data-postgresql-testing-section">9.3. Repositories Testing</a>
<ul class="sectlevel3">
<li><a href="#data-postgresql-test-database-section">9.3.1. Test Database</a></li>
<li><a href="#data-postgresql-test-templates-section">9.3.2. Test Templates</a></li>
</ul>
</li>
<li><a href="#data-postgresql-model-section">9.4. DataBase Models</a>
<ul class="sectlevel3">
<li><a href="#data-postgresql-model-primitives-section">9.4.1. Primitives</a></li>
<li><a href="#data-postgresql-model-entities-section">9.4.2. Entities</a></li>
</ul>
</li>
<li><a href="#data-postgres-universal-placeholder-section">9.5. Universal Placeholder</a></li>
<li><a href="#data-postgres-repeat-parameter-section">9.6. <code>@RepeatParameter</code> Annotation</a></li>
<li><a href="#data-postgresql-sql-operations-section">9.7. SQL Operations</a>
<ul class="sectlevel3">
<li><a href="#data-postgresql-select-section">9.7.1. <code>@Select</code></a></li>
<li><a href="#data-postgresql-insert-section">9.7.2. <code>@Insert</code></a></li>
<li><a href="#data-postgresql-update-section">9.7.3. <code>@Update</code></a></li>
<li><a href="#data-postgresql-delete-section">9.7.4. <code>@Delete</code></a></li>
</ul>
</li>
<li><a href="#data-postgresql-variables-section">9.8. Variables Support</a></li>
<li><a href="#data-postgresql-primary-keys-section">9.9. Primary Keys Support</a></li>
<li><a href="#data-postgresql-expected-updated-rows-count-section">9.10. <code>@ExpectedUpdatedRowsCount</code> annotation</a></li>
<li><a href="#data-postgresql-transactional-section">9.11. Transactions Support</a>
<ul class="sectlevel3">
<li><a href="#data-postgresql-transactional-transaction-section">9.11.1. DataBase Transactions</a></li>
<li><a href="#data-postgresql-transactional-concurrent-section">9.11.2. Concurrent Access Example</a></li>
</ul>
</li>
<li><a href="#data-postgresql-partial-implementation-section">9.12. Partial Implementation</a></li>
<li><a href="#data-postgresql-logging-section">9.13. Logging</a></li>
</ul>
</li>
<li><a href="#data-mongo-section">10. Mongo Data Repositories</a>
<ul class="sectlevel2">
<li><a href="#data-mongo-basic-section">10.1. Basic Usage</a></li>
<li><a href="#data-mongo-annotations-section">10.2. <code>RxMicro Annotations</code></a></li>
<li><a href="#data-mongo-testing-section">10.3. Repositories Testing</a>
<ul class="sectlevel3">
<li><a href="#data-mongo-test-database-section">10.3.1. Test Database</a></li>
<li><a href="#data-mongo-test-templates-section">10.3.2. Test Templates</a></li>
</ul>
</li>
<li><a href="#data-mongo-universal-placeholder-section">10.4. Universal Placeholder</a></li>
<li><a href="#data-mongo-repeat-parameter-section">10.5. <code>@RepeatParameter</code> Annotation</a></li>
<li><a href="#data-mongo-operations-section">10.6. Mongo Operations</a>
<ul class="sectlevel3">
<li><a href="#data-mongo-find-section">10.6.1. <code>@Find</code></a></li>
<li><a href="#data-mongo-aggregate-section">10.6.2. <code>@Aggregate</code></a></li>
<li><a href="#data-mongo-distinct-section">10.6.3. <code>@Distinct</code></a></li>
<li><a href="#data-mongo-countDocuments-section">10.6.4. <code>@CountDocuments</code></a></li>
<li><a href="#data-mongo-estimatedDocumentCount-section">10.6.5. <code>@EstimatedDocumentCount</code></a></li>
<li><a href="#data-mongo-insert-section">10.6.6. <code>@Insert</code></a></li>
<li><a href="#data-mongo-update-section">10.6.7. <code>@Update</code></a></li>
<li><a href="#data-mongo-delete-section">10.6.8. <code>@Delete</code></a></li>
</ul>
</li>
<li><a href="#data-mongo-partial-implementation-section">10.7. Partial Implementation</a></li>
<li><a href="#data-mongo-logging-section">10.8. Logging</a></li>
</ul>
</li>
<li><a href="#cdi-section">11. Contexts and Dependency Injection</a>
<ul class="sectlevel2">
<li><a href="#cdi-basic-section">11.1. Basic Usage</a></li>
<li><a href="#cdi-annotations-section">11.2. <code>RxMicro Annotations</code></a></li>
<li><a href="#cdi-singletons-section">11.3. All Beans are Singletons!</a></li>
<li><a href="#cdi-constructor-injection-section">11.4. Constructor Injection</a></li>
<li><a href="#cdi-method-injection-section">11.5. Method Injection</a></li>
<li><a href="#ambiguity_resolving">11.6. Ambiguity Resolving</a>
<ul class="sectlevel3">
<li><a href="#default_ambiguity_resolving">11.6.1. Default Ambiguity Resolving</a></li>
<li><a href="#cdi-named">11.6.2. The <code>@Named</code> (<code>@Qualifier</code>) Annotation Usage</a></li>
<li><a href="#custom_annotations_usage">11.6.3. Custom Annotations Usage</a></li>
</ul>
</li>
<li><a href="#cdi-spring-style-section">11.7. Dependency Injection Using Spring Style</a></li>
<li><a href="#cdi-post-construct-section">11.8. <code>@PostConstruct</code></a></li>
<li><a href="#cdi-rx-micro-component-injection-section">11.9. RxMicro Components Injection</a>
<ul class="sectlevel3">
<li><a href="#basic_usage">11.9.1. Basic Usage</a></li>
<li><a href="#cdi-rx-micro-component-injection-all-supported-components-section">11.9.2. All Supported RxMicro Components</a></li>
</ul>
</li>
<li><a href="#cdi-factory-method-section">11.10. Factory Method</a></li>
<li><a href="#cdi-factory-class-section">11.11. Factory Class</a></li>
<li><a href="#cdi-resource-section">11.12. External resource injection</a>
<ul class="sectlevel3">
<li><a href="#basic_usage_2">11.12.1. Basic Usage</a></li>
<li><a href="#additional_info">11.12.2. Additional Info</a></li>
</ul>
</li>
<li><a href="#cdi-optional-injection-section">11.13. Optional Injection</a></li>
<li><a href="#cdi-multibindings-section">11.14. Multibindings</a></li>
</ul>
</li>
<li><a href="#monitoring-section">12. Monitoring</a>
<ul class="sectlevel2">
<li><a href="#monitoring-request-id-section">12.1. Request Id</a>
<ul class="sectlevel3">
<li><a href="#basic_rules_9">12.1.1. Basic Rules</a></li>
<li><a href="#supported_generator_providers">12.1.2. Supported Generator Providers</a></li>
</ul>
</li>
<li><a href="#monitoring-request-tracing-usage-example">12.2. Request Tracing Usage Example</a></li>
</ul>
</li>
<li><a href="#java-integration-section">13. Java EcoSystem Integration</a>
<ul class="sectlevel2">
<li><a href="#java-integration-unnamed-module">13.1. Unnamed Modules Support</a>
<ul class="sectlevel3">
<li><a href="#java-integration-unnamed-module-uber-jar">13.1.1. Uber Jar</a></li>
<li><a href="#java-integration-unnamed-module-module-config">13.1.2. Module Configuration</a></li>
</ul>
</li>
<li><a href="#java-integration-graalvm-native-image">13.2. Using GraalVM to Build a Native Image</a>
<ul class="sectlevel3">
<li><a href="#setup_a_graalvm">13.2.1. Setup a GraalVM</a></li>
<li><a href="#rxmicro_project_configuration">13.2.2. RxMicro Project Configuration</a></li>
<li><a href="#creation_of_the_native_image">13.2.3. Creation of the Native Image</a></li>
<li><a href="#verification_of_the_native_image">13.2.4. Verification of the Native Image</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#tesing-section">14. Testing</a>
<ul class="sectlevel2">
<li><a href="#testing-prepare-section">14.1. Preparatory Steps</a>
<ul class="sectlevel3">
<li><a href="#testing-prepare-lib-versions-section">14.1.1. Definition the Versions of the Used Libraries:</a></li>
<li><a href="#testing-prepare-add-required-dependencies-section">14.1.2. Adding the Required Dependencies:</a></li>
<li><a href="#testing-prepare-maven-compiler-plugin-settings-section">14.1.3. Configuring the <code>maven-compiler-plugin</code>:</a></li>
<li><a href="#testing-prepare-maven-surefire-plugin-settings-section">14.1.4. Configuring the  <code>maven-surefire-plugin</code>:</a></li>
</ul>
</li>
<li><a href="#testing-annotations-section">14.2. <code>RxMicro Test Annotations</code></a></li>
<li><a href="#testing-alternatives-section">14.3. Alternatives</a>
<ul class="sectlevel3">
<li><a href="#injection_algorithm_for_the_alternative_of_the_rxmicro_component">14.3.1. Injection Algorithm for the Alternative of the RxMicro Component</a></li>
<li><a href="#injection_algorithm_for_the_alternative_of_the_custom_component">14.3.2. Injection Algorithm for the Alternative of the Custom Component</a></li>
<li><a href="#testing-alternatives-usage-section">14.3.3. Alternative Usage</a></li>
<li><a href="#components_with_custom_constructors">14.3.4. Components with Custom Constructors</a></li>
<li><a href="#ambiguity_resolving_2">14.3.5. Ambiguity Resolving</a></li>
<li><a href="#cdi_beans_alternatives">14.3.6. CDI Beans Alternatives</a></li>
</ul>
</li>
<li><a href="#testing-how-it-works-section">14.4. How It Works</a></li>
<li><a href="#testing-before-test-section">14.5. The <code>@BeforeThisTest</code> and <code>@BeforeIterationMethodSource</code> Annotations</a></li>
<li><a href="#testing-rest-based-microservice-tests-section">14.6. REST-based Microservice Testing</a>
<ul class="sectlevel3">
<li><a href="#basic_principles">14.6.1. Basic Principles</a></li>
<li><a href="#testing-rest-based-microservice-tests-complex-alternative-usage-section">14.6.2. Features of Testing Complex Microservices that use Alternatives</a></li>
<li><a href="#custom_and_the_rxmicro_framework_code_execution_order">14.6.3. Custom and the RxMicro Framework Code Execution Order</a></li>
</ul>
</li>
<li><a href="#testing-component-tests-section">14.7. Testing of Microservice Components</a>
<ul class="sectlevel3">
<li><a href="#basic_principles_2">14.7.1. Basic Principles</a></li>
<li><a href="#features_of_testing_complex_components_that_use_alternatives">14.7.2. Features of Testing Complex Components that Use Alternatives</a></li>
<li><a href="#custom_and_the_rxmicro_framework_execution_order">14.7.3. Custom and the RxMicro Framework Execution Order</a></li>
</ul>
</li>
<li><a href="#testing-integration-tests-section">14.8. REST-based Microservice Integration Testing</a>
<ul class="sectlevel3">
<li><a href="#testing-integration-tests-basic-section">14.8.1. Basic Principles</a></li>
<li><a href="#testing-BlockingHttpClient-settings-section">14.8.2. The <code>BlockingHttpClient</code> Settings</a></li>
<li><a href="#testing-integration-tests-docker-section">14.8.3. The <code>docker</code> Usage</a></li>
</ul>
</li>
<li><a href="#testing-dbunit-tests-section">14.9. Database Testing Using DBUnit</a>
<ul class="sectlevel3">
<li><a href="#testing-dbunit-test-database-config">14.9.1. Test Database Configuration</a></li>
<li><a href="#testing-dbunit-retrieve-connection-strategies">14.9.2. Retrieve Connection Strategies</a></li>
<li><a href="#testing-dbunit-initial-data-set">14.9.3. <code>@InitialDataSet</code> Annotation</a></li>
<li><a href="#testing-dbunit-expected-data-set">14.9.4. <code>@ExpectedDataSet</code> Annotation</a></li>
<li><a href="#testing-dbunit-rollback-changes">14.9.5. <code>@RollbackChanges</code> Annotation</a></li>
<li><a href="#testing-dbunit-order-by">14.9.6. Ordered Comparison</a></li>
<li><a href="#testing-dbunit-supported-expressions">14.9.7. Supported Expressions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#appendices-section">15. Appendices</a>
<ul class="sectlevel2">
<li><a href="#appendices-faq-section">15.1. Appendix A: FAQ</a>
<ul class="sectlevel3">
<li><a href="#does_the_rxmicro_framework_modify_my_byte_code">15.1.1. Does the RxMicro framework modify my byte code?</a></li>
<li><a href="#can_the_rxmicro_framework_be_used_for_purposes_other_than_microservices">15.1.2. Can the RxMicro framework be used for purposes other than microservices?</a></li>
<li><a href="#why_i_receive_class_not_found_error">15.1.3. Why I receive <code>class not found</code> error?</a></li>
<li><a href="#why_i_receive_the_kotlin_standard_library_is_not_found_in_the_module_graph_error">15.1.4. Why I receive <code>The Kotlin standard library is not found in the module graph</code> error?</a></li>
<li><a href="#why_i_receive_java_lang_nullpointerexception_autorelease_couldnt_be_null_error_during_unit_testing">15.1.5. Why I receive <code>java.lang.NullPointerException: autoRelease couldn&#8217;t be null</code> error during unit testing?</a></li>
<li><a href="#why_i_receive_java_lang_reflect_inaccessibleobjectexception_unable_to_make_microservicetest_accessible_module_module_name_does_not_opens_test_package_to_unnamed_module_error_during_unit_testing">15.1.6. Why I receive <code>java.lang.reflect.InaccessibleObjectException: Unable to make MicroServiceTest() accessible: module module.name does not "opens test.package" to unnamed module</code> error during unit testing?</a></li>
</ul>
</li>
<li><a href="#appendices-links-section">15.2. Appendix B: Useful Links</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>&#169; 2019-2022 rxmicro.io.
Free use of this software is granted under the terms of the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/LICENSE" target="_blank" rel="noopener"><code>Apache License 2.0</code></a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Copies of this entity may be made for Your own use and for distribution to others, provided that You do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically.</p>
</div>
<div class="paragraph">
<p>If You find errors or omissions in this entity, please donâ€™t hesitate to submit an
<a href="https://github.com/rxmicro/rxmicro-usage/issues" target="_blank" rel="noopener"><strong>issue</strong></a> or open <a href="https://github.com/rxmicro/rxmicro-usage/pulls" target="_blank" rel="noopener"><strong>a pull request</strong></a> with a fix.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This entity is also available as a <a href="user-guide.pdf" target="_blank" rel="noopener">PDF download</a>.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="introduction-section"><a class="anchor" href="#introduction-section"></a><a class="link" href="#introduction-section">1. Introduction</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>RxMicro</strong> is a modern, JVM-based, full stack framework designed to develop distributed reactive applications that use a microservice architecture.</p>
</div>
<div class="paragraph">
<p>The RxMicro framework provides developers with a convenient tool to focus on writing an application business logic.
Meanwhile, routine and standard operations, which are the prerequisite for launching an application, are delegated to the framework.</p>
</div>
<div class="paragraph">
<p>The RxMicro framework is small and lightweight.
Even though the RxMicro framework is designed to create microservices, a developer can easily use separate <strong>RxMicro</strong> modules to develop any type of application using a reactive approach.</p>
</div>
<div class="paragraph">
<p>The RxMicro framework is a framework that uses <a href="https://en.wikipedia.org/wiki/Reactive_programming" target="_blank" rel="noopener">reactive programming</a> as the main and <strong>only</strong> approach when designing microservices.</p>
</div>
<div class="paragraph">
<p><strong>Any blocking operations are not supported!</strong></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When developing a project using the RxMicro framework, use only <strong>non-blocking drivers</strong> to interact with databases, network connections and files.
Otherwise Your project will work <strong>too slow</strong>, and won&#8217;t be able to process a large number of clients' requests.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
<div class="sect2">
<h3 id="rxmicro_features"><a class="anchor" href="#rxmicro_features"></a><a class="link" href="#rxmicro_features">1.1. RxMicro Features</a></h3>
<div class="paragraph">
<p>The RxMicro framework provides the following feature set:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Declarative programming using <a href="https://docs.oracle.com/javase/tutorial/java/annotations/" target="_blank" rel="noopener">annotations</a>.</p>
</li>
<li>
<p>Reactive programming using common libraries:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/package-summary.html" target="_blank" rel="noopener"><strong>java.util.concurrent</strong></a>:
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html" target="_blank" rel="noopener">CompletableFuture</a>,
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletionStage.html" target="_blank" rel="noopener">CompletionStage</a>.</p>
</li>
<li>
<p><a href="https://projectreactor.io/docs/core/release/reference/index.html" target="_blank" rel="noopener"><strong>Project Reactor</strong>: Mono, Flux</a>.</p>
</li>
<li>
<p><a href="https://github.com/ReactiveX/RxJava/blob/3.x/README.md" target="_blank" rel="noopener"><strong>RxJava</strong>: Completable,Single, Maybe, Flowable</a>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Configuring using java configuration, annotations, files, system properties and environment variables.</p>
</li>
<li>
<p>Declarative handlers of HTTP requests to the microservice.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Request routing based on HTTP method, URL path and HTTP body analysis.</p>
</li>
<li>
<p>HTTP header processing.</p>
</li>
<li>
<p>HTTP parameter processing.</p>
</li>
<li>
<p>Path variable support.</p>
</li>
<li>
<p>Automatic conversion of request data into Java model and vice versa.</p>
</li>
<li>
<p>Built-in validation of requests and responses.</p>
</li>
<li>
<p>Static configuration support.</p>
</li>
<li>
<p>Handler versioning support.</p>
</li>
<li>
<p><a href="https://developer.mozilla.org/ru/docs/Web/HTTP/CORS" target="_blank" rel="noopener"><code>Cross-Origin Resource Sharing (CORS)</code></a> support.</p>
</li>
<li>
<p>Support for request identification during inter-service interaction.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Declarative REST client.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>HTTP header processing.</p>
</li>
<li>
<p>HTTP parameter processing.</p>
</li>
<li>
<p>Path variable support.</p>
</li>
<li>
<p>Automatic conversion of request data into Java model and vice versa.</p>
</li>
<li>
<p>Built-in validation of requests and responses.</p>
</li>
<li>
<p>Static configuration support.</p>
</li>
<li>
<p>REST client versioning support.</p>
</li>
<li>
<p>Request timeout.</p>
</li>
<li>
<p>Automatic redirection support.</p>
</li>
<li>
<p>Customization option for standard client implementation.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Contexts and Dependency Injection (CDI).</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Dependencies can be explicitly managed without using CDI.</p>
</li>
<li>
<p>Dependency injection by fields, methods and constructors.</p>
</li>
<li>
<p>Qualifier support.</p>
</li>
<li>
<p>Factory method support.</p>
</li>
<li>
<p>Post construct method support.</p>
</li>
<li>
<p>Class factory support.</p>
</li>
<li>
<p>Optional injection.</p>
</li>
<li>
<p>Resource injection.</p>
</li>
<li>
<p>Multibinder support.</p>
</li>
<li>
<p>Dependency injection using JEE and Spring style.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Generation of REST-based microservice documentation.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Documenting with annotations.</p>
</li>
<li>
<p><a href="https://asciidoctor.org/" target="_blank" rel="noopener">asciidoc</a> support (widely used and multifunctional documenting format).</p>
</li>
<li>
<p>Configuration of the project documentation standard sections.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Data Repositories.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Postgre SQL Data Repositories.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code> operation support.</p>
</li>
<li>
<p>Auto-generated primary key support.</p>
</li>
<li>
<p>Composite primary key support.</p>
</li>
<li>
<p>Transaction support.</p>
</li>
<li>
<p>Variable support in SQL query.</p>
</li>
<li>
<p>Customized <code>SELECT</code> queries support.</p>
</li>
<li>
<p>Possibility to customize a standard repository implementation.</p>
</li>
<li>
<p>Access to a low-level API.</p>
</li>
<li>
<p>Auto registration of enum codecs.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Mongo Data Repositories.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><code>find</code>, <code>aggregate</code>, <code>distinct</code>, <code>insert</code>, <code>update</code>, <code>delete</code>, <code>countDocuments</code> and <code>estimatedDocumentCount</code> operation support.</p>
</li>
<li>
<p>Auto-generated entity id support.</p>
</li>
<li>
<p>Query parameter logging.</p>
</li>
<li>
<p>Possibility to customize a standard repository implementation.</p>
</li>
<li>
<p>Access to a low-level API.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Monitoring</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Health checks.</p>
</li>
<li>
<p>Request tracing.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Testing.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Component testing.</p>
</li>
<li>
<p>REST-based microservices testing.</p>
</li>
<li>
<p>Integration testing.</p>
</li>
<li>
<p>Support for alternatives and mocks.</p>
</li>
<li>
<p>Integration with <a href="https://junit.org/junit5/" target="_blank" rel="noopener">JUnit 5</a> and <a href="https://site.mockito.org/" target="_blank" rel="noopener">Mockito</a> frameworks.</p>
</li>
<li>
<p>Integration with <a href="http://dbunit.sourceforge.net/" target="_blank" rel="noopener">DBUnit</a> framework.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Monitoring.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Health checks.</p>
</li>
<li>
<p>Request tracing.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Integration with other Java libraries and frameworks.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><a href="https://www.graalvm.org/docs/reference-manual/native-image/" target="_blank" rel="noopener">A GraalVM native image</a> support.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="rxmicro_benefits"><a class="anchor" href="#rxmicro_benefits"></a><a class="link" href="#rxmicro_benefits">1.2. RxMicro Benefits</a></h3>
<div class="paragraph">
<p>The RxMicro framework provides the following benefits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Declarative programming using annotations.</p>
</li>
<li>
<p>CDI by demand.</p>
</li>
<li>
<p>Human readable generated code.</p>
</li>
<li>
<p>Verifier of the redundant and inefficient source code.</p>
</li>
<li>
<p>Runtime without <code>reflection</code>.</p>
</li>
<li>
<p>Fast startup time.</p>
</li>
<li>
<p>Reduced memory footprint.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These benefits are gained due to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>using of <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.compiler/javax/annotation/processing/Processor.html" target="_blank" rel="noopener"><strong>Java annotation processors</strong></a>, which generates standard code based on <code>RxMicro Annotations</code>;</p>
</li>
<li>
<p>replacing standard Java libraries that require <code>reflection</code> for their work with analogs that do not need <code>reflection</code>;</p>
</li>
<li>
<p>using of <a href="https://netty.io/" target="_blank" rel="noopener"><strong>Netty</strong></a> as the primary NIO framework for <strong>non-blocking asynchronous IO operations</strong>;</p>
</li>
<li>
<p>generation of low-level code avoiding unnecessary abstractions and proxies.</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="requirements"><a class="anchor" href="#requirements"></a><a class="link" href="#requirements">1.3. Requirements</a></h3>
<div class="paragraph">
<p>The RxMicro framework requires <a href="https://openjdk.java.net/projects/jdk/11/" target="_blank" rel="noopener">JDK 11 LTS</a> or higher.</p>
</div>
<div class="paragraph">
<p>To succeed in studying this guide, it is assumed that the reader is familiar with the following technologies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/module-summary.html" target="_blank" rel="noopener"><code>JDK 11 base API</code></a>;</p>
</li>
<li>
<p><a href="https://maven.apache.org/users/index.html" target="_blank" rel="noopener"><code>Apache Maven</code></a>;</p>
</li>
<li>
<p><a href="https://junit.org/junit5/docs/current/user-guide/" target="_blank" rel="noopener"><code>JUnit 5</code></a>;</p>
</li>
<li>
<p><a href="http://dbunit.sourceforge.net/intro.html" target="_blank" rel="noopener"><code>DBUnit</code></a>;</p>
</li>
<li>
<p><a href="https://javadoc.io/doc/org.mockito/mockito-core/latest/org/mockito/Mockito.html" target="_blank" rel="noopener"><code>Mockito</code></a>;</p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Overview" target="_blank" rel="noopener"><code>Hypertext Transfer Protocol (HTTP)</code></a>;</p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Representational_state_transfer" target="_blank" rel="noopener"><code>Representational state transfer (REST)</code></a>;</p>
</li>
<li>
<p><a href="https://www.docker.com/resources/what-container" target="_blank" rel="noopener"><code>Docker</code></a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The RxMicro framework uses the following Java modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Common module(s):</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/module-summary.html" target="_blank" rel="noopener"><code>java.base</code></a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>The <code>rxmicro.logger</code> module requires the following module(s):</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.logging/module-summary.html" target="_blank" rel="noopener"><code>java.logging</code></a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>REST client and REST based microservice test modules require the following module(s):</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.net.http/module-summary.html" target="_blank" rel="noopener"><code>java.net.http</code></a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>The <code>rxmicro.data.r2dbc.postgresql</code> module requires the following module(s):</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.naming/module-summary.html" target="_blank" rel="noopener"><code>java.naming</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.management/module-summary.html" target="_blank" rel="noopener"><code>java.management</code></a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>Netty requires the the following module(s):</p>
<div class="ulist">
<ul>
<li>
<p><code>jdk.unsupported</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="microservice-section"><a class="anchor" href="#microservice-section"></a><a class="link" href="#microservice-section">2. What are Microservices?</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Microservices - also known as the microservice architecture - is an architectural style that structures an application as a collection of services that are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Highly maintainable and testable.</p>
</li>
<li>
<p>Loosely coupled.</p>
</li>
<li>
<p>Independently deployable.</p>
</li>
<li>
<p>Organized around business capabilities.</p>
</li>
<li>
<p>Owned by a small team.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>(Read more at <a href="https://microservices.io/" target="_blank" rel="noopener"><code>https://microservices.io/</code></a>&#8230;&#8203;)</em></p>
</div>
<div class="paragraph">
<p>Thus, a microservice project consists of several microservices.
Each microservice must fulfill only one business task.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s look at a microservice that displays the current date and time in UTC format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class MicroService1 {

    public static void main(final String[] args) {
        System.out.println(Instant.now());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Does this microprogram constitute a microservice?<br>
Yes, since this microprogram fulfills a business task.<br>
Unfortunately, this program has a serious disadvantage: it interacts with clients through the console.
Therefore, <strong>only a client&#8217;s program with a console interface launched in a session of the current logged-in OS user will be able to interact with this microservice!</strong>
This restriction makes it impossible to scale this microservice!</p>
</div>
<div class="paragraph">
<p>Can we improve this situation?
Yes, we can:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class MicroService2 {

    public static void main(final String[] args) throws Exception {
        Files.write(
                Paths.get("/var/microservice/now-instant.txt"),
                Instant.now().toString().getBytes(UTF_8)
        );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This microservice uses a file system to interact with client&#8217;s programs.
In this way, the only requirement for the client&#8217;s program is to be run on the same computer on which the microservice is running.
The situation has improved, but it is still impossible to scale this microservice horizontally!</p>
</div>
<div class="paragraph">
<p>Can we improve this situation?
Yes, we can:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class MicroService3 {

    public static void main(final String[] args) throws Exception {
        try (final ServerSocket serverSocket = new ServerSocket(8080)) {
            try (final Socket clientSocket = serverSocket.accept()) {
                try (final OutputStream out = clientSocket.getOutputStream()) {
                    // read command from input stream
                    out.write(Instant.now().toString().getBytes(UTF_8));
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, the microservice uses the network to interact with clients.
This implementation of the microservice is scalable as the microservice can now be run on several networked computers.
The situation has improved markedly, but there are problems with networking:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Presence of firewalls.</p>
</li>
<li>
<p>The need to create an interaction protocol.</p>
</li>
<li>
<p>Independence from the programming language is an important criterion for the interaction protocol.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Can we improve this situation?
Yes, for this purpose You can use the HTTP protocol with the REST architecture style:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class MicroService4 {

    public static void main(final String[] args) throws IOException {
        final HttpServer server = HttpServer.create(new InetSocketAddress("localhost", 8080), 0);
        server.createContext("/now-instant", exchange -&gt; {
            final String content = Instant.now().toString();
            exchange.sendResponseHeaders(200, content.length());
            exchange.getResponseHeaders().add("Content-Type", "text/txt");
            try (final OutputStream body = exchange.getResponseBody()) {
                body.write(content.getBytes(UTF_8));
            }
        });
        server.start();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>That&#8217;s why microservices are often referred to as REST-based microservices</strong></p>
</div>
<div class="paragraph">
<p>For simple tasks, the entire logic of the microservice can be found in one class, which is often called <strong>microservice</strong>.
If a microservice has to solve a complex task, then this microservice is divided into two logical components:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>REST controller, the main task of which is:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>to accept HTTP requests;</p>
</li>
<li>
<p>to validate HTTP requests;</p>
</li>
<li>
<p>to convert HTTP requests into Java models;</p>
</li>
<li>
<p>to invoke request handlers;</p>
</li>
<li>
<p>once the response model is received, convert it to an HTTP response.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Business service, the main task of which is:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>if the task is of medium complexity, then independently calculate the result and return it to the REST controller;</p>
</li>
<li>
<p>if it is a high-complexity task, then decompose it into sub-tasks and delegate its execution to other microservices.
After all sub-tasks have been completed, merge the result and return it to the REST controller.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Therefore, the following is implied in this guide:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If You find the term <strong>microservice</strong>, it means <strong>REST-based microservice</strong>, unless stated otherwise!</p>
</li>
<li>
<p>If You find the term <strong>REST controller</strong>, it means a logical component of the microservice that performs its direct functions!</p>
</li>
</ol>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="quick-start-section"><a class="anchor" href="#quick-start-section"></a><a class="link" href="#quick-start-section">3. Quick Start</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes in detail the steps to be taken in order to create the REST-based microservice that returns the <code>"Hello World!"</code> message, using the RxMicro framework.</p>
</div>
<div class="paragraph">
<p>In order to successfully execute these instructions, You need to install
<a href="https://openjdk.java.net/projects/jdk/11/" target="_blank" rel="noopener">JDK 11 LTS</a> or higher on Your computer.
For Your convenience it is also recommended to use a modern IDE, for example <a href="https://www.jetbrains.com/idea/" target="_blank" rel="noopener">IntelliJ IDEA</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The features of the <strong>IntelliJ IDEA Community Edition</strong> version are enough for a complete and convenient work on a project that uses the RxMicro framework.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The RxMicro framework consists of several dozens of modules, so for convenient handling it is recommended to install <a href="https://maven.apache.org/" target="_blank" rel="noopener"><code>maven</code></a> on Your computer.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Any modern IDE for Java (<code>IntelliJ IDEA, Eclipse, NetBeans</code>) already contains a built-in <code>maven</code>, so there is no need in its additional installation on Your computer.</p>
</div>
<div class="paragraph">
<p>To run <code>maven</code> commands, You can use Your IDE instead of the terminal.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="creating_a_project"><a class="anchor" href="#creating_a_project"></a><a class="link" href="#creating_a_project">3.1. Creating a Project</a></h3>
<div class="paragraph">
<p>For creating a project, it is recommended to use a modern IDE, for example <a href="https://www.jetbrains.com/idea/" target="_blank" rel="noopener">IntelliJ IDEA</a></p>
</div>
<div class="sect3">
<h4 id="using_the_intellij_idea"><a class="anchor" href="#using_the_intellij_idea"></a><a class="link" href="#using_the_intellij_idea">3.1.1. Using the <code>IntelliJ IDEA</code></a></h4>
<div class="paragraph">
<p>To create a new project, proceed as follows: <code>File</code> &#8594; <code>New</code> &#8594; <code>Project</code> or <code>Create a New Project</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/quick-start/create-maven-project-step1.jpg" alt="create maven project step1">
</div>
<div class="title">Figure 1. Creating the simplest project in IntelliJ IDEA: Choosing a project type.</div>
</div>
<div class="paragraph">
<p>In the appeared dialog box select the <code>Maven</code> type, make sure that <code>Project SDK</code> version 11 or higher will be used, remove the <code>Create from archetype</code> checkbox and click <code>Next</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/quick-start/create-maven-project-step2.jpg" alt="create maven project step2">
</div>
<div class="title">Figure 2. Creating the simplest project in IntelliJ IDEA: Basic settings.</div>
</div>
<div class="paragraph">
<p>In the appeared dialog box type <code>Name</code>, <code>Location</code> (if the default value is wrong) and <code>GroupId</code>
(if the default value is wrong), and click <code>Finish</code>.</p>
</div>
<div class="paragraph">
<p>As a result, IntelliJ IDEA will generate the following project template using maven settings:</p>
</div>
<div id="image-basic-project-template-inline" class="imageblock">
<div class="content">
<img src="images/quick-start/create-maven-project-step3.jpg" alt="create maven project step3">
</div>
<div class="title">Figure 3. Creating the simplest project in IntelliJ IDEA: Basic project template.</div>
</div>
<div class="paragraph">
<p>After creating the standard template, activate the <code>Enable Auto-Import</code> option.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If for some reason the <code>IntelliJ IDEA</code> or another IDE You use for Java coding (e.g. <code>Eclipse</code> or <code>NetBeans</code>) has generated another project template, delete unnecessary files, create un-created folders and leave only the following sections in <code>pom.xml</code>: <code>modelVersion, groupId, artifactId, version</code>.</p>
</div>
<div class="paragraph">
<p>As a result, Your template should fully match the template: <a href="#image-basic-project-template-inline">Figure 3, &#8220;Creating the simplest project in IntelliJ IDEA: Basic project template.&#8221;</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="using_the_terminal"><a class="anchor" href="#using_the_terminal"></a><a class="link" href="#using_the_terminal">3.1.2. Using the Terminal</a></h4>
<div class="paragraph">
<p>It is possible to create a new maven project without using the IDE.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If You don&#8217;t intend to write the source code of a project in notepad, but rather use the IDE to do this, You should directly create a maven project using the IDE.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To do this, open the terminal and run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text"><strong>mvn</strong> archetype:generate -DgroupId=io.rxmicro.examples -DartifactId=quick-start -DinteractiveMode=false</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In order to run <code>maven</code> commands in the terminal it is necessary to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Install <code>JDK</code> and <code>maven</code> on Your computer;</p>
</li>
<li>
<p>Set the <code>JAVA_HOME</code> environment variable;</p>
</li>
<li>
<p>Add the path to <code>$MAVEN_HOME/bin</code> folder to the <code>$PATH</code> environment variable.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>A detailed instruction on the <code>maven</code> installation for its further use in the terminal can be found at the following link: <a href="https://maven.apache.org/install.html" target="_blank" rel="noopener"><code>Installing Apache Maven</code></a>.</em></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As a result, the <code>quick-start</code> folder with the basic project template will be created in the current folder.
After that, the created project must be imported into the IDE.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By default, <code>mvn archetype:generate</code> doesn&#8217;t generate an empty project, but a project with two <code>App</code> and <code>AppTest</code> classes, as well as a connected junit library of <code>3.8.1</code> version in <code>pom.xml</code>.
The specified classes and dependencies should be deleted before performing the following steps of this guide.</p>
</div>
<div class="paragraph">
<p>As a result, Your template should fully match the template: <a href="#image-basic-project-template-inline">Figure 3, &#8220;Creating the simplest project in IntelliJ IDEA: Basic project template.&#8221;</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="using_other_ide"><a class="anchor" href="#using_other_ide"></a><a class="link" href="#using_other_ide">3.1.3. Using Other IDE</a></h4>
<div class="paragraph">
<p>Creating the simplest project with other IDEs does not differ much from creating it with IntelliJ IDEA. When creating, You should also specify <code>maven archetype, groupId, artifactId and version</code>.</p>
</div>
<div class="paragraph">
<p>The main thing is that after creation <strong>Your project template should fully match the template: <a href="#image-basic-project-template-inline">Figure 3, &#8220;Creating the simplest project in IntelliJ IDEA: Basic project template.&#8221;</a></strong>.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="configuring_the_project"><a class="anchor" href="#configuring_the_project"></a><a class="link" href="#configuring_the_project">3.2. Configuring the Project</a></h3>
<div class="paragraph">
<p>Before writing the code of a REST-based microservice, You should configure <code>pom.xml</code> of Your project by performing the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Define the versions of used libraries.</p>
</li>
<li>
<p>Add the required dependencies to the <code>pom.xml</code>.</p>
</li>
<li>
<p>Configure the <code>maven-compiler-plugin</code>.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="definition_the_versions_of_the_used_libraries"><a class="anchor" href="#definition_the_versions_of_the_used_libraries"></a><a class="link" href="#definition_the_versions_of_the_used_libraries">3.2.1. Definition the Versions of the Used Libraries</a></h4>
<div class="paragraph">
<p>To make further updating of library versions convenient, it is recommended to use <code>maven properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;properties&gt;
    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
    &lt;rxmicro.version&gt;0.11&lt;/rxmicro.version&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;maven-compiler-plugin.version&gt;3.10.1&lt;/maven-compiler-plugin.version&gt; <i class="conum" data-value="2"></i><b>(2)</b>
&lt;/properties&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><a href="https://mvnrepository.com/artifact/io.rxmicro" target="_blank" rel="noopener">The latest stable version of the RxMicro framework</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><a href="https://mvnrepository.com/artifact/org.apache.maven.plugins/maven-compiler-plugin" target="_blank" rel="noopener">The latest stable version of the <code>maven-compiler-plugin</code></a>.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="adding_the_required_dependencies"><a class="anchor" href="#adding_the_required_dependencies"></a><a class="link" href="#adding_the_required_dependencies">3.2.2. Adding the Required Dependencies</a></h4>
<div class="paragraph">
<p>Before using RxMicro modules, the following dependencies must be added to the project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
        &lt;artifactId&gt;rxmicro-rest-server-netty&lt;/artifactId&gt; <i class="conum" data-value="1"></i><b>(1)</b>
        &lt;version&gt;${rxmicro.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
        &lt;artifactId&gt;rxmicro-rest-server-exchange-json&lt;/artifactId&gt; <i class="conum" data-value="2"></i><b>(2)</b>
        &lt;version&gt;${rxmicro.version}&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Library for building REST-based microservices based on HTTP server that uses <a href="https://netty.io/" target="_blank" rel="noopener">Netty</a>;</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Library for converting Java model to <a href="https://www.json.org/" target="_blank" rel="noopener">JSON</a> format and vice versa;</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="quick-start-maven-compiler-plugin-settings-section"><a class="anchor" href="#quick-start-maven-compiler-plugin-settings-section"></a><a class="link" href="#quick-start-maven-compiler-plugin-settings-section">3.2.3. Configuring the <code>maven-compiler-plugin</code></a></h4>
<div class="paragraph">
<p>Since the RxMicro framework uses the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.compiler/javax/annotation/processing/Processor.html" target="_blank" rel="noopener">Java annotation processors</a>, You need to set up <code>maven-compiler-plugin</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
    &lt;version&gt;${maven-compiler-plugin.version}&lt;/version&gt;
    &lt;configuration&gt;
        &lt;release&gt;11&lt;/release&gt; <i class="conum" data-value="1"></i><b>(1)</b>
        &lt;annotationProcessorPaths&gt;
            &lt;annotationProcessorPath&gt;
                &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
                &lt;artifactId&gt;rxmicro-annotation-processor&lt;/artifactId&gt; <i class="conum" data-value="2"></i><b>(2)</b>
                &lt;version&gt;${rxmicro.version}&lt;/version&gt;
            &lt;/annotationProcessorPath&gt;
        &lt;/annotationProcessorPaths&gt;
    &lt;/configuration&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;id&gt;source-compile&lt;/id&gt;
            &lt;goals&gt;
                &lt;goal&gt;compile&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
                &lt;annotationProcessors&gt;
                    &lt;annotationProcessor&gt;
                        io.rxmicro.annotation.processor.RxMicroAnnotationProcessor <i class="conum" data-value="3"></i><b>(3)</b>
                    &lt;/annotationProcessor&gt;
                &lt;/annotationProcessors&gt;
                &lt;generatedSourcesDirectory&gt;
                    ${project.build.directory}/generated-sources/ <i class="conum" data-value="4"></i><b>(4)</b>
                &lt;/generatedSourcesDirectory&gt;
            &lt;/configuration&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The RxMicro framework requires a Java compiler of v11 or higher;</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The annotation processor library, that will handle all <code>RxMicro Annotations</code>;</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The annotation processor class, that handles the launch configuration;</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Location of the generated Java classes by the <code>RxMicro Annotation Processor</code>;</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="the_final_version_of_pom_xml_file"><a class="anchor" href="#the_final_version_of_pom_xml_file"></a><a class="link" href="#the_final_version_of_pom_xml_file">3.2.4. The Final Version of <code>pom.xml</code> File</a></h4>
<div class="paragraph">
<p>After all the above changes, the final version of the <code>pom.xml</code> file should look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
                             http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;groupId&gt;io.rxmicro.examples&lt;/groupId&gt;
    &lt;artifactId&gt;quick-start&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;

    &lt;properties&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
        &lt;rxmicro.version&gt;0.11&lt;/rxmicro.version&gt;
        &lt;maven-compiler-plugin.version&gt;3.10.1&lt;/maven-compiler-plugin.version&gt;
    &lt;/properties&gt;

    &lt;build&gt;
        &lt;pluginManagement&gt;
            &lt;plugins&gt;
                &lt;plugin&gt;
                    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
                    &lt;version&gt;${maven-compiler-plugin.version}&lt;/version&gt;
                    &lt;configuration&gt;
                        &lt;release&gt;11&lt;/release&gt;
                        &lt;annotationProcessorPaths&gt;
                            &lt;annotationProcessorPath&gt;
                                &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
                                &lt;artifactId&gt;rxmicro-annotation-processor&lt;/artifactId&gt;
                                &lt;version&gt;${rxmicro.version}&lt;/version&gt;
                            &lt;/annotationProcessorPath&gt;
                        &lt;/annotationProcessorPaths&gt;
                    &lt;/configuration&gt;
                    &lt;executions&gt;
                        &lt;execution&gt;
                            &lt;id&gt;source-compile&lt;/id&gt;
                            &lt;goals&gt;
                                &lt;goal&gt;compile&lt;/goal&gt;
                            &lt;/goals&gt;
                            &lt;configuration&gt;
                                &lt;annotationProcessors&gt;
                                    &lt;annotationProcessor&gt;
                            io.rxmicro.annotation.processor.RxMicroAnnotationProcessor
                                    &lt;/annotationProcessor&gt;
                                &lt;/annotationProcessors&gt;
                                &lt;generatedSourcesDirectory&gt;
                                    ${project.build.directory}/generated-sources/
                                &lt;/generatedSourcesDirectory&gt;
                            &lt;/configuration&gt;
                        &lt;/execution&gt;
                    &lt;/executions&gt;
                &lt;/plugin&gt;
            &lt;/plugins&gt;
        &lt;/pluginManagement&gt;
    &lt;/build&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
            &lt;artifactId&gt;rxmicro-rest-server-netty&lt;/artifactId&gt;
            &lt;version&gt;${rxmicro.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
            &lt;artifactId&gt;rxmicro-rest-server-exchange-json&lt;/artifactId&gt;
            &lt;version&gt;${rxmicro.version}&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt;</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="creating_the_source_code"><a class="anchor" href="#creating_the_source_code"></a><a class="link" href="#creating_the_source_code">3.3. Creating the Source Code</a></h3>
<div class="paragraph">
<p>The source code of the simplest REST-based microservice consists of one module, one package and two classes.
The source code of each of these components is described below.</p>
</div>
<div class="sect3">
<h4 id="a_module_info_java_descriptor"><a class="anchor" href="#a_module_info_java_descriptor"></a><a class="link" href="#a_module_info_java_descriptor">3.3.1. A <code>module-info.java</code> Descriptor</a></h4>
<div class="paragraph">
<p>Java 9 has introduced the <a href="https://www.oracle.com/corporate/features/understanding-java-9-modules.html" target="_blank" rel="noopener"><code>JPMS</code></a>.</p>
</div>
<div class="paragraph">
<p>Therefore, the RxMicro framework, which requires the use of <a href="https://openjdk.java.net/projects/jdk/11/" target="_blank" rel="noopener">JDK 11</a> or higher, requires a <code>module-info.java</code> descriptor for any of Your microservice projects.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">module examples.quick.start {
    requires rxmicro.rest.server.netty;         <i class="conum" data-value="1"></i><b>(1)</b>
    requires rxmicro.rest.server.exchange.json; <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Module for building REST-based microservices based on HTTP server that uses
<a href="https://netty.io/" target="_blank" rel="noopener">Netty</a>, with all required transitive dependencies.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Module for converting a Java model to <a href="https://www.json.org/" target="_blank" rel="noopener">JSON</a>
format and vice versa, with all required transitive dependencies.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Usually <code>module-info.java</code> depends on all RxMicro modules listed in the <code>dependencies</code> section of the <code>pom.xml</code>
file of any of Your microservice projects.
Therefore, it is enough to duplicate all the dependencies in <code>module-info.java</code>.</p>
</div>
<div class="paragraph">
<p><em>Thanks to the transitive dependencies of the RxMicro framework, the number of modules required has been greatly reduced</em>.
<em>Only basic RxMicro modules must be specified!</em></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="an_http_response_model_class"><a class="anchor" href="#an_http_response_model_class"></a><a class="link" href="#an_http_response_model_class">3.3.2. An HTTP Response Model Class</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package io.rxmicro.examples.quick.start;

import static java.util.Objects.requireNonNull;

@SuppressWarnings("SameParameterValue")
final class Response {

    final String message;

    Response(final String message) {
        this.message = requireNonNull(message);
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>According to the <a href="https://json-schema.org/understanding-json-schema/reference/type.html" target="_blank" rel="noopener">specification</a>, JSON format supports the following data types: object, array and primitives: strings, logical type, numeric type and <code>null</code>.</p>
</div>
<div class="paragraph">
<p>To simplify communication between REST-based microservices, the RxMicro framework supports only <strong>JSON object</strong> as a return type of any REST-based microservice.
Thus, any REST-based microservice built via the RxMicro framework can return <strong>only JSON objects</strong>.
In case You need to return a primitive or an array, <strong>You need to create a wrapper class</strong>.</p>
</div>
<div class="paragraph">
<p>Therefore, to display the <code>"Hello World!"</code> string, it is necessary to create a <code>Response</code> wrapper class, which is a wrapper above the string data type.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="a_rest_based_microservice_class"><a class="anchor" href="#a_rest_based_microservice_class"></a><a class="link" href="#a_rest_based_microservice_class">3.3.3. A REST-Based Microservice Class</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package io.rxmicro.examples.quick.start;

import io.rxmicro.rest.method.GET;
import io.rxmicro.rest.server.RxMicroRestServer;

import java.util.concurrent.CompletableFuture;

public final class HelloWorldMicroService {

    @GET("/")
    CompletableFuture&lt;Response&gt; sayHelloWorld() {       <i class="conum" data-value="1"></i><b>(1)</b>
        return CompletableFuture.supplyAsync(() -&gt;
                new Response("Hello World!"));          <i class="conum" data-value="2"></i><b>(2)</b>
    }

    public static void main(final String[] args) {              <i class="conum" data-value="3"></i><b>(3)</b>
        RxMicroRestServer.startRestServer(HelloWorldMicroService.class);  <i class="conum" data-value="4"></i><b>(4)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>REST-based microservice contains a handler of HTTP GET method: <code>sayHelloWorld</code>, which doesn&#8217;t accept any parameters and returns a
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html" target="_blank" rel="noopener"><code>CompletableFuture</code></a> reactive type.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html#supplyAsync(U)"><code>CompletableFuture.supplyAsync()</code></a>
static method is used to create an object of <code>CompletableFuture</code> class.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>To launch a REST-based microservice the <code>main</code> method is used.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The launch is performed using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/RxMicro.java#L77" target="_blank" rel="noopener"><code>RxMicroRestServer.startRestServer(Class&lt;?&gt;)</code></a>
static method, which requires the REST-based microservice class as parameter.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that the HTTP request handler method doesn&#8217;t need to be <code>public</code>.</p>
</div>
<div class="paragraph">
<p>The <code>protected</code> and <code>&lt;default&gt;</code> modifiers are also supported by the RxMicro framework.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="a_structure_of_the_microservice_project"><a class="anchor" href="#a_structure_of_the_microservice_project"></a><a class="link" href="#a_structure_of_the_microservice_project">3.3.4. A Structure of the Microservice Project</a></h4>
<div class="paragraph">
<p>The above-mentioned components of the microservice project should be located in the project according to the following screenshot:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/quick-start/project-structure.jpg" alt="project structure">
</div>
<div class="title">Figure 4. A structure of the microservice project</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="compiling_the_project"><a class="anchor" href="#compiling_the_project"></a><a class="link" href="#compiling_the_project">3.4. Compiling the Project</a></h3>
<div class="sect3">
<h4 id="using_the_maven"><a class="anchor" href="#using_the_maven"></a><a class="link" href="#using_the_maven">3.4.1. Using the <code>maven</code></a></h4>
<div class="paragraph">
<p>To compile a project using the <code>maven</code>, open the terminal in the project root folder and proceed with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text"><strong>mvn</strong> clean compile</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In order to run <code>maven</code> commands in the terminal it is necessary to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Install <code>JDK</code> and <code>maven</code> on Your computer;</p>
</li>
<li>
<p>Set the <code>JAVA_HOME</code> environment variable;</p>
</li>
<li>
<p>Add the path to <code>$MAVEN_HOME/bin</code> folder to the <code>$PATH</code> environment variable.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>A detailed instruction on the <code>maven</code> installation for its further use in the terminal can be found at the following link: <a href="https://maven.apache.org/install.html" target="_blank" rel="noopener"><code>Installing Apache Maven</code></a>.</em></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is possible to compile the project with <code>maven</code> even without using the terminal.
Since any modern IDE for Java contains built-in <code>maven</code>, You can use this built-in <code>maven</code> tool.</p>
</div>
<div class="paragraph">
<p>To do this, open the <code>maven panel</code> and execute the specified commands with a mouse or touchpad manipulator.
For example, the <code>maven panel</code> in IntelliJ IDEA looks like:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/quick-start/maven-panel.jpg" alt="maven panel">
</div>
<div class="title">Figure 5. Maven panel in IntelliJ IDEA</div>
</div>
<div class="paragraph">
<p>After successful compilation, the <code>RxMicro Annotation Processor</code> work results are displayed in the terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">[INFO] ------------------------------------------------------------------------
[INFO]  RX-MICRO ANNOTATIONS PROCESSING
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] Current environment context is:
  RxMicro version: 0.11
  Current module:
    <code>examples.quick.start</code>
  Available RxMicro modules:
    <code>rxmicro.common</code>;
    <code>rxmicro.reflection</code>;
    <code>rxmicro.model</code>;
    <code>rxmicro.runtime</code>;
    <code>rxmicro.config</code>;
    <code>rxmicro.logger</code>;
    <code>rxmicro.files</code>;
    <code>rxmicro.http</code>;
    <code>rxmicro.rest</code>;
    <code>rxmicro.rest.server</code>;
    <code>rxmicro.rest.server.netty</code>;
    <code>rxmicro.json</code>;
    <code>rxmicro.exchange.json</code>;
    <code>rxmicro.rest.server.exchange.json</code>;
  Include packages: &lt;none&gt;
  Exclude packages: &lt;none&gt;
[INFO] Found the following REST controllers:
  io.rxmicro.examples.quick.start.HelloWorldMicroService:
    'GET /' -&gt; sayHelloWorld();
[INFO] Generating java classes...
[INFO] All java classes generated successful in 0.031 seconds. <i class="conum" data-value="1"></i><b>(1)</b>
[INFO] ------------------------------------------------------------------------
[INFO] Annotations processing completed successful.
[INFO] ------------------------------------------------------------------------</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The given information indicates that all files needed to run the microservice have been generated.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In the <code>target</code> folder You can find all generated and compiled classes of the microservice project.</p>
</div>
<div class="paragraph">
<p>To understand how the RxMicro framework works, please go to <a href="#core-how-it-works-section">Section 4.1, &#8220;How It Works?&#8221;</a> section.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="using_the_intellij_idea_2"><a class="anchor" href="#using_the_intellij_idea_2"></a><a class="link" href="#using_the_intellij_idea_2">3.4.2. Using the <code>IntelliJ IDEA</code></a></h4>
<div class="paragraph">
<p>The IntelliJ IDEA allows annotation processors to be launched automatically when building a project.
So if You want to compile a microservice project using IntelliJ IDEA rather than <code>maven</code>, You need to set up the <code>Annotation Processors</code> section in the IntelliJ IDEA.</p>
</div>
<div class="sect4">
<h5 id="enable_annotation_processing"><a class="anchor" href="#enable_annotation_processing"></a><a class="link" href="#enable_annotation_processing">3.4.2.1. Enable Annotation Processing</a></h5>
<div class="paragraph">
<p>To enable annotation processing while building a project with IntelliJ IDEA, You need to set up the <code>Annotation Processors</code> section.
To do so, open the menu: <code>File</code> &#8594; <code>Settings</code> and get to the tab:`Build, Execution, Deployment` &#8594; <code>Compiler</code> &#8594; <code>Annotation Processors</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/quick-start/idea-annotation-processing.jpg" alt="idea annotation processing">
</div>
<div class="title">Figure 6. Required Annotation Processing settings</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Make sure that <strong>all</strong> Your settings of the <code>Annotation Processors</code> section correspond to the settings shown in the figure above.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="rebuilding_the_project"><a class="anchor" href="#rebuilding_the_project"></a><a class="link" href="#rebuilding_the_project">3.4.2.2. Rebuilding the Project</a></h5>
<div class="paragraph">
<p>After setting up the <code>Annotation Processors</code> section, the project must be rebuilt.
To do so, run the following command from the main menu: <code>Build</code> &#8594; <code>Rebuild project</code>.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="starting_the_microservice"><a class="anchor" href="#starting_the_microservice"></a><a class="link" href="#starting_the_microservice">3.5. Starting the Microservice</a></h3>
<div class="sect3">
<h4 id="using_the_ide"><a class="anchor" href="#using_the_ide"></a><a class="link" href="#using_the_ide">3.5.1. Using the IDE:</a></h4>
<div class="paragraph">
<p>You can run the REST-based microservice using the IntelliJ IDEA launch context menu</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/quick-start/run-using-ide.jpg" alt="run using ide">
</div>
<div class="title">Figure 7. Run the REST-based micro service using IntelliJ IDEA context menu.</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If You get the following error while starting the REST-based <code>HelloWorldMicroService</code> microservice:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/quick-start/kotlin-error-fix.jpg" alt="kotlin error fix">
</div>
</div>
<div class="paragraph">
<p>rebuild the project!</p>
</div>
<div class="paragraph">
<p><em>(To do this, run the command <strong>Rebuild project</strong> from the main menu: <code>Build</code> &#8594; <code>Rebuild project</code>.)</em></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After starting, the console will display the following information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">2020-02-02 20:14:11.707 [INFO] io.rxmicro.rest.server.netty.internal.component.NettyServer :
Server started at 0.0.0.0:8080 using NETTY transport in 500 millis <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>Server started in &#8230;&#8203; millis</code> message means that the RxMicro HTTP server has been successfully started.</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If an error occurs during the starting process, the console will display a stack trace of this error.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="using_the_terminal_2"><a class="anchor" href="#using_the_terminal_2"></a><a class="link" href="#using_the_terminal_2">3.5.2. Using the Terminal:</a></h4>
<div class="paragraph">
<p>Go to the <code>target</code> folder of the microservice project, open the terminal in this folder and run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text"><strong>java</strong> -Dfile.encoding=UTF-8 -p ./classes:$M2_REPO/io/rxmicro/rxmicro-rest-server-netty/0.11/rxmicro-rest-server-netty-0.11.jar:$M2_REPO/io/rxmicro/rxmicro-rest-server/0.11/rxmicro-rest-server-0.11.jar:$M2_REPO/io/rxmicro/rxmicro-rest/0.11/rxmicro-rest-0.11.jar:$M2_REPO/io/rxmicro/rxmicro-model/0.11/rxmicro-model-0.11.jar:$M2_REPO/io/rxmicro/rxmicro-http/0.11/rxmicro-http-0.11.jar:$M2_REPO/io/rxmicro/rxmicro-logger/0.11/rxmicro-logger-0.11.jar:$M2_REPO/io/rxmicro/rxmicro-common/0.11/rxmicro-common-0.11.jar:$M2_REPO/io/rxmicro/rxmicro-config/0.11/rxmicro-config-0.11.jar:$M2_REPO/io/rxmicro/rxmicro-runtime/0.11/rxmicro-runtime-0.11.jar:$M2_REPO/io/rxmicro/rxmicro-files/0.11/rxmicro-files-0.11.jar:$M2_REPO/io/netty/netty-codec-http/4.1.85.Final/netty-codec-http-4.1.85.Final.jar:$M2_REPO/io/netty/netty-common/4.1.85.Final/netty-common-4.1.85.Final.jar:$M2_REPO/io/netty/netty-buffer/4.1.85.Final/netty-buffer-4.1.85.Final.jar:$M2_REPO/io/netty/netty-codec/4.1.85.Final/netty-codec-4.1.85.Final.jar:$M2_REPO/io/netty/netty-handler/4.1.85.Final/netty-handler-4.1.85.Final.jar:$M2_REPO/io/netty/netty-transport/4.1.85.Final/netty-transport-4.1.85.Final.jar:$M2_REPO/io/netty/netty-resolver/4.1.85.Final/netty-resolver-4.1.85.Final.jar:$M2_REPO/io/rxmicro/rxmicro-rest-server-exchange-json/0.11/rxmicro-rest-server-exchange-json-0.11.jar:$M2_REPO/io/rxmicro/rxmicro-exchange-json/0.11/rxmicro-exchange-json-0.11.jar:$M2_REPO/io/rxmicro/rxmicro-json/0.11/rxmicro-json-0.11.jar -m <strong>examples.quick.start/io.rxmicro.examples.quick.start.HelloWorldMicroService</strong></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is assumed that the <code>M2_REPO</code> environment variable is set on Your computer.
This variable must contain a path to the maven local repository.</p>
</div>
<div class="paragraph">
<p>By default, the local repository is located in the <code>$HOME/.m2/repository</code>
folder, where <code>$HOME</code> is the home directory <em>(i.e. <code>System.getProperty("user.home")</code>)</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>for Linux platform the <code>$HOME</code> directory is <code>/home/$USERNAME</code>;</p>
</li>
<li>
<p>for MacOS platform the <code>$HOME</code> directory is <code>/Users/$USERNAME</code>;</p>
</li>
<li>
<p>for Windows platform the <code>$HOME</code> directory is <code>C:\Documents and Settings\%USERNAME%</code> or <code>C:\Users\%USERNAME%</code>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The above example of launching a microservice project using a terminal won&#8217;t work on <code>Windows</code> OS.</p>
</div>
<div class="paragraph">
<p>Inoperability is caused by the use of different special symbols on Unix (Linux and MacOS) and Windows platforms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/File.html#pathSeparatorChar" target="_blank" rel="noopener"><code>Path separator</code></a>:</p>
<div class="ulist">
<ul>
<li>
<p>Unix uses the <code>:</code> symbol.</p>
</li>
<li>
<p>Windows uses the <code>;</code> symbol.</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/File.html#separatorChar" target="_blank" rel="noopener"><code>Path name separator</code></a>:</p>
<div class="ulist">
<ul>
<li>
<p>Unix uses the <code>/</code> symbol.</p>
</li>
<li>
<p>Windows uses the <code>\</code> symbol.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Address to <a href="https://en.wikipedia.org/wiki/PATH_(variable)" target="_blank" rel="noopener">environment variable with the <code>M2_REPO</code> name</a>:</p>
<div class="ulist">
<ul>
<li>
<p>Unix uses the <code>$M2_REPO</code> expression.</p>
</li>
<li>
<p>Windows uses the <code>%M2_REPO%</code> expression.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Therefore, in order to launch a microservice project on the <code>Windows</code> OS, it is necessary to replace all special symbols.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After starting, the console will display the following information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text"><strong>java</strong> -p ./classes: \
        $M2_REPO/io/rxmicro/rxmicro-rest-server-netty/0.11/rxmicro-rest-server-netty-0.11.jar: \
        $M2_REPO/io/rxmicro/rxmicro-rest-server/0.11/rxmicro-rest-server-0.11.jar: \
        $M2_REPO/io/rxmicro/rxmicro-rest/0.11/rxmicro-rest-0.11.jar: \
        $M2_REPO/io/rxmicro/rxmicro-model/0.11/rxmicro-model-0.11.jar: \
        $M2_REPO/io/rxmicro/rxmicro-http/0.11/rxmicro-http-0.11.jar: \
        $M2_REPO/io/rxmicro/rxmicro-logger/0.11/rxmicro-logger-0.11.jar: \
        $M2_REPO/io/rxmicro/rxmicro-common/0.11/rxmicro-common-0.11.jar: \
        $M2_REPO/io/rxmicro/rxmicro-config/0.11/rxmicro-config-0.11.jar: \
        $M2_REPO/io/rxmicro/rxmicro-runtime/0.11/rxmicro-runtime-0.11.jar: \
        $M2_REPO/io/rxmicro/rxmicro-files/0.11/rxmicro-files-0.11.jar: \
        $M2_REPO/io/rxmicro/rxmicro-rest-server-exchange-json/0.11/rxmicro-rest-server-exchange-json-0.11.jar: \
        $M2_REPO/io/rxmicro/rxmicro-exchange-json/0.11/rxmicro-exchange-json-0.11.jar: \
        $M2_REPO/io/rxmicro/rxmicro-json/0.11/rxmicro-json-0.11.jar: \
        $M2_REPO/io/netty/netty-codec-http/4.1.85.Final/netty-codec-http-4.1.85.Final.jar: \
        $M2_REPO/io/netty/netty-common/4.1.85.Final/netty-common-4.1.85.Final.jar: \
        $M2_REPO/io/netty/netty-buffer/4.1.85.Final/netty-buffer-4.1.85.Final.jar: \
        $M2_REPO/io/netty/netty-codec/4.1.85.Final/netty-codec-4.1.85.Final.jar: \
        $M2_REPO/io/netty/netty-handler/4.1.85.Final/netty-handler-4.1.85.Final.jar: \
        $M2_REPO/io/netty/netty-transport/4.1.85.Final/netty-transport-4.1.85.Final.jar: \
        $M2_REPO/io/netty/netty-resolver/4.1.85.Final/netty-resolver-4.1.85.Final.jar \
    -m <strong>examples.quick.start/io.rxmicro.examples.quick.start.HelloWorldMicroService</strong>

2020-02-02 20:14:11.707 [INFO] io.rxmicro.rest.server.netty.internal.component.NettyServer :
Server started at 0.0.0.0:8080 using NETTY transport in 500 millis <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>Server started in &#8230;&#8203; millis</code> message means that the RxMicro HTTP server has been successfully started.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When starting the microservice via the terminal, it&#8217;s quite inconvenient to list all dependencies and their versions.
To solve this problem, You can use the <code>maven-dependency-plugin</code>, which can copy all project dependencies.
To activate the <code>maven-dependency-plugin</code>, You must add it to <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;
    &lt;version&gt;${maven-dependency-plugin.version}&lt;/version&gt;<i class="conum" data-value="1"></i><b>(1)</b>
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;id&gt;copy-dependencies&lt;/id&gt;
            &lt;phase&gt;package&lt;/phase&gt;<i class="conum" data-value="2"></i><b>(2)</b>
            &lt;goals&gt;
                &lt;goal&gt;copy-dependencies&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
                &lt;outputDirectory&gt;${project.build.directory}/lib&lt;/outputDirectory&gt;<i class="conum" data-value="3"></i><b>(3)</b>
                &lt;includeScope&gt;compile&lt;/includeScope&gt;<i class="conum" data-value="4"></i><b>(4)</b>
            &lt;/configuration&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><a href="https://mvnrepository.com/artifact/org.apache.maven.plugins/maven-dependency-plugin" target="_blank" rel="noopener">The latest stable version of the <code>maven-dependency-plugin</code></a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The plugin is invoked during the <code>package</code> phase.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Target folder all dependencies should be copied to.<br>
<em>(In the example above, this is the <code>target/lib</code> folder.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>This setting specifies what scope of dependencies should be copied.<br>
<em>(This option allows excluding libraries required for testing or libraries, those already present on the client&#8217;s computer.)</em></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After adding the plugin, You need to execute the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text"><strong>mvn</strong> clean package</code></pre>
</div>
</div>
<div class="paragraph">
<p>As a result of running the command, the <code>maven-dependency-plugin</code> will copy all the dependencies to the <code>target/lib</code> folder:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/quick-start/maven-dependency-plugin-results.jpg" alt="maven dependency plugin results">
</div>
<div class="title">Figure 8. The required dependencies for the simplest REST-based micro service.</div>
</div>
<div class="paragraph">
<p>Now You can simplify the start command<br>
<em>(Instead of listing all the libraries, specify the <code>lib</code> folder)</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text"><strong>java</strong> -p ./classes:lib -m <strong>examples.quick.start/io.rxmicro.examples.quick.start.HelloWorldMicroService</strong></code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The above example of launching a microservice project using a terminal won&#8217;t work on <code>Windows</code> OS.</p>
</div>
<div class="paragraph">
<p>Inoperability is caused by the use of different special symbols on Unix (Linux and MacOS) and Windows platforms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/File.html#pathSeparatorChar" target="_blank" rel="noopener"><code>Path separator</code></a>:</p>
<div class="ulist">
<ul>
<li>
<p>Unix uses the <code>:</code> symbol.</p>
</li>
<li>
<p>Windows uses the <code>;</code> symbol.</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/File.html#separatorChar" target="_blank" rel="noopener"><code>Path name separator</code></a>:</p>
<div class="ulist">
<ul>
<li>
<p>Unix uses the <code>/</code> symbol.</p>
</li>
<li>
<p>Windows uses the <code>\</code> symbol.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Address to <a href="https://en.wikipedia.org/wiki/PATH_(variable)" target="_blank" rel="noopener">environment variable with the <code>M2_REPO</code> name</a>:</p>
<div class="ulist">
<ul>
<li>
<p>Unix uses the <code>$M2_REPO</code> expression.</p>
</li>
<li>
<p>Windows uses the <code>%M2_REPO%</code> expression.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Therefore, in order to launch a microservice project on the <code>Windows</code> OS, it is necessary to replace all special symbols.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="verifying_the_microservice"><a class="anchor" href="#verifying_the_microservice"></a><a class="link" href="#verifying_the_microservice">3.6. Verifying the Microservice</a></h3>
<div class="paragraph">
<p>To receive the <code>"Hello World!"</code> message from the created REST-based microservice, execute <code>GET</code> request to <code>localhost:8080</code> endpoint:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">:$ <strong>curl</strong> -v localhost:8080

* Rebuilt URL to: localhost:8080/
*   Trying 127.0.0.1...
* TCP_NODELAY set
* Connected to localhost (127.0.0.1) port 8080 (#0)

&gt; GET / HTTP/1.1 <i class="conum" data-value="1"></i><b>(1)</b>
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.58.0
&gt; Accept: <strong>/</strong>
&gt;

&lt; HTTP/1.1 200 OK <i class="conum" data-value="2"></i><b>(2)</b>
&lt; Server: RxMicro-NettyServer/0.11
&lt; Date: Thu, 2 Jan 2020 11:48:13 GMT
&lt; Content-Type: application/json
&lt; Content-Length: 25
&lt; Request-Id: 62jJeu8x1310662
&lt;
* Connection #0 to host localhost left intact
<strong>{"message":"Hello World!"}</strong> <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><strong>curl</strong> sends a GET request.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>HTTP server successfully returns a response.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The HTTP body contains a JSON response with the <code>"Hello World!"</code> message.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Therefore, the created REST-based microservice works correctly!</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can also use Your favorite browser instead of <code>curl</code> to verify if the REST-based microservice is working correctly.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="automated_test"><a class="anchor" href="#automated_test"></a><a class="link" href="#automated_test">3.7. Automated Test</a></h3>
<div class="paragraph">
<p>The RxMicro framework provides modules for effective writing of <a href="#tesing-section">any type of tests</a>.
Among all supported test types, a REST-based microservice test is required for the current project.</p>
</div>
<div class="sect3">
<h4 id="configuring_the_project_2"><a class="anchor" href="#configuring_the_project_2"></a><a class="link" href="#configuring_the_project_2">3.7.1. Configuring the Project</a></h4>
<div class="paragraph">
<p>Before writing a REST-based microservice test, You need to configure <code>pom.xml</code> of Your project by performing the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add the required dependencies to <code>pom.xml</code>.</p>
</li>
<li>
<p>Configure the <code>maven-compiler-plugin</code>.</p>
</li>
<li>
<p>Configure the <code>maven-surefire-plugin</code>.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="adding_the_required_dependencies_2"><a class="anchor" href="#adding_the_required_dependencies_2"></a><a class="link" href="#adding_the_required_dependencies_2">3.7.1.1. Adding the Required Dependencies</a></h5>
<div class="paragraph">
<p>Before using RxMicro modules for testing, You need to add the following dependencies to the project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
        &lt;artifactId&gt;rxmicro-test-junit&lt;/artifactId&gt; <i class="conum" data-value="1"></i><b>(1)</b>
        &lt;version&gt;${rxmicro.version}&lt;/version&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
        &lt;artifactId&gt;rxmicro-rest-client-exchange-json&lt;/artifactId&gt; <i class="conum" data-value="2"></i><b>(2)</b>
        &lt;version&gt;${rxmicro.version}&lt;/version&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Unit testing library based on the <a href="https://junit.org/junit5/" target="_blank" rel="noopener">JUnit 5</a> framework</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Library for Java model conversion to <a href="https://www.json.org/" target="_blank" rel="noopener">JSON</a> format and vice versa on the HTTP client side;</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The REST-based microservice testing process consists in launching the REST-based microservice and sending a request to the microservice via HTTP client.<br>
<em>(Therefore, in <code>maven</code> dependencies it&#8217;s necessary to add the library supporting the <a href="https://www.json.org/" target="_blank" rel="noopener">JSON</a>
format on the HTTP client side (<code>rxmicro-rest-client-exchange-json</code>))</em>.<br>
After receiving a response from the microservice, the response is compared to the expected one.</p>
</div>
</div>
<div class="sect4">
<h5 id="configuring_the_maven_compiler_plugin"><a class="anchor" href="#configuring_the_maven_compiler_plugin"></a><a class="link" href="#configuring_the_maven_compiler_plugin">3.7.1.2. Configuring the <code>maven-compiler-plugin</code></a></h5>
<div class="paragraph">
<p>Since the RxMicro framework uses the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.compiler/javax/annotation/processing/Processor.html" target="_blank" rel="noopener">Java annotation processors</a>, You need to configure <code>maven-compiler-plugin</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
    &lt;version&gt;${maven-compiler-plugin.version}&lt;/version&gt;
    &lt;configuration&gt;
        &lt;release&gt;11&lt;/release&gt;
        &lt;annotationProcessorPaths&gt;
            &lt;annotationProcessorPath&gt;
                &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
                &lt;artifactId&gt;rxmicro-annotation-processor&lt;/artifactId&gt;
                &lt;version&gt;${rxmicro.version}&lt;/version&gt;
            &lt;/annotationProcessorPath&gt;
        &lt;/annotationProcessorPaths&gt;
    &lt;/configuration&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;id&gt;source-compile&lt;/id&gt;
            &lt;goals&gt;
                &lt;goal&gt;compile&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
                &lt;annotationProcessors&gt;
                    &lt;annotationProcessor&gt;
            io.rxmicro.annotation.processor.RxMicroAnnotationProcessor
                    &lt;/annotationProcessor&gt;
                &lt;/annotationProcessors&gt;
                &lt;generatedSourcesDirectory&gt;
                    ${project.build.directory}/generated-sources/
                &lt;/generatedSourcesDirectory&gt;
            &lt;/configuration&gt;
        &lt;/execution&gt;
        &lt;execution&gt;
            &lt;id&gt;test-compile&lt;/id&gt; <i class="conum" data-value="1"></i><b>(1)</b>
            &lt;goals&gt;
                &lt;goal&gt;testCompile&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
                &lt;annotationProcessors&gt;
                    &lt;annotationProcessor&gt;
            io.rxmicro.annotation.processor.RxMicroTestsAnnotationProcessor <i class="conum" data-value="2"></i><b>(2)</b>
                    &lt;/annotationProcessor&gt;
                &lt;/annotationProcessors&gt;
                &lt;generatedTestSourcesDirectory&gt;
                    ${project.build.directory}/generated-test-sources/ <i class="conum" data-value="3"></i><b>(3)</b>
                &lt;/generatedTestSourcesDirectory&gt;
            &lt;/configuration&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The tests require a separate configuration, so a new <code>execution</code> must be added.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The annotation processor class that handles test configuration.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Location of Java-generated classes by the test annotation processor.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To learn more about how the <code>RxMicro Annotation Processor</code> works in the test environment, please go to the following section: <a href="#testing-how-it-works-section">Section 14.4, &#8220;How It Works&#8221;</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="configuring_the_maven_surefire_plugin"><a class="anchor" href="#configuring_the_maven_surefire_plugin"></a><a class="link" href="#configuring_the_maven_surefire_plugin">3.7.1.3. Configuring the <code>maven-surefire-plugin</code></a></h5>
<div class="paragraph">
<p>For a successful tests launch while building a project with <code>maven</code> it is necessary to update <code>maven-surefire-plugin</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
    &lt;version&gt;${maven-surefire-plugin.version}&lt;/version&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;configuration&gt;
        &lt;properties&gt;
            &lt;!-- https://junit.org/junit5/docs/5.5.1/api/org/junit/jupiter/api/Timeout.html --&gt;
            &lt;configurationParameters&gt;
                junit.jupiter.execution.timeout.default = 60                <i class="conum" data-value="2"></i><b>(2)</b>
                junit.jupiter.execution.timeout.mode = disabled_on_debug    <i class="conum" data-value="3"></i><b>(3)</b>
                junit.jupiter.execution.parallel.enabled = false            <i class="conum" data-value="4"></i><b>(4)</b>
            &lt;/configurationParameters&gt;
        &lt;/properties&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><a href="https://mvnrepository.com/artifact/org.apache.maven.plugins/maven-surefire-plugin" target="_blank" rel="noopener">Last stable version of <code>maven-surefire-plugin</code></a>.<br>
<em>(The plugin version must be <code>2.22.1</code> or higher, otherwise <code>maven</code> will ignore the tests!.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>In case of an error in the code which uses reactive programming, an infinite function execution may occur.
In order to detect such cases, it is necessary to set a global timeout for all methods in the tests.
<em>(By default, timeout is set in seconds.
More detailed information on timeouts configuration is available <a href="https://junit.org/junit5/docs/current/user-guide/user-guide/#writing-tests-declarative-timeouts" target="_blank" rel="noopener">in official JUnit5 documentation</a>.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>While debugging, timeouts can be turned off.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>This property is useful for the tests debugging from IDE or <code>maven</code>.<br>
<em>(By setting this property the speed of test performance will decrease, so use this property for debugging only!)</em></td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="creating_a_test_class"><a class="anchor" href="#creating_a_test_class"></a><a class="link" href="#creating_a_test_class">3.7.2. Creating a Test Class</a></h4>
<div class="paragraph">
<p>REST-based microservice test is a one class containing one test method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package io.rxmicro.examples.quick.start;

import io.rxmicro.test.BlockingHttpClient;
import io.rxmicro.test.ClientHttpResponse;
import io.rxmicro.test.junit.RxMicroRestBasedMicroServiceTest;
import org.junit.jupiter.api.Test;

import static io.rxmicro.test.json.JsonFactory.jsonObject;
import static org.junit.jupiter.api.Assertions.assertEquals;

@RxMicroRestBasedMicroServiceTest(HelloWorldMicroService.class) <i class="conum" data-value="1"></i><b>(1)</b>
final class HelloWorldMicroServiceTest {

    private BlockingHttpClient blockingHttpClient; <i class="conum" data-value="2"></i><b>(2)</b>

    @Test
    void Should_return_Hello_World_message() {
        final ClientHttpResponse response = blockingHttpClient.get("/"); <i class="conum" data-value="3"></i><b>(3)</b>
        assertEquals(
                jsonObject("message", "Hello World!"), <i class="conum" data-value="4"></i><b>(4)</b>
                response.getBody()
        );
        assertEquals(200, response.getStatusCode()); <i class="conum" data-value="5"></i><b>(5)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>RxMicro Test Annotation</code> indicating which microservice should be run for testing.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a> is a basic HTTP client interface designed for use in tests.
This interface allows executing <strong>blocking</strong> requests to the microservice via the <code>HTTP</code> protocol.
This field is initialized automatically when running the test with <code>reflection</code>.
Upon initialization it refers to the test HTTP server that was automatically started for the test.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Blocking request to the microservice.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Comparing the contents of an HTTP body with an expected value.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Comparing the HTTP status code with an expected value.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For low-level and effective work with JSON format, the RxMicro framework provides a separate <code>rxmicro.json</code> module.</p>
</div>
<div class="paragraph">
<p>To get a common idea of the capabilities of this module, which are required when writing tests, go to the following section: <a href="#core-rx-micro-json-section">Section 4.10, &#8220;JSON&#8221;</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>In microservice tests it is recommended to compare the HTTP request body before comparing the HTTP status, when the microservice constantly returns a text error message!
(This will make it easier to understand the error in case it occurred during the testing.)</strong></p>
</div>
<div class="paragraph">
<p><strong>If the microservice returns ONLY the status when an error occurs, the HTTP body comparison should be skipped!</strong></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For further information on how to test REST-based microservices, go to the following section: <a href="#testing-rest-based-microservice-tests-section">Section 14.6, &#8220;REST-based Microservice Testing&#8221;</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="starting_the_test_class"><a class="anchor" href="#starting_the_test_class"></a><a class="link" href="#starting_the_test_class">3.7.3. Starting the Test Class</a></h4>
<div class="paragraph">
<p>To start the tests, You need to run the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-txt" data-lang="txt"><strong>mvn</strong> clean test</code></pre>
</div>
</div>
<div class="paragraph">
<p>After starting, the console will display the following information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">...
[INFO] ------------------------------------------------------------------------
[INFO]  <strong>RX-MICRO ANNOTATIONS PROCESSING</strong> <i class="conum" data-value="1"></i><b>(1)</b>
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] Current environment context is:
  RxMicro version: 0.11
  Current module:
    <code>examples.quick.start</code>
  Available RxMicro modules:
    ...
  Include packages: &lt;none&gt;
  Exclude packages: &lt;none&gt;
[INFO] Found the following REST controllers:
  io.rxmicro.examples.quick.start.HelloWorldMicroService:
    'GET /' -&gt; sayHelloWorld();
[INFO] Generating java classes...
[INFO] All java classes generated successful in 0.030 seconds. <i class="conum" data-value="2"></i><b>(2)</b>
[INFO] ------------------------------------------------------------------------
[INFO] Annotations processing completed successful.
[INFO] ------------------------------------------------------------------------
...
[INFO] ------------------------------------------------------------------------
[INFO]  <strong>RX-MICRO TEST ANNOTATIONS PROCESSING</strong> <i class="conum" data-value="3"></i><b>(3)</b>
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] Current environment context is:
  RxMicro version: 0.11
  Current module:
    <code>examples.quick.start</code>
  Available RxMicro modules:
    ...
  Include packages: &lt;none&gt;
  Exclude packages: &lt;none&gt;
[INFO] Generating java classes...
[INFO] Test fixer class generated successfully: rxmicro.$$RestBasedMicroServiceTestFixer <i class="conum" data-value="4"></i><b>(4)</b>
[INFO] All java classes generated successful in 0.009 seconds. <i class="conum" data-value="4"></i><b>(4)</b>
[INFO] ------------------------------------------------------------------------
[INFO] Annotations processing completed successful.
[INFO] ------------------------------------------------------------------------
...
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
...
[INFO] <strong>Fix the environment for REST based microservice test(s)...</strong> <i class="conum" data-value="5"></i><b>(5)</b>
[INFO] <strong>opens</strong> examples.quick.start/rxmicro to ALL-UNNAMED <i class="conum" data-value="5"></i><b>(5)</b>
[INFO] <strong>opens</strong> examples.quick.start/io.rxmicro.examples.quick.start to ALL-UNNAMED <i class="conum" data-value="5"></i><b>(5)</b>
[INFO] <strong>opens</strong> examples.quick.start/rxmicro to rxmicro.reflection <i class="conum" data-value="5"></i><b>(5)</b>
[INFO] <strong>opens</strong> examples.quick.start/io.rxmicro.examples.quick.start to rxmicro.reflection <i class="conum" data-value="5"></i><b>(5)</b>
[INFO] <strong>opens</strong> rxmicro.rest.server.netty/io.rxmicro.rest.server.netty.local to ALL-UNNAMED <i class="conum" data-value="5"></i><b>(5)</b>
[INFO] <strong>opens</strong> rxmicro.runtime/io.rxmicro.runtime.local to ALL-UNNAMED <i class="conum" data-value="5"></i><b>(5)</b>
[INFO] <strong>opens</strong> rxmicro.runtime/io.rxmicro.runtime.local.error to ALL-UNNAMED <i class="conum" data-value="5"></i><b>(5)</b>
[INFO] <strong>opens</strong> rxmicro.runtime/io.rxmicro.runtime.local.provider to ALL-UNNAMED <i class="conum" data-value="5"></i><b>(5)</b>
[INFO] <strong>opens</strong> rxmicro.config/io.rxmicro.config.local to ALL-UNNAMED <i class="conum" data-value="5"></i><b>(5)</b>
[INFO] <strong>opens</strong> rxmicro.rest.server/io.rxmicro.rest.server.local.model to ALL-UNNAMED <i class="conum" data-value="5"></i><b>(5)</b>
[INFO] <strong>opens</strong> rxmicro.rest.server/io.rxmicro.rest.server.local.component to ALL-UNNAMED <i class="conum" data-value="5"></i><b>(5)</b>
[INFO] <strong>opens</strong> rxmicro.common/io.rxmicro.common.local to ALL-UNNAMED <i class="conum" data-value="5"></i><b>(5)</b>
[INFO] <strong>opens</strong> rxmicro.http/io.rxmicro.http.local to ALL-UNNAMED <i class="conum" data-value="5"></i><b>(5)</b>
[INFO] Running io.rxmicro.examples.quick.start.HelloWorldMicroServiceTest <i class="conum" data-value="6"></i><b>(6)</b>
[INFO] ...NettyServer: Server started at 0.0.0.0:38751 using NETTY transport. <i class="conum" data-value="7"></i><b>(7)</b>
[INFO] ...Router: Mapped "GET '/'  onto ...HelloWorldMicroService.sayHelloWorld()
[INFO] ...Router: Mapped "GET '/bad-request'  onto ...BadHttpRequestRestController.handle(...)
[INFO] ...HelloWorldMicroServiceTest: JdkHttpClient released <i class="conum" data-value="8"></i><b>(8)</b>
[INFO] ...NettyServer: Retrieved shutdown request ...
[INFO] ...NettyServer: Server stopped <i class="conum" data-value="9"></i><b>(9)</b>
[INFO]
[INFO] Results:
[INFO]
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0 <i class="conum" data-value="10"></i><b>(10)</b>
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] <strong>BUILD SUCCESS</strong>
[INFO] ------------------------------------------------------------------------</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Starting of the <code>RxMicro Annotation Processor</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>RxMicro Annotation Processor</code> has successfully completed its work.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Starting of the <code>RxMicro Tests Annotation Processor</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><code>RxMicro Tests Annotation Processor</code> has successfully completed its work.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>For the test configuration, missing exports were automatically added using the capabilities of the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Module.html" target="_blank" rel="noopener"><code>java.lang.Module</code></a> class.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>REST-based microservice test starting.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>HTTP server has started automatically on random free port.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>The resources of the <code>BlockingHttpClient</code> component have been released.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>HTTP server has stopped successfully.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For further information on how the <code>RxMicro Annotation Processor</code> works for the test environment, go to the following section: <a href="#testing-how-it-works-section">Section 14.4, &#8220;How It Works&#8221;</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="the_project_at_the_github"><a class="anchor" href="#the_project_at_the_github"></a><a class="link" href="#the_project_at_the_github">3.8. The Project at the Github</a></h3>
<div class="paragraph">
<p>The REST-based <code>HelloWorldMicroService</code> microservice project is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/quick-start" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/quick-start</code></a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>pom.xml</code> configuration file is a reference configuration and can be copied to Your next project using the RxMicro framework.</p>
</div>
<div class="paragraph">
<p><strong>DON&#8217;T FORGET to remove the link to the parent project</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;parent&gt;
    &lt;artifactId&gt;examples&lt;/artifactId&gt;
    &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
    &lt;version&gt;0.11&lt;/version&gt;
&lt;/parent&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>and add the <code>properties</code> section describing the versions of the libraries used</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;properties&gt;
    &lt;rxmicro.version&gt;0.11&lt;/rxmicro.version&gt; <i class="conum" data-value="1"></i><b>(1)</b>

    &lt;maven-compiler-plugin.version&gt;3.10.1&lt;/maven-compiler-plugin.version&gt; <i class="conum" data-value="2"></i><b>(2)</b>
    &lt;maven-surefire-plugin.version&gt;3.0.0-M7&lt;/maven-surefire-plugin.version&gt; <i class="conum" data-value="3"></i><b>(3)</b>
    &lt;maven-dependency-plugin.version&gt;3.2.0&lt;/maven-dependency-plugin.version&gt; <i class="conum" data-value="4"></i><b>(4)</b>
&lt;/properties&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><a href="https://mvnrepository.com/artifact/io.rxmicro" target="_blank" rel="noopener">The latest stable version of the RxMicro framework</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><a href="https://mvnrepository.com/artifact/org.apache.maven.plugins/maven-compiler-plugin" target="_blank" rel="noopener">The latest stable version of the <code>maven-compiler-plugin</code></a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><a href="https://mvnrepository.com/artifact/org.apache.maven.plugins/maven-surefire-plugin" target="_blank" rel="noopener">The latest stable version of the <code>maven-surefire-plugin</code></a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><a href="https://mvnrepository.com/artifact/org.apache.maven.plugins/maven-dependency-plugin" target="_blank" rel="noopener">The latest stable version of the <code>maven-dependency-plugin</code></a>.</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="core-section"><a class="anchor" href="#core-section"></a><a class="link" href="#core-section">4. Core Concepts</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section will describe the basic working concepts of the RxMicro framework.</p>
</div>
<div class="sect2">
<h3 id="core-how-it-works-section"><a class="anchor" href="#core-how-it-works-section"></a><a class="link" href="#core-how-it-works-section">4.1. How It Works?</a></h3>
<div class="paragraph">
<p>The RxMicro framework uses the
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.compiler/javax/annotation/processing/Processor.html" target="_blank" rel="noopener">Java annotation processor</a>, which generates standard code using <code>RxMicro Annotations</code>.</p>
</div>
<div class="paragraph">
<p>Thus, the RxMicro framework is a framework of declarative programming.</p>
</div>
<div class="paragraph">
<p>Using the RxMicro framework, the developer focuses on writing the business logic of a microservice.
Then he configures the desired standard behavior with <code>RxMicro Annotations</code>.
When compiling a project, the <code>RxMicro Annotation Processor</code> generates additional classes.
Generated classes contain a standard logic that ensures the functionality of the created microservice.</p>
</div>
<div style="page-break-after: always;"></div>
<div class="sect3">
<h4 id="core-how-it-works-core-schema"><a class="anchor" href="#core-how-it-works-core-schema"></a><a class="link" href="#core-how-it-works-core-schema">4.1.1. A Common Work Schema</a></h4>
<div class="paragraph">
<p>The common work schema can be presented as follows:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/core/how-it-work/core-schema.jpg" alt="core schema">
</div>
<div class="title">Figure 9. The RxMicro framework common work schema.</div>
</div>
<div class="paragraph">
<p>While solving a business task, the developer writes <code>Micro service source code</code>.
Then the developer configures the desired standard microservice behavior via <code>RxMicro Annotations</code>.
After that, the developer compiles the project.</p>
</div>
<div class="paragraph">
<p>Since the <code>RxMicro Annotation Processor</code> is configured in <code>maven</code>, when compiling a project this processor handles the source code of the microservice and generates the additional classes: <code>Micro service generated code</code>.
After that, the compiler compiles the source and generated microservice codes: <code>Micro service byte code</code> and <code>Micro service generated byte code</code>.</p>
</div>
<div class="paragraph">
<p>The compiled source and generated codes along with the <code>RxMicro runtime libraries</code> perform useful work.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="generating_of_additional_classes"><a class="anchor" href="#generating_of_additional_classes"></a><a class="link" href="#generating_of_additional_classes">4.1.2. Generating of Additional Classes.</a></h4>
<div class="paragraph">
<p>Let&#8217;s have a look at <a href="#core-how-it-works-core-schema">the RxMicro framework common work schema</a>, by the example of the REST-based microservice project, which displays the <code>"Hello World!"</code> message in JSON format.<br>
<em>(This project was considered in the <a href="#quick-start-section">Section 3, &#8220;Quick Start&#8221;</a> section.)</em></p>
</div>
<div class="paragraph">
<p>While implementing a business task (in this example, it&#8217;s a task of displaying the <code>"Hello World!"</code> message in JSON format) the developer wrote the following <code>Micro service source code</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/core/how-it-work/micro-src.jpg" alt="micro src">
</div>
</div>
<div class="paragraph">
<p>In order to inform the RxMicro framework about the need to generate additional classes by which a written <code>Micro service source code</code> can be built into an HTTP server to handle the desired HTTP requests, the developer added the following <code>RxMicro Annotation</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@GET("/")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the <code>RxMicro Annotation Processor</code> is configured in maven:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;configuration&gt;
    &lt;annotationProcessors&gt;
        &lt;annotationProcessor&gt;
            io.rxmicro.annotation.processor.RxMicroAnnotationProcessor
        &lt;/annotationProcessor&gt;
    &lt;/annotationProcessors&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>then when compiling a project this processor handles the source code of the REST-based microservice and generates the <code>Micro service generated code</code> additional classes:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/core/how-it-work/micro-gen-src.jpg" alt="micro gen src">
</div>
</div>
<div class="paragraph">
<p>After the source code of additional classes was successfully generated by the <code>RxMicro Annotation Processor</code>, the compiler compiles:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>REST-based microservice source code in <code>Micro service byte code</code>:</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/core/how-it-work/micro-byte.jpg" alt="micro byte">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Generated code of additional classes in <code>Micro service byte code</code>:</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/core/how-it-work/micro-gen-byte.jpg" alt="micro gen byte">
</div>
</div>
<div class="paragraph">
<p>As a result of the compiler&#8217;s work, the REST-based microservice byte code and the byte code of the generated additional classes will be stored jointly in the same <code>jar</code> archive:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/core/how-it-work/all-byte.jpg" alt="all byte">
</div>
</div>
<div class="paragraph">
<p>For successful start of the compiled classes, the <code>RxMicro runtime libraries</code> are required:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/core/how-it-work/rxmicro-runtime-libs.jpg" alt="rxmicro runtime libs">
</div>
</div>
<div class="paragraph">
<p>The <code>Micro service byte code</code>, <code>Micro service byte code</code> and <code>RxMicro runtime libraries</code> are the program components of microservice, which perform useful work.</p>
</div>
<div class="paragraph">
<p>Below we will look closely at each generated additional class and what functions it performs.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The names of all classes generated by the RxMicro framework start with the <code>$$</code> prefix.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="an_additional_class_for_the_rest_controller"><a class="anchor" href="#an_additional_class_for_the_rest_controller"></a><a class="link" href="#an_additional_class_for_the_rest_controller">4.1.2.1. An Additional Class for the REST Controller.</a></h5>
<div class="paragraph">
<p>Any REST-based microservice, contains at least one REST controller.
For the simplest project, REST-based microservice and REST controller are the same class.</p>
</div>
<div class="paragraph">
<p>Therefore, when analyzing such projects, such terms as <strong>REST controller</strong>, <strong>REST-based microservice</strong> and <strong>microservice</strong> are synonymous, because physically they are the same class.</p>
</div>
<div class="paragraph">
<p>The considered REST-based microservice, which displays the <code>"Hello World!"</code> message, is the simplest project, therefore the <code>HelloWorldMicroService</code> class is a REST controller.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more information on the differences between <strong>REST controller</strong>, <strong>REST-based microservice</strong> and <strong>microservice</strong>, refer to the <a href="{microservice}.html#microservice-section">{microservice}.html</a> section.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For each REST controller class the RxMicro framework generates an additional class that performs the following functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creates a REST controller object.<br>
<em>(In case of <a href="#cdi-section"><code>rxmicro.cdi</code></a> module activation, after creation it also injects the required dependencies.)</em></p>
</li>
<li>
<p>Creates <code>ModelReader</code> objects that convert HTTP request parameters, headers and body to Java model.</p>
</li>
<li>
<p>Creates <code>ModelWriter</code> objects that convert the Java response model to HTTP response headers and body;</p>
</li>
<li>
<p>Registers all HTTP request handlers of current REST controller in the router.</p>
</li>
<li>
<p>When receiving an HTTP request via the <code>ModelReader</code> object, converts the HTTP request to the Java request model and invokes the corresponding REST controller handler.</p>
</li>
<li>
<p>After receiving the resulting Java response model via the <code>ModelWriter</code> object, converts the Java model into an HTTP response and sends the response to the client.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Such an additional class for the <code>HelloWorldMicroService</code> class is the <code>$$HelloWorldMicroService</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class $$HelloWorldMicroService extends AbstractRestController {

    private HelloWorldMicroService restController;

    private $$ResponseModelWriter responseModelWriter;

    @Override
    protected void postConstruct() {
        restController = new HelloWorldMicroService(); <i class="conum" data-value="1"></i><b>(1)</b>
        responseModelWriter =
                new $$ResponseModelWriter(restServerConfig.isHumanReadableOutput()); <i class="conum" data-value="2"></i><b>(2)</b>
    }

    @Override
    public void register(final RestControllerRegistrar registrar) { <i class="conum" data-value="3"></i><b>(3)</b>
        registrar.register(
                this,
                new Registration(
                        "",
                        "sayHelloWorld()",
                        this::sayHelloWorld, <i class="conum" data-value="4"></i><b>(4)</b>
                        false,
                        new ExactUrlRequestMappingRule( <i class="conum" data-value="5"></i><b>(5)</b>
                                "GET",
                                "/",
                                false
                        )
                )
        );
    }

    private CompletionStage&lt;HttpResponse&gt; sayHelloWorld(final PathVariableMapping mapping,
                                                        final HttpRequest request) {
        final HttpHeaders headers = HttpHeaders.of();
        return restController.sayHelloWorld() <i class="conum" data-value="6"></i><b>(6)</b>
                .thenApply(response -&gt; buildResponse(response, 200, headers)); <i class="conum" data-value="7"></i><b>(7)</b>
    }

    private HttpResponse buildResponse(final Response model,
                                       final int statusCode,
                                       final HttpHeaders headers) {
        final HttpResponse response = httpResponseBuilder.build();
        response.setStatus(statusCode);
        response.setOrAddHeaders(headers);
        responseModelWriter.write(model, response); <i class="conum" data-value="8"></i><b>(8)</b>
        return response;
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>$$HelloWorldMicroService</code> component creates an instance of the REST controller class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>$$HelloWorldMicroService</code> component creates an instance of the <code>ModelWriter</code> that converts the Java response model to the HTTP response headers and body.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>$$HelloWorldMicroService</code> component registers all HTTP request handlers of the current REST controller.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The registration object contains a reference to the HTTP request handler of the current REST controller.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The registration object contains a rule, according to which the router determines whether to invoke this HTTP request handler.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>When receiving HTTP request, the <code>$$HelloWorldMicroService</code> invokes REST controller method.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>After invoking the REST controller method, an asynchronous result handler is added.<br>
<em>(When using the reactive approach, <a href="#core-dont-block-current-thread">the current thread cannot be blocked</a>, so the
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletionStage.html#thenApply(java.util.function.Function)" target="_blank" rel="noopener"><code>thenApply</code></a> method is used for delayed result handling.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>After receiving the Java response model object, the result handler creates an HTTP response based on the data received from the model, which is subsequently sent to the client.</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="an_modelwriter_class"><a class="anchor" href="#an_modelwriter_class"></a><a class="link" href="#an_modelwriter_class">4.1.2.2. An <code>ModelWriter</code> Class.</a></h5>
<div class="paragraph">
<p>To convert a Java model to an HTTP response, You will need a separate component that performs the following functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Defines in what format to return an HTTP response depending on the project settings.</p>
</li>
<li>
<p>Creates converter objects that support the specified messaging format.</p>
</li>
<li>
<p>When converting a Java model to an HTTP response, manages the conversion process by delegating invocations to the appropriate components.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Such a separate component for the <code>Response</code> model class is the <code>$$ResponseModelWriter</code> class:</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The code of the <code>$$ResponseModelWriter</code> generated class depends on the response model class structure, and the format used for message exchange with the client.</p>
</div>
<div class="paragraph">
<p>Since the format of message exchange with the client is set in <code>module-info.java</code> of the project (<code>requires rxmicro.rest.server.exchange.json;</code>), and is the configuration for all REST controllers and all their handlers, then within the current project, the <code>$$ResponseModelWriter</code> will depend only on the response model class structure.</p>
</div>
<div class="paragraph">
<p>Therefore, if several handlers from different REST controllers will return the <code>Response</code> class model, only one <code>$$ResponseModelWriter</code> class will be generated.
As a result, in each additional REST controller class, the instance of this class will be used.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class $$ResponseModelWriter extends ModelWriter&lt;Response&gt; {

    private final $$ResponseModelToJsonConverter responseModelToJsonConverter; <i class="conum" data-value="1"></i><b>(1)</b>

    private final ExchangeDataFormatConverter&lt;Object&gt; exchangeDataFormatConverter; <i class="conum" data-value="2"></i><b>(2)</b>

    private final String outputMimeType;

    public $$ResponseModelWriter(final boolean humanReadableOutput) {
        exchangeDataFormatConverter =
            new JsonExchangeDataFormatConverter(humanReadableOutput); <i class="conum" data-value="3"></i><b>(3)</b>
        responseModelToJsonConverter = new $$ResponseModelToJsonConverter();
        outputMimeType = exchangeDataFormatConverter.getMimeType();
    }

    @Override
    public void write(final Response model,
                      final HttpResponse response) {
        response.setHeader(HttpHeaders.CONTENT_TYPE, outputMimeType); <i class="conum" data-value="4"></i><b>(4)</b>
        final Map&lt;String, Object&gt; json = responseModelToJsonConverter.toJsonObject(model); <i class="conum" data-value="5"></i><b>(5)</b>
        response.setContent(exchangeDataFormatConverter.toBytes(json)); <i class="conum" data-value="6"></i><b>(6)</b>
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Since the JSON message exchange format is specified in the settings, a component that can convert the Java response model to a JSON response model is required.
<em>(This task is specific for each response model, so to avoid using <code>reflection</code>, You need to generate a separate converter component.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>To convert any low-level model (in this example, it&#8217;s a JSON response model) into a byte array, You also need a separate converter component.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Since the JSON messaging format is specified in the settings, it is assumed that the JSON model will be converted to an byte array, which will be created from the Java response model.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Since the JSON message exchange format is specified in the settings, it is necessary to set the HTTP header: <code>Content-Type = application/json</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>When the HTTP response is formed, it is necessary to convert Java response model to JSON model.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The last step is to convert the JSON model to a byte array, that will be written to the HTTP response body.</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="a_java_model_converter"><a class="anchor" href="#a_java_model_converter"></a><a class="link" href="#a_java_model_converter">4.1.2.3. A Java Model Converter.</a></h5>
<div class="paragraph">
<p>To avoid using <code>reflection</code>, You need a component that can convert Java model to JSON model.</p>
</div>
<div class="paragraph">
<p>This component must support the following functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Convert Java model to JSON model of any complexity.</p>
</li>
<li>
<p>Support all possible class field access models to be an all-purpose tool.<br>
<em>(Supported class field access models are described in details in the <a href="#core-encapsulation">Section 4.7, &#8220;Encapsulation&#8221;</a>.)</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Such a separate component for the <code>Response</code> model class is the <code>$$ResponseModelToJsonConverter</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class $$ResponseModelToJsonConverter extends ModelToJsonConverter&lt;Response&gt; {

    @Override
    <i class="conum" data-value="1"></i><b>(1)</b>
    public Map&lt;String, Object&gt; toJsonObject(final Response model) {
        final JsonObjectBuilder builder = new JsonObjectBuilder();
        putValuesToBuilder(model, builder);
        return builder.build();
    }

    public void putValuesToBuilder(final Response model,
                                   final JsonObjectBuilder builder) {
        builder.put("message", model.message); <i class="conum" data-value="2"></i><b>(2)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>JSON object is presented as <code>Map&lt;String, Object&gt;</code>.<br>
<em>(More information about JSON format support by the RxMicro framework can be found in the <a href="#core-rx-micro-json-section">Section 4.10, &#8220;JSON&#8221;</a>.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The value of the <code>message</code> field is read from the Java model by direct reference to the field.<br>
<em>(Supported class field access models are described in details in the <a href="#core-encapsulation">Section 4.7, &#8220;Encapsulation&#8221;</a>.)</em></td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="an_aggregator_of_the_rest_controllers"><a class="anchor" href="#an_aggregator_of_the_rest_controllers"></a><a class="link" href="#an_aggregator_of_the_rest_controllers">4.1.2.4. An Aggregator of the REST Controllers.</a></h5>
<div class="paragraph">
<p>To integrate developer code into the RxMicro framework infrastructure, You need aggregators.</p>
</div>
<div class="paragraph">
<p>The aggregators perform the following functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Register all generated additional classes for REST controllers;</p>
</li>
<li>
<p>Customize the runtime environment;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The aggregators are invoked by the RxMicro framework using <code>reflection</code>.<br>
<em>(That' s why aggregators have a permanent and predefined names and are located in the special package: <code>rxmicro</code>.)</em></p>
</div>
<div class="paragraph">
<p><strong>An Aggregator of the REST Controllers for any project is always the <code>rxmicro.MODULE_NAME.$$RestControllerAggregatorImpl</code> class</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package rxmicro.MODULE_NAME; <i class="conum" data-value="1"></i><b>(1)</b>

public final class $$RestControllerAggregatorImpl extends RestControllerAggregator { <i class="conum" data-value="2"></i><b>(2)</b>

    static {
        $$EnvironmentCustomizer.customize(); <i class="conum" data-value="3"></i><b>(3)</b>
    }

    protected List&lt;AbstractMicroService&gt; listAllRestControllers() {
        return List.of(
                new io.rxmicro.examples.quick.start.$$HelloWorldMicroService() <i class="conum" data-value="4"></i><b>(4)</b>
        );
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>All aggregators are <strong>always</strong> generated in the special package: <code>rxmicro.MODULE_NAME</code>, where <code>MODULE_NAME</code> is the module name or <code>unnamed</code> constant if the current project does not declare the <code>module-info.java</code> descriptor (Read more: <a href="#java-integration-unnamed-module"><code>Unnamed Modules Support</code></a>).</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The predefined name of the REST controller aggregator class is always <code>$$RestControllerAggregatorImpl</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>When the aggregator class is loaded by the RxMicro framework, the component of the <a href="#core-how-it-works-environment-customizer">current environment customization</a> is invoked.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The aggregator registers all generated additional classes for REST controllers;</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="core-how-it-works-environment-customizer"><a class="anchor" href="#core-how-it-works-environment-customizer"></a><a class="link" href="#core-how-it-works-environment-customizer">4.1.2.5. An Environment Customizer.</a></h5>
<div class="paragraph">
<p>Java 9 has introduced the <a href="https://www.oracle.com/corporate/features/understanding-java-9-modules.html" target="_blank" rel="noopener"><code>JPMS</code></a>.</p>
</div>
<div class="paragraph">
<p>This system requires that a developer configures access to classes in the <code>module-info.java</code> file of the microservice project.</p>
</div>
<div class="paragraph">
<p>To enable the RxMicro framework to load aggregator classes, You must export the <code>rxmicro.MODULE_NAME</code> package to the <code>rxmicro.reflection</code> module:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">module examples.quick.start {
    requires rxmicro.rest.server.netty;
    requires rxmicro.rest.server.exchange.json;

    exports rxmicro.MODULE_NAME to rxmicro.reflection; <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Allow access of reflection util classes from the <code>rxmicro.reflection</code> module to all classes from the <code>rxmicro.MODULE_NAME</code> package.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>But the <code>rxmicro.MODULE_NAME</code> package is created automatically and after deleting all the generated files, it won&#8217;t be possible to compile the <code>module-info.java</code> because of the following error:</p>
</div>
<div class="paragraph">
<p><code>package is empty or does not exist: rxmicro.MODULE_NAME</code>.</p>
</div>
<div class="paragraph">
<p>To solve this problem, the RxMicro framework generates the <code>rxmicro.MODULE_NAME.$$EnvironmentCustomizer</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package rxmicro.MODULE_NAME; <i class="conum" data-value="1"></i><b>(1)</b>

final class $$EnvironmentCustomizer {

    static {
        exportTheRxmicroPackageToReflectionModule(); <i class="conum" data-value="2"></i><b>(2)</b>
        invokeAllStaticSections($$EnvironmentCustomizer.class.getModule(), "$$EnvironmentCustomizer"); <i class="conum" data-value="3"></i><b>(3)</b>
        // All required customization must be here
    }

    public static void customize() {
        //do nothing. All customization is done at the static section
    }

    private static void exportTheRxmicroPackageToReflectionModule() {
        final Module currentModule = $$EnvironmentCustomizer.class.getModule();
        currentModule.addExports("rxmicro.MODULE_NAME", RX_MICRO_REFLECTION_MODULE); <i class="conum" data-value="4"></i><b>(4)</b>
    }

    private $$EnvironmentCustomizer() {
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>All customizers are <strong>always</strong> generated in the special package: <code>rxmicro.MODULE_NAME</code>, where <code>MODULE_NAME</code> is the module name or <code>unnamed</code> constant if the current project does not declare the <code>module-info.java</code> descriptor (Read more: <a href="#java-integration-unnamed-module"><code>Unnamed Modules Support</code></a>).</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>When the class is loaded, the <code>exportTheRxmicroPackageToReflectionModule()</code> static method is invoked.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Finds all <code>$$EnvironmentCustomizer</code> classes that are defined in other modules in the current module path and invokes static sections.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>In this method body, the export of the <code>rxmicro.MODULE_NAME</code> package to the <code>rxmicro.reflection</code> module is performed dynamically using the capabilities of the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Module.html" target="_blank" rel="noopener"><code>java.lang.Module</code></a> class.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Due to this additional class, all necessary settings for the <a href="https://www.oracle.com/corporate/features/understanding-java-9-modules.html" target="_blank" rel="noopener"><code>JPMS</code></a> are created automatically.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the RxMicro framework needs additional automatic settings for its correct work, these settings will be automatically added by the <code>RxMicro Annotation Processor</code> to the <code>rxmicro.MODULE_NAME.$$EnvironmentCustomizer</code> class.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect3">
<h4 id="using_the_debug_mode"><a class="anchor" href="#using_the_debug_mode"></a><a class="link" href="#using_the_debug_mode">4.1.3. Using the Debug Mode</a></h4>
<div class="paragraph">
<p>To get a better idea of how the RxMicro framework works, You can use the debug mode.</p>
</div>
<div class="paragraph">
<p>To do this, set breakpoints and start the microservice in debug mode.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/core/how-it-work/micro-service-start-debug.jpg" alt="micro service start debug">
</div>
<div class="title">Figure 10. Starting the microservice in debug mode.</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The code generated by the <code>RxMicro Annotation Processor</code> is a usual source code.
So You can use breakpoints for this code as well as for Your source code.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/core/how-it-work/micro-service-handle-request-debug.jpg" alt="micro service handle request debug">
</div>
<div class="title">Figure 11. HTTP request handling by microservice in debug mode.</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="rxmicro-annotation-processor-options-section"><a class="anchor" href="#rxmicro-annotation-processor-options-section"></a><a class="link" href="#rxmicro-annotation-processor-options-section">4.2. <code>RxMicro Annotation Processor</code> Options</a></h3>
<div class="paragraph">
<p>The <code>RxMicro Annotation Processor</code> supports the following options:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Options supported by the <code>RxMicro Annotation Processor</code>.</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Option</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Default value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RX_MICRO_MAX_JSON_NESTED_DEPTH</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">maximum stack size for recursive invocations when analyzing models containing JSON nested objects.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>positive int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>20</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RX_MICRO_LOG_LEVEL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RxMicro Annotation Processor</code> logging level.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enum {<code>OFF</code>, <code>INFO</code>, <code>DEBUG</code>}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INFO</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RX_MICRO_DOC_DESTINATION_DIR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the resulting directory <a href="#project-documentation-section">for generated documentation</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Asciidoc: <code>./src/main/asciidoc</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RX_MICRO_BUILD_UNNAMED_MODULE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the <a href="#java-integration-unnamed-module"><code>unnamed module</code></a> support for a microservice project.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RX_MICRO_DOC_ANALYZE_PARENT_POM</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">this option allows analyzing parent <code>pom.xml</code> if child <code>pom.xml</code> does not contain required property.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RX_MICRO_STRICT_MODE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">activates additional validation rules during compilation process.</p>
<p class="tableblock"><strong>The RxMicro team strong recommends enabling the strict mode for your production code.</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>These options are set using the compiler arguments in <code>maven-compiler-plugin</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
    &lt;version&gt;${maven-compiler-plugin.version}&lt;/version&gt;
    &lt;configuration&gt;
        &lt;release&gt;11&lt;/release&gt;
        &lt;compilerArgs&gt;
            &lt;arg&gt;-ARX_MICRO_MAX_JSON_NESTED_DEPTH=20&lt;/arg&gt;
            &lt;arg&gt;-ARX_MICRO_LOG_LEVEL=INFO&lt;/arg&gt;
            &lt;arg&gt;-ARX_MICRO_DOC_DESTINATION_DIR=./src/main/asciidoc&lt;/arg&gt;
            &lt;arg&gt;-ARX_MICRO_BUILD_UNNAMED_MODULE=false&lt;/arg&gt;
            &lt;arg&gt;-ARX_MICRO_DOC_ANALYZE_PARENT_POM=true&lt;/arg&gt;
            &lt;arg&gt;-ARX_MICRO_STRICT_MODE=false&lt;/arg&gt;
        &lt;/compilerArgs&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that it is necessary to add the <code>-A</code> prefix before setting the value of the option.</p>
</div>
<div class="paragraph">
<p>The common format is as follows: <code>-A${name}=${value}</code>.
For example: <code>-ARX_MICRO_LOG_LEVEL=OFF</code></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="core-dont-block-current-thread"><a class="anchor" href="#core-dont-block-current-thread"></a><a class="link" href="#core-dont-block-current-thread">4.3. Don&#8217;t Block Current Thread!</a></h3>
<div class="paragraph">
<p>In modern computer architecture, IO operations are the slowest ones.
As a result, when using
<a href="https://en.wikipedia.org/wiki/Multithreading_(computer_architecture)" target="_blank" rel="noopener">multithreading programming model</a>, the use of CPU and RAM is extremely inefficient.
For a single-user monolithic application such inefficiency is imperceptible.
But for a multi-user distributed application with a much higher number of IO operations, this problem generates huge financial costs for additional hardware and coordination between client data streams (Read more: <a href="https://en.wikipedia.org/wiki/C10k_problem" target="_blank" rel="noopener">C10k problem</a>).</p>
</div>
<div class="paragraph">
<p>Therefore, the <a href="https://en.wikipedia.org/wiki/Event-driven_architecture" target="_blank" rel="noopener">Event-driven architecture (EDA)</a> is used for efficient use of the hardware resources of a multi-user distributed application.</p>
</div>
<div class="paragraph">
<p>The most popular Java framework that uses Event-driven architecture for IO operations is <a href="https://netty.io/" target="_blank" rel="noopener">Netty</a>.
To write efficient programs using Netty, it is necessary to comply with certain rules and restrictions.
The most important of these is the following requirement: <strong>Don&#8217;t block current thread!</strong></p>
</div>
<div class="paragraph">
<p>The RxMicro framework is a framework that runs on Netty.
Therefore, all requirements for applications that utilize Netty also cover the RxMicro framework.</p>
</div>
<div class="sect3">
<h4 id="prohibited_operations"><a class="anchor" href="#prohibited_operations"></a><a class="link" href="#prohibited_operations">4.3.1. Prohibited Operations</a></h4>
<div class="paragraph">
<p>Consequently, when writing microservice applications based on the RxMicro framework, the following operations are <strong>prohibited</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Data reading from a socket or file in a blocking style using <code>java.io.InputStream</code> and child classes.</p>
</li>
<li>
<p>Data writing to a socket or file in a blocking style using <code>java.io.OutputStream</code> and child classes.</p>
</li>
<li>
<p>Interaction with a database using of the blocking driver (all <code>JDBC</code> drivers).</p>
</li>
<li>
<p>Waiting on a lock or a monitor (<code>java.util.concurrent.locks.Lock</code>, <code>Object.wait</code>).</p>
</li>
<li>
<p>Putting the thread into sleep mode (<code>Thread.sleep</code>, <code>TimeUnit.sleep</code>).</p>
</li>
<li>
<p>Any other <a href="https://en.wikipedia.org/wiki/Blocking_(computing)" target="_blank" rel="noopener"><strong>blocking operations</strong></a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="recommended_approach"><a class="anchor" href="#recommended_approach"></a><a class="link" href="#recommended_approach">4.3.2. Recommended Approach</a></h4>
<div class="paragraph">
<p>The absence of blocking operations in the microservice allows handling many concurrent connections, using a small number of threads and, as a result, to effectively use hardware resources of the computer.</p>
</div>
<div class="paragraph">
<p>Therefore, when designing microservices via the RxMicro framework, You must follow by the following rule:</p>
</div>
<div class="paragraph">
<p><strong>When implementing a microservice, if the result can be obtained immediately, it must be returned immediately.</strong></p>
</div>
<div class="paragraph">
<p><strong>Otherwise, You must return
<a href="https://github.com/reactive-streams/reactive-streams-jvm/blob/v1.0.3/README.md#specification" target="_blank" rel="noopener">Publisher</a> or
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html" target="_blank" rel="noopener">CompletableFuture</a>, which will generate the result later.</strong></p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="core-reactive-libraries-support"><a class="anchor" href="#core-reactive-libraries-support"></a><a class="link" href="#core-reactive-libraries-support">4.4. Reactive Libraries Support</a></h3>
<div class="paragraph">
<p>The RxMicro framework supports the following reactive programming libraries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/package-summary.html" target="_blank" rel="noopener"><strong>java.util.concurrent</strong></a>:
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html" target="_blank" rel="noopener">CompletableFuture</a>,
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletionStage.html" target="_blank" rel="noopener">CompletionStage</a>;</p>
</li>
<li>
<p><a href="https://projectreactor.io/docs/core/release/reference/index.html" target="_blank" rel="noopener"><strong>Project Reactor</strong>: Mono, Flux</a>;</p>
</li>
<li>
<p><a href="https://github.com/ReactiveX/RxJava/blob/3.x/README.md" target="_blank" rel="noopener"><strong>RxJava</strong>: Completable, Single, Maybe, Flowable</a>;</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="core-reactive-bussiness-process-result-types-section"><a class="anchor" href="#core-reactive-bussiness-process-result-types-section"></a><a class="link" href="#core-reactive-bussiness-process-result-types-section">4.4.1. Expected Business Process Results</a></h4>
<div class="paragraph">
<p>When writing reactive programs, the following 4 expected results of any business process are possible:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>It is important to complete the business process, but the result is missing or unimportant.</p>
</li>
<li>
<p>The business process returns the result in a single instance or nothing.</p>
</li>
<li>
<p>The business process returns the required result in a single instance.</p>
</li>
<li>
<p>The business process returns the result as <code>(0 .. n)</code> object stream.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When writing a business service using reactive libraries, it is recommended to comply with the following agreements:</p>
</div>
<table id="core-reactive-bussiness-process-reactive-class-mapping-table" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Which class from a reactive library must be choose?</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Reactive Library</strong></th>
<th class="tableblock halign-left valign-top"><strong>java.util.concurrent</strong></th>
<th class="tableblock halign-left valign-top"><strong>Project Reactor</strong></th>
<th class="tableblock halign-left valign-top"><strong>RxJava3</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Without result</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CompletableFuture&lt;Void&gt;
CompletionStage&lt;Void&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mono&lt;Void&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Completable</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Optional result</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CompletableFuture&lt;Optional&lt;MODEL&gt;&gt;
CompletionStage&lt;Optional&lt;MODEL&gt;&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mono&lt;MODEL&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maybe&lt;MODEL&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required result</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CompletableFuture&lt;MODEL&gt;
CompletionStage&lt;MODEL&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mono&lt;MODEL&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single&lt;MODEL&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Stream result</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CompletableFuture&lt;List&lt;MODEL&gt;&gt;
CompletionStage&lt;List&lt;MODEL&gt;&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flux&lt;MODEL&gt;, Mono&lt;List&lt;MODEL&gt;&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flowable&lt;MODEL&gt;, Single&lt;List&lt;MODEL&gt;&gt;</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>The following types of results <code>Flux&lt;MODEL&gt;</code> and <code>Mono&lt;List&lt;MODEL&gt;&gt;</code>, as well as <code>Flowable&lt;MODEL&gt;</code>, <code>Single&lt;List&lt;MODEL&gt;&gt;</code> are not absolutely equivalent!</strong></p>
</div>
<div class="paragraph">
<p>For the <code>Flux&lt;MODEL&gt;</code> and <code>Flowable&lt;MODEL&gt;</code> types, the result handler can be invoked before all data is received from a data source, e.g. from a database.</p>
</div>
<div class="paragraph">
<p>Whereas for <code>Mono&lt;List&lt;MODEL&gt;&gt;</code> and <code>Single&lt;List&lt;MODEL&gt;&gt;</code>
the result handler is invoked <strong>only</strong> after <strong>all</strong> the data is received from the data source!</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="recommendations_for_choosing_a_library"><a class="anchor" href="#recommendations_for_choosing_a_library"></a><a class="link" href="#recommendations_for_choosing_a_library">4.4.2. Recommendations for Choosing a Library</a></h4>
<div class="paragraph">
<p>General recommendation for choosing a reactive programming library when using the RxMicro framework:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If Your microservice contains simple logic, You can use the lightweight and Java-provided
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/package-summary.html" target="_blank" rel="noopener"><strong>java.util.concurrent</strong></a> library, represented by the
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html" target="_blank" rel="noopener"><code>CompletableFuture</code></a> class and the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletionStage.html" target="_blank" rel="noopener"><code>CompletionStage</code></a> interface.</p>
</li>
<li>
<p>If Your microservice contains more complex logic, to describe which You need to use
<a href="http://reactivex.io/documentation/operators.html" target="_blank" rel="noopener">complex operators</a>, it is recommended to choose <strong>Project Reactor</strong> or <strong>RxJava</strong>.</p>
</li>
<li>
<p>When choosing between the <strong>Project Reactor</strong> and <strong>RxJava</strong> follow the recommendations:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If You are more familiar with the <strong>Project Reactor</strong>, then use it, otherwise use <strong>RxJava</strong>.</p>
</li>
<li>
<p>If You need <code>r2dbc</code> based reactive SQL repositories (<code>rxmicro.data.sql.r2dbc</code> module), then use the <strong>Project Reactor</strong>.<br>
<em>(Since <code>r2dbc</code> drivers already use the <strong>Project Reactor</strong>.)</em></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Thus, when writing microservices via the RxMicro framework, You can use any Java reactive programming library that You prefer!</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>FYI</strong> All libraries support a blocking getting of the result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BlockingGetResult {

    public static void main(final String[] args) {
        final String blockingResult1 =
                CompletableFuture.completedFuture("Hello")
                        .join();

        final String blockingResult2 =
                Mono.just("Hello")
                        .block();

        final String blockingResult3 =
                Single.just("Hello")
                        .blockingGet();

        System.out.println(blockingResult1);
        System.out.println(blockingResult2);
        System.out.println(blockingResult3);
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The main need in blocking getting of the result, using reactive programming, arises at Unit testing implementation.
Since the main popular frameworks for unit testing (<a href="https://junit.org/junit5/" target="_blank" rel="noopener"><code>JUnit</code></a>, <a href="https://testng.org/" target="_blank" rel="noopener"><code>TestNG</code></a>, etc.) use the usual thread (blocking) programming model.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="base_model"><a class="anchor" href="#base_model"></a><a class="link" href="#base_model">4.5. Base Model</a></h3>
<div class="paragraph">
<p>Java applications use <code>java.lang.Object.toString()</code> method very often for debug purposes.
Thus a developer must override this method for all model classes in his(her) project.</p>
</div>
<div class="paragraph">
<p>To help with overriding of this method for all model classes the RxMicro framework introduces the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-model/src/main/java/io/rxmicro/model/BaseModel.java" target="_blank" rel="noopener"><code>BaseModel</code></a> class.
This class uses the <code>reflection</code> to generate string representation of the model class on fly.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class CustomModel extends BaseModel {

    String string;

    Integer integer;

    //...

    //toString method not necessary!
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>reflection</code> mechanism is slow one, so use the generated string representation of the model class only for debug purposes!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>According to <a href="https://www.oracle.com/corporate/features/understanding-java-9-modules.html" target="_blank" rel="noopener"><code>JPMS</code></a> requirements all <code>reflection</code> access must be configured at the <code>module-info.java</code> descriptor using <code>exports</code> or opens` instructions.
It means that for correct usage the <code>BaseModel</code> feature, it is necessary to add the following instruction:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">opens io.rxmicro.examples.base.model.model.package4 to
        rxmicro.reflection;</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>io.rxmicro.examples.base.model.model.package4</code> is the package that contains custom model classes.</p>
</div>
<div class="paragraph">
<p>But the <code>BaseModel</code> feature is designed for debug purposes, so required <code>exports</code> or <code>opens</code> instructions are added automatically via generated <a href="#core-how-it-works-environment-customizer"><code>$$EnvironmentCustomizer</code></a> class if You do not add these instructions manually!
So You can use the <code>BaseModel</code> feature without any <code>module-info.java</code> modifications for Your project!</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="strings_formatting"><a class="anchor" href="#strings_formatting"></a><a class="link" href="#strings_formatting">4.6. Strings Formatting</a></h3>
<div class="paragraph">
<p>While developing a software product it is necessary to format strings.</p>
</div>
<div class="paragraph">
<p>For this purpose, Java provides different approaches:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Mono&lt;? extends Result&gt; executeQuery(final Connection connection,
                                    final Long id) {
    final String sql = "SELECT * FROM account WHERE id = $1"; <i class="conum" data-value="1"></i><b>(1)</b>
    SLF4J_LOGGER.info("SQL: {}", sql); <i class="conum" data-value="2"></i><b>(2)</b>
    return Mono.from(connection.createStatement(sql)
            .bind(0, id)
            .execute())
            .onErrorResume(e -&gt; Mono.error(
                    new IllegalArgumentException(
                            String.format(
                                    "SQL '%s' contains syntax error: %s", sql, e.getMessage() <i class="conum" data-value="3"></i><b>(3)</b>
                            ))
                    )
            );
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To generate an SQL query, You need to use <code>$1</code> placeholder.<br>
<em>(This placeholder depends on the used <a href="https://r2dbc.io/spec/1.0.0.RELEASE/spec/html/#statements.parameterized" target="_blank" rel="noopener">R2DBC driver</a>.
For postgresql, it&#8217;s a <code>$1</code> symbol.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>To generate a logging message, You need to use <code>{}</code> placeholder.<br>
<em>(This placeholder depends on the logging library used.
For SLF4J, it&#8217;s a <code>{}</code> symbol.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>To generate an error message, You need to use <code>%s</code> placeholder from a separate utility class, for example
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html#format(java.lang.String,java.lang.Object&#8230;&#8203;)" target="_blank" rel="noopener"><code>String.format</code></a>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>While writing the code, a developer can easily confuse the required placeholder.</p>
</div>
<div class="paragraph">
<p><strong>To avoid such a problem, the RxMicro framework recommends using the universal <code>?</code> placeholder</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Mono&lt;? extends Result&gt; executeQuery(final Connection connection,
                                    final Long id) {
    final String sql = "SELECT * FROM account WHERE id = ?"; <i class="conum" data-value="1"></i><b>(1)</b>
    RX_MICRO_LOGGER.info("SQL: ?", sql); <i class="conum" data-value="2"></i><b>(2)</b>
    return Mono.from(connection.createStatement(sql)
            .bind(0, id)
            .execute())
            .onErrorResume(e -&gt; Mono.error(
                    new InvalidStateException(
                            "SQL '?' contains syntax error: ?", sql, e.getMessage()) <i class="conum" data-value="3"></i><b>(3)</b>
                    )
            );
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To generate an SQL query, You need to use <code>?</code> placeholder.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>To generate a logging message, You need to use <code>?</code> placeholder.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>To generate an error message, You need to use <code>?</code> placeholder.</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="core-encapsulation"><a class="anchor" href="#core-encapsulation"></a><a class="link" href="#core-encapsulation">4.7. Encapsulation</a></h3>
<div class="paragraph">
<p>When designing Java request and response models, there is a need to
<a href="https://en.wikipedia.org/wiki/Encapsulation_(computer_programming)" target="_blank" rel="noopener">protect data from unauthorized modification</a>.</p>
</div>
<div class="sect3">
<h4 id="a_private_modifier_usage"><a class="anchor" href="#a_private_modifier_usage"></a><a class="link" href="#a_private_modifier_usage">4.7.1. A <code>private</code> Modifier Usage</a></h4>
<div class="paragraph">
<p>The standard solution to this problem in Java is using the <code>private</code> modifier:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class Response {

    private final String message; <i class="conum" data-value="1"></i><b>(1)</b>

    Response(final String message) {
        this.message = requireNonNull(message);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>By declaring the <code>message</code> field as <code>private</code>, the developer allows access to this field only from inside the class.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To violate encapsulation principles when necessary, Java provides powerful <code>reflection</code> mechanism.</p>
</div>
<div class="paragraph">
<p>The RxMicro framework is aware of this mechanism, so when generating a converter, the framework uses it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import static rxmicro.$$Reflections.getFieldValue; <i class="conum" data-value="1"></i><b>(1)</b>

public final class $$ResponseModelToJsonConverter extends ModelToJsonConverter&lt;Response&gt; {

    @Override
    public Map&lt;String, Object&gt; toJsonObject(final Response model) {
        final JsonObjectBuilder builder = new JsonObjectBuilder();
        putValuesToBuilder(model, builder);
        return builder.build();
    }

    public void putValuesToBuilder(final Response model,
                                   final JsonObjectBuilder builder) {
        builder.put("message", getFieldValue(model, "message")); <i class="conum" data-value="2"></i><b>(2)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Static import of method that allows reading field value with <code>reflection</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Reading the value of the <code>message</code> field from the response model.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Using <code>reflection</code> when converting from Java model to JSON model while processing each request can <a href="#core-encapsulation-benchmark">reduce microservice performance</a>, where this problem can be avoided.
Therefore, when compiling this class, the <code>RxMicro Annotation Processor</code> generates a warning message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text"><strong>[WARNING]</strong> Response.java:[27,26] <strong>PERFORMANCE WARNING</strong>: To read a value from io.rxmicro.example.hello.world.Response.message rxmicro will use the reflection.
It is recommended to add a getter or change the field modifier: from private to default, protected or public.</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the <a href="#rxmicro-annotation-processor-options-section"><code>RX_MICRO_STRICT_MODE</code></a> is set, the RxMicro Annotation Processor throws a compilation error instead of showing the <strong>PERFORMANCE WARNING</strong>.</p>
</div>
<div class="paragraph">
<p><strong>By default the reflection usage for model classes is not allowed for strict mode!</strong></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="a_separate_package_usage"><a class="anchor" href="#a_separate_package_usage"></a><a class="link" href="#a_separate_package_usage">4.7.2. A Separate Package Usage</a></h4>
<div class="paragraph">
<p>The best and <strong>recommended</strong> solution to this problem is to create a separate package (e.g. <code>model</code>) and declare all fields of the model classes without any access modifier (i.e. <code>default/package</code>).
Under this approach, fields can be accessed <strong>only</strong> from classes of the same package.
And the package contains <strong>only</strong> classes of models without any business logic:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/core/encapsulation/model-package.jpg" alt="model package">
</div>
<div class="title">Figure 12. Recommended structure to support encapsulation in Java models.</div>
</div>
<div class="paragraph">
<p><strong>Using model class fields without any access modifier (i.e. <code>default/package</code>) allows You to generate a converter that can read or write a value using direct access to the field by <code>.</code> operator.</strong></p>
</div>
</div>
<div class="sect3">
<h4 id="a_getters_usage"><a class="anchor" href="#a_getters_usage"></a><a class="link" href="#a_getters_usage">4.7.3. A <code>getters</code> Usage</a></h4>
<div class="paragraph">
<p>If the simplest logic is required when reading a value from a model field, You can use <code>getter</code>.</p>
</div>
<div class="paragraph">
<p>To do this, declare the field as <code>private</code> and add <code>getter</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Response {

    private final String message;

    public Response(final String message) {
        this.message = requireNonNull(message);
    }

    public String getMessage() {
        if (message.isEmpty()) {
            return "&lt;Empty&gt;";
        } else {
            return message;
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, <code>getter</code> will be used in the generated converter to get the result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class $$ResponseModelToJsonConverter extends ModelToJsonConverter&lt;Response&gt; {

    @Override
    public Map&lt;String, Object&gt; toJsonObject(final Response model) {
        final JsonObjectBuilder builder = new JsonObjectBuilder();
        putValuesToBuilder(model, builder);
        return builder.build();
    }

    public void putValuesToBuilder(final Response model,
                                   final JsonObjectBuilder builder) {
        builder.put("message", model.getMessage()); <i class="conum" data-value="1"></i><b>(1)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>getter</code> invoking to get the value of the response model field.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="performance_comparison"><a class="anchor" href="#performance_comparison"></a><a class="link" href="#performance_comparison">4.7.4. Performance Comparison</a></h4>
<div class="paragraph">
<p>Performance test source code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Warmup(iterations = 5)
@Measurement(iterations = 5)
@Fork(value = 2, jvmArgsAppend = "-server")
@BenchmarkMode({
        Mode.Throughput,
        Mode.AverageTime,
        Mode.SingleShotTime
})
@State(Scope.Benchmark)
@OutputTimeUnit(MILLISECONDS)
@Threads(1)
public class ReadWriteFieldBenchmark {

    private final CustomClass customClass = new CustomClass("text");

    private final Map&lt;Class&lt;?&gt;, Map&lt;String, Field&gt;&gt; cache = new HashMap&lt;&gt;();

    public ReadWriteFieldBenchmark() {
        try {
            final Field field = CustomClass.class.getDeclaredField("value");
            if (!field.canAccess(customClass)) {
                field.setAccessible(true);
            }
            cache.put(CustomClass.class, new HashMap&lt;&gt;(Map.of("value", field)));
        } catch (final NoSuchFieldException e) {
            throw new RuntimeException(e);
        }
    }

    @Benchmark
    public void readDirectField() {
        var v = customClass.value;
    }

    @Benchmark
    public void writeDirectField() {
        customClass.value = "string";
    }

    @Benchmark
    public void readUsingGetter() {
        var v = customClass.getValue();
    }

    @Benchmark
    public void writeUsingSetter() {
        customClass.setValue("string");
    }

    @Benchmark // read field value using reflection with field search at the cache
    public void readUsingReflection() throws IllegalAccessException {
        var v = cache.get(CustomClass.class).get("value").get(customClass);
    }

    @Benchmark // write field value using reflection with field search at the cache
    public void writeUsingReflection() throws IllegalAccessException {
        cache.get(CustomClass.class).get("value").set(customClass, "string");
    }
}</code></pre>
</div>
</div>
<div id="core-encapsulation-benchmark" class="paragraph">
<p>Performance test results:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-txt" data-lang="txt">Benchmark                                       Mode  Cnt       Score       Error   Units
ReadWriteFieldBenchmark.readDirectField         thrpt   10  753348.188 Â± 90286.947  ops/ms
ReadWriteFieldBenchmark.readUsingGetter         thrpt   10  764112.155 Â± 94525.371  ops/ms
ReadWriteFieldBenchmark.readUsingReflection     thrpt   10   26241.478 Â±  3838.172  ops/ms
ReadWriteFieldBenchmark.writeDirectField        thrpt   10  344623.904 Â± 18961.759  ops/ms
ReadWriteFieldBenchmark.writeUsingReflection    thrpt   10   19430.735 Â±  2135.813  ops/ms
ReadWriteFieldBenchmark.writeUsingSetter        thrpt   10  323596.205 Â± 28416.707  ops/ms
ReadWriteFieldBenchmark.readDirectField          avgt   10      â‰ˆ 10â»â¶               ms/op
ReadWriteFieldBenchmark.readUsingGetter          avgt   10      â‰ˆ 10â»â¶               ms/op
ReadWriteFieldBenchmark.readUsingReflection      avgt   10      â‰ˆ 10â»â´               ms/op
ReadWriteFieldBenchmark.writeDirectField         avgt   10      â‰ˆ 10â»â¶               ms/op
ReadWriteFieldBenchmark.writeUsingReflection     avgt   10      â‰ˆ 10â»â´               ms/op
ReadWriteFieldBenchmark.writeUsingSetter         avgt   10      â‰ˆ 10â»â¶               ms/op
ReadWriteFieldBenchmark.readDirectField            ss   10       0.001 Â±     0.001   ms/op
ReadWriteFieldBenchmark.readUsingGetter            ss   10       0.001 Â±     0.001   ms/op
ReadWriteFieldBenchmark.readUsingReflection        ss   10       0.008 Â±     0.005   ms/op
ReadWriteFieldBenchmark.writeDirectField           ss   10       0.002 Â±     0.001   ms/op
ReadWriteFieldBenchmark.writeUsingReflection       ss   10       0.011 Â±     0.008   ms/op
ReadWriteFieldBenchmark.writeUsingSetter           ss   10       0.001 Â±     0.001   ms/op</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Test results show that reading/writing by a direct reference or via <code>getter</code>/<code>setter</code> is performed <strong>28/17 times faster</strong>, than when using <code>reflection</code>!</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="approach_selection_recommendations"><a class="anchor" href="#approach_selection_recommendations"></a><a class="link" href="#approach_selection_recommendations">4.7.5. Approach Selection Recommendations</a></h4>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Thus, the RxMicro framework uses the following algorithm to read (write) from the fields of the Java model:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If the field is declared with <code>public</code>, <code>protected</code> or <code>default/package</code> modifiers, the generated converter uses direct access to the field using the <code>.</code> operator;</p>
</li>
<li>
<p>If the field is declared with the <code>private</code> modifier and the developer created <code>getter</code>/<code>setter</code>, the generated converter uses the <code>getter</code>/<code>setter</code> invocation to get or write the field value;</p>
</li>
<li>
<p>If the field is declared with the <code>private</code> modifier without <code>getter</code>/<code>setter</code> declaration, the generated converter uses
<code>reflection</code> to access the model field.<br>
<em>(When generating this type of converter the <code>RxMicro Annotation Processor</code> informs the developer about <code>PERFORMANCE WARNING</code>.)</em></p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To benefit from the encapsulation advantages when designing microservices via the RxMicro framework, follow the recommendations:</p>
</div>
<div class="paragraph">
<p><strong>When creating request and response models, use a separate package and <code>default/package</code> access modifier!</strong></p>
</div>
<div class="paragraph">
<p><strong>If the simplest logic of reading (writing) the value of the model field is required, use <code>getter</code> (<code>setter</code>) and
<code>private</code> field access modifier.</strong></p>
</div>
<div class="paragraph">
<p><strong>Do not use the <code>private</code> modifier to access the model field without <code>getter</code> (<code>setter</code>)!</strong><br>
<strong>This approach offers no benefits!</strong></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the <a href="#rxmicro-annotation-processor-options-section"><code>RX_MICRO_STRICT_MODE</code></a> is set, the RxMicro Annotation Processor throws a compilation error instead of showing the <strong>PERFORMANCE WARNING</strong>.</p>
</div>
<div class="paragraph">
<p><strong>By default the reflection usage for model classes is not allowed for strict mode!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="configuration-section"><a class="anchor" href="#configuration-section"></a><a class="link" href="#configuration-section">4.8. Configuration</a></h3>
<div class="paragraph">
<p>The RxMicro framework provides the <code>rxmicro.config</code> module for flexible configuration of microservices to any environment.
This module provides the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Support for different types of configuration sources: files, classpath resources, environment variables, command line arguments, etc.;</p>
</li>
<li>
<p>Inheritance and redefinition of settings from different configuration sources;</p>
</li>
<li>
<p>Changing the order in which the configuration sources are read;</p>
</li>
<li>
<p>Configuration using annotations and Java classes.</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
<div class="sect3">
<h4 id="configuration-basic-structure-section"><a class="anchor" href="#configuration-basic-structure-section"></a><a class="link" href="#configuration-basic-structure-section">4.8.1. Basic Structure of the Config Module</a></h4>
<div class="paragraph">
<p>Each class that extends the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/Config.java" target="_blank" rel="noopener"><code>Config</code></a>
abstract class is a configuration class.</p>
</div>
<div class="paragraph">
<p>Each configuration class defines its own namespace.
Each namespace clearly defines the corresponding configuration class.
The namespace is necessary to set the settings of the configuration class fields in text form.
(<em>Further details will be described below.</em>)</p>
</div>
<div class="paragraph">
<p>To work with configurations, the RxMicro framework provides the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/Configs.java" target="_blank" rel="noopener"><code>Configs</code></a> configuration manager.</p>
</div>
<div class="paragraph">
<p>To read the current settings, You must use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/Configs.java#L101" target="_blank" rel="noopener"><code>Configs.getConfig(Class&lt;T&gt;)</code></a> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class ReadConfigMicroService {

    @GET("/")
    void readHttpServerPort() {
        final HttpServerConfig config = getConfig(HttpServerConfig.class); <i class="conum" data-value="1"></i><b>(1)</b>
        System.out.println("HTTP server port: " + config.getPort());
    }

    public static void main(final String[] args) {
        startRestServer(ReadConfigMicroService.class);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Getting the current HTTP server configuration using the <code>Configs.getConfig</code> static method.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To change the standard configuration settings, You must use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/Configs.java#L134" target="_blank" rel="noopener"><code>Configs.Builder</code></a> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class CustomizeConfigMicroService {

    @GET("/")
    void test() {
        // do something
    }

    public static void main(final String[] args) {
        new Configs.Builder()
                .withConfigs(new HttpServerConfig()
                        .setPort(9090)) <i class="conum" data-value="1"></i><b>(1)</b>
                .build(); <i class="conum" data-value="2"></i><b>(2)</b>
        startRestServer(CustomizeConfigMicroService.class); <i class="conum" data-value="3"></i><b>(3)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Setting the HTTP server custom port.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Creating the configuration manager object.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>REST-based microservice should be started after configuration manager settings, otherwise changes will not take effect.</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Each subsequent invocation of the <code>Configs.Builder.build()</code> method overrides all configuration manager settings.
<em>(In any microservice project there is only one configuration manager object!)</em></p>
</div>
<div class="paragraph">
<p>It means that if the developer creates several <code>Configs.Builder</code> instances, it will be the last invocation of the <code>build</code>
method that matters, the others will be ignored.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-common/config-basic" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-common/config-basic</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Settings customization via the <code>Configs.Builder.build()</code> is one of the types of configuration.
This type of configuration is called <a href="#core-config-java-classes-section">configuration using Java classes</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="core-config-types"><a class="anchor" href="#core-config-types"></a><a class="link" href="#core-config-types">4.8.2. Configuration Types</a></h4>
<div class="paragraph">
<p>The RxMicro framework supports the following configuration types:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configuration using <code>classpath</code> resources.</p>
</li>
<li>
<p>Configuration using <code>properties</code> files.</p>
</li>
<li>
<p>Configuration using environment variables.</p>
</li>
<li>
<p>Configuration using Java system properties.</p>
</li>
<li>
<p>Configuration using Java classes.</p>
</li>
<li>
<p>Configuration using Java annotations.</p>
</li>
<li>
<p>Configuration using command line arguments.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="configuration_using_classpath_resources"><a class="anchor" href="#configuration_using_classpath_resources"></a><a class="link" href="#configuration_using_classpath_resources">4.8.2.1. Configuration Using <code>classpath</code> Resources.</a></h5>
<div class="paragraph">
<p>The RxMicro framework supports shared and separate classpath resources for the external configuration in relation to the microservice source code.</p>
</div>
<div class="paragraph">
<p>The only supported classpath resource format is the <code>properties</code> file format.</p>
</div>
<div class="sect5">
<h6 id="configuration_using_separate_classpath_resource"><a class="anchor" href="#configuration_using_separate_classpath_resource"></a><a class="link" href="#configuration_using_separate_classpath_resource">4.8.2.1.1. Configuration Using Separate <code>classpath</code> Resource.</a></h6>
<div class="paragraph">
<p>If the classpath of the current project contains the <code>http-server.properties</code> resource with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">port=9090 <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Custom port for HTTP server.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>then the RxMicro framework when reading the <code>HttpServerConfig</code> class configuration will read this resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">2020-01-11 12:44:27.518 [INFO] io.rxmicro.rest.server.netty.internal.component.NettyServer :
Server started at 0.0.0.0:9090 using NETTY transport in 500 millis. <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The HTTP server has started at the <code>9090</code> port instead of the standard <code>8080</code> port.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>http-server</code> name is the default namespace for the <code>HttpServerConfig</code> class.
That&#8217;s why these settings are automatically applied when requesting the <code>HttpServerConfig</code> class configuration.</p>
</div>
<div class="paragraph">
<p>The default namespace for the configuration class is calculated using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/Config.java#L95" target="_blank" rel="noopener"><code>Config.getDefaultNameSpace(Class&lt;? extends Config&gt;)</code></a> method,</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="configuration_using_shared_classpath_resource"><a class="anchor" href="#configuration_using_shared_classpath_resource"></a><a class="link" href="#configuration_using_shared_classpath_resource">4.8.2.1.2. Configuration Using Shared <code>classpath</code> Resource.</a></h6>
<div class="paragraph">
<p>If the classpath of the current project contains the <code>rxmicro.properties</code> resource with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">http-server.port=9090 <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Custom port for HTTP server.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>then the RxMicro framework when reading the <code>HttpServerConfig</code> class configuration will read this resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">2020-01-11 12:44:27.518 [INFO] io.rxmicro.rest.server.netty.internal.component.NettyServer :
Server started at 0.0.0.0:9090 using NETTY transport in 500 millis. <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The HTTP server has started at the <code>9090</code> port instead of the standard <code>8080</code> port.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>rxmicro</code> name for the <code>properties</code> file is constant.
That&#8217;s why when requesting any configuration, the RxMicro framework tries to read the content of this file, if it exists.</p>
</div>
<div class="paragraph">
<p>The <code>rxmicro</code> name is a named constant:
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/Config.java#L74" target="_blank" rel="noopener"><code>Config.RX_MICRO_CONFIG_FILE_NAME</code></a>,</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Since the <code>rxmicro.properties</code> resource is a shared resource for <strong>any</strong> configuration, You must specify a namespace when specifying the settings.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>That&#8217;s why when specifying the HTTP server port, You should specify the <code>http-server</code> prefix in the <code>rxmicro.properties</code> file.
<em>(When using the <code>http-server.properties</code> file, there was no such need!)</em></p>
</div>
<div class="paragraph">
<p>That means</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">http-server.port=9090</code></pre>
</div>
</div>
<div class="paragraph">
<p>instead of</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">port=9090</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="core-config-properties-files-section"><a class="anchor" href="#core-config-properties-files-section"></a><a class="link" href="#core-config-properties-files-section">4.8.2.2. Configuration Using <code>properties</code> Files.</a></h5>
<div class="paragraph">
<p>Similar to classpath resources, the RxMicro framework also supports shared and separate <code>properties</code> files for the external configuration in relation to the microservice source code.</p>
</div>
<div class="paragraph">
<p>Configuration files can be located:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in the current directory in relation to the microservice;</p>
</li>
<li>
<p>in the <code>$HOME</code> directory:</p>
<div class="ulist">
<ul>
<li>
<p>for Linux platform the <code>$HOME</code> directory is <code>/home/$USERNAME</code>;</p>
</li>
<li>
<p>for MacOS platform the <code>$HOME</code> directory is <code>/Users/$USERNAME</code>;</p>
</li>
<li>
<p>for Windows platform the <code>$HOME</code> directory is <code>C:\Documents and Settings\%USERNAME%</code> or <code>C:\Users\%USERNAME%</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>in the default rxmicro config directory: <code>$HOME/.rxmicro/</code> (predefined name and location).<br>
<em>(Using <code>$HOME/.rxmicro/</code> directory instead of <code>$HOME</code> one allows configuring this directory as <a href="https://www.docker.com/" target="_blank" rel="noopener">docker</a> or <a href="https://kubernetes.io/" target="_blank" rel="noopener">kubernetes</a> volume.)</em></p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To find out the location of the <code>$HOME</code> directory on Your computer using Java, start the following program:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class GetHomeDirectory {

    public static void main(final String[] args) {
        System.out.println(System.getProperty("user.home"));
    }
}</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>By default, the function of searching and reading configuration files is disabled in the RxMicro framework!</strong></p>
</div>
<div class="paragraph">
<p>To activate this function, You must use the <code>Configs.Builder</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">new Configs.Builder()
        .withAllConfigSources() <i class="conum" data-value="1"></i><b>(1)</b>
        .build();</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Activation of all available configuration sources for the current microservice.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Besides activating all available sources, it is possible to activate only configuration files in a given location.</p>
</div>
<div class="paragraph">
<p>For details on how to do this, go to the <a href="#core-config-order-settings">Section 4.8.3.2, &#8220;Custom Reading Order of Config Sources.&#8221;</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="configuration_using_separate_properties_file"><a class="anchor" href="#configuration_using_separate_properties_file"></a><a class="link" href="#configuration_using_separate_properties_file">4.8.2.2.1. Configuration Using Separate <code>properties</code> File.</a></h6>
<div class="paragraph">
<p>If the current directory (or <code>$HOME</code>, or <code>$HOME/.rxmicro/</code>) directory contains the <code>http-server.properties</code> file with the following content</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">port=9090 <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Custom port for HTTP server.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>then the RxMicro framework when reading the <code>HttpServerConfig</code> class configuration will read this file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">2020-01-11 12:44:27.518 [INFO] io.rxmicro.rest.server.netty.internal.component.NettyServer :
Server started at 0.0.0.0:9090 using NETTY transport in 500 millis. <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The HTTP server has started at the <code>9090</code> port instead of the standard <code>8080</code> port.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>http-server</code> name is the default namespace for the <code>HttpServerConfig</code> class.
That&#8217;s why these settings are automatically applied when requesting the <code>HttpServerConfig</code> class configuration.</p>
</div>
<div class="paragraph">
<p>The default namespace for the configuration class is calculated using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/Config.java#L95" target="_blank" rel="noopener"><code>Config.getDefaultNameSpace(Class&lt;? extends Config&gt;)</code></a> method,</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="configuration_using_shared_properties_file"><a class="anchor" href="#configuration_using_shared_properties_file"></a><a class="link" href="#configuration_using_shared_properties_file">4.8.2.2.2. Configuration Using Shared <code>properties</code> File.</a></h6>
<div class="paragraph">
<p>If the current directory (or <code>$HOME</code>, or <code>$HOME/.rxmicro/</code>) directory contains the <code>rxmicro.properties</code> file with the following content</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">http-server.port=9090 <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Custom port for HTTP server.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>then the RxMicro framework when reading the <code>HttpServerConfig</code> class configuration will read this resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">2020-01-11 12:44:27.518 [INFO] io.rxmicro.rest.server.netty.internal.component.NettyServer :
Server started at 0.0.0.0:9090 using NETTY transport in 500 millis. <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The HTTP server has started at the <code>9090</code> port instead of the standard <code>8080</code> port.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>rxmicro</code> name for the <code>properties</code> file is constant.
That&#8217;s why when requesting any configuration, the RxMicro framework tries to read the content of this file, if it exists.</p>
</div>
<div class="paragraph">
<p>The <code>rxmicro</code> name is a named constant:
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/Config.java#L74" target="_blank" rel="noopener"><code>Config.RX_MICRO_CONFIG_FILE_NAME</code></a>,</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Since the <code>rxmicro.properties</code> file is a shared file for <strong>any</strong> configuration, You must specify a namespace when specifying the settings.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>That&#8217;s why when specifying the HTTP server port, You should specify the <code>http-server</code> prefix in the <code>rxmicro.properties</code> file.
<em>(When using the <code>http-server.properties</code> file, there was no such need!)</em></p>
</div>
<div class="paragraph">
<p>That means</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">http-server.port=9090</code></pre>
</div>
</div>
<div class="paragraph">
<p>instead of</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">port=9090</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="configuration_using_environment_variables"><a class="anchor" href="#configuration_using_environment_variables"></a><a class="link" href="#configuration_using_environment_variables">4.8.2.3. Configuration Using Environment Variables.</a></h5>
<div class="paragraph">
<p>When using environment variables, the format of configurations matches the following format:</p>
</div>
<div class="paragraph">
<p><code>export ${name-space}.${property-name} = ${value}</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text"><strong>export</strong> http-server.port=9090 <i class="conum" data-value="1"></i><b>(1)</b>

<strong>java</strong> -p ./classes:lib -m <strong>examples.quick.start/io.rxmicro.examples.quick.start.HelloWorldMicroService</strong>
2020-01-02 18:49:58.372 [INFO] io.rxmicro.rest.server.netty.internal.component.NettyServer :
Server started at 0.0.0.0:9090 using NETTY transport in 500 millis. <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Setting the <code>http-server.port</code> environment variable = 9090 (custom port for HTTP server).</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The HTTP server has started at the <code>9090</code> port instead of the standard <code>8080</code> port.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Thus, the format of configurations using environment variables corresponds to the format of <code>rxmicro.properties</code> file or classpath resource.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Allowed characters in environment variable names!</strong></p>
</div>
<div class="paragraph">
<p>From <a href="https://pubs.opengroup.org/onlinepubs/000095399/basedefs/xbd_chap08.html" target="_blank" rel="noopener">The Open Group</a>:</p>
</div>
<div class="paragraph">
<p><em>These strings have the form name=value; names shall not contain the character '='.
For values to be portable across systems conforming to IEEE Std 1003.1-2001, the value shall be composed of characters from the portable character set (except NUL and as indicated below).</em></p>
</div>
<div class="paragraph">
<p>So names may contain any character except <code>=</code> and <code>NUL</code>, but:</p>
</div>
<div class="paragraph">
<p><em>Environment variable names used by the utilities in the Shell and Utilities volume of IEEE Std 1003.1-2001 consist solely of <strong>uppercase letters, digits, and the '</em>' (underscore)</strong> from the characters defined in Portable Character Set and do not begin with a digit.
Other characters may be permitted by an implementation; applications shall tolerate the presence of such names._</p>
</div>
<div class="paragraph">
<p>So for such restricted environment the RxMicro framework supports the following format for environment variable mapping as well:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">export <strong>HTTP_SERVER_PORT</strong>=9090 <i class="conum" data-value="1"></i><b>(1)</b>

java -p ./classes:lib -m examples.quick.start/io.rxmicro.examples.quick.start.HelloWorldMicroService
2020-01-02 18:49:58.372 [INFO] io.rxmicro.rest.server.netty.internal.component.NettyServer :
Server started at <strong>0.0.0.0:9090</strong> using NETTY transport in 500 millis. <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Setting the <code>HTTP_SERVER_PORT</code> environment variable = 9090 (custom port for HTTP server).</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The HTTP server has started at the <code>9090</code> port instead of the standard <code>8080</code> port.</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Configuring with environment variables is very convenient when using <a href="https://www.docker.com/" target="_blank" rel="noopener">docker</a> containers!</strong></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To protect Your secret data, use configuration via properties files instead of environment variables.
The config directory with secret config files (for example <code>$HOME/.rxmicro/</code>) must be mount as external volume using <a href="https://en.wikipedia.org/wiki/Tmpfs" target="_blank" rel="noopener"><code>tmpfs</code></a> file system.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If it is necessary to separate environment variables used for the configuration of the RxMicro environment from other environment variables,
You must define the standard environment variable with name <code>RX_MICRO_CONFIG_ENVIRONMENT_VARIABLE_PREFIX</code>!</p>
</div>
<div class="paragraph">
<p>For example if You runtime contains the following environment variable <code>RX_MICRO_CONFIG_ENVIRONMENT_VARIABLE_PREFIX=MY_RUNTIME_</code>
than it is necessary to use</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">export <strong>MY_RUNTIME_HTTP_SERVER_PORT</strong>=9090</code></pre>
</div>
</div>
<div class="paragraph">
<p>instead of</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">export <strong>HTTP_SERVER_PORT</strong>=9090</code></pre>
</div>
</div>
<div class="paragraph">
<p>setting for configuring a port for the HTTP server!</p>
</div>
</div>
<div class="sect4">
<h5 id="configuration_using_java_system_properties"><a class="anchor" href="#configuration_using_java_system_properties"></a><a class="link" href="#configuration_using_java_system_properties">4.8.2.4. Configuration Using Java System Properties</a></h5>
<div class="paragraph">
<p>When using the <code>Java System Properties</code>, the format of configurations matches the following format:</p>
</div>
<div class="paragraph">
<p><code>${name-space}.${property-name} = ${value}</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text"><strong>java</strong> -p ./classes:lib \
    -Dhttp-server.port=9090 \ <i class="conum" data-value="1"></i><b>(1)</b>
    -m <strong>examples.quick.start/io.rxmicro.examples.quick.start.HelloWorldMicroService</strong>

2020-01-02 18:49:58.372 [INFO] io.rxmicro.rest.server.netty.internal.component.NettyServer :
Server started at 0.0.0.0:9090 using NETTY transport in 500 millis. <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Setting the <code>http-server.port</code> Java system variable = 9090 (custom port for HTTP server).</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The HTTP server has started at the <code>9090</code> port instead of the standard <code>8080</code> port.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Thus, the format of configurations using Java system variables corresponds to the format of configuration using environment variables, and also to the format of <code>rxmicro.properties</code> file or classpath resource.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="core-config-java-classes-section"><a class="anchor" href="#core-config-java-classes-section"></a><a class="link" href="#core-config-java-classes-section">4.8.2.5. Configuration Using Java Classes.</a></h5>
<div class="paragraph">
<p>Configuring with Java classes is the easiest and most explicit configuration method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public static void main(final String[] args) {
    new Configs.Builder()
            .withConfigs(new HttpServerConfig()
                    .setPort(9090)) <i class="conum" data-value="1"></i><b>(1)</b>
            .build();
    startRestServer(MicroService.class);
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Changing the HTTP server port.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">2020-01-02 18:49:58.372 [INFO] io.rxmicro.rest.server.netty.internal.component.NettyServer :
Server started at 0.0.0.0:9090 using NETTY transport in 500 millis. <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The HTTP server has started at the <code>9090</code> port instead of the standard <code>8080</code> port.</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>The main difference between this type of configuration and the others is that when using Java classes, other configuration sources are always ignored!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Therefore this type is recommended to be used ONLY for test purposes!</strong></p>
</div>
<div class="paragraph">
<p>(<em>It does not have enough flexibility for the production environment!</em>)</p>
</div>
<div class="paragraph">
<p><strong>For the production environment, use the configuration with annotations instead of the configuration with Java classes!</strong></p>
</div>
</div>
<div class="sect4">
<h5 id="core-config-annotations-section"><a class="anchor" href="#core-config-annotations-section"></a><a class="link" href="#core-config-annotations-section">4.8.2.6. Configuration Using Java Annotations.</a></h5>
<div class="paragraph">
<p>To override the default value, the RxMicro framework provides the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/DefaultConfigValue.java" target="_blank" rel="noopener"><code>@DefaultConfigValue</code></a> annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@DefaultConfigValue(
        configClass = HttpServerConfig.class,   <i class="conum" data-value="1"></i><b>(1)</b>
        name = "port",                          <i class="conum" data-value="2"></i><b>(2)</b>
        value = "9090"
)
@DefaultConfigValue(
        name = "http-server.host",  <i class="conum" data-value="3"></i><b>(3)</b>
        value = "localhost"
)
module examples.config.annotations { <i class="conum" data-value="4"></i><b>(4)</b>
    requires rxmicro.rest.server.netty;
    requires rxmicro.rest.server.exchange.json;
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When overriding the configuration value, You must specify the configuration class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If the configuration class is specified, the namespace may not be specified.<br>
<em>(It means the field of the specified configuration class.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>If no configuration class is specified, the name <strong>must</strong> contain a namespace.<br>
<em>(The namespace allows You to clearly define to which configuration class the specified setting belongs.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>When configuring a microservice project, the annotation must be specified on the <code>module-info.java</code> descriptor.<br>
<em>(A microservice project may contain several classes of REST controllers, so the common settings are configured using the <code>module-info.java</code> descriptor rather than the REST controller class.)</em></td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Please, pay attention when overriding the default value with the annotations!</strong></p>
</div>
<div class="paragraph">
<p>If You make a mistake when specifying a setting name (this refers to the namespace and field name), no error will occur upon starting!
The overridden value will be simply <strong>ignored</strong>!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By overriding the default values using the <code>module-info.java</code> descriptor, You can start the microservice.
While reading the configuration of the <code>HttpServerConfig</code> class, the RxMicro framework reads the default values set with annotations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">2020-01-13 13:09:44.236 [INFO] io.rxmicro.rest.server.netty.internal.component.NettyServer :
Server started at localhost:9090 using NETTY transport in 500 millis. <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>HTTP server started on <code>localhost:9090</code></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-common/config-annotations" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-common/config-annotations</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The main difference between configuring with annotations and configuring with Java classes is support of the <strong>settings inheritance and overriding</strong>.</p>
</div>
<div class="paragraph">
<p>In other words, when using configuration via annotations, the RxMicro framework can also read other configuration sources.</p>
</div>
<div class="paragraph">
<p>When using configuration via Java classes, other configuration sources <strong>are always ignored</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For the test environment only, the RxMicro framework provides special <a href="#testing-annotations-WithConfig-inline"><code>@WithConfig</code></a> annotation.
Using this annotation it is convenient to configure the configuration manager for the test environment:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@WithConfig
private static final HttpServerConfig SERVER_CONFIG =
        new HttpServerConfig()
                .setPort(56789);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The source code of the project using the <a href="#testing-annotations-WithConfig-inline"><code>@WithConfig</code></a> annotation is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-microservice-with-config" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/testing-microservice-with-config</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/DefaultConfigValue.java" target="_blank" rel="noopener"><code>@DefaultConfigValue</code></a>
annotation can be applied to override primitive values only:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>strings</code>,</p>
</li>
<li>
<p><code>booleans</code>,</p>
</li>
<li>
<p><code>numbers</code>,</p>
</li>
<li>
<p><code>dates</code>,</p>
</li>
<li>
<p><code>times</code>,</p>
</li>
<li>
<p><code>enums</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If You need to override a complex value, it is necessary to use
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/DefaultConfigValueSupplier.java" target="_blank" rel="noopener"><code>@DefaultConfigValueSupplier</code></a>
annotation instead.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The source code of the project using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/DefaultConfigValueSupplier.java" target="_blank" rel="noopener"><code>@DefaultConfigValueSupplier</code></a>
annotation is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-common/config-annotations-supplier" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/config-annotations-supplier</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="core-config-command-line-args-section"><a class="anchor" href="#core-config-command-line-args-section"></a><a class="link" href="#core-config-command-line-args-section">4.8.2.7. Configuration Using Command Line Arguments.</a></h5>
<div class="paragraph">
<p>To override configs You can use command line arguments.</p>
</div>
<div class="paragraph">
<p>This type of configuration has <strong>the highest priority and overrides all other types</strong>.
<em>(Except of configuration using Java classes.)</em></p>
</div>
<div class="paragraph">
<p><strong>Configuration using command line arguments is disabled by default.</strong></p>
</div>
<div class="paragraph">
<p>To enable it is necessary to configure the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/Configs.java" target="_blank" rel="noopener"><code>Configs</code></a> configuration manager:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public static void main(final String[] args) {
    new Configs.Builder()
            .withCommandLineArguments(args) <i class="conum" data-value="1"></i><b>(1)</b>
            .build();
    startRestServer(MicroService.class);
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Use <code>withCommandLineArguments(args)</code> method to enable the configuration using command line arguments.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, If You want to start HTTP server at <code>9191</code> port, You can pass the following command line argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">java -p ./classes:lib -m examples.quick.start/io.rxmicro.examples.quick.start.HelloWorldMicroService <strong>http-server.port=9191</strong></code></pre>
</div>
</div>
<div class="paragraph">
<p>Result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">2020-01-02 18:49:58.372 [INFO] io.rxmicro.rest.server.netty.internal.component.NettyServer :
Server started at 0.0.0.0: <strong>9191</strong> using NETTY transport in 500 millis.</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect3">
<h4 id="config_sources_setting"><a class="anchor" href="#config_sources_setting"></a><a class="link" href="#config_sources_setting">4.8.3. Config Sources Setting</a></h4>
<div class="paragraph">
<p>The RxMicro framework allows You to customize the order in which the configuration sources are read.</p>
</div>
<div class="paragraph">
<p>With this feature, the RxMicro framework automatically supports inheritance and redefinition of launch configurations.</p>
</div>
<div class="sect4">
<h5 id="core-config-order-default-section"><a class="anchor" href="#core-config-order-default-section"></a><a class="link" href="#core-config-order-default-section">4.8.3.1. Default Reading Order of Config Sources.</a></h5>
<div class="paragraph">
<p>By default, the RxMicro framework reads configuration sources
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/Configs.java#L55" target="_blank" rel="noopener">in the following order</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configuration using <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/DefaultConfigValue.java" target="_blank" rel="noopener"><code>@DefaultConfigValue</code></a> annotations;</p>
</li>
<li>
<p>Configuration using the <code>rxmicro.properties</code> classpath resource;</p>
</li>
<li>
<p>Configuration using the separate (<code>${name-space}.properties</code>) classpath resource;</p>
</li>
<li>
<p>Configuration using environment variables;</p>
</li>
<li>
<p>Configuration using Java system variables;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Thus, if there are two classpath resources for a microservice:</p>
</div>
<div class="paragraph">
<p>The <code>rxmicro.properties</code> resource with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">http-server.port=9090
http-server.host=localhost</code></pre>
</div>
</div>
<div class="paragraph">
<p>and the <code>http-server.properties</code> resource with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">port=9876</code></pre>
</div>
</div>
<div class="paragraph">
<p>then the result will be as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">2020-01-11 16:52:26.797 [INFO] io.rxmicro.rest.server.netty.internal.component.NettyServer :
Server started at localhost:9876 using NETTY transport in 500 millis. <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>HTTP server has started at <code>localhost:9876</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The configuration reading algorithm for the above example is as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>By default, the HTTP server should start at <code>0.0.0.0:8080</code>.</p>
</li>
<li>
<p>But in the <code>rxmicro.properties</code> classpath resource there is a different IP address and port: <code>localhost:9090</code>.</p>
</li>
<li>
<p>If the <code>http-server.properties</code> classpath resource had not existed, the HTTP server would have run at <code>localhost:9090</code>.</p>
</li>
<li>
<p>But in the <code>http-server.properties</code> classpath resource it is specified the <code>9876</code> port.</p>
</li>
<li>
<p>Therefore, when starting, the IP address is inherited from the <code>rxmicro.properties</code> resource and the overridden port value is read from the <code>http-server.properties</code> resource.<br>
<em>(This behavior corresponds to the order of reading the default configurations.)</em></p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="core-config-order-settings"><a class="anchor" href="#core-config-order-settings"></a><a class="link" href="#core-config-order-settings">4.8.3.2. Custom Reading Order of Config Sources.</a></h5>
<div class="paragraph">
<p>To change the order of the configuration reading it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/Configs.java#L200" target="_blank" rel="noopener"><code>Configs.Builder.withOrderedConfigSources(ConfigSource&#8230;&#8203;)</code></a> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public static void main(final String[] args) {
    new Configs.Builder()
            .withOrderedConfigSources(
                    SEPARATE_CLASS_PATH_RESOURCE, <i class="conum" data-value="1"></i><b>(1)</b>
                    RXMICRO_CLASS_PATH_RESOURCE   <i class="conum" data-value="2"></i><b>(2)</b>
            )
            .build();
    startRestServer(MicroService.class);
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>First, it is necessary to read the configuration from the <code>${name-space}.properties</code> classpath resource (In our case, it&#8217;s a <code>http-server.properties</code>)</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>and then from the <code>rxmicro.properties</code> classpath resource.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Thus, the order of the configuration reading from classpath resources has been changed in comparison with the
<a href="#core-config-order-default-section">default order</a>.</p>
</div>
<div class="paragraph">
<p>When starting the microservice, the settings from the <code>http-server.properties</code> classpath resource will be overwritten by the settings from the <code>rxmicro.properties</code> classpath resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">2020-01-11 16:52:26.797 [INFO] io.rxmicro.rest.server.netty.internal.component.NettyServer :
Server started at localhost:9090 using NETTY transport in 500 millis. <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>HTTP server has started at <code>localhost:9090</code>.</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/Configs.java#L200" target="_blank" rel="noopener"><code>Configs.Builder.withOrderedConfigSources(ConfigSource&#8230;&#8203;)</code></a>
method allows not only to change the order of reading the configuration sources, but also to activate/deactivate the sources.</p>
</div>
<div class="paragraph">
<p><strong>In the above example, the RxMicro framework will ignore any configuration sources except classpath resources!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/Configs.java#L200" target="_blank" rel="noopener"><code>Configs.Builder.withOrderedConfigSources(ConfigSource&#8230;&#8203;)</code></a>
method is universal.</p>
</div>
<div class="paragraph">
<p>The RxMicro framework also provides other additional methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/Configs.java#L227" target="_blank" rel="noopener"><code>Configs.Builder.withAllConfigSources()</code></a> - activation of all configuration types in the order given by the list:
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/ConfigSource.java" target="_blank" rel="noopener"><code>ConfigSource</code></a></p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/Configs.java#L245" target="_blank" rel="noopener"><code>Configs.Builder.withContainerConfigSources()</code></a> - this combination is recommended for microservices operating in <a href="https://www.docker.com/" target="_blank" rel="noopener">docker</a> or <a href="https://kubernetes.io/" target="_blank" rel="noopener">kubernetes</a>.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/Configs.java#L227" target="_blank" rel="noopener"><code>Configs.Builder.withAllConfigSources()</code></a>
method was used to activate the reading of configurations from properties files in the <a href="#core-config-properties-files-section">Section 4.8.2.2, &#8220;Configuration Using <code>properties</code> Files.&#8221;</a> subsection.</p>
</div>
<div class="paragraph">
<p>If You plan to use only <code>properties</code> files, it is recommended to specify only these types, excluding all other types:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public static void main(final String[] args) {
    new Configs.Builder()
            .withOrderedConfigSources(
                    RXMICRO_FILE_AT_THE_HOME_DIR,    <i class="conum" data-value="1"></i><b>(1)</b>
                    RXMICRO_FILE_AT_THE_CURRENT_DIR, <i class="conum" data-value="2"></i><b>(2)</b>
                    SEPARATE_FILE_AT_THE_HOME_DIR,   <i class="conum" data-value="3"></i><b>(3)</b>
                    SEPARATE_FILE_AT_THE_CURRENT_DIR <i class="conum" data-value="4"></i><b>(4)</b>
            )
            .build();
    startRestServer(MicroService.class);
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Activation of configuration reading from the <code>$HOME/rxmicro.properties</code> file.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Activation of configuration reading from the <code>rxmicro.properties</code> file in the current directory.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Activation of configuration reading from the <code>$HOME/${name-space}.properties</code> files (for example, <code>http-server.properties</code>).</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>ctivation of configuration reading from the <code>${name-space}.properties</code> files (for example, <code>http-server.properties</code>) in the current directory.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>The order of reading is set by the argument order of the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/Configs.java#L200" target="_blank" rel="noopener"><code>Configs.Builder.withOrderedConfigSources(ConfigSource&#8230;&#8203;)</code></a></strong> method</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>If You know exactly which configuration sources should be used by the microservice, ALWAYS specify them explicitly!</strong></p>
</div>
<div class="paragraph">
<p><strong>With this approach, at the microservice starting, the RxMicro framework won&#8217;t try to search for non-existent sources, spending precious microseconds!</strong></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="logging_the_config_reading_process"><a class="anchor" href="#logging_the_config_reading_process"></a><a class="link" href="#logging_the_config_reading_process">4.8.3.3. Logging the Config Reading Process</a></h5>
<div class="paragraph">
<p>To debug the configuration reading process You can activate the <a href="#core-logger-config-file-inline">logger</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">.level=INFO
io.rxmicro.config.level=DEBUG <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>For all classes and subpackages of the <code>io.rxmicro.config</code> package activate the <code>DEBUG</code>(<code>FINE</code>) logging level.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After activating the logger, the start of the microservice with default settings will be as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">[DEBUG] Discovering properties for 'rest-server' namespace from sources: [<strong>DEFAULT_CONFIG_VALUES</strong>, <strong>RXMICRO_CLASS_PATH_RESOURCE</strong>, <strong>SEPARATE_CLASS_PATH_RESOURCE</strong>, <strong>ENVIRONMENT_VARIABLES</strong>, <strong>JAVA_SYSTEM_PROPERTIES</strong>]

[DEBUG] Classpath resource not found: <strong>rest-server.properties</strong>

[DEBUG] All properties discovered for 'rest-server' namespace <i class="conum" data-value="1"></i><b>(1)</b>

[DEBUG] Discovering properties for 'http-server' namespace from sources: [<strong>DEFAULT_CONFIG_VALUES</strong>, <strong>RXMICRO_CLASS_PATH_RESOURCE</strong>, <strong>SEPARATE_CLASS_PATH_RESOURCE</strong>, <strong>ENVIRONMENT_VARIABLES</strong>, <strong>JAVA_SYSTEM_PROPERTIES</strong>]

[DEBUG] Discovered properties from <strong>'rxmicro.properties'</strong> classpath resource: [http-server.port=9090, http-server.host=localhost] <i class="conum" data-value="2"></i><b>(2)</b>

[DEBUG] Discovered properties from <strong>'http-server.properties'</strong> classpath resource: [port=9876] <i class="conum" data-value="3"></i><b>(3)</b>

[DEBUG] All properties discovered for 'http-server' namespace

[DEBUG] Discovering properties for 'netty-rest-server' namespace from sources: [<strong>DEFAULT_CONFIG_VALUES</strong>, <strong>RXMICRO_CLASS_PATH_RESOURCE</strong>, <strong>SEPARATE_CLASS_PATH_RESOURCE</strong>, <strong>ENVIRONMENT_VARIABLES</strong>, <strong>JAVA_SYSTEM_PROPERTIES</strong>]

[DEBUG] Classpath resource not found: <strong>netty-rest-server.properties</strong>

[DEBUG] All properties discovered for 'netty-rest-server' namespace <i class="conum" data-value="4"></i><b>(4)</b>

[INFO] Server started at <strong>0.0.0.0:9876</strong> using NETTY transport in 500 millis. <i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>There is no configuration customization for the <code>rest-server</code> namespace, so the default configuration will be used.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Configuration reading for the <code>http-server</code> namespace from the <code>rxmicro.properties</code> classpath resource (Read values: <code>http-server.port=9090</code>, <code>http-server.host=localhost</code>).</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Configuration reading for the <code>http-server</code> namespace from the <code>http-server.properties</code> classpath resource (Read value: <code>port=9876</code>).</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>There is no configuration customization for the <code>netty-rest-server</code> namespace, so the default configuration will be used.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>HTTP server has started at <code>localhost:9876</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Additional debugging information will show the order of reading the configuration sources and overriding the configuration parameter values!</strong></p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect3">
<h4 id="dynamic_configuration"><a class="anchor" href="#dynamic_configuration"></a><a class="link" href="#dynamic_configuration">4.8.4. Dynamic Configuration</a></h4>
<div class="paragraph">
<p>If Your runtime environment can contain dynamic properties You can use <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/AsMapConfig.java" target="_blank" rel="noopener"><code>AsMapConfig</code></a> configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class DynamicAsMapConfig extends AsMapConfig {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>rxmicro.properties</code> classpath resource with the following content exists:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">dynamic.bigDecimal=3.1423456676
dynamic.bigInteger=9999999999999999999999999999999999999999999999999
dynamic.boolean=true
dynamic.integer=34
dynamic.string=staging</code></pre>
</div>
</div>
<div class="paragraph">
<p>then the following code will return configured dynamic parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public static void main(final String[] args) {
    final DynamicAsMapConfig config = getConfig(DynamicAsMapConfig.class);

    System.out.println(config.getBigDecimal("bigDecimal"));
    System.out.println(config.getBigInteger("bigInteger"));
    System.out.println(config.getBoolean("boolean"));
    System.out.println(config.getInteger("integer"));
    System.out.println(config.getString("string"));
}</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="core-config-user-defined-config"><a class="anchor" href="#core-config-user-defined-config"></a><a class="link" href="#core-config-user-defined-config">4.8.5. User Defined Configurations</a></h4>
<div class="paragraph">
<p>The developer can use the configuration module for custom configurations.</p>
</div>
<div class="paragraph">
<p>To do this, it is necessary to create a separate class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BusinessServiceConfig extends Config {

    private boolean production = true;

    public boolean isProduction() {
        return production;
    }

    public BusinessServiceConfig setProduction(final boolean production) {
        this.production = production;
        return this;
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The custom configuration class must meet the following requirements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The class must be public.</p>
</li>
<li>
<p>The class must contain a public constructor without parameters.</p>
</li>
<li>
<p>The class must extend the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/Config.java" target="_blank" rel="noopener"><code>Config</code></a> abstract class.</p>
</li>
<li>
<p>To set property values, the class must contain <a href="https://www.w3schools.com/java/java_encapsulation.asp" target="_blank" rel="noopener"><code>setters</code></a>.<br>
<em>(Only those fields that contain <code>setters</code> can be initialized!)</em></p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Since this class will be created and initialized by the reflection util classes from <code>rxmicro.reflection</code> module automatically, it is necessary to export the package of the custom config class to this module in the <code>module-info.java</code> descriptor.<br>
<em>(These are the <a href="https://www.oracle.com/corporate/features/understanding-java-9-modules.html" target="_blank" rel="noopener"><code>JPMS</code></a> requirements.)</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">module examples.config.custom {
    requires rxmicro.rest.server.netty;
    requires rxmicro.rest.server.exchange.json;

    exports io.rxmicro.examples.config.custom to
            rxmicro.reflection;  <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Allow the access of reflection util classes from <code>rxmicro.reflection</code> module to config classes from the <code>io.rxmicro.example.config.custom</code> package.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After these changes, a class of custom configurations is available for use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class MicroService {

    @GET("/")
    void test() {
        final BusinessServiceConfig config = getConfig(BusinessServiceConfig.class);
        System.out.println("Production: " + config.isProduction());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>production</code> flag can now be set using any type of configuration, for example using the classpath of the <code>business-service.properties</code> resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">production=false</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-common/config-custom" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-common/config-custom</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="supported_parameter_types"><a class="anchor" href="#supported_parameter_types"></a><a class="link" href="#supported_parameter_types">4.8.6. Supported Parameter Types</a></h4>
<div class="paragraph">
<p>The RxMicro framework supports the primitive, custom and container types, which can be config parameters for any configuration.</p>
</div>
<div class="sect4">
<h5 id="supported_primitive_parameter_types"><a class="anchor" href="#supported_primitive_parameter_types"></a><a class="link" href="#supported_primitive_parameter_types">4.8.6.1. Supported Primitive Parameter Types</a></h5>
<div class="paragraph">
<p>The RxMicro framework supports the following primitive Java types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>? extends Enum&lt;?&gt;</code>;</p>
</li>
<li>
<p><code>boolean</code>;</p>
</li>
<li>
<p><code>java.lang.Boolean</code>;</p>
</li>
<li>
<p><code>byte</code>;</p>
</li>
<li>
<p><code>java.lang.Byte</code>;</p>
</li>
<li>
<p><code>short</code>;</p>
</li>
<li>
<p><code>java.lang.Short</code>;</p>
</li>
<li>
<p><code>int</code>;</p>
</li>
<li>
<p><code>java.lang.Integer</code>;</p>
</li>
<li>
<p><code>long</code>;</p>
</li>
<li>
<p><code>java.lang.Long</code>;</p>
</li>
<li>
<p><code>java.math.BigInteger</code>;</p>
</li>
<li>
<p><code>float</code>;</p>
</li>
<li>
<p><code>java.lang.Float</code>;</p>
</li>
<li>
<p><code>double</code>;</p>
</li>
<li>
<p><code>java.lang.Double</code>;</p>
</li>
<li>
<p><code>java.math.BigDecimal</code>;</p>
</li>
<li>
<p><code>char</code>;</p>
</li>
<li>
<p><code>java.lang.Character</code>;</p>
</li>
<li>
<p><code>java.lang.CharSequence</code>;</p>
</li>
<li>
<p><code>java.lang.String</code>;</p>
</li>
<li>
<p><code>java.time.Instant</code>;</p>
</li>
<li>
<p><code>java.time.LocalDate</code>;</p>
</li>
<li>
<p><code>java.time.LocalDateTime</code>;</p>
</li>
<li>
<p><code>java.time.LocalTime</code>;</p>
</li>
<li>
<p><code>java.time.MonthDay</code>;</p>
</li>
<li>
<p><code>java.time.OffsetDateTime</code>;</p>
</li>
<li>
<p><code>java.time.OffsetTime</code>;</p>
</li>
<li>
<p><code>java.time.Year</code>;</p>
</li>
<li>
<p><code>java.time.YearMonth</code>;</p>
</li>
<li>
<p><code>java.time.ZonedDateTime</code>;</p>
</li>
<li>
<p><code>java.time.Duration</code>;</p>
</li>
<li>
<p><code>java.time.ZoneOffset</code>;</p>
</li>
<li>
<p><code>java.time.ZoneId</code>;</p>
</li>
<li>
<p><code>java.time.Period</code>;</p>
</li>
<li>
<p><code>java.nio.file.Path</code>;</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For temporal classes the RxMicro framework uses <code>parse</code> or <code>of</code> factory method to converts string value to the appropriate Java representation.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="core_config_supported_custom_parameter_types"><a class="anchor" href="#core_config_supported_custom_parameter_types"></a><a class="link" href="#core_config_supported_custom_parameter_types">4.8.6.2. Supported Custom Parameter Types</a></h5>
<div class="paragraph">
<p>The RxMicro framework supports a custom type as valid config parameter type.</p>
</div>
<div class="paragraph">
<p>For example if Your project contain the following custom type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface CustomType {

    String getValue();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>then Your custom config class can use this type as valid config parameter type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class ExampleConfig extends Config {

    private CustomType type = () -&gt; "DEFAULT_CONSTANT";

    public CustomType getType() {
        return type;
    }

    public void setType(final CustomType type) {
        this.type = type;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Instances of the custom type can be created as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Enum constant:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public enum CustomEnum implements CustomType {

    ENUM_CONSTANT;

    @Override
    public String getValue() {
        return "ENUM_CONSTANT";
    }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Class <code>public static final</code> constant:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class CustomClass {

    public static final CustomType CLASS_CONSTANT = () -&gt; "CLASS_CONSTANT";
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Interface constant:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface CustomInterface {

    CustomType INTERFACE_CONSTANT = () -&gt; "INTERFACE_CONSTANT";
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Annotation constant:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public @interface CustomAnnotation {

    CustomType ANNOTATION_CONSTANT = () -&gt; "ANNOTATION_CONSTANT";
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To inform the RxMicro framework which instance must be created and injected to config parameter, it is necessary to use the following syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">@${FULL_CLASS_NAME}:${CONSTANT_FIELD_NAME}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example if Your environment contains the following Java system properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">System.setProperty(
        "enum-constant.type",
        "@io.rxmicro.examples.config.custom.type._enum.CustomEnum:ENUM_CONSTANT"
);
System.setProperty(
        "class-constant.type",
        "@io.rxmicro.examples.config.custom.type._class.CustomClass:CLASS_CONSTANT"
);
System.setProperty(
        "interface-constant.type",
        "@io.rxmicro.examples.config.custom.type._interface.CustomInterface:INTERFACE_CONSTANT"
);
System.setProperty(
        "annotation-constant.type",
        "@io.rxmicro.examples.config.custom.type._annotation.CustomAnnotation:ANNOTATION_CONSTANT"
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>and Your application read configuration for all configured namespaces:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">System.out.println(
        "Default constant: " +
                getConfig(ExampleConfig.class).getType().getValue()
);
System.out.println(
        "Enum constant: " +
                getConfig("enum-constant", ExampleConfig.class).getType().getValue()
);
System.out.println(
        "Class constant: " +
                getConfig("class-constant", ExampleConfig.class).getType().getValue()
);
System.out.println(
        "Interface constant: " +
                getConfig("interface-constant", ExampleConfig.class).getType().getValue()
);
System.out.println(
        "Annotation constant: " +
                getConfig("annotation-constant", ExampleConfig.class).getType().getValue()
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Result will be the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">Default constant: DEFAULT_CONSTANT
Enum constant: ENUM_CONSTANT
Class constant: CLASS_CONSTANT
Interface constant: INTERFACE_CONSTANT
Annotation constant: ANNOTATION_CONSTANT</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For class or interface or annotation constants the RxMicro framework uses the <code>reflection</code> to read value.<br>
So before using this type of custom type instances don&#8217;t forget to export packages to <code>rxmicro.reflection</code> module, because this module contains the <code>reflection</code> util class which is used to read this value:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">exports io.rxmicro.examples.config.custom.type._class to
        rxmicro.reflection;
exports io.rxmicro.examples.config.custom.type._interface to
        rxmicro.reflection;
exports io.rxmicro.examples.config.custom.type._annotation to
        rxmicro.reflection;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>The RxMicro team recommends using an enum for custom type injection to config instances!</strong></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="supported_container_parameter_types"><a class="anchor" href="#supported_container_parameter_types"></a><a class="link" href="#supported_container_parameter_types">4.8.6.3. Supported Container Parameter Types</a></h5>
<div class="paragraph">
<p>The RxMicro framework supports the following container Java types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>java.util.List&lt;V&gt;</code>;</p>
</li>
<li>
<p><code>java.util.Set&lt;V&gt;</code>;</p>
</li>
<li>
<p><code>java.util.SortedSet&lt;V&gt;</code>;</p>
</li>
<li>
<p><code>java.util.Map&lt;K, V&gt;</code>;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>where <code>K</code> and <code>V</code> can be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>java.lang.Boolean</code>;</p>
</li>
<li>
<p><code>java.lang.Long</code>;</p>
</li>
<li>
<p><code>java.math.BigDecimal</code>;</p>
</li>
<li>
<p><code>java.lang.String</code>;</p>
</li>
<li>
<p><code>CUSTOM_TYPE</code>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The RxMicro framework uses <code>,</code> character as collection (List, Set, SortedSet, Map.Entry) value delimiter and '=' character as key-value separator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">list=red,green,blue
set=red,green,blue
sorted-set=red,green,blue
map=red=0xFF0000,green=0x00FF00,blue=0x0000FF</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The RxMicro framework uses <code>reflection</code> to initialize config instances.
But container parametrization types are not available for the <code>reflection</code> reading.</p>
</div>
<div class="paragraph">
<p>Thus the RxMicro framework tries to guess which type must be created using the following algorithm:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Try to convert to <code>java.lang.Boolean</code> type.
If failed then goto <code>2</code> step.</p>
</li>
<li>
<p>Try to convert to <code>java.math.BigDecimal</code> type.
If failed then goto <code>3</code> step.</p>
</li>
<li>
<p>Try to convert to <code>java.lang.Long</code> type.
If failed then goto <code>4</code> step.</p>
</li>
<li>
<p>Try to convert to <code>CUSTOM_TYPE</code>.
If failed then goto <code>5</code> step.</p>
</li>
<li>
<p>Return <code>java.lang.String</code> instance.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This means that if You provide a config list with different types, the RxMicro framework create a <code>java.util.List</code> with different types:</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">list=red,1.2,4,true</code></pre>
</div>
</div>
<div class="paragraph">
<p>the result will be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">java.util.List.of(new String("red"), new BigDecimal("1.2"), Long.valueOf(4), Boolean.valueOf(true));</code></pre>
</div>
</div>
<div class="paragraph">
<p>and the <code>ClassCastException</code> will be thrown if Your config parameter is not of <code>java.util.List&lt;java.lang.Object&gt;</code> type.</p>
</div>
<div class="paragraph">
<p>To avoid the <code>ClassCastException</code> use the following recommendation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For <code>boolean</code> lists use <code>java.util.List&lt;java.lang.Boolean&gt;</code> type.</p>
</li>
<li>
<p>For <code>integer number</code> lists use <code>java.util.List&lt;java.lang.Long&gt;</code> type.</p>
</li>
<li>
<p>For <code>decimal number</code> lists use <code>java.util.List&lt;java.math.BigDecimal&gt;</code> type.</p>
</li>
<li>
<p>For <code>string</code> lists use <code>java.util.List&lt;java.lang.String&gt;</code> type.</p>
</li>
<li>
<p>For <code>custom type</code> lists use <code>java.util.List&lt;CUSTOM_TYPE&gt;</code> type.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>DON&#8217;T USE ANY OTHER TYPES FOR COLLECTION PARAMETRIZATION!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect3">
<h4 id="configuration_verifiers"><a class="anchor" href="#configuration_verifiers"></a><a class="link" href="#configuration_verifiers">4.8.7. Configuration Verifiers</a></h4>
<div class="paragraph">
<p>If Your runtime has complex configuration the RxMicro team strong recommends enabling runtime strict mode.</p>
</div>
<div class="paragraph">
<p>If the runtime strict mode activated the RxMicro runtime invokes additional checks to find unused or redundant configurations.</p>
</div>
<div class="paragraph">
<p>To enable the runtime strict mode set <code>RX_MICRO_RUNTIME_STRICT_MODE</code> environment variable to the <code>true</code> value!
<em>(Instead of environment variable You can use Java System property as well.)</em></p>
</div>
<div class="paragraph">
<p>If runtime strict mode successful activated the following log message can be found:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">[INFO] RxMicroRuntime !!! RxMicro Runtime Strict Mode is activated !!!</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="logger"><a class="anchor" href="#logger"></a><a class="link" href="#logger">4.9. Logger</a></h3>
<div class="paragraph">
<p><a href="https://en.wikipedia.org/wiki/Data_logger" target="_blank" rel="noopener"><strong>Logger</strong></a> is an integral component of any software system.</p>
</div>
<div class="paragraph">
<p>The RxMicro framework provides the <code>rxmicro.logger</code> module for logging important events during the work of microservices.</p>
</div>
<div class="paragraph">
<p>Creation and usage of a logger in the source code is no different from <a href="http://www.java-logging.com/" target="_blank" rel="noopener">other logging frameworks</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class MicroService {

    private static final Logger LOGGER = LoggerFactory.getLogger(MicroService.class); <i class="conum" data-value="1"></i><b>(1)</b>

    @GET("/")
    void test() {
        LOGGER.info("test message"); <i class="conum" data-value="2"></i><b>(2)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Logger creation for the current microservice class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Logging of a message with <code>INFO</code> level.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-logger/src/main/java/io/rxmicro/logger/Logger.java" target="_blank" rel="noopener"><code>Logger</code></a> interface is an abstraction over the real logger.</p>
</div>
<div class="paragraph">
<p>At the moment, there is only one implementation of this interface that delegates logging to the
<a href="https://docs.oracle.com/javase/10/core/java-logging-overview.htm" target="_blank" rel="noopener"><code>java.logging</code></a> module.</p>
</div>
<div style="page-break-after: always;"></div>
<div class="sect3">
<h4 id="logger_configuration"><a class="anchor" href="#logger_configuration"></a><a class="link" href="#logger_configuration">4.9.1. Logger Configuration</a></h4>
<div class="sect4">
<h5 id="using_configuration_file"><a class="anchor" href="#using_configuration_file"></a><a class="link" href="#using_configuration_file">4.9.1.1. Using Configuration File</a></h5>
<div id="core-logger-config-file-inline" class="paragraph">
<p>The main configuration file of the <code>java.logging</code> logger is the <code>jul.properties</code> classpath resource.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If classpath contains the <code>jul.test.properties</code> resource, then this resource overrides <strong>all</strong> configurations of the <code>jul.properties</code> resource.</p>
</div>
<div class="paragraph">
<p>This function allows configuring the logger for a test environment.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>jul.properties</code> classpath resource must contain a configuration <a href="http://tutorials.jenkov.com/java-logging/configuration.html" target="_blank" rel="noopener">in the standard format for the <code>java.logging</code> module</a>.</p>
</div>
<div class="paragraph">
<p>Example of logger configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">.level=INFO
io.rxmicro.config.level=DEBUG</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>rxmicro.logger</code> module supports all logging levels from the following sets: <code>{OFF, ERROR, WARN, INFO, DEBUG, TRACE, ALL}</code> and <code>{OFF, SEVERE, WARNING, INFO, CONFIG, FINE, FINER, FINEST, ALL}</code>.</p>
</div>
<div class="paragraph">
<p>Therefore, in the <code>jul.properties</code> configuration file You can use any logging level.
When activating the <code>java.logging</code> logger, the RxMicro framework automatically converts levels from a set of <code>{OFF, ERROR, WARN, INFO, DEBUG, TRACE, ALL}</code> into <code>{OFF, SEVERE, WARNING, INFO, FINE, FINEST, ALL}</code>.</p>
</div>
<div class="paragraph">
<p>This option makes it possible to use unsupported but widely used in other logging frameworks logging levels for the <code>java.logging</code> logger.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="default_reading_order_of_config_sources"><a class="anchor" href="#default_reading_order_of_config_sources"></a><a class="link" href="#default_reading_order_of_config_sources">4.9.1.2. Default Reading Order of Config Sources.</a></h5>
<div class="paragraph">
<p>By default, the <code>rxmicro.logger</code> module reads configuration sources in the following order <em>(From the lowest to the highest priority)</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Default config.</p>
</li>
<li>
<p>Configuration from the <code>jul.properties</code> classpath resource if the resource found.</p>
</li>
<li>
<p>Configuration from the <code>jul.test.properties</code> classpath resource if the resource found.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="using_additional_config_sources_for_logging_configuration"><a class="anchor" href="#using_additional_config_sources_for_logging_configuration"></a><a class="link" href="#using_additional_config_sources_for_logging_configuration">4.9.1.3. Using Additional Config Sources for Logging Configuration</a></h5>
<div class="paragraph">
<p>Besides <code>jul.properties</code> and <code>jul.test.properties</code> classpath resources the <code>rxmicro.logger</code> module supports the following configuration sources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configuration using environment variables;</p>
</li>
<li>
<p>Configuration using Java system properties;</p>
</li>
<li>
<p>Configuration using properties file that is located at the following paths:</p>
<div class="ulist">
<ul>
<li>
<p><code>./jul.properties</code>;</p>
</li>
<li>
<p><code>$HOME/jul.properties</code>;</p>
</li>
<li>
<p><code>$HOME/.rxmicro/jul.properties</code>;</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>where</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>.</code> - is the current project directory <em>(i.e. <code>System.getProperty("user.dir")</code>)</em>;</p>
</li>
<li>
<p><code>$HOME</code> - is the home directory <em>(i.e. <code>System.getProperty("user.home")</code>)</em>:</p>
<div class="ulist">
<ul>
<li>
<p>for Linux platform the <code>$HOME</code> directory is <code>/home/$USERNAME</code>;</p>
</li>
<li>
<p>for MacOS platform the <code>$HOME</code> directory is <code>/Users/$USERNAME</code>;</p>
</li>
<li>
<p>for Windows platform the <code>$HOME</code> directory is <code>C:\Documents and Settings\%USERNAME%</code> or <code>C:\Users\%USERNAME%</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To enable the additional config sources use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-logger/src/main/java/io/rxmicro/logger/LoggerConfigSources.java" target="_blank" rel="noopener"><code>LoggerConfigSources</code></a> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
static {
    LoggerConfigSources.setLoggerConfigSources(
            LoggerConfigSource.DEFAULT,
            LoggerConfigSource.CLASS_PATH_RESOURCE,
            LoggerConfigSource.TEST_CLASS_PATH_RESOURCE,
            LoggerConfigSource.FILE_AT_THE_HOME_DIR,
            LoggerConfigSource.FILE_AT_THE_CURRENT_DIR,
            LoggerConfigSource.FILE_AT_THE_RXMICRO_CONFIG_DIR,
            LoggerConfigSource.ENVIRONMENT_VARIABLES,
            LoggerConfigSource.JAVA_SYSTEM_PROPERTIES
    );
}

private static final Logger LOGGER = LoggerFactory.getLogger(LoggerConfigSourceTest.class);

public static void main(final String[] args) {
    LOGGER.info("Hello World!");
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>- The logger config sources must be configured before the first usage of the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-logger/src/main/java/io/rxmicro/logger/LoggerFactory.java" target="_blank" rel="noopener"><code>LoggerFactory</code></a>,
otherwise these config settings will be ignored.</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>If You know exactly which configuration sources should be used by the microservice, ALWAYS specify them explicitly!</strong></p>
</div>
<div class="paragraph">
<p><strong>With this approach, at the microservice starting, the RxMicro framework wonâ€™t try to search for non-existent sources, spending precious microseconds!</strong></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="using_environment_variables_and_java_system_properties"><a class="anchor" href="#using_environment_variables_and_java_system_properties"></a><a class="link" href="#using_environment_variables_and_java_system_properties">4.9.1.4. Using Environment Variables And Java System Properties</a></h5>
<div class="paragraph">
<p>After activation of the configuration using environment variables and(or) Java system properties, the RxMicro framework parses environment variables and(or) Java system properties.<br>
If Your runtime contains an environment variable and (or) java system property with name that starts with <code>logger.</code> phrase, the <code>rxmicro.logger</code> module interprets it as configuration.
For example to enable <code>TRACE</code> logger level for <code>MicroServiceLauncher</code> it is necessary to provide one of the following configurations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Example of the configuration using environment variable:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">export logger.io.rxmicro.rest.server.level=TRACE

java -p lib:. -m module/package.MicroServiceLauncher</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Example of the configuration using Java system property:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">java -p lib:. -Dlogger.io.rxmicro.rest.server.level=TRACE -m module/package.MicroServiceLauncher</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect3">
<h4 id="logger_handler"><a class="anchor" href="#logger_handler"></a><a class="link" href="#logger_handler">4.9.2. Logger Handler</a></h4>
<div class="paragraph">
<p>By default the <code>INFO</code> logging level is activated for the all loggers.</p>
</div>
<div class="paragraph">
<p>All logger events are sent to the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-logger/src/main/java/io/rxmicro/logger/jul/SystemConsoleHandler.java" target="_blank" rel="noopener"><code>SystemConsoleHandler</code></a>
appender, which outputs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Logger events with <code>ERROR</code> level into <code>System.err</code>;</p>
</li>
<li>
<p>Logger events with other levels into <code>System.out</code>.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>rxmicro.logger</code> module follows the logs recommendations, that are defined at <a href="https://12factor.net/logs" target="_blank" rel="noopener">The Twelve-Factor App Manifest</a> and logs messages to <code>System.out</code>/<code>System.err</code> only!</p>
</div>
<div class="paragraph">
<p>If these functions are not enough You can use any other logging framework:
<a href="http://logback.qos.ch/" target="_blank" rel="noopener"><code>Logback</code></a>,
<a href="https://logging.apache.org/log4j/2.x/" target="_blank" rel="noopener"><code>Apache Log4j 2</code></a> and others.</p>
</div>
<div class="paragraph">
<p>P.S. You can use also the <code>FileHandler</code>, <code>SocketHandler</code>, etc that defined at the
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.logging/java/util/logging/package-summary.html" target="_blank" rel="noopener"><code>java.logging</code></a> module.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-logger/src/main/java/io/rxmicro/logger/jul/SystemConsoleHandler.java" target="_blank" rel="noopener"><code>SystemConsoleHandler</code></a>
appender must output all logging information into <code>System.out</code> or <code>System.err</code> it is necessary to set <code>stream</code> parameter:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To enable <code>System.err</code> output for the all log levels use the following configuration:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>io.rxmicro.logger.jul.SystemConsoleHandler.stream=stderror</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>To enable <code>System.out</code> output for the all log levels use the following configuration:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>io.rxmicro.logger.jul.SystemConsoleHandler.stream=stdout</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To get more information about the configuration of the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-logger/src/main/java/io/rxmicro/logger/jul/SystemConsoleHandler.java" target="_blank" rel="noopener"><code>SystemConsoleHandler</code></a>
component read javadoc for this component:<br>
<a href="https://javadoc.io/doc/io.rxmicro/rxmicro-logger/latest/rxmicro.logger/io/rxmicro/logger/jul/SystemConsoleHandler.html" target="_blank" rel="noopener">SystemConsoleHandler.html</a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="pattern_formatter"><a class="anchor" href="#pattern_formatter"></a><a class="link" href="#pattern_formatter">4.9.3. Pattern Formatter</a></h4>
<div class="paragraph">
<p>The current version of the <code>rxmicro.logger</code> module is supported only one logger formatter:
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-logger/src/main/java/io/rxmicro/logger/jul/PatternFormatter.java" target="_blank" rel="noopener"><code>PatternFormatter</code></a> with the default configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">io.rxmicro.logger.jul.PatternFormatter.pattern=%d{yyyy-MM-dd HH:mm:ss.SSS} [%p] %c: %m%n</code></pre>
</div>
</div>
<div class="paragraph">
<p>This class supports conversion specifiers that can be used as format control expressions.
Each conversion specifier starts with a percent sign <code>%</code> and is followed by optional format modifiers, a conversion word and optional parameters between braces.
The conversion word controls the data field to convert, e.g. logger name or date format.</p>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-logger/src/main/java/io/rxmicro/logger/jul/PatternFormatter.java" target="_blank" rel="noopener"><code>PatternFormatter</code></a> supports the following conversion specifiers:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Conversion specifiers supported by the <code>PatternFormatter</code>.</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-right valign-top"><strong>Conversion specifiers</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>c</strong><code>{length}</code><br>
<strong>lo</strong><code>{length}</code><br>
<strong>logger</strong><code>{length}</code><br></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Outputs the name of the logger at the origin of the logging event.<br>
This conversion specifier takes a string as its first and only option.<br>
Currently supported only one of the following options: <code>{short}</code>, <code>{0}</code>, <code>{full}</code>.<br>
<code>{short}</code> is synonym for <code>{0}</code> option.<br>
If no option defined this conversion specifier uses <code>{full}</code> option.<br></p>
</div>
<div class="paragraph">
<p>The following table describes option usage results:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Conversion specifier</th>
<th class="tableblock halign-left valign-top">Logger name</th>
<th class="tableblock halign-left valign-top">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%logger</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>package.sub.Bar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>package.sub.Bar</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%logger{full}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>package.sub.Bar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>package.sub.Bar</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%logger{short}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>package.sub.Bar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bar</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%logger{0}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>package.sub.Bar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bar</code></p></td>
</tr>
</tbody>
</table></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>C</strong><code>{length}</code><br>
<strong>class</strong><code>{length}</code><br></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Outputs the fully-qualified class name of the caller issuing the logging request.<br>
This conversion specifier takes a string as its first and only option.<br>
Currently supported only one of the following options: <code>{short}</code>, <code>{0}</code>, <code>{full}</code>.<br>
<code>{short}</code> is synonym for <code>{0}</code> option.<br>
If no option defined this conversion specifier uses <code>{full}</code> option.<br></p>
</div>
<div class="paragraph">
<p>The following table describes option usage results:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Conversion specifier</th>
<th class="tableblock halign-left valign-top">Logger name</th>
<th class="tableblock halign-left valign-top">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%logger</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>package.sub.Bar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>package.sub.Bar</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%logger{full}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>package.sub.Bar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>package.sub.Bar</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%logger{short}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>package.sub.Bar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bar</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%logger{0}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>package.sub.Bar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bar</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Generating the caller class information is not particularly fast.
Thus, its use should be avoided unless execution speed is not an issue!</strong></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>d</strong><code>{pattern}</code><br>
<strong>date</strong><code>{pattern}</code><br>
<strong>d</strong><code>{pattern, timezone}</code><br>
<strong>date</strong><code>{pattern, timezone}</code><br></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Used to output the date of the logging event.<br>
The date conversion word admits a pattern string as a parameter.<br>
The pattern syntax is compatible with the format accepted by <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/time/format/DateTimeFormatter.html" target="_blank" rel="noopener"><code>DateTimeFormatter</code></a>.<br>
If {@code timezone} is specified, this conversion specifier uses <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/time/ZoneId.html#of(java.lang.String)" target="_blank" rel="noopener"><code>ZoneId.of(String)</code></a> method to parse it, so timezone syntax must be compatible with zone id format.<br></p>
</div>
<div class="paragraph">
<p>The following table describes option usage results:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Conversion specifier</th>
<th class="tableblock halign-left valign-top">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%date</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2020-01-02 03:04:05.123</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%date{yyyy-MM-dd}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2020-01-02</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%date{HH:mm:ss.SSS}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>03:04:05.123</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%date{, UTC}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2020-01-02 03:04:05.123</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If pattern is missing (For example: <code>%d</code>, <code>%date</code>, <code>%date{, UTC}}</code>, the default pattern will be used:
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-logger/src/main/java/io/rxmicro/logger/internal/jul/config/adapter/pattern/consumers/DateTimeOfLoggingEventBiConsumer.java#L40" target="_blank" rel="noopener"><code>yyyy-MM-dd HH:mm:ss.SSS</code></a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>F</strong><br>
<strong>file</strong>`</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Outputs the file name of the Java source file where the logging request was issued.</p>
</div>
<div class="paragraph">
<p><strong>Generating the file information is not particularly fast.
Thus, its use should be avoided unless execution speed is not an issue!</strong></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>L</strong><br>
<strong>line</strong>`</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Outputs the line number from where the logging request was issued.</p>
</div>
<div class="paragraph">
<p><strong>Generating the file information is not particularly fast.
Thus, its use should be avoided unless execution speed is not an issue!</strong></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>m</strong><br>
<strong>mes</strong>`<br>
<strong>message</strong><br></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Outputs the application-supplied message associated with the logging event.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>M</strong><br>
<strong>method</strong>`</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Outputs the method name where the logging request was issued.</p>
</div>
<div class="paragraph">
<p><strong>Generating the method name is not particularly fast.
Thus, its use should be avoided unless execution speed is not an issue.</strong></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>n</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Outputs the platform dependent line separator character or characters.</p>
</div>
<div class="paragraph">
<p>This conversion word offers practically the same performance as using non-portable line separator strings such as <code>\n</code>, or <code>\r\n</code>.
Thus, it is the preferred way of specifying a line separator.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>p</strong><br>
<strong>le</strong>`<br>
<strong>level</strong><br></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Outputs the level of the logging event.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>r</strong><br>
<strong>relative</strong><br></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Outputs the number of milliseconds elapsed since the start of the application until the creation of the logging event.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>t</strong><br>
<strong>thread</strong><br></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Outputs the name of the thread that generated the logging event.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>id</strong><br>
<strong>rid</strong><br>
<strong>request-id</strong><br>
<strong>request_id</strong><br>
<strong>requestId</strong><br></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Outputs the request id if specified.</p>
</div>
<div class="paragraph">
<p>This specifier displays the request id that retrieved from HTTP request if the <a href="{monitoring}.html#monitoring-request-tracing">request tracing</a> is enabled.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For request tracing feature usage Your code must use the overloaded logger methods with <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-logger/src/main/java/io/rxmicro/logger/RequestIdSupplier.java" target="_blank" rel="noopener"><code>RequestIdSupplier</code></a> argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface Logger {

    // ...

    void trace(RequestIdSupplier requestIdSupplier, Object... otherArguments);

    void debug(RequestIdSupplier requestIdSupplier, Object... otherArguments);

    void info(RequestIdSupplier requestIdSupplier, Object... otherArguments);

    void warn(RequestIdSupplier requestIdSupplier, Object... otherArguments);

    void error(RequestIdSupplier requestIdSupplier, Object... otherArguments);

    // ...
}</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="custom_log_event"><a class="anchor" href="#custom_log_event"></a><a class="link" href="#custom_log_event">4.9.4. Custom Log Event</a></h4>
<div class="paragraph">
<p>The RxMicro framework provides a factory method to build a custom logger event:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">private static final Logger LOGGER = LoggerFactory.getLogger(LoggerEventBuilderTest.class);

public static void main(final String[] args) {
    final LoggerEventBuilder builder = LoggerFactory.newLoggerEventBuilder();
    builder.setMessage("Hello World!");
    LOGGER.info(builder.build());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A custom logger event can be useful if Your log message depends on some parameter.<br>
For example, the following methods implement the same logic:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public void log1(final Throwable throwable,
                 final boolean withStackTrace) {
    final LoggerEventBuilder builder = LoggerFactory.newLoggerEventBuilder()
            .setMessage("Some error message: ?", throwable.getMessage());
    if (withStackTrace) {
        builder.setThrowable(throwable);
    }
    LOGGER.error(builder.build());
}

public void log2(final Throwable throwable,
                 final boolean withStackTrace) {
    if (withStackTrace) {
        LOGGER.error(throwable, "Some error message: ?", throwable.getMessage());
    } else {
        LOGGER.error("Some error message: ?", throwable.getMessage());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Besides that a custom logger event allows customizing the following auto detect parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Thread id;</p>
</li>
<li>
<p>Thread name;</p>
</li>
<li>
<p>Source class name;</p>
</li>
<li>
<p>Source method name;</p>
</li>
<li>
<p>Source file name;</p>
</li>
<li>
<p>Source line number.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">LOGGER.info(
        LoggerFactory.newLoggerEventBuilder()
                .setMessage("Some error message")
                .setThreadName("Test-Thread-Name")
                .setThreadId(34L)
                .setStackFrame("package.Class", "method", "Test.java", 85)
                .setThrowable(throwable)
                .build()
);</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="multiline_logs_issue_for_docker_environment"><a class="anchor" href="#multiline_logs_issue_for_docker_environment"></a><a class="link" href="#multiline_logs_issue_for_docker_environment">4.9.5. Multiline Logs Issue For Docker Environment</a></h4>
<div class="paragraph">
<p>By default the <code>docker</code> log driver does not support multiline log data.<br>
It means that if Your microservice prints a stacktrace of any exception to the <code>System.out</code> or <code>System.err</code> each stack trace element will be processed as separate log event.</p>
</div>
<div class="paragraph">
<p>There are several standard solutions to this problem.
The RxMicro framework adds the one of them.</p>
</div>
<div class="sect4">
<h5 id="solution_from_rxmicro_framework"><a class="anchor" href="#solution_from_rxmicro_framework"></a><a class="link" href="#solution_from_rxmicro_framework">4.9.5.1. Solution From RxMicro Framework</a></h5>
<div class="paragraph">
<p>If Your logger configuration contains the following setting:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">io.rxmicro.logger.jul.PatternFormatter.singleLine=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>than all multiline log events are processed by the RxMicro framework as single line ones:<br>
i.e. the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-logger/src/main/java/io/rxmicro/logger/jul/PatternFormatter.java" target="_blank" rel="noopener"><code>PatternFormatter</code></a>
component replaces <code>'\n'</code> character by the <code>"\\n"</code> string before printing it to the <code>System.out</code> or <code>System.err</code>.<br>
<em>(For Windows platform the <code>"\r\n""</code> character combination will be replaced by <code>"\\r\\n"</code> string!)</em></p>
</div>
</div>
<div class="sect4">
<h5 id="how_to_view_original_log_events"><a class="anchor" href="#how_to_view_original_log_events"></a><a class="link" href="#how_to_view_original_log_events">4.9.5.2. How To View Original Log Events?</a></h5>
<div class="paragraph">
<p>To view original logs You can use the <a href="https://www.gnu.org/software/sed/manual/sed.html" target="_blank" rel="noopener"><code>sed</code></a> util:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">docker logs microservice-container | sed -e 's/\\n/\n/g'</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">kubectl logs microservice-pod | sed -e 's/\\n/\n/g'</code></pre>
</div>
</div>
<div class="paragraph">
<p>To view original logs on Your log aggregation tool if <a href="https://www.fluentd.org/" target="_blank" rel="noopener"><code>fluentd</code></a>
open source data collector is used, it is necessary to add the following filter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">&lt;filter exampleTag&gt;
    @type record_transformer
    enable_ruby true
    &lt;record&gt;
        # --- Replace "\n" string by '\n' character ---
        log ${record["log"].gsub("\\n", "\n")}
    &lt;/record&gt;
&lt;/filter&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>FYI: This filter requires that your log messages are parsed and converted to the json property with <code>log</code> name before invocation of this filter!</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="core-rx-micro-json-section"><a class="anchor" href="#core-rx-micro-json-section"></a><a class="link" href="#core-rx-micro-json-section">4.10. JSON</a></h3>
<div class="paragraph">
<p><a href="https://www.json.org/" target="_blank" rel="noopener"><strong>JSON</strong></a> is a widely used message exchange format for distributed applications.</p>
</div>
<div class="paragraph">
<p>The RxMicro framework provides the <code>rxmicro.json</code> module for low-level and efficient work with this format.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Unfortunately <a href="https://www.json.org/" target="_blank" rel="noopener"><strong>JSON</strong></a> format is defined in at least seven different documents:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>2002</code> - <a href="https://www.json.org/" target="_blank" rel="noopener">json.org</a>, and the business card</p>
</li>
<li>
<p><code>2006</code> - IETF <a href="https://tools.ietf.org/html/rfc4627" target="_blank" rel="noopener">RFC 4627</a>, which set the application/json MIME media type</p>
</li>
<li>
<p><code>2011</code> - <a href="http://www.ecma-international.org/ecma-262/5.1/#sec-15.12" target="_blank" rel="noopener">ECMAScript 262, section 15.12</a></p>
</li>
<li>
<p><code>2013</code> - <a href="http://www.ecma-international.org/publications/standards/Ecma-404.htm" target="_blank" rel="noopener">ECMA 404</a> according to Tim Bray (RFC 7159 editor)</p>
</li>
<li>
<p><code>2014</code> - IETF <a href="https://tools.ietf.org/html/rfc7158" target="_blank" rel="noopener">RFC 7158</a></p>
</li>
<li>
<p><code>2014</code> - IETF <a href="https://tools.ietf.org/html/rfc7159" target="_blank" rel="noopener">RFC 7159</a></p>
</li>
<li>
<p><code>2017</code> - IETF <a href="https://tools.ietf.org/html/rfc8259" target="_blank" rel="noopener">RFC 8259</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>(Read more at <a href="http://seriot.ch/parsing_json.php" target="_blank" rel="noopener">Parsing JSON is a Minefield</a> article).</p>
</div>
<div class="paragraph">
<p>So the RxMicro framework implementation of JSON parser can be described using the following test suites:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.rxmicro.io/latest/static/java-parsers-only.html">JSON Parsing Tests, Only Java Parsers</a></p>
</li>
<li>
<p><a href="https://docs.rxmicro.io/latest/static/all-parsers.html">JSON Parsing Tests, All Parsers</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The RxMicro framework uses classes from the <code>rxmicro.json</code> module when automatically converting Java models to JSON format and vice versa.</p>
</div>
<div class="paragraph">
<p><strong>Therefore, a developer should not explicitly use this module!</strong></p>
</div>
<div class="paragraph">
<p><em>However, the common idea about the capabilities of this module is needed for correct test writing!</em></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
<div class="sect3">
<h4 id="core-json-type-mapping"><a class="anchor" href="#core-json-type-mapping"></a><a class="link" href="#core-json-type-mapping">4.10.1. A Mapping Between JSON and Java Types</a></h4>
<div class="paragraph">
<p>Since this module is used automatically, it is optimized for machine operations.
Therefore, this module doesn&#8217;t provide separate classes for JSON types.
Instead, standard Java classes are used:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Mapping table between JSON and Java types.</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>JSON type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Java type</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>object</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Map.html" target="_blank" rel="noopener"><code>java.util.Map&lt;String, Object&gt;</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>array</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html" target="_blank" rel="noopener"><code>java.util.List&lt;Object&gt;</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Boolean.html" target="_blank" rel="noopener"><code>java.lang.Boolean</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>null</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>null</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-json/src/main/java/io/rxmicro/json/JsonNumber.java" target="_blank" rel="noopener"><code>io.rxmicro.json.JsonNumber</code></a></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Mapping table between Java and JSON types.</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Java type</strong></th>
<th class="tableblock halign-left valign-top"><strong>JSON type</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Map.html" target="_blank" rel="noopener"><code>java.util.Map&lt;String, Object&gt;</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>object</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html" target="_blank" rel="noopener"><code>java.util.List&lt;Object&gt;</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>array</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Boolean.html" target="_blank" rel="noopener"><code>java.lang.Boolean</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>null</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>null</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Number.html" target="_blank" rel="noopener"><code>? extends java.lang.Number</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-json/src/main/java/io/rxmicro/json/JsonNumber.java" target="_blank" rel="noopener"><code>io.rxmicro.json.JsonNumber</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Any Java Class</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="core-json-rxmicro-json-module-usage"><a class="anchor" href="#core-json-rxmicro-json-module-usage"></a><a class="link" href="#core-json-rxmicro-json-module-usage">4.10.2. <code>rxmicro.json</code> Module Usage</a></h4>
<div class="paragraph">
<p>To write <a href="#testing-section">tests</a> correctly, it is necessary to have a common idea about the <code>rxmicro.json</code> module.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s look at a microservice that returns the result in JSON object format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class MicroService {

    @GET("/")
    CompletionStage&lt;Response&gt; produce() {
        return completedStage(new Response());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Response</code> class - Java model of HTTP response in JSON format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Response {

    final Child child = new Child(); <i class="conum" data-value="1"></i><b>(1)</b>

    final List&lt;Integer&gt; values = List.of(25, 50, 75, 100); <i class="conum" data-value="2"></i><b>(2)</b>

    final String string = "text"; <i class="conum" data-value="3"></i><b>(3)</b>

    final Integer integer = 10; <i class="conum" data-value="4"></i><b>(4)</b>

    final BigDecimal decimal = new BigDecimal("0.1234"); <i class="conum" data-value="5"></i><b>(5)</b>

    final Boolean logical = true; <i class="conum" data-value="6"></i><b>(6)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Nested JSON object.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>JSON numeric array.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>String data type.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Integer numeric data type.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Floating-point numeric data type.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Logical data type.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>Child</code> class - Java model of the nested JSON object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Child {

    final Integer integer = 20;
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For simplicity, each response model field is immediately initialized with test data.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As a result, the microservice returns the following JSON object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "child": {
    "integer": 20
  },
  "values": [
    25,
    50,
    75,
    100
  ],
  "string": "text",
  "integer": 10,
  "decimal": 0.1234,
  "logical": true
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>While writing <a href="#testing-rest-based-microservice-tests-section">REST-based microservice test</a> or <a href="#testing-integration-tests-basic-section">integration test</a>, it is necessary to compare the expected JSON response with the one returned by REST-based microservice.
<em>(The response returned by the microservice is available through the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http-client/src/main/java/io/rxmicro/http/client/ClientHttpResponse.java#L75" target="_blank" rel="noopener"><code>ClientHttpResponse.getBody()</code></a>method)</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceTest {
    //..
    @Test
    void Should_return_Response() {
        final ClientHttpResponse response = httpClient.get("/").join();
        final Object actualBody = response.getBody(); <i class="conum" data-value="1"></i><b>(1)</b>
        // ...
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>ClientHttpResponse.getBody()</code> method returns the HTTP response body.
Since the REST-based microservice returns a JSON object, this method returns the result as the <a href="#core-json-type-mapping"><code>java.util.Map&lt;String, Object&gt;</code></a> object.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Therefore, to compare JSON objects, You need to create the <code>java.util.Map&lt;String, Object&gt;</code> object containing the expected properties of the JSON object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceTest {
    //..
    @Test
    void Should_return_Response() {
        final ClientHttpResponse response = httpClient.get("/").join();
        final Object actualBody = response.getBody(); <i class="conum" data-value="1"></i><b>(1)</b>
        final Object expectedBody = Stream.of(
                Map.entry("child", Map.of(
                        "integer", new io.rxmicro.json.JsonNumber("20")
                )),
                Map.entry("values", List.of(
                        new io.rxmicro.json.JsonNumber("25"),
                        new io.rxmicro.json.JsonNumber("50"),
                        new io.rxmicro.json.JsonNumber("75"),
                        new io.rxmicro.json.JsonNumber("100")
                )),
                Map.entry("string", "text"),
                Map.entry("integer", new io.rxmicro.json.JsonNumber("10")),
                Map.entry("decimal", new io.rxmicro.json.JsonNumber("0.1234")),
                Map.entry("logical", true)
        ).collect(Collectors.toMap(
                Map.Entry::getKey,
                Map.Entry::getValue,
                (u, v) -&gt; u, LinkedHashMap::new
        )); <i class="conum" data-value="2"></i><b>(2)</b>
        assertEquals(expectedBody, actualBody); <i class="conum" data-value="3"></i><b>(3)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A JSON object returned by microservice.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Expected JSON object.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Comparison of JSON objects using the
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" target="_blank" rel="noopener"><code>java.lang.Object.equals()</code></a> method.</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>According to the <a href="https://tools.ietf.org/html/rfc7159#page-6" target="_blank" rel="noopener">JSON specification</a>, the property order in JSON object is undefined.</p>
</div>
<div class="paragraph">
<p>Thus, the following JSON objects:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "firstname" : "David",
    "lastname" : "Smith"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "lastname" : "Smith",
    "firstname" : "David"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>are considered to be the same.</p>
</div>
<div class="paragraph">
<p><strong>The RxMicro framework always arranges JSON object properties!</strong></p>
</div>
<div class="paragraph">
<p><strong>Thus, the order of JSON properties always corresponds to the order of fields in the Java model!</strong></p>
</div>
<div class="paragraph">
<p>This allows You to compare JSON objects in the form of  <code>java.util.Map&lt;String, Object&gt;</code> using the
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" target="_blank" rel="noopener"><code>java.lang.Object.equals()</code></a> method.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If Your microservice returns the JSON object with unordered properties, use
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/json/JsonFactory.java" target="_blank" rel="noopener"><code>JsonFactory.orderedJsonObject(Object jsonObject)</code></a>
method to sort properties before comparison!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For convenient creation of the expected JSON object, it is recommended to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/json/JsonFactory.java" target="_blank" rel="noopener"><code>JsonFactory</code></a> utility class.
This class arranges JSON properties and automatically converts all
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Number.html" target="_blank" rel="noopener"><code>java.lang.Number</code></a> types into the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-json/src/main/java/io/rxmicro/json/JsonNumber.java" target="_blank" rel="noopener"><code>io.rxmicro.json.JsonNumber</code></a> type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceTest {

    private BlockingHttpClient blockingHttpClient;

    @Test
    void Should_return_Response() {
        final ClientHttpResponse response = blockingHttpClient.get("/");

        final Object actualBody = response.getBody(); <i class="conum" data-value="1"></i><b>(1)</b>
        final Object expectedBody = jsonObject(
                "child", jsonObject("integer", 20), <i class="conum" data-value="4"></i><b>(4)</b>
                "values", jsonArray(25, 50, 75, 100),   <i class="conum" data-value="5"></i><b>(5)</b>
                "string", "text",
                "integer", 10,
                "decimal", new BigDecimal("0.1234"),
                "logical", true
        ); <i class="conum" data-value="2"></i><b>(2)</b>
        assertEquals(expectedBody, actualBody); <i class="conum" data-value="3"></i><b>(3)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A JSON object returned by microservice.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Expected JSON object.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Comparison of JSON objects using the
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" target="_blank" rel="noopener"><code>java.lang.Object.equals()</code></a> method.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>To create JSON object, it is recommended to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/json/JsonFactory.java" target="_blank" rel="noopener"><code>JsonFactory.jsonObject</code></a> method.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>To create JSON array, it is recommended to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/json/JsonFactory.java" target="_blank" rel="noopener"><code>JsonFactory.jsonArray</code></a> method.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http-client/src/main/java/io/rxmicro/http/client/ClientHttpResponse.java" target="_blank" rel="noopener"><code>ClientHttpResponse</code></a>
interface besides <code>body()</code> method also contains <code>bodyAsBytes()</code> and <code>bodyAsString()</code> ones.</p>
</div>
<div class="paragraph">
<p>Therefore in the test You can compare JSON objects by comparing their string representation or using a third-party Java library that supports the JSON format.
(For example, <a href="https://github.com/stleary/JSON-java" target="_blank" rel="noopener"><code>JSON-java</code></a>, <a href="https://javaee.github.io/jsonp/" target="_blank" rel="noopener"><code>Java API for JSON Processing</code></a>, etc.)</p>
</div>
<div class="paragraph">
<p><strong>Thus, the RxMicro framework recommends using the <code>rxmicro.json</code> module to compare JSON objects, but at the same time provides an opportunity to use any other JSON framework!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-common/json" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-common/json</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="core-json-rxmicro-json-wrappers"><a class="anchor" href="#core-json-rxmicro-json-wrappers"></a><a class="link" href="#core-json-rxmicro-json-wrappers">4.10.3. Json Wrappers</a></h4>
<div class="paragraph">
<p>If you want to work with JSON format using usual Java style, the RxMicro framework provides wrapper classes for JSON object and array:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceTestWithWrappers {

    private BlockingHttpClient blockingHttpClient;

    static Stream&lt;Function&lt;ClientHttpResponse, JsonObject&gt;&gt; toJsonObjectWrapperConverterProvider() {
        return Stream.of(
                <i class="conum" data-value="1"></i><b>(1)</b>
                response -&gt; JsonWrappers.toJsonObject(response.getBody()),
                <i class="conum" data-value="2"></i><b>(2)</b>
                response -&gt; JsonWrappers.readJsonObject(response.getBodyAsString(UTF_8))
        );
    }

    @ParameterizedTest
    @MethodSource("toJsonObjectWrapperConverterProvider")
    void Should_return_Response(final Function&lt;ClientHttpResponse, JsonObject&gt; converter) {
        final ClientHttpResponse response = blockingHttpClient.get("/");

        final JsonObject actualBody = converter.apply(response);

        assertEquals(
                new JsonObject()
                        .set("integer", 20),
                actualBody.getJsonObject("child")
        );
        assertEquals(
                new JsonArray()
                        .add(25).add(50).add(75).add(100),
                actualBody.getJsonArray("values")
        );
        assertEquals(
                "text",
                actualBody.getString("string")
        );
        assertEquals(
                10,
                actualBody.getNumber("integer").intValueExact()
        );
        assertEquals(
                new BigDecimal("0.1234"),
                actualBody.getNumber("decimal").bigDecimalValueExact()
        );
        assertTrue(
                actualBody.getBoolean("logical")
        );
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>- To convert a internal view of JSON object to the JSON wrapper use <code>JsonWrappers.toJsonObject</code> method.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>- To convert a string view of JSON object to the JSON wrapper use <code>JsonWrappers.readJsonObject</code> method.</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="native_transports"><a class="anchor" href="#native_transports"></a><a class="link" href="#native_transports">4.11. Native Transports</a></h3>
<div class="paragraph">
<p>The RxMicro framework uses <a href="https://netty.io/" target="_blank" rel="noopener"><code>Netty</code></a> to perform asynchronous non-blocking IO operations.
To increase productivity, <code>Netty</code> allows the use of <a href="https://netty.io/wiki/native-transports.html" target="_blank" rel="noopener"><code>native transports</code></a>.</p>
</div>
<div class="paragraph">
<p>To enable <code>native transports</code> feature, add one of the following dependencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
    &lt;artifactId&gt;rxmicro-netty-native-linux&lt;/artifactId&gt;
    &lt;version&gt;${rxmicro.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
    &lt;artifactId&gt;rxmicro-netty-native-osx&lt;/artifactId&gt;
    &lt;version&gt;${rxmicro.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
    &lt;artifactId&gt;rxmicro-netty-native&lt;/artifactId&gt;
    &lt;version&gt;${rxmicro.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
    &lt;artifactId&gt;rxmicro-netty-native-all&lt;/artifactId&gt;
    &lt;version&gt;${rxmicro.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>rxmicro-netty-native-linux</code> dependency adds the <code>netty-transport-native-epoll</code> artifact;</p>
</li>
<li>
<p>The <code>rxmicro-netty-native-osx</code> dependency adds the <code>netty-transport-native-kqueue</code> artifact;</p>
</li>
<li>
<p>The <code>rxmicro-netty-native</code> dependency activates <code>native transports</code> for the current platform:</p>
<div class="ulist">
<ul>
<li>
<p>in case of the <code>Linux</code> current platform, the <code>netty-transport-native-epoll</code> artifact is added;</p>
</li>
<li>
<p>in case of the <code>MacOS</code> current platform, the <code>netty-transport-native-kqueue</code> artifact is added;</p>
</li>
<li>
<p>otherwise <code>native transports</code> is not activated for the current platform;</p>
</li>
</ul>
</div>
</li>
<li>
<p>the <code>rxmicro-netty-native-all</code> dependency adds the <code>netty-transport-native-epoll</code> and <code>netty-transport-native-kqueue</code> artifacts.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Adding a dependency to the microservice project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
    &lt;artifactId&gt;rxmicro-netty-native-linux&lt;/artifactId&gt;
    &lt;version&gt;${rxmicro.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>instead of</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.netty&lt;/groupId&gt;
    &lt;artifactId&gt;netty-transport-native-epoll&lt;/artifactId&gt;
    &lt;version&gt;${netty.version}&lt;/version&gt;
    &lt;classifier&gt;linux-x86_64&lt;/classifier&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>allows using the <code>Netty native transports</code> library version compatible with all other <code>Netty</code> libraries used by the RxMicro framework.</p>
</div>
<div class="paragraph">
<p>Therefore, the <strong><code>rxmicro-netty-native-&#8230;&#8203;</code> modules don&#8217;t contain any logic.</strong> <strong>They just add <code>Netty native transports</code> libraries of the correct version.</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code>native transports</code> has been successfully activated, the information message about the start of the HTTP server will display the corresponding type of transport.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">2020-02-02 20:14:11.707 [INFO] io.rxmicro.rest.server.netty.internal.component.NettyServer :
Server started at 0.0.0.0:8080 using <strong>EPOLL</strong> transport in 500 millis. <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>using EPOLL transport</code> message format means that <code>Netty</code> will use the <code>netty-transport-native-epoll</code> library.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">2020-02-02 20:14:11.707 [INFO] io.rxmicro.rest.server.netty.internal.component.NettyServer :
Server started at 0.0.0.0:8080 using <strong>KQUEUE</strong> transport in 500 millis. <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>using KQUEUE transport</code> message format means that <code>Netty</code> will use the <code>netty-transport-native-kqueue</code> library.</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="rest-controller-section"><a class="anchor" href="#rest-controller-section"></a><a class="link" href="#rest-controller-section">5. REST Controller</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>REST Controller is a class that contains at least one declarative HTTP request handler.</p>
</div>
<div class="paragraph">
<p>Each REST-based microservice project must contain at least one REST Controller.<br>
<em>(The REST Controller is the entry point for the client.)</em></p>
</div>
<div class="paragraph">
<p>To create REST controllers, the RxMicro framework provides the following modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-rest" target="_blank" rel="noopener"><code>rxmicro.rest</code></a> is a basic module that defines basic <code>RxMicro Annotations</code>, required when using the
<a href="https://en.wikipedia.org/wiki/Representational_state_transfer" target="_blank" rel="noopener"><code>REST</code></a> architecture of building program systems;</p>
</li>
<li>
<p>The <a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-rest-server" target="_blank" rel="noopener"><code>rxmicro.rest.server</code></a> is a basic HTTP server module used to create REST controllers and run REST-based microservices;</p>
</li>
<li>
<p>The <a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-rest-server-netty" target="_blank" rel="noopener"><code>rxmicro.rest.server.netty</code></a> is an HTTP server implementation module based on <a href="https://netty.io/" target="_blank" rel="noopener"><code>Netty</code></a>;</p>
</li>
<li>
<p>The <a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-rest-server-exchange-json" target="_blank" rel="noopener"><code>rxmicro.rest.server.exchange.json</code></a> is a module for converting Java models to <a href="https://www.json.org/" target="_blank" rel="noopener"><code>JSON</code></a> format and vice versa;</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Due to transit dependencies only two modules usually need to be added to a project:
<a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-rest-server-netty" target="_blank" rel="noopener"><code>rxmicro.rest.server.netty</code></a> and <a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-rest-server-exchange-json" target="_blank" rel="noopener"><code>rxmicro.rest.server.exchange.json</code></a>.<br>
<em>(All other modules are automatically added to the project!)</em></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
<div class="sect2">
<h3 id="rest_controller_implementation_requirements"><a class="anchor" href="#rest_controller_implementation_requirements"></a><a class="link" href="#rest_controller_implementation_requirements">5.1. REST Controller Implementation Requirements.</a></h3>
<div class="sect3">
<h4 id="rest_controller_class_requirements"><a class="anchor" href="#rest_controller_class_requirements"></a><a class="link" href="#rest_controller_class_requirements">5.1.1. REST Controller Class Requirements.</a></h4>
<div class="paragraph">
<p>REST Controller is a Java class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.rxmicro.rest.method.GET;

final class MicroService {

    @GET("/")
    void requestHandler() {

    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>that must meet the following requirements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The class must extend the <code>java.lang.Object</code> one.</p>
</li>
<li>
<p>The class couldn&#8217;t be an <code>abstract</code> one.</p>
</li>
<li>
<p>The class couldn&#8217;t be a nested one.</p>
</li>
<li>
<p>The class must contain an accessible (not private) constructor without parameters.<br>
<em>(The last requirement can be ignored if Your project depends on <a href="#{cdi-section}"><code>rxmicro.cdi</code></a> module.)</em></p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A REST Controller class must be a public one, only if it contains the method: <code>public static void main(final String[] args)</code>.
Otherwise, a REST Controller class can be nonpublic.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="http_request_handler_requirements"><a class="anchor" href="#http_request_handler_requirements"></a><a class="link" href="#http_request_handler_requirements">5.1.2. HTTP Request Handler Requirements.</a></h4>
<div class="paragraph">
<p>HTTP request handler is a method, that must meet the following requirements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The method couldn&#8217;t be a <code>private</code> one.</p>
</li>
<li>
<p>The method couldn&#8217;t be an <code>abstract</code> one.</p>
</li>
<li>
<p>The method couldn&#8217;t be a <code>synchronized</code> one.</p>
</li>
<li>
<p>The method couldn&#8217;t be a <code>static</code> one.</p>
</li>
<li>
<p>The method couldn&#8217;t be a <code>native</code> one.</p>
</li>
<li>
<p>The method must be annotated by at least one of the following annotations:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/GET.java" target="_blank" rel="noopener"><code>GET</code></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/POST.java" target="_blank" rel="noopener"><code>POST</code></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/PUT.java" target="_blank" rel="noopener"><code>PUT</code></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/DELETE.java" target="_blank" rel="noopener"><code>DELETE</code></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/PATCH.java" target="_blank" rel="noopener"><code>PATCH</code></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/HEAD.java" target="_blank" rel="noopener"><code>HEAD</code></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/OPTIONS.java" target="_blank" rel="noopener"><code>OPTIONS</code></a>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>The method must return a <code>void</code> type or one of the following reactive types:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html" target="_blank" rel="noopener"><code>CompletableFuture</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletionStage.html" target="_blank" rel="noopener"><code>CompletionStage</code></a>;</p>
</li>
<li>
<p><a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Mono.html" target="_blank" rel="noopener"><code>Mono</code></a>;</p>
</li>
<li>
<p><a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Completable.html" target="_blank" rel="noopener"><code>Completable</code></a>;</p>
</li>
<li>
<p><a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Single.html" target="_blank" rel="noopener"><code>Single</code></a>;</p>
</li>
<li>
<p><a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Maybe.html" target="_blank" rel="noopener"><code>Maybe</code></a>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>If the method returns a reactive type, that this type must be parametrized by a HTTP response model type.
(The additional types such as <code>java.lang.Void</code> and <code>java.util.Optional</code> are supported also.
<em>(Read more: <a href="#core-reactive-bussiness-process-reactive-class-mapping-table">Table 2, &#8220;Which class from a reactive library must be choose?&#8221;</a>)</em>).</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The
<a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Flux.html" target="_blank" rel="noopener"><code>Flux</code></a> and
<a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Flowable.html" target="_blank" rel="noopener"><code>Flowable</code></a>
types are developed to handle data stream that may arrive within a certain period of time.</p>
</div>
<div class="paragraph">
<p>For such cases the HTTP protocol provides the special <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Transfer-Encoding" target="_blank" rel="noopener"><code>Transfer-Encoding</code></a> mechanism.</p>
</div>
<div class="paragraph">
<p>But this mechanism is not supported by the RxMicro framework yet, so the
<a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Flux.html" target="_blank" rel="noopener"><code>Flux</code></a> and
<a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Flowable.html" target="_blank" rel="noopener"><code>Flowable</code></a>
types cannot be used in the HTTP request handler.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The RxMicro framework supports the following parameter types for the HTTP request handler:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Handler without parameters.<br>
<em>(This type is recommended for the simplest <code>stateless</code> microservices without parameters.)</em></p>
</li>
<li>
<p>List of primitive parameters.<br>
<em>(This type is recommended for microservices, the behavior of which depends on 1-2 parameters.)</em></p>
</li>
<li>
<p>Custom class modeling an HTTP request.<br>
<em>(This type is recommended for microservices, the behavior of which depends on 3 or more parameters.)</em></p>
</li>
</ol>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When using the
<a href="https://projectreactor.io/docs/core/release/reference/index.html" target="_blank" rel="noopener"><strong>Project Reactor</strong></a> and <a href="https://github.com/ReactiveX/RxJava/blob/3.x/README.md" target="_blank" rel="noopener"><strong>RxJava</strong></a>
reactive libraries, You need:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add dependencies to <code>pom.xml</code>.</p>
</li>
<li>
<p>Add modules to <code>module-info.java</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Adding dependencies to <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;io.projectreactor&lt;/groupId&gt;
        &lt;artifactId&gt;reactor-core&lt;/artifactId&gt;
        &lt;version&gt;${projectreactor.version}&lt;/version&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;io.reactivex.rxjava3&lt;/groupId&gt;
        &lt;artifactId&gt;rxjava&lt;/artifactId&gt;
        &lt;version&gt;${rxjava.version}&lt;/version&gt; <i class="conum" data-value="2"></i><b>(2)</b>
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><a href="https://mvnrepository.com/artifact/io.projectreactor/reactor-core" target="_blank" rel="noopener">The latest stable version of the <code>Project Reactor</code> library</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><a href="https://mvnrepository.com/artifact/io.reactivex.rxjava3/rxjava" target="_blank" rel="noopener">The latest stable version of the <code>RxJava3</code> library</a>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Adding modules to <code>module-info.java</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">module example {
    requires reactor.core; <i class="conum" data-value="1"></i><b>(1)</b>
    requires io.reactivex.rxjava3; <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>reactor.core</code> module when using the <a href="https://projectreactor.io/docs/core/release/reference/index.html" target="_blank" rel="noopener"><strong>Project Reactor</strong></a> library.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>io.reactivex.rxjava3</code> module when using the <a href="https://github.com/ReactiveX/RxJava/blob/3.x/README.md" target="_blank" rel="noopener"><strong>RxJava</strong></a> library.</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="rest-controller-annotations-section"><a class="anchor" href="#rest-controller-annotations-section"></a><a class="link" href="#rest-controller-annotations-section">5.2. <code>RxMicro Annotations</code></a></h3>
<div class="paragraph">
<p>The RxMicro framework supports the following <code>RxMicro Annotations</code>, which are used to create and configure REST Controllers.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Supported <code>RxMicro Annotations</code>.</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Annotation</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/GET.java" target="_blank" rel="noopener"><code>@GET</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a method, that must handle a <code>GET</code> HTTP request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/POST.java" target="_blank" rel="noopener"><code>@POST</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a method, that must handle a <code>POST</code> HTTP request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/PUT.java" target="_blank" rel="noopener"><code>@PUT</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a method, that must handle a <code>PUT</code> HTTP request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/DELETE.java" target="_blank" rel="noopener"><code>@DELETE</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a method, that must handle a <code>DELETE</code> HTTP request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/PATCH.java" target="_blank" rel="noopener"><code>@PATCH</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a method, that must handle a <code>PATCH</code> HTTP request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/HEAD.java" target="_blank" rel="noopener"><code>@HEAD</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a method, that must handle a <code>HEAD</code> HTTP request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/OPTIONS.java" target="_blank" rel="noopener"><code>@OPTIONS</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a method, that must handle a <code>OPTIONS</code> HTTP request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/BaseUrlPath.java" target="_blank" rel="noopener"><code>@BaseUrlPath</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#rest-controller-base-url-path-section">a base URL path for the all request handlers at the REST controller</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Version.java" target="_blank" rel="noopener"><code>@Version</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#rest-controller-versioning-section">a version of the REST controller</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Header.java" target="_blank" rel="noopener"><code>@Header</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes that a field of Java model class is <a href="#rest-controller-headers-basic">a HTTP header</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/HeaderMappingStrategy.java" target="_blank" rel="noopener"><code>@HeaderMappingStrategy</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares <a href="#rest-controller-headers-basic">a strategy of header name formation based on Java model field name analysis</a>.</p>
<p class="tableblock"><em>(By default, the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-model/src/main/java/io/rxmicro/model/MappingStrategy.java#L76" target="_blank" rel="noopener"><code>CAPITALIZE_WITH_HYPHEN</code></a> strategy is used.
Thus, by using this strategy, the <code>Header-Name</code> name header corresponds to the <code>headerName</code> field name.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/AddHeader.java" target="_blank" rel="noopener"><code>@AddHeader</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#rest-controller-headers-static">a static HTTP header</a> that must be added to the response, created by the request handler.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/SetHeader.java" target="_blank" rel="noopener"><code>@SetHeader</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#rest-controller-headers-static">a static HTTP header</a> that must be set to the response, created by the request handler.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RepeatHeader.java" target="_blank" rel="noopener"><code>@RepeatHeader</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes the header, <a href="#rest-controller-headers-repeating">which name needs to be repeated for each element in the list</a>.</p>
<p class="tableblock"><em>(This annotation applies only to fields with the <code>java.util.List&lt;?&gt;</code> type.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Parameter.java" target="_blank" rel="noopener"><code>@Parameter</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes that a field of Java model class is <a href="#rest-controller-headers-basic">a HTTP parameter</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ParameterMappingStrategy.java" target="_blank" rel="noopener"><code>@ParameterMappingStrategy</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares <a href="#rest-controller-params-basic">a strategy of parameter name formation based on Java model field name analysis</a>.</p>
<p class="tableblock"><em>(By default, the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-model/src/main/java/io/rxmicro/model/MappingStrategy.java#L41" target="_blank" rel="noopener"><code>LOWERCASE_WITH_UNDERSCORED</code></a> strategy is used.
Thus, by using this strategy, the <code>header_name</code> name header corresponds to the <code>headerName</code> field name.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/PathVariable.java" target="_blank" rel="noopener"><code>@PathVariable</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes that a field of Java model class is <a href="#rest-controller-path-variables-basic">a <code>path variable</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RemoteAddress.java" target="_blank" rel="noopener"><code>@RemoteAddress</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the Java model field as a field, in which the RxMicro framework must inject <a href="#rest-controller-internals-basic-section">the remote client connection address</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RequestMethod.java" target="_blank" rel="noopener"><code>@RequestMethod</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the Java model field as a field, in which the RxMicro framework must inject <a href="#rest-controller-internals-basic-section">a method of the received request</a>.</p>
<p class="tableblock"><em>(This feature is useful for request logging when one handler supports different HTTP methods.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RequestUrlPath.java" target="_blank" rel="noopener"><code>@RequestUrlPath</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the Java model field as a field, in which the RxMicro framework must inject <a href="#rest-controller-internals-basic-section"><code>URL path</code> of the received request</a>.</p>
<p class="tableblock"><em>(This feature is useful for request logging using <code>path-variables</code>.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RequestBody.java" target="_blank" rel="noopener"><code>@RequestBody</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the Java model field as a field, in which the RxMicro framework must inject <a href="#rest-controller-internals-basic-section">a body of the received request</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ResponseStatusCode.java" target="_blank" rel="noopener"><code>@ResponseStatusCode</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates to the RxMicro framework that the value of the Java model field should be used as <a href="#rest-controller-internals-basic-section">a status code to be sent to the client</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ResponseBody.java" target="_blank" rel="noopener"><code>@ResponseBody</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates to the RxMicro framework that the value of the Java model field should be used as <a href="#rest-controller-internals-basic-section">a body to be sent to the client</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RequestId.java" target="_blank" rel="noopener"><code>@RequestId</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the Java model field as a field, in which the RxMicro framework must inject <a href="#rest-controller-request-id-section">a unique request ID</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/SetStatusCode.java" target="_blank" rel="noopener"><code>@SetStatusCode</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares <a href="#rest-controller-set-status-code-section">a status code</a>, which should be sent to the client in case of successful execution of the HTTP request handler.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/NotFoundMessage.java" target="_blank" rel="noopener"><code>@NotFoundMessage</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares a message returned by the handler in case of <a href="#rest-controller-not-found-section">no result</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/RestServerGeneratorConfig.java" target="_blank" rel="noopener"><code>@RestServerGeneratorConfig</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows <a href="#rest-controller-rest-server-generator-config-section">to configure the process of code generation by the <code>RxMicro Annotation Processor</code> for REST controllers</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/feature/EnableCrossOriginResourceSharing.java" target="_blank" rel="noopener"><code>@EnableCrossOriginResourceSharing</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Activates the <a href="#rest-controller-cors-section"><code>Cross Origin Resource Sharing</code> for all request handlers in the REST controller</a>.</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="return_types"><a class="anchor" href="#return_types"></a><a class="link" href="#return_types">5.3. Return Types</a></h3>
<div class="paragraph">
<p>The HTTP request handler supports two categories of returned results:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>HTTP response without body;</p>
</li>
<li>
<p>HTTP response with body;</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
<div class="sect3">
<h4 id="supported_return_types_for_http_response_without_body"><a class="anchor" href="#supported_return_types_for_http_response_without_body"></a><a class="link" href="#supported_return_types_for_http_response_without_body">5.3.1. Supported Return Types for HTTP Response without Body</a></h4>
<div class="paragraph">
<p>The RxMicro framework supports the following return result types for an HTTP response without body:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class RestControllerWithoutBody {

    <i class="conum" data-value="1"></i><b>(1)</b>
    @GET("/void/void1")
    void void1() {
        //do something
    }

    @GET("/void/void2")
    void void2(final Request request) {
        //do something with request
    }

    @GET("/void/void3")
    void void3(final String requestParameter) {
        //do something with requestParameter
    }

    <i class="conum" data-value="2"></i><b>(2)</b>

    @GET("/jse/completedFuture1")
    CompletableFuture&lt;Void&gt; completedFuture1() {
        return CompletableFuture.completedFuture(null);
    }

    @GET("/jse/completedFuture2")
    CompletableFuture&lt;Void&gt; completedFuture1(final Request request) {
        return CompletableFuture.completedFuture(null);
    }

    @GET("/jse/completedFuture3")
    CompletableFuture&lt;Void&gt; completedFuture1(final String requestParameter) {
        return CompletableFuture.completedFuture(null);
    }

    <i class="conum" data-value="3"></i><b>(3)</b>

    @GET("/jse/completionStage1")
    CompletionStage&lt;Void&gt; completionStage1() {
        return CompletableFuture.completedStage(null);
    }

    @GET("/jse/completionStage2")
    CompletionStage&lt;Void&gt; completionStage2(final Request request) {
        return CompletableFuture.completedStage(null);
    }

    @GET("/jse/completionStage3")
    CompletionStage&lt;Void&gt; completionStage3(final String requestParameter) {
        return CompletableFuture.completedStage(null);
    }

    <i class="conum" data-value="4"></i><b>(4)</b>

    @GET("/spring-reactor/mono1")
    Mono&lt;Void&gt; mono1() {
        return Mono.just("").then();
    }

    @GET("/spring-reactor/mono2")
    Mono&lt;Void&gt; mono2(final String requestParameter) {
        return Mono.just("").then();
    }

    @GET("/spring-reactor/mono3")
    Mono&lt;Void&gt; mono4(final Request request) {
        return Mono.just("").then();
    }

    <i class="conum" data-value="5"></i><b>(5)</b>

    @GET("/rxjava3/completable1")
    Completable completable1() {
        return Completable.complete();
    }

    @GET("/rxjava3/completable2")
    Completable completable2(final Request request) {
        return Completable.complete();
    }

    @GET("/rxjava3/completable3")
    Completable completable3(final String requestParameter) {
        return Completable.complete();
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>void</code> type is supported mainly for test purposes.<br>
<em>(The <code>void</code> type can also be applied when the request handler does not use any <a href="core.html#core-dont-block-current-thread">blocking operations</a>.
In cases where the request handler uses <a href="core.html#core-dont-block-current-thread">blocking operations</a>, one of the reactive types must be used instead of the <code>void</code> type.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html" target="_blank" rel="noopener"><code>CompletableFuture&lt;Void&gt;</code></a>
type is recommended when using the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/package-summary.html" target="_blank" rel="noopener"><strong>java.util.concurrent</strong></a> library.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Instead of the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html" target="_blank" rel="noopener"><code>CompletableFuture&lt;Void&gt;</code></a> type, can also be used the
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletionStage.html" target="_blank" rel="noopener"><code>CompletionStage&lt;Void&gt;</code></a> type.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>When using the <a href="https://projectreactor.io/docs/core/release/reference/index.html" target="_blank" rel="noopener"><strong>Project Reactor</strong></a> library, only the
<a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Mono.html" target="_blank" rel="noopener"><code>Mono&lt;Void&gt;</code></a> type can be used.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>When using the <a href="https://github.com/ReactiveX/RxJava/blob/3.x/README.md" target="_blank" rel="noopener"><strong>RxJava</strong></a> library, only the
<a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Completable.html" target="_blank" rel="noopener"><code>Completable</code></a> type can be used.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All the above mentioned handlers return an HTTP response without body:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(RestControllerWithoutBody.class)
final class RestControllerWithoutBodyTest {

    private BlockingHttpClient blockingHttpClient;

    @ParameterizedTest
    @ValueSource(strings = {
            "/void/void1",
            "/void/void2",
            "/void/void3",

            "/jse/completedFuture1",
            "/jse/completedFuture2",
            "/jse/completedFuture3",

            "/jse/completionStage1",
            "/jse/completionStage2",
            "/jse/completionStage3",

            "/spring-reactor/mono1",
            "/spring-reactor/mono2",
            "/spring-reactor/mono3",

            "/rxjava3/completable1",
            "/rxjava3/completable2",
            "/rxjava3/completable3"
    })
    void Should_support_HTTP_responses_without_body(final String urlPath) {
        final ClientHttpResponse response = blockingHttpClient.get(urlPath);

        assertTrue(response.isBodyEmpty(), "Body not empty: " + response.getBody()); <i class="conum" data-value="1"></i><b>(1)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When testing all <code>RestControllerWithoutBody</code> class handlers, each handler returns an HTTP response without body.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The RxMicro framework recommends for request handlers that depend on 3 or more
HTTP headers, HTTP parameters or <code>path variables</code>
to create separate classes of request model.</p>
</div>
<div class="paragraph">
<p><strong>Upon implementation of</strong>
<strong>HTTP headers, HTTP parameters or <code>path variables</code></strong>
<strong>directly into the handler, the code becomes hard to read!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-handlers" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-handlers</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="supported_return_types_for_http_response_with_body"><a class="anchor" href="#supported_return_types_for_http_response_with_body"></a><a class="link" href="#supported_return_types_for_http_response_with_body">5.3.2. Supported Return Types for HTTP Response with Body</a></h4>
<div class="paragraph">
<p>The RxMicro framework supports the following return result types for an HTTP response with body:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class RestControllerWithBody {

    <i class="conum" data-value="1"></i><b>(1)</b>

    @GET("/jse/completedFuture1")
    CompletableFuture&lt;Response&gt; completedFuture1() {
        return CompletableFuture.completedFuture(new Response());
    }

    @GET("/jse/completedFuture2")
    CompletableFuture&lt;Response&gt; completedFuture2(final Request request) {
        return CompletableFuture.completedFuture(new Response());
    }

    @GET("/jse/completedFuture3")
    CompletableFuture&lt;Response&gt; completedFuture3(final String requestParameter) {
        return CompletableFuture.completedFuture(new Response());
    }

    @GET("/jse/completedFuture4")
    CompletableFuture&lt;Optional&lt;Response&gt;&gt; completedFuture4() {
        return CompletableFuture.completedFuture(Optional.of(new Response()));
    }

    @GET("/jse/completedFuture5")
    CompletableFuture&lt;Optional&lt;Response&gt;&gt; completedFuture5(final Request request) {
        return CompletableFuture.completedFuture(Optional.of(new Response()));
    }

    @GET("/jse/completedFuture6")
    CompletableFuture&lt;Optional&lt;Response&gt;&gt; completedFuture6(final String requestParameter) {
        return CompletableFuture.completedFuture(Optional.of(new Response()));
    }

    <i class="conum" data-value="2"></i><b>(2)</b>

    @GET("/jse/completionStage1")
    CompletionStage&lt;Response&gt; completionStage1() {
        return CompletableFuture.completedStage(new Response());
    }

    @GET("/jse/completionStage2")
    CompletionStage&lt;Response&gt; completionStage2(final Request request) {
        return CompletableFuture.completedStage(new Response());
    }

    @GET("/jse/completionStage3")
    CompletionStage&lt;Response&gt; completionStage3(final String requestParameter) {
        return CompletableFuture.completedStage(new Response());
    }

    @GET("/jse/completionStage4")
    CompletionStage&lt;Optional&lt;Response&gt;&gt; completionStage4() {
        return CompletableFuture.completedStage(Optional.of(new Response()));
    }

    @GET("/jse/completionStage5")
    CompletionStage&lt;Optional&lt;Response&gt;&gt; completionStage5(final Request request) {
        return CompletableFuture.completedStage(Optional.of(new Response()));
    }

    @GET("/jse/completionStage6")
    CompletionStage&lt;Optional&lt;Response&gt;&gt; completionStage6(final String requestParameter) {
        return CompletableFuture.completedStage(Optional.of(new Response()));
    }

    <i class="conum" data-value="3"></i><b>(3)</b>

    @GET("/spring-reactor/mono1")
    Mono&lt;Response&gt; mono1() {
        return Mono.just(new Response());
    }

    @GET("/spring-reactor/mono2")
    Mono&lt;Response&gt; mono2(final Request request) {
        return Mono.just(new Response());
    }

    @GET("/spring-reactor/mono3")
    Mono&lt;Response&gt; mono3(final String requestParameter) {
        return Mono.just(new Response());
    }

    <i class="conum" data-value="4"></i><b>(4)</b>

    @GET("/rxjava3/single1")
    Single&lt;Response&gt; single1() {
        return Single.just(new Response());
    }

    @GET("/rxjava3/single2")
    Single&lt;Response&gt; single2(final Request request) {
        return Single.just(new Response());
    }

    @GET("/rxjava3/single3")
    Single&lt;Response&gt; single3(final String requestParameter) {
        return Single.just(new Response());
    }

    @GET("/rxjava3/maybe1")
    Maybe&lt;Response&gt; maybe1() {
        return Maybe.just(new Response());
    }

    @GET("/rxjava3/maybe2")
    Maybe&lt;Response&gt; maybe2(final Request request) {
        return Maybe.just(new Response());
    }

    @GET("/rxjava3/maybe3")
    Maybe&lt;Response&gt; maybe3(final String requestParameter) {
        return Maybe.just(new Response());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html" target="_blank" rel="noopener"><code>CompletableFuture&lt;MODEL&gt;</code></a>
type is recommended when using the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/package-summary.html" target="_blank" rel="noopener"><strong>java.util.concurrent</strong></a> library.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Instead of the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html" target="_blank" rel="noopener"><code>CompletableFuture&lt;MODEL&gt;</code></a> type, can also be used the
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletionStage.html" target="_blank" rel="noopener"><code>CompletionStage&lt;MODEL&gt;</code></a> type.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>When using the <a href="https://projectreactor.io/docs/core/release/reference/index.html" target="_blank" rel="noopener"><strong>Project Reactor</strong></a> library, only the
<a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Mono.html" target="_blank" rel="noopener"><code>Mono&lt;MODEL&gt;</code></a> type can be used.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>When using the <a href="https://github.com/ReactiveX/RxJava/blob/3.x/README.md" target="_blank" rel="noopener"><strong>RxJava</strong></a> library, the
<a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Single.html" target="_blank" rel="noopener"><code>Single&lt;MODEL&gt;</code></a> or
<a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Maybe.html" target="_blank" rel="noopener"><code>Maybe&lt;MODEL&gt;</code></a> can be used.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Note that the reactive types must be parameterized by the HTTP response model class!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All the above mentioned handlers return an HTTP response with body:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(RestControllerWithBody.class)
final class RestControllerWithBodyTest {

    private BlockingHttpClient blockingHttpClient;

    @ParameterizedTest
    @ValueSource(strings = {
            "/jse/completedFuture1",
            "/jse/completedFuture2",
            "/jse/completedFuture3",
            "/jse/completedFuture4",
            "/jse/completedFuture5",
            "/jse/completedFuture6",

            "/jse/completionStage1",
            "/jse/completionStage2",
            "/jse/completionStage3",
            "/jse/completionStage4",
            "/jse/completionStage5",
            "/jse/completionStage6",

            "/spring-reactor/mono1",
            "/spring-reactor/mono2",
            "/spring-reactor/mono3",

            "/rxjava3/single1",
            "/rxjava3/single2",
            "/rxjava3/single3",

            "/rxjava3/maybe1",
            "/rxjava3/maybe2",
            "/rxjava3/maybe3"
    })
    void Should_support_HTTP_responses_with_body(final String urlPath) {
        final ClientHttpResponse response = blockingHttpClient.get(urlPath);

        assertEquals(
                jsonObject("message", "Hello World!"), <i class="conum" data-value="1"></i><b>(1)</b>
                response.getBody()
        );
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When testing all <code>RestControllerWithBody</code> class handlers, each handler returns an HTTP response containing a JSON object, with the <code>Hello World!</code> message.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-handlers" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-handlers</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="routing_of_requests"><a class="anchor" href="#routing_of_requests"></a><a class="link" href="#routing_of_requests">5.4. Routing of Requests</a></h3>
<div class="paragraph">
<p>The RxMicro framework supports request routing based on HTTP method, URL Path and HTTP body:</p>
</div>
<div style="page-break-after: always;"></div>
<div class="sect3">
<h4 id="routing_of_requests_based_on_http_method"><a class="anchor" href="#routing_of_requests_based_on_http_method"></a><a class="link" href="#routing_of_requests_based_on_http_method">5.4.1. Routing of Requests Based on HTTP Method</a></h4>
<div class="paragraph">
<p>The RxMicro framework allows handling identical HTTP requests, differing <strong>only</strong> in HTTP method, by different handlers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class RoutingUsingHTTPMethod {

    @GET("/")
    void get() {
        System.out.println("GET");
    }

    @HEAD("/")
    void head() {
        System.out.println("HEAD");
    }

    @OPTIONS("/")
    void options() {
        System.out.println("OPTIONS");
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(RoutingUsingHTTPMethod.class)
final class RoutingUsingHTTPMethodTest {

    private BlockingHttpClient blockingHttpClient;

    private SystemOut systemOut;

    @ParameterizedTest
    @ValueSource(strings = {"GET", "HEAD", "OPTIONS"})
    void Should_route_to_valid_request_handler(final String method) {
        blockingHttpClient.send(method, "/");
        assertEquals(method, systemOut.asString());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-routing" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-routing</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="routing_of_requests_based_on_url_path"><a class="anchor" href="#routing_of_requests_based_on_url_path"></a><a class="link" href="#routing_of_requests_based_on_url_path">5.4.2. Routing of Requests Based on URL Path</a></h4>
<div class="paragraph">
<p>The RxMicro framework allows handling HTTP requests on different URL Paths by different handlers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class RoutingUsingUrlPath {

    @GET("/urlPath1")
    void get1() {
        System.out.println("/urlPath1");
    }

    @GET("/urlPath2")
    void get2() {
        System.out.println("/urlPath2");
    }

    @GET("/${type}")
    void get3(final @PathVariable String type) { <i class="conum" data-value="1"></i><b>(1)</b>
        System.out.println("/${type}: " + type);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>In addition to static URL Paths, the RxMicro framework also supports <a href="#rest-controller-path-variables-basic"><code>path variables</code>.</a></td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(RoutingUsingUrlPath.class)
final class RoutingUsingUrlPathTest {

    private BlockingHttpClient blockingHttpClient;

    private SystemOut systemOut;

    @ParameterizedTest
    @CsvSource({
            "/urlPath1,     /urlPath1",
            "/urlPath2,     /urlPath2",
            "/urlPath3,     /${type}: urlPath3",
            "/put,          /${type}: put",
            "/get,          /${type}: get"
    })
    void Should_route_to_valid_request_handler(final String urlPath,
                                               final String expectedOut) {
        blockingHttpClient.get(urlPath);
        assertEquals(expectedOut, systemOut.asString());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-routing" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-routing</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="routing_of_requests_based_on_http_body"><a class="anchor" href="#routing_of_requests_based_on_http_body"></a><a class="link" href="#routing_of_requests_based_on_http_body">5.4.3. Routing of Requests Based on HTTP Body</a></h4>
<div class="paragraph">
<p>Some HTTP methods allows transferring request parameters both in the start line and in the request body.</p>
</div>
<div class="paragraph">
<p>Therefore, in addition to standard routing types, the RxMicro framework also supports routing based on the HTTP body availability:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class RoutingUsingHttpBody {

    @GET("/")
    @HEAD("/")
    @OPTIONS("/")
    @DELETE("/")
    @PATCH("/")
    @POST(value = "/", httpBody = false)
    @PUT(value = "/", httpBody = false)
    void handleRequestsWithoutBody(final String parameter) { <i class="conum" data-value="1"></i><b>(1)</b>
        System.out.println("without body");
    }

    @PATCH(value = "/", httpBody = true)
    @POST("/")
    @PUT("/")
    void handleRequestsWithBody(final String parameter) { <i class="conum" data-value="2"></i><b>(2)</b>
        System.out.println("with body");
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The request handler with parameters transferred in the start line.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The request handler with parameters transferred in the request body.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For the <code>GET</code>, <code>HEAD</code>, <code>OPTIONS</code> and <code>DELETE</code> HTTP methods, the request parameters are <strong>always</strong> transferred in the start line.</p>
</div>
<div class="paragraph">
<p>For the <code>POST</code>, <code>PUT</code> and <code>PATCH</code> HTTP methods, the request parameters can be transferred both in the start line and in the request body.
<em>(To configure the parameter transfer type, the <code>httpBody</code> option is used.)</em></p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(RoutingUsingHttpBody.class)
final class RoutingUsingHttpBodyTest {

    private BlockingHttpClient blockingHttpClient;

    private SystemOut systemOut;

    @ParameterizedTest
    @ValueSource(strings = {"GET", "HEAD", "POST", "PUT", "PATCH", "OPTIONS", "DELETE"})
    void Should_route_to_handleRequestsWithoutBody(final String method) {
        blockingHttpClient.send(
                method,
                "/?parameter=test" <i class="conum" data-value="1"></i><b>(1)</b>
        );
        assertEquals("without body", systemOut.asString());
    }

    @ParameterizedTest
    @ValueSource(strings = {"POST", "PUT", "PATCH"})
    void Should_route_to_handleRequestsWithBody(final String method) {
        blockingHttpClient.send(
                method,
                "/",
                jsonObject("parameter", "test") <i class="conum" data-value="2"></i><b>(2)</b>
        );
        assertEquals("with body", systemOut.asString());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Parameter transfer in the start line.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Parameter transfer in the request body as JSON object.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-routing" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-routing</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="rest-controller-not-found-section"><a class="anchor" href="#rest-controller-not-found-section"></a><a class="link" href="#rest-controller-not-found-section">5.5. <code>Not Found</code> Logic</a></h3>
<div class="paragraph">
<p>The RxMicro framework supports <code>Not Found</code> Logic for HTTP request handlers.</p>
</div>
<div class="paragraph">
<p>To activate this feature it&#8217;s necessary to return a reactive type that supports <a href="#core-reactive-bussiness-process-result-types-section">optional result</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class NotFoundMicroService {

    @GET("/get1")
    CompletableFuture&lt;Optional&lt;Response&gt;&gt; getOptional1(final Boolean found) { <i class="conum" data-value="1"></i><b>(1)</b>
        return completedFuture(found ? Optional.of(new Response()) : Optional.empty());
    }

    @GET("/get2")
    Mono&lt;Response&gt; getOptional2(final Boolean found) { <i class="conum" data-value="2"></i><b>(2)</b>
        return found ? Mono.just(new Response()) : Mono.empty();
    }

    @GET("/get3")
    Maybe&lt;Response&gt; getOptional3(final Boolean found) { <i class="conum" data-value="3"></i><b>(3)</b>
        return found ? Maybe.just(new Response()) : Maybe.empty();
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When using <code>CompletableFuture</code>/<code>CompletionStage</code> it is necessary to use the
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Optional.html" target="_blank" rel="noopener"><code>java.util.Optional</code></a> contract, since the <code>CompletableFuture</code>/<code>CompletionStage</code> reactive types do not support optional result by default.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Unlike <code>CompletableFuture</code>/<code>CompletionStage</code>, the <code>Mono</code> reactive type supports optional result.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Unlike <code>CompletableFuture</code>/<code>CompletionStage</code>, the <code>Maybe</code> reactive type also supports optional result.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When handling requests, the RxMicro framework checks the handler result:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the handler returns a response model, the RxMicro framework will convert it to an HTTP response with the <code>200</code> status and JSON representation of this model.</p>
</li>
<li>
<p>If the handler returns an empty result, the RxMicro framework generates an HTTP response with the <code>404</code> and the standard <code>"Not Found"</code> error message.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(NotFoundMicroService.class)
final class NotFoundMicroServiceTest {

    private BlockingHttpClient blockingHttpClient;

    @ParameterizedTest
    @ValueSource(strings = {"/get1", "/get2", "/get3"})
    void Should_return_found_response(final String urlPath) {
        final ClientHttpResponse response = blockingHttpClient.get(urlPath + "?found=true");

        assertEquals(jsonObject("message", "Hello World!"), response.getBody()); <i class="conum" data-value="1"></i><b>(1)</b>
        assertEquals(200, response.getStatusCode()); <i class="conum" data-value="1"></i><b>(1)</b>
    }

    @ParameterizedTest
    @ValueSource(strings = {"/get1", "/get2", "/get3"})
    void Should_return_not_found_response(final String urlPath) {
        final ClientHttpResponse response = blockingHttpClient.get(urlPath + "?found=false");

        assertEquals(jsonErrorObject("Not Found"), response.getBody()); <i class="conum" data-value="2"></i><b>(2)</b>
        assertEquals(404, response.getStatusCode()); <i class="conum" data-value="2"></i><b>(2)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>In case there is a result, the result is returned in JSON format, and the HTTP response status is <code>200</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If there is no result, a standard error message is returned, and the HTTP response status is <code>404</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The RxMicro framework provides an option to customize the <code>Not Found</code> message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class CustomizeNotFoundMicroService {

    @GET("/")
    <i class="conum" data-value="1"></i><b>(1)</b>
    @NotFoundMessage("Custom not found message")
    CompletableFuture&lt;Optional&lt;Response&gt;&gt; getOptional1(final Boolean found) {
        return completedFuture(found ? Optional.of(new Response()) : Optional.empty());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/NotFoundMessage.java" target="_blank" rel="noopener"><code>@NotFoundMessage</code></a>
annotation allows You to specify a message that will be displayed to the client in case of missing result instead of the standard <code>"Not Found"</code> message.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
void Should_return_custom_not_found_message() {
    final ClientHttpResponse response = blockingHttpClient.get("/?found=false");

    assertEquals(jsonErrorObject("Custom not found message"), response.getBody()); <i class="conum" data-value="1"></i><b>(1)</b>
    assertEquals(404, response.getStatusCode()); <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If there is no result, the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/NotFoundMessage.java" target="_blank" rel="noopener"><code>@NotFoundMessage</code></a> message, which is set by the annotation, is returned.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The HTTP status is <code>404</code>.<br>
(<em>The RxMicro framework does not allow overriding the HTTP status for <code>Not Found</code> logic!</em>)</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more control over the HTTP response generated in case of an error, use <a href="#rest-controller-errors-section">exception</a> instead of <code>Not Found</code> Logic feature!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-notfound" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-notfound</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="rest-controller-errors-section"><a class="anchor" href="#rest-controller-errors-section"></a><a class="link" href="#rest-controller-errors-section">5.6. Exceptions Usage</a></h3>
<div class="paragraph">
<p>Each reactive type of returned request handler result supports two states:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Successful completion signal.</p>
</li>
<li>
<p>Completion signal with an error.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The feature of a successful completion signal consists in its uniqueness, i.e. if such a signal has occurred, it ensures successful completion of the business task.
The feature of a completion signal with an error is that different types of errors may occur during the execution of the business task:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>validation error;</p>
</li>
<li>
<p>data source connection error;</p>
</li>
<li>
<p>computational algorithm error, etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It means that each request handler can return <strong>only one successful result and several results with errors</strong>.</p>
</div>
<div class="paragraph">
<p>So the RxMicro framework introduces the <code>error</code> concept.
An error means any unsuccessful result.</p>
</div>
<div class="paragraph">
<p><strong>For simplified error handling, the RxMicro framework recommends using HTTP status codes for each error category!</strong></p>
</div>
<div class="paragraph">
<p>In case the HTTP code status is not sufficient, the RxMicro framework recommends using an additional text description.</p>
</div>
<div id="rest-controller-errors-model-inline" class="paragraph">
<p>For this purpose, the RxMicro framework defines a standard JSON model which is returned in case of any error:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "message": "Not Found"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Thus, in case of an error, the client determines the error category basing on HTTP status code analysis.
For more information, the client should analyze a text message.</p>
</div>
<div style="page-break-after: always;"></div>
<div class="sect3">
<h4 id="basic_class_of_exceptions"><a class="anchor" href="#basic_class_of_exceptions"></a><a class="link" href="#basic_class_of_exceptions">5.6.1. Basic Class of Exceptions</a></h4>
<div class="paragraph">
<p>When handling an HTTP request, the RxMicro framework defines the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/error/HttpErrorException.java" target="_blank" rel="noopener"><code>HttpErrorException</code></a> base exception class.</p>
</div>
<div class="paragraph">
<p><strong>All custom exception types must extend this base class!</strong></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For all child classes which extend the <code>HttpErrorException</code> class, when creating an exception instance <strong>the stack trace is not filled</strong>, as this information is redundant.</p>
</div>
<div class="paragraph">
<p><em>(This behavior is achieved by using the
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/RuntimeException.html#%3Cinit%3E(java.lang.String,java.lang.Throwable,boolean,boolean)" target="_blank" rel="noopener"><code>protected RuntimeException(String, Throwable, boolean, boolean)</code></a> protected constructor.)</em></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="using_the_user_defined_exceptions"><a class="anchor" href="#using_the_user_defined_exceptions"></a><a class="link" href="#using_the_user_defined_exceptions">5.6.2. Using the User Defined Exceptions</a></h4>
<div class="paragraph">
<p>If the request handler must return an HTTP status code other than the successful one, a separate exception class must be created:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class CustomNotFoundException extends HttpErrorException { <i class="conum" data-value="1"></i><b>(1)</b>

    private static final int STATUS_CODE = 404; <i class="conum" data-value="2"></i><b>(2)</b>

    public CustomNotFoundException(final String message) { <i class="conum" data-value="3"></i><b>(3)</b>
        super(STATUS_CODE, message);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The custom exception class must extend the <code>HttpErrorException</code> class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Each class must define the static <code>int STATUS_CODE</code> field with a status code that identifies the error category.
<em>(This name is constant and is used by the <a href="#project-documentation-custom-error-requirements"><code>rxmicro.documentation</code></a> module when building the project documentation.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>If You want to display a detailed message to the client, You need to add the constructor parameter.<br>
<em>(If You want to return to the client only the HTTP status without the HTTP body, then create a constructor without parameters.)</em></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>The RxMicro framework does not support <code>null</code> as a business value!</strong></p>
</div>
<div class="paragraph">
<p>So if the <code>null</code> value is passed to the exception constructor as a message, then the RxMicro framework will return an HTTP response without a message body!<br>
<em>(i.e. the <code>new CustomNotFoundException(null)</code> and <code>new CustomNotFoundException()</code> constructions are identical in terms of the RxMicro framework!)</em></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can use two approaches to return an HTTP status code other than successful one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class MicroService {

    @PUT(value = "/business-object-1", httpBody = false)
    CompletableFuture&lt;Void&gt; updateObject1(final Integer id) {
        return failedFuture(new CustomNotFoundException("Object not found by id=" + id)); <i class="conum" data-value="1"></i><b>(1)</b>
    }

    @PUT(value = "/business-object-2", httpBody = false)
    CompletableFuture&lt;Void&gt; updateObject2(final Integer id) {
        throw new CustomNotFoundException("Object not found by id=" + id); <i class="conum" data-value="2"></i><b>(2)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Use the reactive type method to generate a completion signal with an error.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Create and throw an exception instance.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>From the client&#8217;s point of view, the two above-mentioned approaches are exactly the same:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceTest {

    private BlockingHttpClient blockingHttpClient;

    @ParameterizedTest
    @ValueSource(strings = {"/business-object-1", "/business-object-2"})
    void Should_return_404(final String urlPath) {
        final ClientHttpResponse response = blockingHttpClient.put(urlPath + "?id=0");

        assertEquals(jsonErrorObject("Object not found by id=0"), response.getBody()); <i class="conum" data-value="1"></i><b>(1)</b>
        assertEquals(404, response.getStatusCode()); <i class="conum" data-value="2"></i><b>(2)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>As a detailed error message, the message passed to the exception constructor is returned.<br>
<em>(The <code>jsonErrorObject("&#8230;&#8203;")</code> utility method is synonymous with the <code>jsonObject("message", "&#8230;&#8203;")</code> method.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The returned status code equals the status code defined in the exception class in the <code>int STATUS_CODE</code> field.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-errors" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-errors</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="error_signal_generation_methods"><a class="anchor" href="#error_signal_generation_methods"></a><a class="link" href="#error_signal_generation_methods">5.6.3. Error Signal Generation Methods</a></h4>
<div class="paragraph">
<p>To return an HTTP response with an error it is necessary to use the appropriate reactive type method to generate the error signal.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. Error signal generation method.</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Reactive type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Static method</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CompletableFuture</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html#failedFuture(java.lang.Throwable)" target="_blank" rel="noopener"><code>CompletableFuture.failedFuture</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CompletionStage</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html#failedStage(java.lang.Throwable)" target="_blank" rel="noopener"><code>CompletableFuture.failedStage</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Mono</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Mono.html#error-java.lang.Throwable-" target="_blank" rel="noopener"><code>Mono.error</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Completable</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Completable.html#error-java.lang.Throwable-" target="_blank" rel="noopener"><code>Completable.error</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Single</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Single.html#error-java.lang.Throwable-" target="_blank" rel="noopener"><code>Single.error</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Maybe</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Maybe.html#error-java.lang.Throwable-" target="_blank" rel="noopener"><code>Maybe.error</code></a></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Using the error signal generation method instead of throwing an exception instance requires writing more code but saves processor resources!</p>
</div>
<div class="paragraph">
<p>So it&#8217;s up to You to determine which method to use in Your project!</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="predefined_classes_of_exceptions"><a class="anchor" href="#predefined_classes_of_exceptions"></a><a class="link" href="#predefined_classes_of_exceptions">5.6.4. Predefined Classes of Exceptions</a></h4>
<div class="paragraph">
<p>The RxMicro framework defines the following predefined exception classes:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. List of predefined exception classes.</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 10%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Exception class</strong></th>
<th class="tableblock halign-left valign-top"><strong>Status code</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/error/RedirectException.java" target="_blank" rel="noopener"><code>RedirectException</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>300..399</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A base class to inform the client about the need to perform <code>redirect</code>.</p>
<p class="tableblock"><em>(Instead of using a base class, it is recommended to use one of the following child ones: <code>TemporaryRedirectException</code> or <code>PermanentRedirectException</code>.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/error/TemporaryRedirectException.java" target="_blank" rel="noopener"><code>TemporaryRedirectException</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/307" target="_blank" rel="noopener"><code>307</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A class that signals the need to perform <a href="#rest-controller-redirect-section"><code>Temporary Redirect</code>.</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/error/PermanentRedirectException.java" target="_blank" rel="noopener"><code>PermanentRedirectException</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/308" target="_blank" rel="noopener"><code>308</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A class that signals the need to perform <a href="#rest-controller-redirect-section"><code>Permanent Redirect</code>.</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/error/ValidationException.java" target="_blank" rel="noopener"><code>ValidationException</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400" target="_blank" rel="noopener"><code>400</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A class signaling that the client has sent <a href="#validation-section">a bad request.</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/error/InternalHttpErrorException.java" target="_blank" rel="noopener"><code>InternalHttpErrorException</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500" target="_blank" rel="noopener"><code>500</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A class signaling that an internal error has occurred during execution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/UnexpectedResponseException.java" target="_blank" rel="noopener"><code>UnexpectedResponseException</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500" target="_blank" rel="noopener"><code>500</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A class signaling that the <a href="#validation-response-section">HTTP response, generated by the request handler, contains validation errors.</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http-client/src/main/java/io/rxmicro/http/client/HttpClientTimeoutException.java" target="_blank" rel="noopener"><code>HttpClientTimeoutException</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/504" target="_blank" rel="noopener"><code>504</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A class signaling that the HTTP client didn&#8217;t receive a response from the server in given time.</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="rest-controller-set-status-code-section"><a class="anchor" href="#rest-controller-set-status-code-section"></a><a class="link" href="#rest-controller-set-status-code-section">5.7. Overriding the Status Code</a></h3>
<div class="paragraph">
<p>By default, if there are no errors during HTTP request handling, the HTTP server returns the <code>200</code> status code.
If You need to change the status code returned by default, You must use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/SetStatusCode.java" target="_blank" rel="noopener"><code>@SetStatusCode</code></a> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class MicroService {

    @GET("/200")
    void success() {
    }

    @GET("/307")
    @SetStatusCode(307)
    void permanentRedirect() {
    }

    @GET("/404")
    @SetStatusCode(404)
    void notFound() {
    }

    @GET("/500")
    @SetStatusCode(500)
    void internalError() {
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceTest {

    private BlockingHttpClient blockingHttpClient;

    @ParameterizedTest
    @ValueSource(ints = {200, 307, 404, 500})
    void Should_return_valid_status_codes(final int expectedStatus) {
        final ClientHttpResponse response = blockingHttpClient.get("/" + expectedStatus);

        assertEquals(expectedStatus, response.getStatusCode());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-set-status-code" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-set-status-code</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="rest-controller-redirect-section"><a class="anchor" href="#rest-controller-redirect-section"></a><a class="link" href="#rest-controller-redirect-section">5.8. Redirecting of Requests</a></h3>
<div class="paragraph">
<p>The RxMicro framework supports request redirection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class MicroService {

    @PUT(value = "/old-url")
    CompletableFuture&lt;Void&gt; redirect() {
        return failedFuture(new PermanentRedirectException("/new-url")); <i class="conum" data-value="1"></i><b>(1)</b>
    }

    <i class="conum" data-value="2"></i><b>(2)</b>
    @PUT(value = "/new-url")
    void put(final String parameter) {
        System.out.println(parameter);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To redirect a request, You need to return the <code>PermanentRedirectException</code> instance, indicating a new URL Path.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Once the HTTP response with request redirection is returned, the HTTP client will automatically repeat the request to a new URL Path.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>If temporary redirection is required, the <code>TemporaryRedirectException</code> class must be used instead of the <code>PermanentRedirectException</code> class!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The predefined redirection classes (<code>TemporaryRedirectException</code> and <code>PermanentRedirectException</code>) return the
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/307" target="_blank" rel="noopener"><code>307</code></a> and
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/308" target="_blank" rel="noopener"><code>308</code></a> HTTP statuses.</p>
</div>
<div class="paragraph">
<p><strong>According to the HTTP protocol rules, the HTTP method is preserved at such redirection!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceTest {

    <i class="conum" data-value="1"></i><b>(1)</b>
    @BlockingHttpClientSettings(followRedirects = ENABLED)
    private BlockingHttpClient blockingHttpClient;

    private SystemOut systemOut;

    @Test
    void Should_redirect() {
        blockingHttpClient.put(
                "/old-url",
                jsonObject("parameter", "test")
        ); <i class="conum" data-value="2"></i><b>(2)</b>

        assertEquals("test", systemOut.asString()); <i class="conum" data-value="3"></i><b>(3)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>By default, the predefined HTTP client, that is used to perform test requests to the microservice, does not support redirection.
Therefore, automatic redirection must be activated using the <a href="testing.html#testing-BlockingHttpClient-settings-section"><code>@BlockingHttpClientSettings(followRedirects = ENABLED)</code> setting</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>PUT</code> request to the <code>/put1</code> URL Path is performed.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Consequently, the <code>MicroService.put</code> handler is automatically performed after the <code>MicroService.redirect</code> handler.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Besides using the <code>PermanentRedirectException</code>/<code>TemporaryRedirectException</code> exceptions, a custom model class or the
<a href="#rest-controller-set-status-code-section"><code>@SetStatusCode</code></a> and <a href="#rest-controller-headers-static"><code>@SetHeader</code></a> annotation composition can be used for redirection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PUT(value = "/old-url1")
CompletableFuture&lt;RedirectResponse&gt; redirect1() {
    return completedFuture(new RedirectResponse("/new-url")); <i class="conum" data-value="1"></i><b>(1)</b>
}

@PUT(value = "/old-url2")
<i class="conum" data-value="2"></i><b>(2)</b>
@SetStatusCode(307)
@SetHeader(name = LOCATION, value = "/new-url")
void redirect2() {
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Using a custom model class with the <code>Location</code> header.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Using the <a href="#rest-controller-set-status-code-section"><code>@SetStatusCode</code></a> and <a href="#rest-controller-headers-static"><code>@SetHeader</code></a> annotation composition.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FYI:</strong> The <code>RedirectResponse</code> model class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class RedirectResponse {

    @ResponseStatusCode
    final Integer status = 307;

    @Header(LOCATION)
    final String location;

    public RedirectResponse(final String location) {
        this.location = requireNonNull(location);
    }
}</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-redirect" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-redirect</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="rest-controller-headers-basic"><a class="anchor" href="#rest-controller-headers-basic"></a><a class="link" href="#rest-controller-headers-basic">5.9. HTTP Headers Support</a></h3>
<div class="sect3">
<h4 id="basic_rules"><a class="anchor" href="#basic_rules"></a><a class="link" href="#basic_rules">5.9.1. Basic Rules</a></h4>
<div class="paragraph">
<p>The RxMicro framework supports HTTP headers in request and response models:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@HeaderMappingStrategy
public final class Request {

    <i class="conum" data-value="2"></i><b>(2)</b>
    @Header
    String endpointVersion;

    <i class="conum" data-value="3"></i><b>(3)</b>
    @Header("UseProxy")
    Boolean useProxy;

    public String getEndpointVersion() {
        return endpointVersion;
    }

    public Boolean getUseProxy() {
        return useProxy;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@HeaderMappingStrategy
public final class Response {

    <i class="conum" data-value="2"></i><b>(2)</b>
    @Header
    final String endpointVersion;

    <i class="conum" data-value="3"></i><b>(3)</b>
    @Header("UseProxy")
    final Boolean useProxy;

    public Response(final Request request) {
        this.endpointVersion = request.getEndpointVersion();
        this.useProxy = request.getUseProxy();
    }

    public Response(final String endpointVersion,
                    final Boolean useProxy) {
        this.endpointVersion = endpointVersion;
        this.useProxy = useProxy;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/HeaderMappingStrategy.java" target="_blank" rel="noopener"><code>@HeaderMappingStrategy</code></a>
annotation allows setting common conversion rules for all header names from HTTP to Java format and vice versa in the current model class.<br>
<em>(By default, the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-model/src/main/java/io/rxmicro/model/MappingStrategy.java#L76" target="_blank" rel="noopener"><code>CAPITALIZE_WITH_HYPHEN</code></a> strategy is used.
The field name is used as the basic name, and then, following the rules of the specified strategy, the HTTP header name is generated.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>In order to declare a model field as the HTTP header field, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Header.java" target="_blank" rel="noopener"><code>@Header</code></a> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Using the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Header.java" target="_blank" rel="noopener"><code>@Header</code></a>
annotation, it is possible to specify the HTTP header name, which does not correspond to the used strategy declared by the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/HeaderMappingStrategy.java" target="_blank" rel="noopener"><code>@HeaderMappingStrategy</code></a> annotation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The RxMicro framework uses the following algorithm to define the HTTP header name for the specified model field:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If the field is annotated by the <code>@Header</code> annotation with an explicit indication of the HTTP header name, the specified name is used;</p>
</li>
<li>
<p>If no HTTP header name is specified in the <code>@Header</code> annotation, the RxMicro framework checks for the <code>@HeaderMappingStrategy</code> annotation above the model class;</p>
</li>
<li>
<p>If the model class is annotated by the <code>@HeaderMappingStrategy</code> annotation, then the specified naming strategy is used.<br>
<em>(The field name is used as the basic name, and then, following the rules of the specified strategy, the HTTP header name is generated.)</em></p>
</li>
<li>
<p>If the <code>@HeaderMappingStrategy</code> annotation is missing, the model class field name is used as the HTTP header name.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After creating model classes, it is necessary to create a request handler that uses the following models:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class SimpleUsageMicroService {

    @GET("/get1")
    CompletableFuture&lt;Response&gt; get1(final Request request) { <i class="conum" data-value="1"></i><b>(1)</b>
        return completedFuture(new Response(request));
    }

    <i class="conum" data-value="2"></i><b>(2)</b>
    @GET("/get2")
    <i class="conum" data-value="3"></i><b>(3)</b>
    @HeaderMappingStrategy
    CompletableFuture&lt;Response&gt; get2(final @Header String endpointVersion,          <i class="conum" data-value="4"></i><b>(4)</b>
                                     final @Header("UseProxy") Boolean useProxy) {  <i class="conum" data-value="5"></i><b>(5)</b>
        return completedFuture(new Response(endpointVersion, useProxy));
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If a separate model class has been created for an HTTP request, then this class must be passed to the method parameter that handles the HTTP request.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Besides supporting HTTP request model classes, the RxMicro framework supports request handlers that accept HTTP headers as method parameters.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>To define a common naming strategy for all HTTP headers which are passed as method parameters, the request handler must be annotated by the <code>@HeaderMappingStrategy</code> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>To declare a method parameter as an HTTP header field, use the <code>@Header</code> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Using the <code>@Header</code> annotation, it is possible to specify an HTTP header name that does not correspond to the strategy used, declared by the <code>@HeaderMappingStrategy</code> annotation.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The RxMicro framework recommends for request handlers that depend on 3 or more
HTTP headers
to create separate classes of request model.</p>
</div>
<div class="paragraph">
<p><strong>Upon implementation of</strong>
<strong>HTTP headers</strong>
<strong>directly into the handler, the code becomes hard to read!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Despite the different approaches to HTTP header handling support, from the client&#8217;s point of view the two above-mentioned handlers are absolutely equal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(SimpleUsageMicroService.class)
final class SimpleUsageMicroServiceTest {

    private BlockingHttpClient blockingHttpClient;

    @ParameterizedTest
    @ValueSource(strings = {"/get1", "/get2"})
    void Should_process_HTTP_headers(final String path) {
        final ClientHttpResponse response = blockingHttpClient.get(
                path, <i class="conum" data-value="1"></i><b>(1)</b>
                HttpHeaders.of(
                        "Endpoint-Version", "v1",   <i class="conum" data-value="2"></i><b>(2)</b>
                        "UseProxy", true            <i class="conum" data-value="3"></i><b>(3)</b>
                )
        );

        final HttpHeaders responseHeaders = response.getHeaders();
        assertEquals("v1", responseHeaders.getValue("Endpoint-Version"));   <i class="conum" data-value="4"></i><b>(4)</b>
        assertEquals("true", responseHeaders.getValue("UseProxy"));         <i class="conum" data-value="4"></i><b>(4)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When performing a request to different URL Paths, the result is the same.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>Endpoint-Version</code> name corresponds to the <code>endpointVersion</code> field of the request model.<br>
<em>(This correspondence is formed basing on the default strategy use, which is defined by the <code>@HeaderMappingStrategy</code> annotation.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>UseProxy</code> name corresponds to the <code>useProxy</code> field of the request model, since this name is specified in the <code>@Header</code> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>After executing the request in the resulting HTTP response, the <code>Endpoint-Version</code> and <code>UseProxy</code> headers are equal to <code>v1</code> and <code>true</code> respectively.
<em>(The handler returns the same header values it received from an HTTP request.)</em></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-headers" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-headers</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="supported_data_types"><a class="anchor" href="#supported_data_types"></a><a class="link" href="#supported_data_types">5.9.2. Supported Data Types</a></h4>
<div class="paragraph">
<p>The RxMicro framework supports the following Java types, which can be HTTP request model headers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>? extends Enum&lt;?&gt;</code>;</p>
</li>
<li>
<p><code>java.lang.Boolean</code>;</p>
</li>
<li>
<p><code>java.lang.Byte</code>;</p>
</li>
<li>
<p><code>java.lang.Short</code>;</p>
</li>
<li>
<p><code>java.lang.Integer</code>;</p>
</li>
<li>
<p><code>java.lang.Long</code>;</p>
</li>
<li>
<p><code>java.math.BigInteger</code>;</p>
</li>
<li>
<p><code>java.lang.Float</code>;</p>
</li>
<li>
<p><code>java.lang.Double</code>;</p>
</li>
<li>
<p><code>java.math.BigDecimal</code>;</p>
</li>
<li>
<p><code>java.lang.Character</code>;</p>
</li>
<li>
<p><code>java.lang.String</code>;</p>
</li>
<li>
<p><code>java.time.Instant</code>;</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For floating point numbers, it is suggested to use the <code>java.math.BigDecimal</code> type instead of <code>java.lang.Float</code> or <code>java.lang.Double</code>.</p>
</div>
<div class="paragraph">
<p>Using the <code>java.math.BigDecimal</code> allows excluding errors of decimal number notation.
<strong>This is particularly important if the decimal number is used to represent currency-related data!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>and also the <code>java.util.List&lt;T&gt;</code>, <code>java.util.Set&lt;T&gt;</code> and the <code>java.util.Map&lt;String, T&gt;</code> type is parameterized by any of the above mentioned primitive types.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the <code>java.util.Map&lt;String, T&gt;</code> type is used, then REST model can contain dynamic properties, where <code>keys</code> are the names of properties and <code>values</code> are the properties values.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class ListHeaderMicroService {

    @GET("/")
    @HeaderMappingStrategy
    void consume(final @Header List&lt;Status&gt; supportedStatuses) {
        System.out.println(supportedStatuses);
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(ListHeaderMicroService.class)
final class ListHeaderMicroServiceTest {

    private BlockingHttpClient blockingHttpClient;

    private SystemOut systemOut;

    static Stream&lt;Arguments&gt; supportedListProvider() {
        return Stream.of(
                arguments("created|approved|rejected"),                         <i class="conum" data-value="1"></i><b>(1)</b>
                arguments(new Status[]{created, approved, rejected}, 0),        <i class="conum" data-value="2"></i><b>(2)</b>
                arguments(new String[]{"created", "approved", "rejected"}, 0),  <i class="conum" data-value="3"></i><b>(3)</b>
                arguments(List.of(created, approved, rejected)),                <i class="conum" data-value="4"></i><b>(4)</b>
                arguments(List.of("created", "approved", "rejected")),          <i class="conum" data-value="5"></i><b>(5)</b>
                arguments(HttpHeaders.of(                                       <i class="conum" data-value="6"></i><b>(6)</b>
                        "Supported-Statuses", "created",
                        "Supported-Statuses", "approved",
                        "Supported-Statuses", "rejected"
                )),
                arguments(HttpHeaders.of(                                       <i class="conum" data-value="6"></i><b>(6)</b>
                        "Supported-Statuses", "created|approved",
                        "Supported-Statuses", "rejected"
                ))
        );
    }

    @ParameterizedTest
    @MethodSource("supportedListProvider")
    void Should_support_list_headers(final Object headerValue) {
        blockingHttpClient.get(
                "/",
                headerValue instanceof HttpHeaders ?
                        (HttpHeaders) headerValue :
                        HttpHeaders.of("Supported-Statuses", headerValue) <i class="conum" data-value="7"></i><b>(7)</b>
        );

        assertEquals(
                "[created, approved, rejected]", <i class="conum" data-value="8"></i><b>(8)</b>
                systemOut.asString()
        );
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If the HTTP header is a list of values, the list elements are transferred via the HTTP protocol as a string separated by the <code>|</code> symbol.<br>
<em>(For HTTP response headers it is possible to activate the <a href="#rest-controller-headers-repeating">repeating headers mode.</a>)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Besides transferring the list using a comma-separated string, the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a> component also supports:<br>
an array of enumerations,</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>an array of string values,</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>a list of enumerations,</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>a list of string values.<br>
<em>(The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a>
component converts these types to a comma-separated string automatically!)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Besides transferring HTTP headers as a comma-separated string, the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a> component also supports repeatable HTTP headers with different values.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>All specified value types for the HTTP header, which is a list of values, are transferred as the <code>java.lang.Object</code> type.
<em>(The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a>
component automatically converts them to a comma-separated string and transfers via the HTTP protocol.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>The RxMicro framework converts different types to a list of enumerations and displays it in the console.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest-controller-headers-static"><a class="anchor" href="#rest-controller-headers-static"></a><a class="link" href="#rest-controller-headers-static">5.9.3. Static HTTP headers</a></h4>
<div class="paragraph">
<p>For setting of the static headers, the RxMicro framework provides the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/AddHeader.java" target="_blank" rel="noopener"><code>@AddHeader</code></a> and
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/SetHeader.java" target="_blank" rel="noopener"><code>@SetHeader</code></a> annotations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@SetHeader(name = "Mode", value = "Demo")
final class StaticHeadersMicroService {

    @GET("/get1")
    void get1() {
    }

    @GET("/get2")
    <i class="conum" data-value="2"></i><b>(2)</b>
    @SetHeader(name = "Debug", value = "true")
    void get2() {
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If the HTTP header is set for the REST controller, it is added to the HTTP responses for each handler.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If the HTTP header is set for the handler, it is added to the HTTP responses only for that handler.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>From the client&#8217;s point of view, static headers do not differ from any others:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
void Should_use_parent_header_only() {
    final ClientHttpResponse response = blockingHttpClient.get("/get1");

    assertEquals("Demo", response.getHeaders().getValue("Mode"));
}

@Test
void Should_use_parent_and_child_headers() {
    final ClientHttpResponse response = blockingHttpClient.get("/get2");

    assertEquals("Demo", response.getHeaders().getValue("Mode"));
    assertEquals("true", response.getHeaders().getValue("Debug"));
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In order to understand the differences between the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/AddHeader.java" target="_blank" rel="noopener"><code>@AddHeader</code></a> and
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/SetHeader.java" target="_blank" rel="noopener"><code>@SetHeader</code></a> annotations, take a look to the following example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-rest-controller/rest-controller-headers/src/main/java/io/rxmicro/examples/rest/controller/headers/ComplexStaticHeadersMicroService.java" target="_blank" rel="noopener"><code>ComplexStaticHeadersMicroService.java</code></a></p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-rest-controller/rest-controller-headers/src/test/java/io/rxmicro/examples/rest/controller/headers/ComplexStaticHeadersMicroServiceTest.java" target="_blank" rel="noopener"><code>ComplexStaticHeadersMicroServiceTest.java</code></a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-headers" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-headers</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest-controller-headers-repeating"><a class="anchor" href="#rest-controller-headers-repeating"></a><a class="link" href="#rest-controller-headers-repeating">5.9.4. Repeating HTTP headers</a></h4>
<div class="paragraph">
<p>If the HTTP header of an HTTP response is a list of values, the list elements are transferred by default via the HTTP protocol as a string separated by the <code>|</code> symbol.</p>
</div>
<div class="paragraph">
<p>If You want the HTTP header to be repeated for each value, You need to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RepeatHeader.java" target="_blank" rel="noopener"><code>@RepeatHeader</code></a> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Header
List&lt;Status&gt; singleHeader = List.of(created, approved, rejected);

@Header
@RepeatHeader
List&lt;Status&gt; repeatingHeader = List.of(created, approved, rejected);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>The use of the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RepeatHeader.java" target="_blank" rel="noopener"><code>@RepeatHeader</code></a> annotation is supported for response models only!</strong></p>
</div>
<div class="paragraph">
<p>For request models it makes no sense, because the RxMicro framework converts any of the supported formats into a list of values.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As a result of converting the Java model to HTTP response, the result will be as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">assertEquals(
        "created|approved|rejected", <i class="conum" data-value="1"></i><b>(1)</b>
        response.getHeaders().getValue("Single-Header")
);
assertEquals(
        List.of("created", "approved", "rejected"), <i class="conum" data-value="2"></i><b>(2)</b>
        response.getHeaders().getValues("Repeating-Header")
);</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>By default, HTTP header list elements are transferred via the HTTP protocol as a string separated by the <code>|</code> symbol.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If the field is annotated by the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RepeatHeader.java" target="_blank" rel="noopener"><code>@RepeatHeader</code></a> annotation, then the header is repeated for each element of the list.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-headers" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-headers</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="rest-controller-params-basic"><a class="anchor" href="#rest-controller-params-basic"></a><a class="link" href="#rest-controller-params-basic">5.10. HTTP Parameters Handling</a></h3>
<div class="sect3">
<h4 id="basic_rules_2"><a class="anchor" href="#basic_rules_2"></a><a class="link" href="#basic_rules_2">5.10.1. Basic Rules</a></h4>
<div class="paragraph">
<p>The RxMicro framework supports HTTP parameters in request and response models:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@ParameterMappingStrategy
public final class Request {

    <i class="conum" data-value="2"></i><b>(2)</b>
    String endpointVersion;

    <i class="conum" data-value="3"></i><b>(3)</b>
    @Parameter("use-Proxy")
    Boolean useProxy;

    public String getEndpointVersion() {
        return endpointVersion;
    }

    public Boolean getUseProxy() {
        return useProxy;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@ParameterMappingStrategy
public final class Response {

    <i class="conum" data-value="2"></i><b>(2)</b>
    final String endpointVersion;

    <i class="conum" data-value="3"></i><b>(3)</b>
    @Parameter("use-Proxy")
    final Boolean useProxy;

    public Response(final Request request) {
        this.endpointVersion = request.getEndpointVersion();
        this.useProxy = request.getUseProxy();
    }

    public Response(final String endpointVersion,
                    final Boolean useProxy) {
        this.endpointVersion = endpointVersion;
        this.useProxy = useProxy;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ParameterMappingStrategy.java" target="_blank" rel="noopener"><code>@ParameterMappingStrategy</code></a>
annotation allows setting common conversion rules for all parameter names from HTTP to Java format and vice versa in the current model class.
<em>(By default, the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-model/src/main/java/io/rxmicro/model/MappingStrategy.java#L41" target="_blank" rel="noopener"><code>LOWERCASE_WITH_UNDERSCORED</code></a> strategy is used.
The field name is used as the basic name, and then, following the rules of the specified strategy, the HTTP parameter name is generated.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>In order to declare a model field as the HTTP parameter field, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Parameter.java" target="_blank" rel="noopener"><code>@Parameter</code></a> annotation.
<em>(Unlike the <code>@Header</code> annotation, the <code>@Parameter</code> annotation is optional.
Thus, if the model field is not annotated by any annotation, then by default it is assumed that there is the <code>@Parameter</code> annotation above the model field.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Using the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Parameter.java" target="_blank" rel="noopener"><code>@Parameter</code></a>
annotation, it is possible to specify the HTTP parameter name, which does not correspond to the used strategy declared by the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ParameterMappingStrategy.java" target="_blank" rel="noopener"><code>@ParameterMappingStrategy</code></a> annotation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The RxMicro framework uses the following algorithm to define the HTTP parameter name for the specified model field:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If the field is annotated by the <code>@Parameter</code> annotation with an explicit indication of the HTTP parameter name, the specified name is used;</p>
</li>
<li>
<p>If no HTTP parameter name is specified in the <code>@Parameter</code> annotation, the RxMicro framework checks for the <code>@ParameterMappingStrategy</code> annotation above the model class;</p>
</li>
<li>
<p>If the model class is annotated by the <code>@ParameterMappingStrategy</code> annotation, then the specified naming strategy is used.
<em>(The field name is used as the basic name, and then, following the rules of the specified strategy, the HTTP parameter name is generated.)</em></p>
</li>
<li>
<p>If the <code>@ParameterMappingStrategy</code> annotation is missing, the model class field name is used as the HTTP parameter name.</p>
</li>
</ol>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Unlike the <code>@Header</code> annotation, the <code>@Parameter</code> annotation is optional!</strong></p>
</div>
<div class="paragraph">
<p>Thus, if the model field is not annotated by any annotation, then <strong>by default it is assumed that there is the <code>@Parameter</code> annotation above the model field!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After creating model classes, it is necessary to create an HTTP request handler that uses the following models:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class SimpleUsageMicroService {

    @GET("/get1")
    @POST("/post1")
    CompletableFuture&lt;Response&gt; get1(final Request request) { <i class="conum" data-value="1"></i><b>(1)</b>
        return completedFuture(new Response(request));
    }

    <i class="conum" data-value="2"></i><b>(2)</b>
    @GET("/get2")
    @POST("/post2")
    <i class="conum" data-value="3"></i><b>(3)</b>
    @ParameterMappingStrategy
    CompletableFuture&lt;Response&gt; get2(final String endpointVersion,                      <i class="conum" data-value="4"></i><b>(4)</b>
                                     final @Parameter("use-Proxy") Boolean useProxy) {  <i class="conum" data-value="5"></i><b>(5)</b>
        return completedFuture(new Response(endpointVersion, useProxy));
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If a separate model class has been created for an HTTP request, then this class must be passed by the method parameter that handles the HTTP request.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Besides supporting HTTP request model classes, the RxMicro framework supports request handlers that accept HTTP request parameters as method parameters.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>To define a common naming strategy for all HTTP parameters which are passed as method parameters, the request handler must be annotated by the <code>@ParameterMappingStrategy</code> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>To declare a method parameter as an HTTP parameter field, You do not need to use any additional annotations.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Using the <code>@Parameter</code> annotation, it is possible to specify an HTTP parameter name that does not correspond to the strategy used, declared by the <code>@ParameterMappingStrategy</code> annotation.</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Note that the RxMicro framework does not distinguish whether HTTP request parameters will be transferred to the handler using the start line or HTTP body!</strong></p>
</div>
<div class="paragraph">
<p>Therefore, if the parameters are the same, it is possible to use the same handler with the specified request model to handle both <code>GET</code> (parameters are transferred in the start line) and <code>POST</code> (parameters are transferred in the HTTP body) request.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The RxMicro framework recommends for request handlers that depend on 3 or more
HTTP parameters
to create separate classes of request model.</p>
</div>
<div class="paragraph">
<p><strong>Upon implementation of</strong>
<strong>HTTP parameters</strong>
<strong>directly into the handler, the code becomes hard to read!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Despite the different approaches to HTTP parameter handling support, from the client&#8217;s point of view the two above-mentioned handlers are absolutely equal to <code>GET</code> and <code>POST</code> requests respectively:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(SimpleUsageMicroService.class)
final class SimpleUsageMicroServiceTest {

    private BlockingHttpClient blockingHttpClient;

    @ParameterizedTest
    @ValueSource(strings = {"/get1", "/get2"})
    void Should_process_HTTP_query_params(final String path) {
        final ClientHttpResponse response = blockingHttpClient.get(
                path, <i class="conum" data-value="1"></i><b>(1)</b>
                QueryParams.of(
                        "endpoint_version", "v1",   <i class="conum" data-value="2"></i><b>(2)</b>
                        "use-Proxy", true           <i class="conum" data-value="3"></i><b>(3)</b>
                )
        );

        assertHttpBody(response);
    }

    @ParameterizedTest
    @ValueSource(strings = {"/post1", "/post2"})
    void Should_process_HTTP_body_params(final String path) {
        final ClientHttpResponse response = blockingHttpClient.post(
                path, <i class="conum" data-value="1"></i><b>(1)</b>
                jsonObject(
                        "endpoint_version", "v1",   <i class="conum" data-value="2"></i><b>(2)</b>
                        "use-Proxy", true           <i class="conum" data-value="3"></i><b>(3)</b>
                )
        );

        assertHttpBody(response);
    }

    private void assertHttpBody(final ClientHttpResponse response) {
        assertEquals(
                jsonObject(
                        "endpoint_version", "v1", <i class="conum" data-value="4"></i><b>(4)</b>
                        "use-Proxy", true         <i class="conum" data-value="4"></i><b>(4)</b>
                ),
                response.getBody()
        );
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When performing a request to different URL Paths, the result is the same.
<em>(Despite the differences in parameter transfer for <code>GET</code> and `POST`requests.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>endpoint_version</code> name corresponds to the <code>endpointVersion</code> field of the request model.
<em>(This correspondence is formed basing on the default strategy use, which is defined by the <code>@ParameterMappingStrategy</code> annotation.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>use-Proxy</code> name corresponds to the <code>useProxy</code> field of the request model, since this name is specified in the <code>@Parameter</code> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>After executing the request in the resulting HTTP response, the <code>endpoint_version</code> and <code>use-Proxy</code> HTTP parameters are equal to <code>v1</code> and <code>true</code> respectively.
<em>(The handler returns the same header values it received from an HTTP request.)</em></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-params" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-params</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="supported_data_types_2"><a class="anchor" href="#supported_data_types_2"></a><a class="link" href="#supported_data_types_2">5.10.2. Supported Data Types</a></h4>
<div class="paragraph">
<p>The RxMicro framework supports the following Java types, which can be HTTP request model parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>? extends Enum&lt;?&gt;</code>;</p>
</li>
<li>
<p><code>java.lang.Boolean</code>;</p>
</li>
<li>
<p><code>java.lang.Byte</code>;</p>
</li>
<li>
<p><code>java.lang.Short</code>;</p>
</li>
<li>
<p><code>java.lang.Integer</code>;</p>
</li>
<li>
<p><code>java.lang.Long</code>;</p>
</li>
<li>
<p><code>java.math.BigInteger</code>;</p>
</li>
<li>
<p><code>java.lang.Float</code>;</p>
</li>
<li>
<p><code>java.lang.Double</code>;</p>
</li>
<li>
<p><code>java.math.BigDecimal</code>;</p>
</li>
<li>
<p><code>java.lang.Character</code>;</p>
</li>
<li>
<p><code>java.lang.String</code>;</p>
</li>
<li>
<p><code>java.time.Instant</code>;</p>
</li>
<li>
<p><code>? extends Object</code>;</p>
</li>
<li>
<p><code>java.util.List&lt;? extends Object&gt;</code>;</p>
</li>
<li>
<p><code>java.util.Set&lt;? extends Object&gt;</code>;</p>
</li>
<li>
<p><code>java.util.Map&lt;java.lang.String, ? extends Object&gt;</code>;</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For floating point numbers, it is suggested to use the <code>java.math.BigDecimal</code> type instead of <code>java.lang.Float</code> or <code>java.lang.Double</code>.</p>
</div>
<div class="paragraph">
<p>Using the <code>java.math.BigDecimal</code> allows excluding errors of decimal number notation.
<strong>This is particularly important if the decimal number is used to represent currency-related data!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>and also the <code>java.util.List&lt;T&gt;</code>, <code>java.util.Set&lt;T&gt;</code> and the <code>java.util.Map&lt;String, T&gt;</code> type is parameterized by any of the above mentioned primitive types.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the <code>java.util.Map&lt;String, T&gt;</code> type is used, then REST model can contain dynamic properties, where <code>keys</code> are the names of properties and <code>values</code> are the properties values.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class ListQueryParamMicroService {

    @GET("/")
    @ParameterMappingStrategy
    void consume(final List&lt;Status&gt; supportedStatuses) {
        System.out.println(supportedStatuses);
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(ListQueryParamMicroService.class)
final class ListQueryParamMicroServiceTest {

    private BlockingHttpClient blockingHttpClient;

    private SystemOut systemOut;

    static Stream&lt;Arguments&gt; supportedListProvider() {
        return Stream.of(
                arguments("created|approved|rejected"),                         <i class="conum" data-value="1"></i><b>(1)</b>
                arguments(new Status[]{created, approved, rejected}, 0),        <i class="conum" data-value="2"></i><b>(2)</b>
                arguments(new String[]{"created", "approved", "rejected"}, 0),  <i class="conum" data-value="3"></i><b>(3)</b>
                arguments(List.of(created, approved, rejected)),                <i class="conum" data-value="4"></i><b>(4)</b>
                arguments(List.of("created", "approved", "rejected")),          <i class="conum" data-value="5"></i><b>(5)</b>
                arguments(QueryParams.of(                                       <i class="conum" data-value="6"></i><b>(6)</b>
                        "supported_statuses", "created",
                        "supported_statuses", "approved",
                        "supported_statuses", "rejected"
                )),
                arguments(QueryParams.of(                                       <i class="conum" data-value="0"></i><b>(0)</b>
                        "supported_statuses", "created|approved",
                        "supported_statuses", "rejected"
                ))
        );
    }

    @ParameterizedTest
    @MethodSource("supportedListProvider")
    void Should_support_list_headers(final Object queryParamValue) {
        blockingHttpClient.get(
                "/",
                queryParamValue instanceof QueryParams ?
                        (QueryParams) queryParamValue :
                        QueryParams.of("supported_statuses", queryParamValue) <i class="conum" data-value="7"></i><b>(7)</b>
        );

        assertEquals(
                "[created, approved, rejected]", <i class="conum" data-value="8"></i><b>(8)</b>
                systemOut.asString()
        );
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If the HTTP parameter is a list of values, the list elements are transferred via the HTTP protocol as a string separated by the <code>|</code> symbol.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Besides transferring the list using a comma-separated string, the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a> component also supports:<br>
an array of enumerations,</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>an array of string values,</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>a list of enumerations,</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>a list of string values.<br>
<em>(The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a>
component converts these types to a comma-separated string automatically!)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Besides transferring HTTP parameters as a comma-separated string, the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a> component also supports repeatable query params with different values.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>All specified value types for the HTTP parameter, which is a list of values, are transferred as the <code>java.lang.Object</code> type.
<em>(The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a>
component automatically converts them to a comma-separated string and transfers via the HTTP protocol.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>The RxMicro framework converts different types to a list of enumerations and displays it in the console.</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="complex_model_support"><a class="anchor" href="#complex_model_support"></a><a class="link" href="#complex_model_support">5.10.3. Complex Model Support</a></h4>
<div class="paragraph">
<p>Unlike HTTP headers, HTTP parameters can be transferred in the request body.</p>
</div>
<div class="paragraph">
<p>Therefore, besides primitives the RxMicro framework also supports nested JSON objects and arrays.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Therefore, the list of supported types includes the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>? extends Object</code> - custom class of the nested Java model;</p>
</li>
<li>
<p><code>java.util.List&lt;? extends Object&gt;</code> - list of the nested Java model custom classes;</p>
</li>
<li>
<p><code>java.util.Set&lt;? extends Object&gt;</code> - set of the nested Java model custom classes;</p>
</li>
<li>
<p><code>java.util.Map&lt;String, ? extends Object&gt;</code> - map of the nested Java model custom classes;</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Nested Model Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ParameterMappingStrategy
public final class NestedModel {

    String stringParameter;

    BigDecimal bigDecimalParameter;

    Instant instantParameter;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As well as examples of more complex Java models that use a nested model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ParameterMappingStrategy
public final class ComplexRequest {

    Integer integerParameter; <i class="conum" data-value="1"></i><b>(1)</b>

    Status enumParameter; <i class="conum" data-value="1"></i><b>(1)</b>

    List&lt;Status&gt; enumsParameter; <i class="conum" data-value="2"></i><b>(2)</b>

    NestedModel nestedModelParameter; <i class="conum" data-value="3"></i><b>(3)</b>

    List&lt;NestedModel&gt; nestedModelsParameter; <i class="conum" data-value="4"></i><b>(4)</b>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ParameterMappingStrategy
public final class ComplexResponse {

    final Integer integerParameter; <i class="conum" data-value="1"></i><b>(1)</b>

    final Status enumParameter; <i class="conum" data-value="1"></i><b>(1)</b>

    final List&lt;Status&gt; enumsParameter; <i class="conum" data-value="2"></i><b>(2)</b>

    final NestedModel nestedModelParameter; <i class="conum" data-value="3"></i><b>(3)</b>

    final List&lt;NestedModel&gt; nestedModelsParameter; <i class="conum" data-value="4"></i><b>(4)</b>

    public ComplexResponse(final ComplexRequest request) {
        this.integerParameter = request.integerParameter;
        this.enumParameter = request.enumParameter;
        this.enumsParameter = request.enumsParameter;
        this.nestedModelParameter = request.nestedModelParameter;
        this.nestedModelsParameter = request.nestedModelsParameter;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Primitive JSON type field.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Primitive JSON array type.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Nested JSON object.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>JSON array of JSON nested objects.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After creating model classes, it is necessary to create a request handler that uses the following models:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class ComplexModelMicroService {

    @POST("/")
    CompletableFuture&lt;ComplexResponse&gt; handle(final ComplexRequest request) {
        return completedFuture(new ComplexResponse(request));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the request is transferred in an HTTP body, the sent and received JSON objects must be the same:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(ComplexModelMicroService.class)
final class ComplexModelMicroServiceTest {

    private BlockingHttpClient blockingHttpClient;

    @Test
    void Should_support_complex_models() {
        final Object jsonObject = jsonObject(
                "integer_parameter", 1,
                "enum_parameter", created,
                "enums_parameter", jsonArray(created, approved),
                "nested_model_parameter", jsonObject(
                        "string_parameter", "test",
                        "big_decimal_parameter", new BigDecimal("3.14"),
                        "instant_parameter", Instant.now()
                ),
                "nested_models_parameter", jsonArray(
                        jsonObject(
                                "string_parameter", "test1",
                                "big_decimal_parameter", new BigDecimal("1.1"),
                                "instant_parameter", Instant.now()
                        ),
                        jsonObject(
                                "string_parameter", "test2",
                                "big_decimal_parameter", new BigDecimal("1.2"),
                                "instant_parameter", Instant.now()
                        )
                )
        );
        final ClientHttpResponse response = blockingHttpClient.post("/", jsonObject);

        assertEquals(jsonObject, response.getBody());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For automatic conversion of Java types to JSON types, it is recommended to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/json/JsonFactory.java" target="_blank" rel="noopener"><code>JsonFactory</code></a> test class from the <code>rxmicro-test-json</code> module.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-params" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-params</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="rest-controller-path-variables-basic"><a class="anchor" href="#rest-controller-path-variables-basic"></a><a class="link" href="#rest-controller-path-variables-basic">5.11. The <code>path variables</code> Support</a></h3>
<div class="sect3">
<h4 id="basic_rules_3"><a class="anchor" href="#basic_rules_3"></a><a class="link" href="#basic_rules_3">5.11.1. Basic Rules</a></h4>
<div class="paragraph">
<p>The RxMicro framework supports <code>path variables</code> in request models:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Request {

    <i class="conum" data-value="1"></i><b>(1)</b>
    @PathVariable
    String category;

    <i class="conum" data-value="2"></i><b>(2)</b>
    @PathVariable("class")
    String type;

    @PathVariable
    String subType;

    public String getCategory() {
        return category;
    }

    public String getType() {
        return type;
    }

    public String getSubType() {
        return subType;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>In order to declare a model field as the <code>path variable</code>, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/PathVariable.java" target="_blank" rel="noopener"><code>@PathVariable</code></a> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Using the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/PathVariable.java" target="_blank" rel="noopener"><code>@PathVariable</code></a> annotation, it is possible to specify the <code>path variable</code> name.<br>
<em>(If no name is specified, the model field name is used as the <code>path variable</code> name.)</em></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Unlike HTTP headers and parameters that are available also on the client side, <code>path variables</code> are available <strong>only</strong> within the HTTP request handlers.</p>
</div>
<div class="paragraph">
<p><strong>So for simplicity it is recommended to always use the model field name as the <code>path variable</code> name!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After creating model classes, it is necessary to create an HTTP request handler that uses the following model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class MicroService {

    <i class="conum" data-value="1"></i><b>(1)</b>
    @GET("/1/${category}/${class}/${subType}")
    @GET("/1/${category}/${class}_${subType}")
    @GET("/1/${category}-${class}-${subType}")
    @GET("/1-${category}-${class}-${subType}")
    void consume(final Request request) {
        System.out.println(format(
                "?-?-?",
                request.getCategory(), request.getType(), request.getSubType()
        ));
    }

    <i class="conum" data-value="1"></i><b>(1)</b>
    @GET("/2/${category}/${class}/${subType}")
    @GET("/2/${category}/${class}_${subType}")
    @GET("/2/${category}-${class}-${subType}")
    @GET("/2-${category}-${class}-${subType}")
    void consume(final @PathVariable String category,       <i class="conum" data-value="2"></i><b>(2)</b>
                 final @PathVariable("class") String type,  <i class="conum" data-value="3"></i><b>(3)</b>
                 final @PathVariable String subType) {
        System.out.println(format(
                "?-?-?",
                category, type, subType
        ));
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When using <code>path variables</code> in request models, be sure to use <strong>all</strong> <code>path variables</code> in the URL Path.
<em>(Based on the analysis of the URL Path, and considering all <code>path variables</code>, the RxMicro framework selects the required HTTP request handler.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>In order to declare a method parameter as <code>path variable</code>, You must use the <code>@PathVariable</code> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Using <code>@PathVariable</code> annotation it is possible to specify the <code>path variable</code> name, which does not match the name of the method parameter.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The RxMicro framework recommends for request handlers that depend on 3 or more
<code>path variables</code>
to create separate classes of request model.</p>
</div>
<div class="paragraph">
<p><strong>Upon implementation of</strong>
<strong><code>path variables</code></strong>
<strong>directly into the handler, the code becomes hard to read!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Despite the different approaches to <code>path variables</code> handling support, from the client&#8217;s point of view the two above-mentioned handlers are absolutely equal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceTest {

    private BlockingHttpClient blockingHttpClient;

    private SystemOut systemOut;

    @ParameterizedTest
    @CsvSource({
            "/1/category/class/subType,     category-class-subType",
            "/1/category/class_subType,     category-class-subType",
            "/1/category-class-subType,     category-class-subType",
            "/1-category-class-subType,     category-class-subType",

            "/2/category/class/subType,     category-class-subType",
            "/2/category/class_subType,     category-class-subType",
            "/2/category-class-subType,     category-class-subType",
            "/2-category-class-subType,     category-class-subType",

            "/1/5/6/7,                      5-6-7",
            "/1/5/6_7,                      5-6-7",
            "/1/5-6-7,                      5-6-7",
            "/1-5-6-7,                      5-6-7",

            "/2/5/6/7,                      5-6-7",
            "/2/5/6_7,                      5-6-7",
            "/2/5-6-7,                      5-6-7",
            "/2-5-6-7,                      5-6-7",
    })
    void Should_support_path_variables(final String path,           <i class="conum" data-value="1"></i><b>(1)</b>
                                       final String expectedOut) {  <i class="conum" data-value="2"></i><b>(2)</b>
        blockingHttpClient.get(path);

        assertEquals(expectedOut, systemOut.asString());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The current <code>path</code>, which corresponds to one of the specified <code>path</code> templates.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The expected string containing all extracted <code>path variables</code>  from the current <code>path</code>, displayed in the console.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-path-variables" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-path-variables</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="supported_data_types_3"><a class="anchor" href="#supported_data_types_3"></a><a class="link" href="#supported_data_types_3">5.11.2. Supported Data Types</a></h4>
<div class="paragraph">
<p>The RxMicro framework supports the following Java types, which can be <code>path variables</code> of the request model:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>? extends Enum&lt;?&gt;</code>;</p>
</li>
<li>
<p><code>java.lang.Boolean</code>;</p>
</li>
<li>
<p><code>java.lang.Byte</code>;</p>
</li>
<li>
<p><code>java.lang.Short</code>;</p>
</li>
<li>
<p><code>java.lang.Integer</code>;</p>
</li>
<li>
<p><code>java.lang.Long</code>;</p>
</li>
<li>
<p><code>java.math.BigInteger</code>;</p>
</li>
<li>
<p><code>java.lang.Float</code>;</p>
</li>
<li>
<p><code>java.lang.Double</code>;</p>
</li>
<li>
<p><code>java.math.BigDecimal</code>;</p>
</li>
<li>
<p><code>java.lang.Character</code>;</p>
</li>
<li>
<p><code>java.lang.String</code>;</p>
</li>
<li>
<p><code>java.time.Instant</code>;</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For floating point numbers, it is suggested to use the <code>java.math.BigDecimal</code> type instead of <code>java.lang.Float</code> or <code>java.lang.Double</code>.</p>
</div>
<div class="paragraph">
<p>Using the <code>java.math.BigDecimal</code> allows excluding errors of decimal number notation.
<strong>This is particularly important if the decimal number is used to represent currency-related data!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="rest-controller-internals-basic-section"><a class="anchor" href="#rest-controller-internals-basic-section"></a><a class="link" href="#rest-controller-internals-basic-section">5.12. Support of Internal Data Types</a></h3>
<div class="sect3">
<h4 id="basic_rules_4"><a class="anchor" href="#basic_rules_4"></a><a class="link" href="#basic_rules_4">5.12.1. Basic Rules</a></h4>
<div class="paragraph">
<p>The RxMicro framework works with internal data.
Due to this, the developer can extract additional information about the HTTP request and gain more control over the generated HTTP response.</p>
</div>
<div class="paragraph">
<p>To work with internal data, it is necessary to create request and response models:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Request {

    <i class="conum" data-value="1"></i><b>(1)</b>
    @RemoteAddress
    String remoteAddress1;

    <i class="conum" data-value="2"></i><b>(2)</b>
    @RequestUrlPath
    String urlPath;

    <i class="conum" data-value="3"></i><b>(3)</b>
    @RequestMethod
    String method;

    <i class="conum" data-value="4"></i><b>(4)</b>
    HttpVersion httpVersion;

    <i class="conum" data-value="5"></i><b>(5)</b>
    HttpHeaders headers;

    <i class="conum" data-value="6"></i><b>(6)</b>
    @RequestBody
    byte[] bodyBytes;

    public String getRemoteAddress1() {
        return remoteAddress1;
    }

    public String getUrlPath() {
        return urlPath;
    }

    public String getMethod() {
        return method;
    }

    public HttpVersion getHttpVersion() {
        return httpVersion;
    }

    public HttpHeaders getHeaders() {
        return headers;
    }

    public byte[] getBodyBytes() {
        return bodyBytes;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To extract the remote address of the client connection, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RemoteAddress.java" target="_blank" rel="noopener"><code>@RemoteAddress</code></a> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>To extract the current <code>URL path</code>, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RequestUrlPath.java" target="_blank" rel="noopener"><code>@RequestUrlPath</code></a> annotation.<br>
<em>(This feature is useful for request logging using <code>path-variables</code>.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>To extract the current HTTP method, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RequestMethod.java" target="_blank" rel="noopener"><code>@RequestMethod</code></a> annotation.<br>
<em>(This feature is useful for request logging when one handler supports different HTTP methods.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>To extract the HTTP protocol version, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/HttpVersion.java" target="_blank" rel="noopener"><code>HttpVersion</code></a> type.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>To extract all HTTP headers, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/HttpHeaders.java" target="_blank" rel="noopener"><code>HttpHeaders</code></a> type.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>To extract the request body content as a byte array, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RequestBody.java" target="_blank" rel="noopener"><code>@RequestBody</code></a> annotation.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Response {

    <i class="conum" data-value="1"></i><b>(1)</b>
    @ResponseStatusCode
    final Integer status;

    <i class="conum" data-value="2"></i><b>(2)</b>
    final HttpVersion version;

    <i class="conum" data-value="3"></i><b>(3)</b>
    final HttpHeaders headers;

    <i class="conum" data-value="4"></i><b>(4)</b>
    @ResponseBody
    final byte[] body;

    public Response(final Integer status,
                    final HttpVersion version,
                    final HttpHeaders headers,
                    final byte[] body) {
        this.status = status;
        this.version = version;
        this.headers = headers;
        this.body = body;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To override the HTTP status code, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ResponseStatusCode.java" target="_blank" rel="noopener"><code>@ResponseStatusCode</code></a> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>To set the HTTP protocol version, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/HttpVersion.java" target="_blank" rel="noopener"><code>HttpVersion</code></a> type.<br>
<em>(Currently only <code>1.0</code> and <code>1.1</code> HTTP versions are supported.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>To set all HTTP headers, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/HttpHeaders.java" target="_blank" rel="noopener"><code>HttpHeaders</code></a> type.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>To set the response body content as a byte array, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ResponseBody.java" target="_blank" rel="noopener"><code>@ResponseBody</code></a> annotation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After creating model classes, it is necessary to create an HTTP request handler that uses the following models:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class MicroService {

    @POST("/")
    CompletableFuture&lt;Response&gt; handle(final Request request) {
        return completedFuture(new Response(
                201,
                request.getHttpVersion(),
                HttpHeaders.of(
                        "Remote-Address", request.getRemoteAddress1(),
                        "Url-Path", request.getUrlPath(),
                        "Method", request.getMethod(),
                        "Custom-Header", request.getHeaders().getValue("Custom-Header")
                ),
                request.getBodyBytes()
        ));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>After creating the REST controller, let&#8217;s check that everything works:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceTest {

    private BlockingHttpClient blockingHttpClient;

    @Test
    void Should_support_internal_types() {
        final Object body = jsonObject("message", "Hello World!");
        final ClientHttpResponse response = blockingHttpClient.post(
                "/",
                HttpHeaders.of("Custom-Header", "Custom-Value"),
                body
        );

        assertEquals(body, response.getBody());
        assertEquals(201, response.getStatusCode());
        assertSame(HTTP_1_1, response.getVersion());
        final HttpHeaders responseHeaders = response.getHeaders();
        final String remoteAddress = responseHeaders.getValue("Remote-Address");
        assertTrue(
                remoteAddress.contains("127.0.0.1"),
                "Invalid Remote-Address: " + remoteAddress
        );
        assertEquals("/", responseHeaders.getValue("Url-Path"));
        assertEquals("POST", responseHeaders.getValue("Method"));
        assertEquals("Custom-Value", responseHeaders.getValue("Custom-Header"));
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-internals" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-internals</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="supported_internal_data_types"><a class="anchor" href="#supported_internal_data_types"></a><a class="link" href="#supported_internal_data_types">5.12.2. Supported Internal Data Types</a></h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. Supported internal data types for a request model.</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Java type</strong></th>
<th class="tableblock halign-left valign-top"><strong>RxMicro Annotation</strong></th>
<th class="tableblock halign-left valign-top"><strong>Is the annotation required?</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/detail/model/HttpRequest.java" target="_blank" rel="noopener"><code>HttpRequest</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP request model</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/HttpVersion.java" target="_blank" rel="noopener"><code>HttpVersion</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP protocol version</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/HttpHeaders.java" target="_blank" rel="noopener"><code>HttpHeaders</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP header model</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/net/SocketAddress.html" target="_blank" rel="noopener"><code>SocketAddress</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RemoteAddress.java" target="_blank" rel="noopener"><code>@RemoteAddress</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>No</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remote client address</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RemoteAddress.java" target="_blank" rel="noopener"><code>@RemoteAddress</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Yes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remote client address</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RequestUrlPath.java" target="_blank" rel="noopener"><code>@RequestUrlPath</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Yes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL Path of the current request</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RequestMethod.java" target="_blank" rel="noopener"><code>@RequestMethod</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Yes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP request method</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>byte[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RequestBody.java" target="_blank" rel="noopener"><code>@RequestBody</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Yes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP request body content</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Currently only <code>1.0</code> and <code>1.1</code> HTTP versions are supported.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. Supported internal data types for a response model.</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Java type</strong></th>
<th class="tableblock halign-left valign-top"><strong>RxMicro Annotation</strong></th>
<th class="tableblock halign-left valign-top"><strong>Is the annotation required?</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/HttpVersion.java" target="_blank" rel="noopener"><code>HttpVersion</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP protocol version</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/HttpHeaders.java" target="_blank" rel="noopener"><code>HttpHeaders</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP header model</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html" target="_blank" rel="noopener"><code>Integer</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ResponseStatusCode.java" target="_blank" rel="noopener"><code>@ResponseStatusCode</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Yes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP response status code</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>byte[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ResponseBody.java" target="_blank" rel="noopener"><code>@ResponseBody</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Yes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP response body content</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="rest-controller-versioning-section"><a class="anchor" href="#rest-controller-versioning-section"></a><a class="link" href="#rest-controller-versioning-section">5.13. Versioning of REST Controllers</a></h3>
<div class="paragraph">
<p>The RxMicro framework supports versioning of REST Controllers using two strategies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Versioning based on HTTP header analysis with the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/HttpStandardHeaderNames.java#L406" target="_blank" rel="noopener"><code>Api-Version</code></a> name.</p>
</li>
<li>
<p>Versioning based on URL Path fragment analysis.</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
<div class="sect3">
<h4 id="versioning_based_on_http_header_analysis"><a class="anchor" href="#versioning_based_on_http_header_analysis"></a><a class="link" href="#versioning_based_on_http_header_analysis">5.13.1. Versioning Based on HTTP Header Analysis</a></h4>
<div class="paragraph">
<p>The RxMicro framework allows creating identical REST controllers that differ only in version:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Version(value = "v1", strategy = Version.Strategy.HEADER) <i class="conum" data-value="1"></i><b>(1)</b>
final class OldMicroService {

    @PATCH("/patch")
    void update() {
        System.out.println("old");
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>REST controller of the old <code>v1</code> version, using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Version.java#L89" target="_blank" rel="noopener"><code>Version.Strategy.HEADER</code></a> strategy;</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Version(value = "v2", strategy = Version.Strategy.HEADER) <i class="conum" data-value="1"></i><b>(1)</b>
final class NewMicroService {

    @PATCH("/patch")
    void update() {
        System.out.println("new");
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>REST controller of the new <code>v2</code> version, using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Version.java#L89" target="_blank" rel="noopener"><code>Version.Strategy.HEADER</code></a> strategy;</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Note that the rules for defining a handler are the same for two different classes!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The correct selection of the appropriate REST controller handler can be checked with the following test:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest({OldMicroService.class, NewMicroService.class}) <i class="conum" data-value="1"></i><b>(1)</b>
final class MicroServiceTest {

    private BlockingHttpClient blockingHttpClient;

    private SystemOut systemOut;

    @ParameterizedTest
    @CsvSource({
            "v1,    old",
            "v2,    new"
    })
    void Should_route_to_valid_request_handler(final String versionHeaderValue,
                                               final String expectedOut) {
        blockingHttpClient.patch(
                "/patch",    <i class="conum" data-value="2"></i><b>(2)</b>
                HttpHeaders.of(
                        API_VERSION, <i class="conum" data-value="3"></i><b>(3)</b>
                        versionHeaderValue
                )
        );

        assertEquals(expectedOut, systemOut.asString());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="#testing-rest-based-microservice-tests-section"><code>@RxMicroRestBasedMicroServiceTest</code></a> annotation allows You to run several REST controllers in test mode.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The test runs the <code>PATCH</code> request to a URL Path: <code>/</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>To specify the handler version, the standard
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/HttpStandardHeaderNames.java#L406" target="_blank" rel="noopener"><code>Api-Version</code></a> HTTP header is used.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If only REST controllers of a certain version need to be tested, then the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a>
component can be set up for operation of only certain versions of REST controller using the <a href="#testing-BlockingHttpClient-settings-section"><code>@BlockingHttpClientSettings</code> annotation.</a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-versioning-header" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-versioning-header</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="versioning_based_on_url_path_fragment_analysis"><a class="anchor" href="#versioning_based_on_url_path_fragment_analysis"></a><a class="link" href="#versioning_based_on_url_path_fragment_analysis">5.13.2. Versioning Based on URL Path Fragment Analysis</a></h4>
<div class="paragraph">
<p>The RxMicro framework allows creating identical REST controllers that differ only in version:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Version(value = "v1", strategy = Version.Strategy.URL_PATH) <i class="conum" data-value="1"></i><b>(1)</b>
final class OldMicroService {

    @PATCH("/patch")
    void update() {
        System.out.println("old");
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>REST controller of the old <code>v1</code> version, using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Version.java#L70" target="_blank" rel="noopener"><code>Version.Strategy.URL_PATH</code></a> strategy;</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Version(value = "v2", strategy = Version.Strategy.URL_PATH) <i class="conum" data-value="1"></i><b>(1)</b>
final class NewMicroService {

    @PATCH("/patch")
    void update() {
        System.out.println("new");
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>REST controller of the new <code>v2</code> version, using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Version.java#L70" target="_blank" rel="noopener"><code>Version.Strategy.URL_PATH</code></a> strategy;</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Note that the rules for defining a handler are the same for two different classes!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The correct selection of the appropriate REST controller handler can be checked with the following test:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest({OldMicroService.class, NewMicroService.class}) <i class="conum" data-value="1"></i><b>(1)</b>
final class MicroServiceTest {

    private BlockingHttpClient blockingHttpClient;

    private SystemOut systemOut;

    @ParameterizedTest
    @CsvSource({
            "/v1,    old",
            "/v2,    new"
    })
    void Should_route_to_valid_request_handler(final String urlVersionPath,
                                               final String expectedOut) {
        blockingHttpClient.patch(
                urlVersionPath + "/patch"    <i class="conum" data-value="2"></i><b>(2)</b>
        );

        assertEquals(expectedOut, systemOut.asString());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="#testing-rest-based-microservice-tests-section"><code>@RxMicroRestBasedMicroServiceTest</code></a> annotation allows You to run several REST controllers in test mode.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The test runs the <code>PATCH</code> request to different URL Paths;</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If only REST controllers of a certain version need to be tested, then the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a>
component can be set up for operation of only certain versions of REST controller using the <a href="#testing-BlockingHttpClient-settings-section"><code>@BlockingHttpClientSettings</code> annotation.</a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-versioning-url-path" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-versioning-url-path</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="rest-controller-base-url-path-section"><a class="anchor" href="#rest-controller-base-url-path-section"></a><a class="link" href="#rest-controller-base-url-path-section">5.14. Base URL Path for All Handlers</a></h3>
<div class="paragraph">
<p>To configure a base URL Path for all HTTP request handlers, the RxMicro framework provides the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/BaseUrlPath.java" target="_blank" rel="noopener"><code>@BaseUrlPath</code></a> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@BaseUrlPath("base-url-path")
final class MicroService {

    @GET("/path")
    void path() {
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceTest {

    private BlockingHttpClient blockingHttpClient;

    @Test
    void Should_support_base_url() {
        final ClientHttpResponse response = blockingHttpClient.get("/base-url-path/path");

        assertEquals(200, response.getStatusCode());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-base-url-path" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-base-url-path</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="rest-controller-cors-section"><a class="anchor" href="#rest-controller-cors-section"></a><a class="link" href="#rest-controller-cors-section">5.15. <code>CORS</code> Support</a></h3>
<div class="paragraph">
<p>The RxMicro framework supports the <a href="https://developer.mozilla.org/ru/docs/Web/HTTP/CORS" target="_blank" rel="noopener"><code>Cross Origin Resource Sharing (CORS)</code></a>.</p>
</div>
<div class="paragraph">
<p>To activate this function it is necessary to add the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/feature/EnableCrossOriginResourceSharing.java" target="_blank" rel="noopener"><code>@EnableCrossOriginResourceSharing</code></a> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@EnableCrossOriginResourceSharing <i class="conum" data-value="1"></i><b>(1)</b>
final class MicroService {

    @PATCH("/")
    void handle() {
        System.out.println("handle");
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="https://developer.mozilla.org/ru/docs/Web/HTTP/CORS" target="_blank" rel="noopener"><code>Cross Origin Resource Sharing (CORS)</code></a> feature is activated for <strong>all</strong> handlers of the specified REST controller.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When activating this feature, the RxMicro framework automatically adds a standard handler:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceTest {

    private BlockingHttpClient blockingHttpClient;

    private SystemOut systemOut;

    @Test
    void Should_handle_PATCH_request() {
        blockingHttpClient.patch("/");

        assertEquals("handle", systemOut.asString());
    }

    <i class="conum" data-value="1"></i><b>(1)</b>
    @Test
    void Should_support_CORS_Options_request() {
        final ClientHttpResponse response = blockingHttpClient.options(
                "/",
                HttpHeaders.of(
                        ORIGIN, "test.rxmicro.io",
                        ACCESS_CONTROL_REQUEST_METHOD, PATCH
                )
        );

        assertEquals(ORIGIN, response.getHeaders().getValue(VARY));
        assertEquals("*", response.getHeaders().getValue(ACCESS_CONTROL_ALLOW_ORIGIN));
        assertEquals(PATCH.name(), response.getHeaders().getValue(ACCESS_CONTROL_ALLOW_METHODS));
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The standard handler can handle <code>OPTIONS</code> requests with additional HTTP headers.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more information on the <a href="https://developer.mozilla.org/ru/docs/Web/HTTP/CORS" target="_blank" rel="noopener"><code>Cross Origin Resource Sharing (CORS)</code></a> support, check out the following examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-rest-controller/rest-controller-cors/src/main/java/io/rxmicro/examples/rest/controller/cors/ComplexCORSMicroService.java" target="_blank" rel="noopener"><code>ComplexCORSMicroService.java</code></a></p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-rest-controller/rest-controller-cors/src/test/java/io/rxmicro/examples/rest/controller/cors/ComplexCORSMicroServiceTest.java" target="_blank" rel="noopener"><code>ComplexCORSMicroServiceTest.java</code></a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-cors" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-cors</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="rest-controller-request-id-section"><a class="anchor" href="#rest-controller-request-id-section"></a><a class="link" href="#rest-controller-request-id-section">5.16. Request ID</a></h3>
<div class="paragraph">
<p>The Request Id feature described at <a href="{monitoring}.html#monitoring-request-id-section">Monitoring</a> section.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="rest-controller-rest-server-generator-config-section"><a class="anchor" href="#rest-controller-rest-server-generator-config-section"></a><a class="link" href="#rest-controller-rest-server-generator-config-section">5.17. Configuring the Code Generation Process</a></h3>
<div class="paragraph">
<p>The RxMicro framework provides an ability to configure the code generation process for REST controllers.
For this purpose, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/RestServerGeneratorConfig.java" target="_blank" rel="noopener"><code>@RestServerGeneratorConfig</code></a>
annotation, that annotates the <code>module-info.java</code> module descriptor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.rxmicro.rest.model.GenerateOption;
import io.rxmicro.rest.model.ServerExchangeFormatModule;
import io.rxmicro.rest.server.RestServerGeneratorConfig;

@RestServerGeneratorConfig(
        exchangeFormat = ServerExchangeFormatModule.AUTO_DETECT, <i class="conum" data-value="1"></i><b>(1)</b>
        generateRequestValidators = GenerateOption.AUTO_DETECT,  <i class="conum" data-value="2"></i><b>(2)</b>
        generateResponseValidators = GenerateOption.DISABLED     <i class="conum" data-value="3"></i><b>(3)</b>
)
module rest.controller.generator {
    requires rxmicro.rest.server.netty;
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>exchangeFormat</code> parameter allows You to specify a format for message exchange with a client.<br>
<em>(By default, it is used the message exchange format added to the <code>module-info.java</code> descriptor.
If several modules supporting the message exchange format are added to the <code>module-info.java</code> descriptor, then using the <code>exchangeFormat</code> parameter, You need to specify which module should be used for REST controllers.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>generateRequestValidators</code> parameter allows enabling/disabling the option of generating HTTP request validators for all handlers in the project.
<em>(The <code>AUTO_DETECT</code> value means that validators will be generated only if the developer adds the <a href="#validation-section"><code>rxmicro.validation</code></a> module to the <code>module-info.java</code> descriptor.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>generateResponseValidators</code> parameter allows enabling/disabling the option of generating HTTP response validators for all handlers in the project.
<em>(The <code>DISABLED</code> value means that validators won&#8217;t be generated by the <code>RxMicro Annotation Processor</code>.)</em></td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The RxMicro team strong recommends using the <code>AUTO_DETECT</code> generate option always!
(This is default value for <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/RestServerGeneratorConfig.java" target="_blank" rel="noopener"><code>@RestServerGeneratorConfig</code></a> annotation).</p>
</div>
<div class="paragraph">
<p><em>(HTTP response validation can be useful for identifying errors in business task implementation algorithms.
For example, instead of returning an incorrect response model to a client, the microservice will throw an error.
This approach increases the speed of error search and debugging of the source code that performs the business task.)</em></p>
</div>
<div class="paragraph">
<p><strong>FYI:</strong> By default the response validators are generated but not invoked!
To activate the validation of responses it is necessary to set <code>enableAdditionalValidations</code> property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">new Configs.Builder()
        .withConfigs(new RestServerConfig()
                .setEnableAdditionalValidations(true)) <i class="conum" data-value="1"></i><b>(1)</b>
        .build();</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Enables the response validators</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">export rest-server.enableAdditionalValidations=true <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Enables the response validators</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>or using any other <a href="#core-config-types">supported config types</a></p>
</div>
<div class="paragraph">
<p>Thus the RxMicro team recommends the following approach:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Your project configuration must enable generation of validators for all possible model classes.</p>
</li>
<li>
<p>Your <code>development</code> and <code>staging</code> environment must enable additional validation.</p>
</li>
<li>
<p>Your <code>production</code> environment must disable additional validation!</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="rest-client-section"><a class="anchor" href="#rest-client-section"></a><a class="link" href="#rest-client-section">6. REST Client</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>REST Client is an interface that contains at least one declarative HTTP request handler.</p>
</div>
<div class="paragraph">
<p>To create REST clients, the RxMicro framework provides the following modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-rest" target="_blank" rel="noopener"><code>rxmicro.rest</code></a> is a basic module that defines basic <code>RxMicro Annotations</code>, required when using the
<a href="https://en.wikipedia.org/wiki/Representational_state_transfer" target="_blank" rel="noopener"><code>REST</code></a> architecture of building program systems;</p>
</li>
<li>
<p>The <a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-rest-client" target="_blank" rel="noopener"><code>rxmicro.rest.client</code></a> is a basic module used to create and run REST clients;</p>
</li>
<li>
<p>The <a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-rest-client-jdk" target="_blank" rel="noopener"><code>rxmicro.rest.client.jdk</code></a> is an HTTP client implementation module based on <a href="https://openjdk.java.net/groups/net/httpclient/intro.html" target="_blank" rel="noopener"><code>Java HTTP Client</code></a>;</p>
</li>
<li>
<p>The <a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-rest-client-exchange-json" target="_blank" rel="noopener"><code>rxmicro.rest.client.exchange.json</code></a> is a module for converting Java models to <a href="https://www.json.org/" target="_blank" rel="noopener"><code>JSON</code></a> format and vice versa;</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Due to transit dependencies only two modules usually need to be added to a project:
<a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-rest-client-jdk" target="_blank" rel="noopener"><code>rxmicro.rest.client.jdk</code></a> and <a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-rest-client-exchange-json" target="_blank" rel="noopener"><code>rxmicro.rest.client.exchange.json</code></a>.<br>
<em>(All other modules are automatically added to the project!)</em></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
<div class="sect2">
<h3 id="rest_client_implementation_requirements"><a class="anchor" href="#rest_client_implementation_requirements"></a><a class="link" href="#rest_client_implementation_requirements">6.1. REST Client Implementation Requirements</a></h3>
<div class="sect3">
<h4 id="rest_client_interface_requirements"><a class="anchor" href="#rest_client_interface_requirements"></a><a class="link" href="#rest_client_interface_requirements">6.1.1. REST Client Interface Requirements</a></h4>
<div class="paragraph">
<p>REST Client is a Java interface that annotated by the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-client/src/main/java/io/rxmicro/rest/client/RestClient.java" target="_blank" rel="noopener"><code>@RestClient</code></a> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.util.concurrent.CompletableFuture;

import io.rxmicro.rest.client.RestClient;
import io.rxmicro.rest.method.GET;

@RestClient
public interface RESTClient {

    @GET("/")
    CompletableFuture&lt;Model&gt; getContent();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>that must meet the following requirements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The interface must be a <code>public</code> one.</p>
</li>
<li>
<p>The interface must be annotated by the required <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-client/src/main/java/io/rxmicro/rest/client/RestClient.java" target="_blank" rel="noopener"><code>@RestClient</code></a> annotation.</p>
</li>
<li>
<p>The interface couldn&#8217;t extend any other interfaces.</p>
</li>
<li>
<p>The interface couldn&#8217;t be a nested one.</p>
</li>
</ol>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="http_request_handler_requirements_2"><a class="anchor" href="#http_request_handler_requirements_2"></a><a class="link" href="#http_request_handler_requirements_2">6.1.2. HTTP Request Handler Requirements</a></h4>
<div class="paragraph">
<p>HTTP request handler is a method, that must meet the following requirements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The method couldn&#8217;t be a <code>private</code> one.</p>
</li>
<li>
<p>The method couldn&#8217;t be an <code>abstract</code> one.</p>
</li>
<li>
<p>The method couldn&#8217;t be a <code>static</code> one.</p>
</li>
<li>
<p>The method must be annotated by <strong>only one</strong> of the following annotations:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/GET.java" target="_blank" rel="noopener"><code>GET</code></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/POST.java" target="_blank" rel="noopener"><code>POST</code></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/PUT.java" target="_blank" rel="noopener"><code>PUT</code></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/DELETE.java" target="_blank" rel="noopener"><code>DELETE</code></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/PATCH.java" target="_blank" rel="noopener"><code>PATCH</code></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/HEAD.java" target="_blank" rel="noopener"><code>HEAD</code></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/OPTIONS.java" target="_blank" rel="noopener"><code>OPTIONS</code></a>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>The method must return one of the following reactive types:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html" target="_blank" rel="noopener"><code>CompletableFuture</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletionStage.html" target="_blank" rel="noopener"><code>CompletionStage</code></a>;</p>
</li>
<li>
<p><a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Mono.html" target="_blank" rel="noopener"><code>Mono</code></a>;</p>
</li>
<li>
<p><a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Completable.html" target="_blank" rel="noopener"><code>Completable</code></a>;</p>
</li>
<li>
<p><a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Single.html" target="_blank" rel="noopener"><code>Single</code></a>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>If the method returns a reactive type, that this type must be parametrized by a HTTP response model type.
(The additional types such as <code>java.lang.Void</code> and <code>java.util.Optional</code> are supported also.
<em>(Read more: <a href="#core-reactive-bussiness-process-reactive-class-mapping-table">Table 2, &#8220;Which class from a reactive library must be choose?&#8221;</a>)</em>).</p>
</li>
</ol>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A REST client can contain <code>static</code>, <code>private</code> and <code>default</code> methods, but such methods couldn&#8217;t be HTTP request handlers!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The
<a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Flux.html" target="_blank" rel="noopener"><code>Flux</code></a> and
<a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Flowable.html" target="_blank" rel="noopener"><code>Flowable</code></a>
types are developed to handle data stream that may arrive within a certain period of time.</p>
</div>
<div class="paragraph">
<p>For such cases the HTTP protocol provides the special <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Transfer-Encoding" target="_blank" rel="noopener"><code>Transfer-Encoding</code></a> mechanism.</p>
</div>
<div class="paragraph">
<p>But this mechanism is not supported by the RxMicro framework yet, so the
<a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Flux.html" target="_blank" rel="noopener"><code>Flux</code></a> and
<a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Flowable.html" target="_blank" rel="noopener"><code>Flowable</code></a>
types cannot be used in the HTTP request handler.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The RxMicro framework supports the following parameter types for the HTTP request handler:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Handler without parameters.<br>
<em>(This type is recommended for the simplest <code>stateless</code> REST clients without parameters.)</em></p>
</li>
<li>
<p>List of primitive parameters.<br>
<em>(This type is recommended for REST clients, the behavior of which depends on 1-2 parameters.)</em></p>
</li>
<li>
<p>Custom class modeling an HTTP request.<br>
<em>(This type is recommended for REST clients, the behavior of which depends on 3 or more parameters.)</em></p>
</li>
</ol>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When using the
<a href="https://projectreactor.io/docs/core/release/reference/index.html" target="_blank" rel="noopener"><strong>Project Reactor</strong></a> and <a href="https://github.com/ReactiveX/RxJava/blob/3.x/README.md" target="_blank" rel="noopener"><strong>RxJava</strong></a>
reactive libraries, You need:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add dependencies to <code>pom.xml</code>.</p>
</li>
<li>
<p>Add modules to <code>module-info.java</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Adding dependencies to <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;io.projectreactor&lt;/groupId&gt;
        &lt;artifactId&gt;reactor-core&lt;/artifactId&gt;
        &lt;version&gt;${projectreactor.version}&lt;/version&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;io.reactivex.rxjava3&lt;/groupId&gt;
        &lt;artifactId&gt;rxjava&lt;/artifactId&gt;
        &lt;version&gt;${rxjava.version}&lt;/version&gt; <i class="conum" data-value="2"></i><b>(2)</b>
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><a href="https://mvnrepository.com/artifact/io.projectreactor/reactor-core" target="_blank" rel="noopener">The latest stable version of the <code>Project Reactor</code> library</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><a href="https://mvnrepository.com/artifact/io.reactivex.rxjava3/rxjava" target="_blank" rel="noopener">The latest stable version of the <code>RxJava3</code> library</a>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Adding modules to <code>module-info.java</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">module example {
    requires reactor.core; <i class="conum" data-value="1"></i><b>(1)</b>
    requires io.reactivex.rxjava3; <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>reactor.core</code> module when using the <a href="https://projectreactor.io/docs/core/release/reference/index.html" target="_blank" rel="noopener"><strong>Project Reactor</strong></a> library.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>io.reactivex.rxjava3</code> module when using the <a href="https://github.com/ReactiveX/RxJava/blob/3.x/README.md" target="_blank" rel="noopener"><strong>RxJava</strong></a> library.</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="rest-client-annotations-section"><a class="anchor" href="#rest-client-annotations-section"></a><a class="link" href="#rest-client-annotations-section">6.2. <code>RxMicro Annotations</code></a></h3>
<div class="paragraph">
<p>The RxMicro framework supports the following <code>RxMicro Annotations</code>, which are used to create and configure REST Clients.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. Supported <code>RxMicro Annotations</code>.</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Annotation</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-client/src/main/java/io/rxmicro/rest/client/RestClient.java" target="_blank" rel="noopener"><code>@RestClient</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes that an interface is a dynamic generated REST client.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/GET.java" target="_blank" rel="noopener"><code>@GET</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a method, that must handle a <code>GET</code> HTTP request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/POST.java" target="_blank" rel="noopener"><code>@POST</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a method, that must handle a <code>POST</code> HTTP request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/PUT.java" target="_blank" rel="noopener"><code>@PUT</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a method, that must handle a <code>PUT</code> HTTP request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/DELETE.java" target="_blank" rel="noopener"><code>@DELETE</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a method, that must handle a <code>DELETE</code> HTTP request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/PATCH.java" target="_blank" rel="noopener"><code>@PATCH</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a method, that must handle a <code>PATCH</code> HTTP request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/HEAD.java" target="_blank" rel="noopener"><code>@HEAD</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a method, that must handle a <code>HEAD</code> HTTP request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/method/OPTIONS.java" target="_blank" rel="noopener"><code>@OPTIONS</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a method, that must handle a <code>OPTIONS</code> HTTP request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/BaseUrlPath.java" target="_blank" rel="noopener"><code>@BaseUrlPath</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#rest-controller-base-url-path-section">a base URL path for the all request handlers at the REST controller</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Version.java" target="_blank" rel="noopener"><code>@Version</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#rest-controller-versioning-section">a version of the REST controller</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Header.java" target="_blank" rel="noopener"><code>@Header</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes that a field of Java model class is <a href="#rest-controller-headers-basic">a HTTP header</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/HeaderMappingStrategy.java" target="_blank" rel="noopener"><code>@HeaderMappingStrategy</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares <a href="#rest-controller-headers-basic">a strategy of header name formation based on Java model field name analysis</a>.</p>
<p class="tableblock"><em>(By default, the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-model/src/main/java/io/rxmicro/model/MappingStrategy.java#L76" target="_blank" rel="noopener"><code>CAPITALIZE_WITH_HYPHEN</code></a> strategy is used.
Thus, by using this strategy, the <code>Header-Name</code> name header corresponds to the <code>headerName</code> field name.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/AddHeader.java" target="_blank" rel="noopener"><code>@AddHeader</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#rest-controller-headers-static">a static HTTP header</a> that must be added to the response, created by the request handler.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/SetHeader.java" target="_blank" rel="noopener"><code>@SetHeader</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#rest-controller-headers-static">a static HTTP header</a> that must be set to the response, created by the request handler.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RepeatHeader.java" target="_blank" rel="noopener"><code>@RepeatHeader</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes the header, <a href="#rest-controller-headers-repeating">which name needs to be repeated for each element in the list</a>.</p>
<p class="tableblock"><em>(This annotation applies only to fields with the <code>java.util.List&lt;?&gt;</code> type.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Parameter.java" target="_blank" rel="noopener"><code>@Parameter</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes that a field of Java model class is <a href="#rest-controller-headers-basic">a HTTP parameter</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ParameterMappingStrategy.java" target="_blank" rel="noopener"><code>@ParameterMappingStrategy</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares <a href="#rest-controller-params-basic">a strategy of parameter name formation based on Java model field name analysis</a>.</p>
<p class="tableblock"><em>(By default, the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-model/src/main/java/io/rxmicro/model/MappingStrategy.java#L41" target="_blank" rel="noopener"><code>LOWERCASE_WITH_UNDERSCORED</code></a> strategy is used.
Thus, by using this strategy, the <code>header_name</code> name header corresponds to the <code>headerName</code> field name.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/PathVariable.java" target="_blank" rel="noopener"><code>@PathVariable</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes that a field of Java model class is <a href="#rest-controller-path-variables-basic">a <code>path variable</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RemoteAddress.java" target="_blank" rel="noopener"><code>@RemoteAddress</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the Java model field as a field, in which the RxMicro framework must inject <a href="#rest-controller-internals-basic-section">the remote client connection address</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RequestMethod.java" target="_blank" rel="noopener"><code>@RequestMethod</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the Java model field as a field, in which the RxMicro framework must inject <a href="#rest-controller-internals-basic-section">a method of the received request</a>.</p>
<p class="tableblock"><em>(This feature is useful for request logging when one handler supports different HTTP methods.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RequestUrlPath.java" target="_blank" rel="noopener"><code>@RequestUrlPath</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the Java model field as a field, in which the RxMicro framework must inject <a href="#rest-controller-internals-basic-section"><code>URL path</code> of the received request</a>.</p>
<p class="tableblock"><em>(This feature is useful for request logging using <code>path-variables</code>.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RequestBody.java" target="_blank" rel="noopener"><code>@RequestBody</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the Java model field as a field, in which the RxMicro framework must inject <a href="#rest-controller-internals-basic-section">a body of the received request</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ResponseStatusCode.java" target="_blank" rel="noopener"><code>@ResponseStatusCode</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates to the RxMicro framework that the value of the Java model field should be used as <a href="#rest-controller-internals-basic-section">a status code to be sent to the client</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ResponseBody.java" target="_blank" rel="noopener"><code>@ResponseBody</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates to the RxMicro framework that the value of the Java model field should be used as <a href="#rest-controller-internals-basic-section">a body to be sent to the client</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RequestId.java" target="_blank" rel="noopener"><code>@RequestId</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the Java model field as a field, in which the RxMicro framework must inject <a href="#rest-controller-request-id-section">a unique request ID</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/SetStatusCode.java" target="_blank" rel="noopener"><code>@SetStatusCode</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares <a href="#rest-controller-set-status-code-section">a status code</a>, which should be sent to the client in case of successful execution of the HTTP request handler.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/NotFoundMessage.java" target="_blank" rel="noopener"><code>@NotFoundMessage</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares a message returned by the handler in case of <a href="#rest-controller-not-found-section">no result</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/RestServerGeneratorConfig.java" target="_blank" rel="noopener"><code>@RestServerGeneratorConfig</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows <a href="#rest-controller-rest-server-generator-config-section">to configure the process of code generation by the <code>RxMicro Annotation Processor</code> for REST controllers</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/feature/EnableCrossOriginResourceSharing.java" target="_blank" rel="noopener"><code>@EnableCrossOriginResourceSharing</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Activates the <a href="#rest-controller-cors-section"><code>Cross Origin Resource Sharing</code> for all request handlers in the REST controller</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/BaseUrlPath.java" target="_blank" rel="noopener"><code>@BaseUrlPath</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#rest-client-base-url-path-section">a base URL path for the all request handlers at the REST client</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Version.java" target="_blank" rel="noopener"><code>@Version</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#rest-client-versioning-section">a version of the REST client</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Header.java" target="_blank" rel="noopener"><code>@Header</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes that a field of Java model class is <a href="#rest-client-headers-basic">a HTTP header</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/HeaderMappingStrategy.java" target="_blank" rel="noopener"><code>@HeaderMappingStrategy</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares <a href="#rest-client-headers-basic">a strategy of header name formation based on Java model field name analysis</a>.</p>
<p class="tableblock"><em>(By default, the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-model/src/main/java/io/rxmicro/model/MappingStrategy.java#L76" target="_blank" rel="noopener"><code>CAPITALIZE_WITH_HYPHEN</code></a> strategy is used.
Thus, by using this strategy, the <code>Header-Name</code> name header corresponds to the <code>headerName</code> field name.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/AddHeader.java" target="_blank" rel="noopener"><code>@AddHeader</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#rest-client-headers-static">a static HTTP header</a> that must be added to the request, created by REST client implementation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/SetHeader.java" target="_blank" rel="noopener"><code>@SetHeader</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#rest-client-headers-static">a static HTTP header</a> that must be set to the request, created by REST client implementation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RepeatHeader.java" target="_blank" rel="noopener"><code>@RepeatHeader</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes the header, <a href="#rest-client-headers-repeating">which name needs to be repeated for each element in the list</a>.</p>
<p class="tableblock"><em>(This annotation applies only to fields with the <code>java.util.List&lt;?&gt;</code> type.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Parameter.java" target="_blank" rel="noopener"><code>@Parameter</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes that a field of Java model class is <a href="#rest-client-headers-basic">a HTTP parameter</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ParameterMappingStrategy.java" target="_blank" rel="noopener"><code>@ParameterMappingStrategy</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares <a href="#rest-client-params-basic">a strategy of parameter name formation based on Java model field name analysis</a>.</p>
<p class="tableblock"><em>(By default, the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-model/src/main/java/io/rxmicro/model/MappingStrategy.java#L41" target="_blank" rel="noopener"><code>LOWERCASE_WITH_UNDERSCORED</code></a> strategy is used.
Thus, by using this strategy, the <code>header_name</code> name header corresponds to the <code>headerName</code> field name.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/AddQueryParameter.java" target="_blank" rel="noopener"><code>@AddQueryParameter</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#rest-client-query-params-static">a static query parameter</a> that must be added to the request, created by REST client implementation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/SetQueryParameter.java" target="_blank" rel="noopener"><code>@SetQueryParameter</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#rest-client-query-params-static">a static query parameter</a> that must be set to the request, created by REST client implementation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RepeatQueryParameter.java" target="_blank" rel="noopener"><code>@RepeatQueryParameter</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes the query parameter, <a href="#rest-client-query-params-repeating">which name needs to be repeated for each element in the list</a>.</p>
<p class="tableblock"><em>(This annotation applies only to fields with the <code>java.util.List&lt;?&gt;</code> type.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/PathVariable.java" target="_blank" rel="noopener"><code>@PathVariable</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes that a field of Java model class is <a href="#rest-client-path-variables-basic">a <code>path variable</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RequestId.java" target="_blank" rel="noopener"><code>@RequestId</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the Java model field as a field, that the RxMicro framework must used as <a href="#rest-client-request-id-section">a unique request ID</a> and sent it to the server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ResponseStatusCode.java" target="_blank" rel="noopener"><code>@ResponseStatusCode</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates to the RxMicro framework that the value of the Java model field should be used as <a href="#rest-client-internals-basic-section">a status code that received from the server</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ResponseBody.java" target="_blank" rel="noopener"><code>@ResponseBody</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates to the RxMicro framework that the value of the Java model field should be used as <a href="#rest-client-internals-basic-section">a body that received from the server</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-client/src/main/java/io/rxmicro/rest/client/PartialImplementation.java" target="_blank" rel="noopener"><code>@PartialImplementation</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes an abstract class that contains <a href="#rest-client-partial-implementation-section">a partial implementation of the annotated by this annotation REST client interface</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-client/src/main/java/io/rxmicro/rest/client/RestClientGeneratorConfig.java" target="_blank" rel="noopener"><code>@RestClientGeneratorConfig</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows <a href="#rest-client-rest-client-generator-config-section">to configure the process of code generation by the <code>RxMicro Annotation Processor</code> for REST clients</a>.</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="http_request_handler_return_types"><a class="anchor" href="#http_request_handler_return_types"></a><a class="link" href="#http_request_handler_return_types">6.3. HTTP Request Handler Return Types</a></h3>
<div class="paragraph">
<p>The HTTP request handler supports two categories of returned results:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>HTTP response without body;</p>
</li>
<li>
<p>HTTP response with body;</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
<div class="sect3">
<h4 id="supported_return_result_types_for_http_response_without_body"><a class="anchor" href="#supported_return_result_types_for_http_response_without_body"></a><a class="link" href="#supported_return_result_types_for_http_response_without_body">6.3.1. Supported Return Result Types for HTTP Response without Body</a></h4>
<div class="paragraph">
<p>The RxMicro framework supports the following return result types for an HTTP response without body:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
public interface RestClientWithoutBody {

    <i class="conum" data-value="1"></i><b>(1)</b>

    @GET("/jse/completedFuture1")
    CompletableFuture&lt;Void&gt; completedFuture1();

    @GET("/jse/completedFuture2")
    CompletableFuture&lt;Void&gt; completedFuture2(final Request request);

    @GET("/jse/completedFuture3")
    CompletableFuture&lt;Void&gt; completedFuture3(final String requestParameter);

    <i class="conum" data-value="2"></i><b>(2)</b>

    @GET("/jse/completionStage1")
    CompletionStage&lt;Void&gt; completionStage1();

    @GET("/jse/completionStage2")
    CompletionStage&lt;Void&gt; completionStage2(final Request request);

    @GET("/jse/completionStage3")
    CompletionStage&lt;Void&gt; completionStage3(final String requestParameter);

    <i class="conum" data-value="3"></i><b>(3)</b>

    @GET("/spring-reactor/mono1")
    Mono&lt;Void&gt; mono1();

    @GET("/spring-reactor/mono2")
    Mono&lt;Void&gt; mono2(final Request request);

    @GET("/spring-reactor/mono3")
    Mono&lt;Void&gt; mono3(final String requestParameter);

    <i class="conum" data-value="4"></i><b>(4)</b>

    @GET("/rxjava3/completable1")
    Completable completable1();

    @GET("/rxjava3/completable2")
    Completable completable2(final Request request);

    @GET("/rxjava3/completable3")
    Completable completable3(final String requestParameter);
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html" target="_blank" rel="noopener"><code>CompletableFuture&lt;Void&gt;</code></a>
type is recommended when using the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/package-summary.html" target="_blank" rel="noopener"><strong>java.util.concurrent</strong></a> library.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Instead of the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html" target="_blank" rel="noopener"><code>CompletableFuture&lt;Void&gt;</code></a> type, can also be used the
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletionStage.html" target="_blank" rel="noopener"><code>CompletionStage&lt;Void&gt;</code></a> type.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>When using the <a href="https://projectreactor.io/docs/core/release/reference/index.html" target="_blank" rel="noopener"><strong>Project Reactor</strong></a> library, only the
<a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Mono.html" target="_blank" rel="noopener"><code>Mono&lt;Void&gt;</code></a> type can be used.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>When using the <a href="https://github.com/ReactiveX/RxJava/blob/3.x/README.md" target="_blank" rel="noopener"><strong>RxJava</strong></a> library, only the
<a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Completable.html" target="_blank" rel="noopener"><code>Completable</code></a> type can be used.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All the above mentioned HTTP request handlers shouldn&#8217;t throw any exceptions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(RestClientWithoutBody.class)
final class RestClientWithoutBodyTest {

    private RestClientWithoutBody restClient;

    @Mock(answer = RETURNS_DEEP_STUBS)
    @Alternative
    private HttpClientFactory httpClientFactory;

    static Stream&lt;Consumer&lt;RestClientWithoutBody&gt;&gt; clientMethodsProvider() {
        return Stream.of(
                client -&gt; client.completedFuture1().join(),
                client -&gt; client.completedFuture2(new Request("param")).join(),
                client -&gt; client.completedFuture3("param").join(),

                client -&gt; client.completionStage1().toCompletableFuture().join(),
                client -&gt; client.completionStage2(
                        new Request("param")).toCompletableFuture().join(),
                client -&gt; client.completionStage3("param").toCompletableFuture().join(),

                client -&gt; client.mono1().block(),
                client -&gt; client.mono2(new Request("param")).block(),
                client -&gt; client.mono3("param").block(),

                client -&gt; client.completable1().blockingAwait(),
                client -&gt; client.completable2(new Request("param")).blockingAwait(),
                client -&gt; client.completable3("param").blockingAwait()
        );
    }

    private void prepare() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder().setAnyRequest().build(),
                true
        );
    }

    @ParameterizedTest
    @MethodSource("clientMethodsProvider")
    @BeforeThisTest(method = "prepare")
    void Should_be_invoked_successfully(final Consumer&lt;RestClientWithoutBody&gt; clientMethod) {
        assertDoesNotThrow(() -&gt; clientMethod.accept(restClient));
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-handlers" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-handlers</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="supported_return_result_types_for_http_response_with_body"><a class="anchor" href="#supported_return_result_types_for_http_response_with_body"></a><a class="link" href="#supported_return_result_types_for_http_response_with_body">6.3.2. Supported Return Result Types for HTTP Response with Body</a></h4>
<div class="paragraph">
<p>The RxMicro framework supports the following return result types for an HTTP response with body:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
public interface RestClientWithBody {

    <i class="conum" data-value="1"></i><b>(1)</b>

    @GET("/jse/completedFuture1")
    CompletableFuture&lt;Response&gt; completedFuture1();

    @GET("/jse/completedFuture2")
    CompletableFuture&lt;Response&gt; completedFuture2(final Request request);

    @GET("/jse/completedFuture3")
    CompletableFuture&lt;Response&gt; completedFuture3(final String requestParameter);

    <i class="conum" data-value="2"></i><b>(2)</b>

    @GET("/jse/completionStage1")
    CompletionStage&lt;Response&gt; completionStage1();

    @GET("/jse/completionStage2")
    CompletionStage&lt;Response&gt; completionStage2(final Request request);

    @GET("/jse/completionStage3")
    CompletionStage&lt;Response&gt; completionStage3(final String requestParameter);

    <i class="conum" data-value="3"></i><b>(3)</b>

    @GET("/spring-reactor/mono1")
    Mono&lt;Response&gt; mono1();

    @GET("/spring-reactor/mono2")
    Mono&lt;Response&gt; mono2(final Request request);

    @GET("/spring-reactor/mono3")
    Mono&lt;Response&gt; mono3(final String requestParameter);

    <i class="conum" data-value="4"></i><b>(4)</b>

    @GET("/rxjava3/single1")
    Single&lt;Response&gt; single1();

    @GET("/rxjava3/single2")
    Single&lt;Response&gt; single2(final Request request);

    @GET("/rxjava3/single3")
    Single&lt;Response&gt; single3(final String requestParameter);
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html" target="_blank" rel="noopener"><code>CompletableFuture&lt;MODEL&gt;</code></a>
type is recommended when using the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/package-summary.html" target="_blank" rel="noopener"><strong>java.util.concurrent</strong></a> library.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Instead of the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html" target="_blank" rel="noopener"><code>CompletableFuture&lt;MODEL&gt;</code></a> type, can also be used the
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletionStage.html" target="_blank" rel="noopener"><code>CompletionStage&lt;MODEL&gt;</code></a> type.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>When using the <a href="https://projectreactor.io/docs/core/release/reference/index.html" target="_blank" rel="noopener"><strong>Project Reactor</strong></a> library, only the
<a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Mono.html" target="_blank" rel="noopener"><code>Mono&lt;MODEL&gt;</code></a> type can be used.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>When using the <a href="https://github.com/ReactiveX/RxJava/blob/3.x/README.md" target="_blank" rel="noopener"><strong>RxJava</strong></a> library, only the
<a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Single.html" target="_blank" rel="noopener"><code>Single&lt;MODEL&gt;</code></a> type can be used.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Note that the reactive types must be parameterized by the HTTP response model class!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All of the above mentioned handlers return the <code>Response</code> class instance with the <code>Hello World!</code> message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(RestClientWithBody.class)
final class RestClientWithBodyTest {

    private RestClientWithBody restClient;

    @Mock(answer = RETURNS_DEEP_STUBS)
    @Alternative
    private HttpClientFactory httpClientFactory;

    static Stream&lt;Function&lt;RestClientWithBody, Response&gt;&gt; clientMethodsProvider() {
        return Stream.of(
                client -&gt; client.completedFuture1().join(),
                client -&gt; client.completedFuture2(new Request("param")).join(),
                client -&gt; client.completedFuture3("param").join(),

                client -&gt; client.completionStage1().toCompletableFuture().join(),
                client -&gt; client.completionStage2(
                        new Request("param")).toCompletableFuture().join(),
                client -&gt; client.completionStage3("param").toCompletableFuture().join(),

                client -&gt; client.mono1().block(),
                client -&gt; client.mono2(new Request("param")).block(),
                client -&gt; client.mono3("param").block(),

                client -&gt; client.single1().blockingGet(),
                client -&gt; client.single2(new Request("param")).blockingGet(),
                client -&gt; client.single3("param").blockingGet()
        );
    }

    private void prepare() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder().setAnyRequest().build(),
                jsonObject("message", "Hello World!"),
                true
        );
    }

    @ParameterizedTest
    @MethodSource("clientMethodsProvider")
    @BeforeThisTest(method = "prepare")
    void Should_return_message_Hello_World(final Function&lt;RestClientWithBody, Response&gt; clientMethod) {
        final Response response = assertDoesNotThrow(() -&gt; clientMethod.apply(restClient));

        assertEquals("Hello World!", response.getMessage());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-handlers" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-handlers</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="rest-client-headers-basic"><a class="anchor" href="#rest-client-headers-basic"></a><a class="link" href="#rest-client-headers-basic">6.4. HTTP Headers Handling</a></h3>
<div class="sect3">
<h4 id="basic_rules_5"><a class="anchor" href="#basic_rules_5"></a><a class="link" href="#basic_rules_5">6.4.1. Basic Rules</a></h4>
<div class="paragraph">
<p>The RxMicro framework supports HTTP headers in request and response models:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@HeaderMappingStrategy
public final class Request {

    <i class="conum" data-value="2"></i><b>(2)</b>
    @Header
    String endpointVersion;

    <i class="conum" data-value="3"></i><b>(3)</b>
    @Header("UseProxy")
    Boolean useProxy;

    public String getEndpointVersion() {
        return endpointVersion;
    }

    public Boolean getUseProxy() {
        return useProxy;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@HeaderMappingStrategy
public final class Response {

    <i class="conum" data-value="2"></i><b>(2)</b>
    @Header
    final String endpointVersion;

    <i class="conum" data-value="3"></i><b>(3)</b>
    @Header("UseProxy")
    final Boolean useProxy;

    public Response(final Request request) {
        this.endpointVersion = request.getEndpointVersion();
        this.useProxy = request.getUseProxy();
    }

    public Response(final String endpointVersion,
                    final Boolean useProxy) {
        this.endpointVersion = endpointVersion;
        this.useProxy = useProxy;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/HeaderMappingStrategy.java" target="_blank" rel="noopener"><code>@HeaderMappingStrategy</code></a>
annotation allows setting common conversion rules for all header names from HTTP to Java format and vice versa in the current model class.<br>
<em>(By default, the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-model/src/main/java/io/rxmicro/model/MappingStrategy.java#L76" target="_blank" rel="noopener"><code>CAPITALIZE_WITH_HYPHEN</code></a> strategy is used.
The field name is used as the basic name, and then, following the rules of the specified strategy, the HTTP header name is generated.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>In order to declare a model field as the HTTP header field, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Header.java" target="_blank" rel="noopener"><code>@Header</code></a> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Using the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Header.java" target="_blank" rel="noopener"><code>@Header</code></a>
annotation, it is possible to specify the HTTP header name, which does not correspond to the used strategy declared by the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/HeaderMappingStrategy.java" target="_blank" rel="noopener"><code>@HeaderMappingStrategy</code></a> annotation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The RxMicro framework uses the following algorithm to define the HTTP header name for the specified model field:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If the field is annotated by the <code>@Header</code> annotation with an explicit indication of the HTTP header name, the specified name is used;</p>
</li>
<li>
<p>If no HTTP header name is specified in the <code>@Header</code> annotation, the RxMicro framework checks for the <code>@HeaderMappingStrategy</code> annotation above the model class;</p>
</li>
<li>
<p>If the model class is annotated by the <code>@HeaderMappingStrategy</code> annotation, then the specified naming strategy is used.<br>
<em>(The field name is used as the basic name, and then, following the rules of the specified strategy, the HTTP header name is generated.)</em></p>
</li>
<li>
<p>If the <code>@HeaderMappingStrategy</code> annotation is missing, the model class field name is used as the HTTP header name.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After creating model classes, it is necessary to create a request handler that uses the following models:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
public interface SimpleUsageRestClient {

    @GET("/get1")
    CompletableFuture&lt;Response&gt; get1(final Request request); <i class="conum" data-value="1"></i><b>(1)</b>


    <i class="conum" data-value="2"></i><b>(2)</b>
    @GET("/get2")
    <i class="conum" data-value="3"></i><b>(3)</b>
    @HeaderMappingStrategy
    CompletableFuture&lt;Response&gt; get2(final @Header String endpointVersion,        <i class="conum" data-value="4"></i><b>(4)</b>
                                     final @Header("UseProxy") Boolean useProxy); <i class="conum" data-value="5"></i><b>(5)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If a separate model class has been created for an HTTP request, then this class must be passed by the method parameter that handles the HTTP request.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Besides supporting HTTP request model classes, the RxMicro framework supports request handlers that accept HTTP headers as method parameters.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>To define a common naming strategy for all HTTP headers which are passed as method parameters, the request handler must be annotated by the <code>@HeaderMappingStrategy</code> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>To declare a method parameter as an HTTP header field, use the <code>@Header</code> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Using the <code>@Header</code> annotation, it is possible to specify an HTTP header name that does not correspond to the strategy used, declared by the <code>@HeaderMappingStrategy</code> annotation.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The RxMicro framework recommends for request handlers that depend on 3 or more
HTTP headers
to create separate classes of request model.</p>
</div>
<div class="paragraph">
<p><strong>Upon implementation of</strong>
<strong>HTTP headers</strong>
<strong>directly into the handler, the code becomes hard to read!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Despite the different approaches to HTTP header handling support, as to the message generated by the HTTP protocol, the two above-mentioned handlers are absolutely equal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(SimpleUsageRestClient.class)
final class SimpleUsageRestClientTest {

    private static final String ENDPOINT_VERSION = "v1";

    private static final Boolean USE_PROXY = true;

    private SimpleUsageRestClient restClient;

    @Mock(answer = RETURNS_DEEP_STUBS)
    @Alternative
    private HttpClientFactory httpClientFactory;

    static Stream&lt;Function&lt;SimpleUsageRestClient, Response&gt;&gt; restClientExecutableProvider() {
        return Stream.of(
                client -&gt; client.get1(new Request(ENDPOINT_VERSION, USE_PROXY)).join(),
                client -&gt; client.get2(ENDPOINT_VERSION, USE_PROXY).join()
        );
    }

    private void prepare() {
        final HttpHeaders headers = HttpHeaders.of(
                "Endpoint-Version", ENDPOINT_VERSION, <i class="conum" data-value="2"></i><b>(2)</b>
                "UseProxy", USE_PROXY                 <i class="conum" data-value="3"></i><b>(3)</b>
        );
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(GET)
                        .setAnyPath()
                        .setHeaders(headers)
                        .build(),
                new HttpResponseMock.Builder()
                        .setHeaders(headers)
                        .build(),
                true
        );
    }

    @ParameterizedTest
    @MethodSource("restClientExecutableProvider")
    @BeforeThisTest(method = "prepare")
    void Should_process_HTTP_headers(
            final Function&lt;SimpleUsageRestClient, Response&gt; clientMethod) {
        final Response response = assertDoesNotThrow(() -&gt;
                clientMethod.apply(restClient)); <i class="conum" data-value="1"></i><b>(1)</b>

        assertEquals(ENDPOINT_VERSION, response.getEndpointVersion()); <i class="conum" data-value="4"></i><b>(4)</b>
        assertEquals(USE_PROXY, response.getUseProxy());               <i class="conum" data-value="4"></i><b>(4)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When performing a request to different URL Paths, the result is the same.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>Endpoint-Version</code> name corresponds to the <code>endpointVersion</code> field of the request model.<br>
<em>(This correspondence is formed basing on the default strategy use, which is defined by the <code>@HeaderMappingStrategy</code> annotation.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>UseProxy</code> name corresponds to the <code>useProxy</code> field of the request model, since this name is specified in the <code>@Header</code> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>After executing the request in the resulting HTTP response, the <code>Endpoint-Version</code> and <code>UseProxy</code> headers are equal to <code>v1</code> and <code>true</code> respectively.
<em>(The handler returns the same header values it received from an HTTP request.)</em></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-headers" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-headers</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="supported_data_types_4"><a class="anchor" href="#supported_data_types_4"></a><a class="link" href="#supported_data_types_4">6.4.2. Supported Data Types</a></h4>
<div class="paragraph">
<p>The RxMicro framework supports the following Java types, which can be HTTP request model headers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>? extends Enum&lt;?&gt;</code>;</p>
</li>
<li>
<p><code>java.lang.Boolean</code>;</p>
</li>
<li>
<p><code>java.lang.Byte</code>;</p>
</li>
<li>
<p><code>java.lang.Short</code>;</p>
</li>
<li>
<p><code>java.lang.Integer</code>;</p>
</li>
<li>
<p><code>java.lang.Long</code>;</p>
</li>
<li>
<p><code>java.math.BigInteger</code>;</p>
</li>
<li>
<p><code>java.lang.Float</code>;</p>
</li>
<li>
<p><code>java.lang.Double</code>;</p>
</li>
<li>
<p><code>java.math.BigDecimal</code>;</p>
</li>
<li>
<p><code>java.lang.Character</code>;</p>
</li>
<li>
<p><code>java.lang.String</code>;</p>
</li>
<li>
<p><code>java.time.Instant</code>;</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For floating point numbers, it is suggested to use the <code>java.math.BigDecimal</code> type instead of <code>java.lang.Float</code> or <code>java.lang.Double</code>.</p>
</div>
<div class="paragraph">
<p>Using the <code>java.math.BigDecimal</code> allows excluding errors of decimal number notation.
<strong>This is particularly important if the decimal number is used to represent currency-related data!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>and also the <code>java.util.List&lt;T&gt;</code>, <code>java.util.Set&lt;T&gt;</code> and the <code>java.util.Map&lt;String, T&gt;</code> type is parameterized by any of the above mentioned primitive types.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the <code>java.util.Map&lt;String, T&gt;</code> type is used, then REST model can contain dynamic properties, where <code>keys</code> are the names of properties and <code>values</code> are the properties values.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="rest-client-headers-static"><a class="anchor" href="#rest-client-headers-static"></a><a class="link" href="#rest-client-headers-static">6.4.3. Static HTTP Headers</a></h4>
<div class="paragraph">
<p>For static header installation, the RxMicro framework provides the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/AddHeader.java" target="_blank" rel="noopener"><code>@AddHeader</code></a> and
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/SetHeader.java" target="_blank" rel="noopener"><code>@SetHeader</code></a> annotations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
<i class="conum" data-value="1"></i><b>(1)</b>
@SetHeader(name = "Mode", value = "Demo")
public interface StaticHeadersRestClient {

    @GET("/get1")
    CompletableFuture&lt;Void&gt; get1();

    @GET("/get2")
    <i class="conum" data-value="2"></i><b>(2)</b>
    @SetHeader(name = "Debug", value = "true")
    CompletableFuture&lt;Void&gt; get2();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If the HTTP header is set for the REST client, it is added to the HTTP requests for each handler.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If the HTTP header is set for the handler, it is added to the HTTP requests only for that handler.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In terms of the HTTP protocol, static headers do not differ from any others:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(StaticHeadersRestClient.class)
final class StaticHeadersRestClientTest {

    private StaticHeadersRestClient restClient;

    @Mock(answer = RETURNS_DEEP_STUBS)
    @Alternative
    private HttpClientFactory httpClientFactory;

    private void prepareParentHeaderOnly() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(GET)
                        .setPath("/get1")
                        .setHeaders(HttpHeaders.of(
                                "Mode", "Demo"
                        ))
                        .build(),
                true
        );
    }

    @Test
    @BeforeThisTest(method = "prepareParentHeaderOnly")
    void Should_use_parent_header_only() {
        assertDoesNotThrow(() -&gt; restClient.get1().join());
    }

    private void prepareParentAndChildHeaders() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(GET)
                        .setPath("/get2")
                        .setHeaders(HttpHeaders.of(
                                "Mode", "Demo",
                                "Debug", "true"
                        ))
                        .build(),
                true
        );
    }

    @Test
    @BeforeThisTest(method = "prepareParentAndChildHeaders")
    void Should_use_parent_and_child_headers() {
        assertDoesNotThrow(() -&gt; restClient.get2().join());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In order to understand the differences between the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/AddHeader.java" target="_blank" rel="noopener"><code>@AddHeader</code></a> and
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/SetHeader.java" target="_blank" rel="noopener"><code>@SetHeader</code></a> annotations, check out the following example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-rest-client/rest-client-headers/src/main/java/io/rxmicro/examples/rest/client/headers/ComplexStaticHeadersRestClient.java" target="_blank" rel="noopener"><code>ComplexStaticHeadersRestClient.java</code></a></p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-rest-client/rest-client-headers/src/test/java/io/rxmicro/examples/rest/client/headers/ComplexStaticHeadersRestClientTest.java" target="_blank" rel="noopener"><code>ComplexStaticHeadersRestClientTest.java</code></a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-headers" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-headers</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="rest-client-headers-repeating"><a class="anchor" href="#rest-client-headers-repeating"></a><a class="link" href="#rest-client-headers-repeating">6.4.4. Repeating HTTP Headers</a></h4>
<div class="paragraph">
<p>If the HTTP header of an HTTP request is a list of values, the list elements are transferred by default via the HTTP protocol as a string separated by the <code>|</code> symbol.</p>
</div>
<div class="paragraph">
<p>If You want the HTTP header to be repeated for each value, You need to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RepeatHeader.java" target="_blank" rel="noopener"><code>@RepeatHeader</code></a> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
public interface RepeatingHeadersRestClient {

    @PUT("/")
    @HeaderMappingStrategy
    CompletableFuture&lt;Void&gt; put(@Header List&lt;Status&gt; singleHeader,
                                @Header @RepeatHeader List&lt;Status&gt; repeatingHeader);
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>The use of the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RepeatHeader.java" target="_blank" rel="noopener"><code>@RepeatHeader</code></a> annotation is supported for request models only!</strong></p>
</div>
<div class="paragraph">
<p>For response models it makes no sense, because the RxMicro framework converts any of the supported formats into a list of values.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As a result of converting the Java model to HTTP response, the result will be as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(RepeatingHeadersRestClient.class)
final class RepeatingHeadersRestClientTest {

    private RepeatingHeadersRestClient restClient;

    @Mock(answer = RETURNS_DEEP_STUBS)
    @Alternative
    private HttpClientFactory httpClientFactory;

    private void prepare() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(PUT)
                        .setPath("/")
                        .setHeaders(HttpHeaders.of(
                                "Single-Header", "created|approved|rejected", <i class="conum" data-value="1"></i><b>(1)</b>
                                "Repeating-Header", "created",
                                "Repeating-Header", "approved",               <i class="conum" data-value="2"></i><b>(2)</b>
                                "Repeating-Header", "rejected"
                        ))
                        .build(),
                true
        );
    }

    @Test
    @BeforeThisTest(method = "prepare")
    void Should_support_repeating_headers() {
        final List&lt;Status&gt; headers = List.of(created, approved, rejected);
        assertDoesNotThrow(() -&gt; restClient.put(headers, headers).join());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>By default, HTTP header list elements are transferred via the HTTP protocol as a string separated by the <code>|</code> symbol.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If the field is annotated by the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RepeatHeader.java" target="_blank" rel="noopener"><code>@RepeatHeader</code></a> annotation, then the header is repeated for each element of the list.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-headers" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-headers</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="rest-client-params-basic"><a class="anchor" href="#rest-client-params-basic"></a><a class="link" href="#rest-client-params-basic">6.5. HTTP Parameters Handling</a></h3>
<div class="sect3">
<h4 id="basic_rules_6"><a class="anchor" href="#basic_rules_6"></a><a class="link" href="#basic_rules_6">6.5.1. Basic Rules</a></h4>
<div class="paragraph">
<p>The RxMicro framework supports HTTP parameters in request and response models:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@ParameterMappingStrategy
public final class Request {

    <i class="conum" data-value="2"></i><b>(2)</b>
    String endpointVersion;

    <i class="conum" data-value="3"></i><b>(3)</b>
    @Parameter("use-Proxy")
    Boolean useProxy;

    public String getEndpointVersion() {
        return endpointVersion;
    }

    public Boolean getUseProxy() {
        return useProxy;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@ParameterMappingStrategy
public final class Response {

    <i class="conum" data-value="2"></i><b>(2)</b>
    final String endpointVersion;

    <i class="conum" data-value="3"></i><b>(3)</b>
    @Parameter("use-Proxy")
    final Boolean useProxy;

    public Response(final Request request) {
        this.endpointVersion = request.getEndpointVersion();
        this.useProxy = request.getUseProxy();
    }

    public Response(final String endpointVersion,
                    final Boolean useProxy) {
        this.endpointVersion = endpointVersion;
        this.useProxy = useProxy;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ParameterMappingStrategy.java" target="_blank" rel="noopener"><code>@ParameterMappingStrategy</code></a>
annotation allows setting common conversion rules for all parameter names from HTTP to Java format and vice versa in the current model class.
<em>(By default, the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-model/src/main/java/io/rxmicro/model/MappingStrategy.java#L41" target="_blank" rel="noopener"><code>LOWERCASE_WITH_UNDERSCORED</code></a> strategy is used.
The field name is used as the basic name, and then, following the rules of the specified strategy, the HTTP parameter name is generated.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>In order to declare a model field as the HTTP parameter field, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Parameter.java" target="_blank" rel="noopener"><code>@Parameter</code></a> annotation.
<em>(Unlike the <code>@Header</code> annotation, the <code>@Parameter</code> annotation is optional.
Thus, if the model field is not annotated by any annotation, then by default it is assumed that there is the <code>@Parameter</code> annotation above the model field.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Using the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Parameter.java" target="_blank" rel="noopener"><code>@Parameter</code></a>
annotation, it is possible to specify the HTTP parameter name, which does not correspond to the used strategy declared by the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ParameterMappingStrategy.java" target="_blank" rel="noopener"><code>@ParameterMappingStrategy</code></a> annotation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The RxMicro framework uses the following algorithm to define the HTTP parameter name for the specified model field:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If the field is annotated by the <code>@Parameter</code> annotation with an explicit indication of the HTTP parameter name, the specified name is used;</p>
</li>
<li>
<p>If no HTTP parameter name is specified in the <code>@Parameter</code> annotation, the RxMicro framework checks for the <code>@ParameterMappingStrategy</code> annotation above the model class;</p>
</li>
<li>
<p>If the model class is annotated by the <code>@ParameterMappingStrategy</code> annotation, then the specified naming strategy is used.
<em>(The field name is used as the basic name, and then, following the rules of the specified strategy, the HTTP parameter name is generated.)</em></p>
</li>
<li>
<p>If the <code>@ParameterMappingStrategy</code> annotation is missing, the model class field name is used as the HTTP parameter name.</p>
</li>
</ol>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Unlike the <code>@Header</code> annotation, the <code>@Parameter</code> annotation is optional!</strong></p>
</div>
<div class="paragraph">
<p>Thus, if the model field is not annotated by any annotation, then <strong>by default it is assumed that there is the <code>@Parameter</code> annotation above the model field!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After creating model classes, it is necessary to create an HTTP request handler that uses the following models:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
public interface SimpleUsageRestClient {

    @GET("/get1")
    CompletableFuture&lt;Response&gt; get1(final Request request); <i class="conum" data-value="1"></i><b>(1)</b>

    <i class="conum" data-value="2"></i><b>(2)</b>
    @GET("/get2")
    <i class="conum" data-value="3"></i><b>(3)</b>
    @ParameterMappingStrategy
    CompletableFuture&lt;Response&gt; get2(final String endpointVersion,        <i class="conum" data-value="4"></i><b>(4)</b>
                                     final @Parameter("use-Proxy") Boolean useProxy); <i class="conum" data-value="5"></i><b>(5)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If a separate model class has been created for an HTTP request, then this class must be passed by the method parameter that handles the HTTP request.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Besides supporting HTTP request model classes, the RxMicro framework supports request handlers that accept HTTP request parameters as method parameters.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>To define a common naming strategy for all HTTP parameters which are passed as method parameters, the request handler must be annotated by the <code>@ParameterMappingStrategy</code> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>To declare a method parameter as an HTTP parameter field, You do not need to use any additional annotations.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Using the <code>@Parameter</code> annotation, it is possible to specify an HTTP parameter name that does not correspond to the strategy used, declared by the <code>@ParameterMappingStrategy</code> annotation.</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Note that the RxMicro framework does not distinguish whether HTTP request parameters will be transferred to the handler using the start line or HTTP body!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The RxMicro framework recommends for request handlers that depend on 3 or more
HTTP parameters
to create separate classes of request model.</p>
</div>
<div class="paragraph">
<p><strong>Upon implementation of</strong>
<strong>HTTP parameters</strong>
<strong>directly into the handler, the code becomes hard to read!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Despite the different approaches to HTTP parameter handling support, as to the message generated by the HTTP protocol, the two above-mentioned handlers are absolutely equal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(SimpleUsageRestClient.class)
final class SimpleUsageRestClientTest {

    private static final String ENDPOINT_VERSION = "v1";

    private static final Boolean USE_PROXY = true;

    private static final QueryParams QUERY_PARAMETERS = QueryParams.of(
            "endpoint_version", ENDPOINT_VERSION,
            "use-Proxy", USE_PROXY
    );

    private static final Object BODY = jsonObject(
            "endpoint_version", ENDPOINT_VERSION,
            "use-Proxy", USE_PROXY
    );

    private SimpleUsageRestClient restClient;

    @Mock(answer = RETURNS_DEEP_STUBS)
    @Alternative
    private HttpClientFactory httpClientFactory;

    private void prepare1() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(HttpMethod.GET)
                        .setPath("/get1")
                        .setQueryParameters(QUERY_PARAMETERS)
                        .build(),
                BODY,
                true
        );
    }

    @Test
    @BeforeThisTest(method = "prepare1")
    void Should_use_handler_with_request_class() {
        final Response response =
                assertDoesNotThrow(() -&gt;
                        restClient.get1(new Request(ENDPOINT_VERSION, USE_PROXY)).join());

        assertEquals(ENDPOINT_VERSION, response.getEndpointVersion());
        assertEquals(USE_PROXY, response.getUseProxy());
    }

    private void prepare2() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(HttpMethod.GET)
                        .setPath("/get2")
                        .setQueryParameters(QUERY_PARAMETERS)
                        .build(),
                BODY,
                true
        );
    }

    @Test
    @BeforeThisTest(method = "prepare2")
    void Should_use_handler_with_request_params() {
        final Response response =
                assertDoesNotThrow(() -&gt;
                        restClient.get2(ENDPOINT_VERSION, USE_PROXY).join());

        assertEquals(ENDPOINT_VERSION, response.getEndpointVersion());
        assertEquals(USE_PROXY, response.getUseProxy());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-params" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-params</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="supported_data_types_5"><a class="anchor" href="#supported_data_types_5"></a><a class="link" href="#supported_data_types_5">6.5.2. Supported Data Types</a></h4>
<div class="paragraph">
<p>The RxMicro framework supports the following Java types, which can be HTTP request model parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>? extends Enum&lt;?&gt;</code>;</p>
</li>
<li>
<p><code>java.lang.Boolean</code>;</p>
</li>
<li>
<p><code>java.lang.Byte</code>;</p>
</li>
<li>
<p><code>java.lang.Short</code>;</p>
</li>
<li>
<p><code>java.lang.Integer</code>;</p>
</li>
<li>
<p><code>java.lang.Long</code>;</p>
</li>
<li>
<p><code>java.math.BigInteger</code>;</p>
</li>
<li>
<p><code>java.lang.Float</code>;</p>
</li>
<li>
<p><code>java.lang.Double</code>;</p>
</li>
<li>
<p><code>java.math.BigDecimal</code>;</p>
</li>
<li>
<p><code>java.lang.Character</code>;</p>
</li>
<li>
<p><code>java.lang.String</code>;</p>
</li>
<li>
<p><code>java.time.Instant</code>;</p>
</li>
<li>
<p><code>? extends Object</code>;</p>
</li>
<li>
<p><code>java.util.List&lt;? extends Object&gt;</code>;</p>
</li>
<li>
<p><code>java.util.Set&lt;? extends Object&gt;</code>;</p>
</li>
<li>
<p><code>java.util.Map&lt;java.lang.String, ? extends Object&gt;</code>;</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For floating point numbers, it is suggested to use the <code>java.math.BigDecimal</code> type instead of <code>java.lang.Float</code> or <code>java.lang.Double</code>.</p>
</div>
<div class="paragraph">
<p>Using the <code>java.math.BigDecimal</code> allows excluding errors of decimal number notation.
<strong>This is particularly important if the decimal number is used to represent currency-related data!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>and also the <code>java.util.List&lt;T&gt;</code>, <code>java.util.Set&lt;T&gt;</code> and the <code>java.util.Map&lt;String, T&gt;</code> type is parameterized by any of the above mentioned primitive types.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the <code>java.util.Map&lt;String, T&gt;</code> type is used, then REST model can contain dynamic properties, where <code>keys</code> are the names of properties and <code>values</code> are the properties values.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="complex_model_support_2"><a class="anchor" href="#complex_model_support_2"></a><a class="link" href="#complex_model_support_2">6.5.3. Complex Model Support</a></h4>
<div class="paragraph">
<p>Unlike HTTP headers, HTTP parameters can be transferred in the request body.</p>
</div>
<div class="paragraph">
<p>Therefore, besides primitives the RxMicro framework also supports nested JSON objects and arrays.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Therefore, the list of supported types includes the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>? extends Object</code> - custom class of the nested Java model;</p>
</li>
<li>
<p><code>java.util.List&lt;? extends Object&gt;</code> - list of the nested Java model custom classes;</p>
</li>
<li>
<p><code>java.util.Set&lt;? extends Object&gt;</code> - set of the nested Java model custom classes;</p>
</li>
<li>
<p><code>java.util.Map&lt;String, ? extends Object&gt;</code> - map of the nested Java model custom classes;</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Nested Model Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ParameterMappingStrategy
public final class NestedModel {

    String stringParameter;

    BigDecimal bigDecimalParameter;

    Instant instantParameter;

    public NestedModel(final String stringParameter,
                       final BigDecimal bigDecimalParameter,
                       final Instant instantParameter) {
        this.stringParameter = stringParameter;
        this.bigDecimalParameter = bigDecimalParameter;
        this.instantParameter = instantParameter;
    }

    public NestedModel() {
    }

    @Override
    public int hashCode() {
        return Objects.hash(stringParameter, bigDecimalParameter, instantParameter);
    }

    @Override
    public boolean equals(final Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        final NestedModel that = (NestedModel) o;
        return stringParameter.equals(that.stringParameter) &amp;&amp;
                bigDecimalParameter.equals(that.bigDecimalParameter) &amp;&amp;
                instantParameter.equals(that.instantParameter);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As well as examples of more complex Java models that use a nested model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ParameterMappingStrategy
public final class ComplexRequest {

    final Integer integerParameter; <i class="conum" data-value="1"></i><b>(1)</b>

    final Status enumParameter; <i class="conum" data-value="1"></i><b>(1)</b>

    final List&lt;Status&gt; enumsParameter; <i class="conum" data-value="2"></i><b>(2)</b>

    final NestedModel nestedModelParameter; <i class="conum" data-value="3"></i><b>(3)</b>

    final List&lt;NestedModel&gt; nestedModelsParameter; <i class="conum" data-value="4"></i><b>(4)</b>

    public ComplexRequest(final Integer integerParameter,
                          final Status enumParameter,
                          final List&lt;Status&gt; enumsParameter,
                          final NestedModel nestedModelParameter,
                          final List&lt;NestedModel&gt; nestedModelsParameter) {
        this.integerParameter = integerParameter;
        this.enumParameter = enumParameter;
        this.enumsParameter = enumsParameter;
        this.nestedModelParameter = nestedModelParameter;
        this.nestedModelsParameter = nestedModelsParameter;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ParameterMappingStrategy
public final class ComplexResponse {

    Integer integerParameter; <i class="conum" data-value="1"></i><b>(1)</b>

    Status enumParameter; <i class="conum" data-value="1"></i><b>(1)</b>

    List&lt;Status&gt; enumsParameter; <i class="conum" data-value="2"></i><b>(2)</b>

    NestedModel nestedModelParameter; <i class="conum" data-value="3"></i><b>(3)</b>

    List&lt;NestedModel&gt; nestedModelsParameter; <i class="conum" data-value="4"></i><b>(4)</b>

    public Integer getIntegerParameter() {
        return integerParameter;
    }

    public Status getEnumParameter() {
        return enumParameter;
    }

    public List&lt;Status&gt; getEnumsParameter() {
        return enumsParameter;
    }

    public NestedModel getNestedModelParameter() {
        return nestedModelParameter;
    }

    public List&lt;NestedModel&gt; getNestedModelsParameter() {
        return nestedModelsParameter;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Primitive JSON type field.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Primitive JSON array type.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Nested JSON object.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>JSON array of JSON nested objects.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After creating model classes, it is necessary to create a request handler that uses the following models:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
public interface ComplexModelRestClient {

    @POST("/")
    CompletableFuture&lt;ComplexResponse&gt; post(ComplexRequest request);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the request is transferred in an HTTP body, the sent and received JSON objects must be the same:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(ComplexModelRestClient.class)
final class ComplexModelRestClientTest {

    private final Integer integerParameter = 1;

    private final Status enumParameter = created;

    private final List&lt;Status&gt; enumsParameter = List.of(created, approved);

    private final NestedModel nestedModelParameter =
            new NestedModel("test", new BigDecimal("3.14"), Instant.now());

    private final List&lt;NestedModel&gt; nestedModelsParameter = List.of(
            new NestedModel("test1", new BigDecimal("1.1"), Instant.now()),
            new NestedModel("test2", new BigDecimal("1.2"), Instant.now())
    );

    private ComplexModelRestClient restClient;

    @Mock(answer = RETURNS_DEEP_STUBS)
    @Alternative
    private HttpClientFactory httpClientFactory;

    void prepare() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(POST)
                        .setPath("/")
                        .setAnyBody()
                        .build(),
                new HttpResponseMock.Builder()
                        .setReturnRequestBody()
                        .build(),
                true
        );
    }

    @Test
    @BeforeThisTest(method = "prepare")
    void Should_support_complex_requests_and_responses() {
        final ComplexResponse response = assertDoesNotThrow(() -&gt;
                restClient.post(new ComplexRequest(
                        integerParameter,
                        enumParameter,
                        enumsParameter,
                        nestedModelParameter,
                        nestedModelsParameter
                )).join());

        assertEquals(integerParameter, response.getIntegerParameter());
        assertEquals(enumParameter, response.getEnumParameter());
        assertEquals(enumsParameter, response.getEnumsParameter());
        assertEquals(nestedModelParameter, response.getNestedModelParameter());
        assertEquals(nestedModelsParameter, response.getNestedModelsParameter());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-params" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-params</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="rest-client-query-params-static"><a class="anchor" href="#rest-client-query-params-static"></a><a class="link" href="#rest-client-query-params-static">6.5.4. Static Query Parameters</a></h4>
<div class="paragraph">
<p>For setting static query parameters, the RxMicro framework provides the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/AddQueryParameter.java" target="_blank" rel="noopener"><code>@AddQueryParameter</code></a> and
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/SetQueryParameter.java" target="_blank" rel="noopener"><code>@SetQueryParameter</code></a> annotations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
<i class="conum" data-value="1"></i><b>(1)</b>
@SetQueryParameter(name = "mode", value = "demo")
public interface StaticQueryParametersRestClient {

    @GET("/get1")
    CompletableFuture&lt;Void&gt; get1();

    @GET("/get2")
    <i class="conum" data-value="2"></i><b>(2)</b>
    @SetQueryParameter(name = "debug", value = "true")
    CompletableFuture&lt;Void&gt; get2();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If the static query parameter is set for the REST client, it is added to the HTTP requests for each handler.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If the static query parameter is set for the handler, it is added to the HTTP requests only for that handler.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In terms of the HTTP protocol, static query parameters do not differ from any standard parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(StaticQueryParametersRestClient.class)
final class StaticQueryParametersRestClientTest {

    private StaticQueryParametersRestClient restClient;

    @Mock(answer = RETURNS_DEEP_STUBS)
    @Alternative
    private HttpClientFactory httpClientFactory;

    private void prepareParentParamOnly() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(GET)
                        .setPath("/get1")
                        .setQueryParameters(QueryParams.of(
                                "mode", "demo"
                        ))
                        .build(),
                true
        );
    }

    @Test
    @BeforeThisTest(method = "prepareParentParamOnly")
    void Should_use_parent_param_only() {
        assertDoesNotThrow(() -&gt; restClient.get1().join());
    }

    private void prepareParentAndChildParams() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(GET)
                        .setPath("/get2")
                        .setQueryParameters(QueryParams.of(
                                "debug", true,
                                "mode", "demo"
                        ))
                        .build(),
                true
        );
    }

    @Test
    @BeforeThisTest(method = "prepareParentAndChildParams")
    void Should_use_parent_and_child_params() {
        assertDoesNotThrow(() -&gt; restClient.get2().join());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In order to understand the differences between the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/AddQueryParameter.java" target="_blank" rel="noopener"><code>@AddQueryParameter</code></a> and
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/SetQueryParameter.java" target="_blank" rel="noopener"><code>@SetQueryParameter</code></a> annotations, check out the following example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-rest-client/rest-client-params/src/main/java/io/rxmicro/examples/rest/client/params/ComplexStaticQueryParametersRestClient.java" target="_blank" rel="noopener"><code>ComplexStaticQueryParametersRestClient.java</code></a></p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-rest-client/rest-client-params/src/test/java/io/rxmicro/examples/rest/client/params/ComplexStaticQueryParametersRestClientTest.java" target="_blank" rel="noopener"><code>ComplexStaticQueryParametersRestClientTest.java</code></a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-params" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-params</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="rest-client-query-params-repeating"><a class="anchor" href="#rest-client-query-params-repeating"></a><a class="link" href="#rest-client-query-params-repeating">6.5.5. Repeating Query Parameters</a></h4>
<div class="paragraph">
<p>If the static query parameter of an HTTP request is a list of values, the list elements are transferred by default via the HTTP protocol as a string separated by the <code>|</code> symbol.</p>
</div>
<div class="paragraph">
<p>If You want the static query parameter to be repeated for each value, You need to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RepeatQueryParameter.java" target="_blank" rel="noopener"><code>@RepeatQueryParameter</code></a> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
public interface RepeatingQueryParamsRestClient {

    @PUT(value = "/", httpBody = false)
    @ParameterMappingStrategy
    CompletableFuture&lt;Void&gt; put(List&lt;Status&gt; singleHeader,
                                @RepeatQueryParameter List&lt;Status&gt; repeatingHeader);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As a result of converting the Java model to HTTP response, the result will be as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(RepeatingQueryParamsRestClient.class)
final class RepeatingQueryParamsRestClientTest {

    private RepeatingQueryParamsRestClient restClient;

    @Mock(answer = RETURNS_DEEP_STUBS)
    @Alternative
    private HttpClientFactory httpClientFactory;

    private void prepare() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(PUT)
                        .setPath("/")
                        .setQueryParameters(QueryParams.of(
                                "single_header", "created|approved|rejected", <i class="conum" data-value="1"></i><b>(1)</b>
                                "repeating_header", "created",
                                "repeating_header", "approved",               <i class="conum" data-value="2"></i><b>(2)</b>
                                "repeating_header", "rejected"
                        ))
                        .build(),
                true
        );
    }

    @Test
    @BeforeThisTest(method = "prepare")
    void Should_support_repeating_headers() {
        final List&lt;Status&gt; headers = List.of(created, approved, rejected);
        assertDoesNotThrow(() -&gt; restClient.put(headers, headers).join());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>By default, static query parameter list elements are transferred via the HTTP protocol as a string separated by the <code>|</code> symbol.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If the field is annotated by the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RepeatQueryParameter.java" target="_blank" rel="noopener"><code>@RepeatQueryParameter</code></a> annotation, then the static query parameter is repeated for each element of the list.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-params" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-params</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="rest-client-path-variables-basic"><a class="anchor" href="#rest-client-path-variables-basic"></a><a class="link" href="#rest-client-path-variables-basic">6.6. The <code>path variables</code> Support</a></h3>
<div class="sect3">
<h4 id="basic_rules_7"><a class="anchor" href="#basic_rules_7"></a><a class="link" href="#basic_rules_7">6.6.1. Basic Rules</a></h4>
<div class="paragraph">
<p>The RxMicro framework supports <code>path variables</code> in request models:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Request {

    <i class="conum" data-value="1"></i><b>(1)</b>
    @PathVariable
    String category;

    <i class="conum" data-value="2"></i><b>(2)</b>
    @PathVariable("class")
    String type;

    @PathVariable
    String subType;

    public String getCategory() {
        return category;
    }

    public String getType() {
        return type;
    }

    public String getSubType() {
        return subType;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>In order to declare a model field as the <code>path variable</code>, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/PathVariable.java" target="_blank" rel="noopener"><code>@PathVariable</code></a> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Using the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/PathVariable.java" target="_blank" rel="noopener"><code>@PathVariable</code></a> annotation, it is possible to specify the <code>path variable</code> name.<br>
<em>(If no name is specified, the model field name is used as the <code>path variable</code> name.)</em></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Unlike HTTP headers and parameters that are available also on the client side, <code>path variables</code> are available <strong>only</strong> within the HTTP request handlers.</p>
</div>
<div class="paragraph">
<p><strong>So for simplicity it is recommended to always use the model field name as the <code>path variable</code> name!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After creating model classes, it is necessary to create an HTTP request handler that uses the following model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
public interface RESTClient {

    <i class="conum" data-value="1"></i><b>(1)</b>
    @GET("/${category}/${class}-${subType}")
    CompletableFuture&lt;Void&gt; consume(final Request request);

    <i class="conum" data-value="1"></i><b>(1)</b>
    @GET("/${category}/${class}-${subType}")
    CompletableFuture&lt;Void&gt; consume(@PathVariable String category,       <i class="conum" data-value="2"></i><b>(2)</b>
                                    @PathVariable("class") String type,  <i class="conum" data-value="3"></i><b>(3)</b>
                                    @PathVariable String subType);
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When using <code>path variables</code> in request models, be sure to use <strong>all</strong> <code>path variables</code> in the URL Path.
<em>(Based on the analysis of the URL Path, and considering all <code>path variables</code>, the RxMicro framework generates the final URL to which the HTTP request will be sent.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>In order to declare a method parameter as <code>path variable</code>, You must use the <code>@PathVariable</code> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Using the <code>@PathVariable</code> annotation it is possible to specify the <code>path variable</code> name, which does not match the name of the method parameter.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The RxMicro framework recommends for request handlers that depend on 3 or more
<code>path variables</code>
to create separate classes of request model.</p>
</div>
<div class="paragraph">
<p><strong>Upon implementation of</strong>
<strong><code>path variables</code></strong>
<strong>directly into the handler, the code becomes hard to read!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Despite the different approaches to <code>path variables</code> handling support, in terms of the final URL the two above-mentioned handlers are absolutely equal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(RESTClient.class)
final class RESTClientTest {

    private RESTClient restClient;

    @Mock(answer = RETURNS_DEEP_STUBS)
    @Alternative
    private HttpClientFactory httpClientFactory;

    static Stream&lt;Consumer&lt;RESTClient&gt;&gt; clientMethodsProvider() {
        return Stream.of(
                client -&gt; client.consume(new Request("CATEGORY", "TYPE", "SUB-TYPE")).join(),
                client -&gt; client.consume("CATEGORY", "TYPE", "SUB-TYPE").join()
        );
    }

    private void prepare() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(HttpMethod.GET)
                        .setPath("/CATEGORY/TYPE-SUB-TYPE") <i class="conum" data-value="1"></i><b>(1)</b>
                        .build(),
                true
        );
    }

    @ParameterizedTest
    @MethodSource("clientMethodsProvider")
    @BeforeThisTest(method = "prepare")
    void Should_return_message_Hello_World(final Consumer&lt;RESTClient&gt; clientMethod) {
        assertDoesNotThrow(() -&gt; clientMethod.accept(restClient));
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>As a result of the HTTP request handler execution, the RxMicro framework generates the same URL: <code>/CATEGORY/TYPE-SUB-TYPE</code></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-path-variables" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-path-variables</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="supported_data_types_6"><a class="anchor" href="#supported_data_types_6"></a><a class="link" href="#supported_data_types_6">6.6.2. Supported Data Types</a></h4>
<div class="paragraph">
<p>The RxMicro framework supports the following Java types, which can be <code>path variables</code> of the request model:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>? extends Enum&lt;?&gt;</code>;</p>
</li>
<li>
<p><code>java.lang.Boolean</code>;</p>
</li>
<li>
<p><code>java.lang.Byte</code>;</p>
</li>
<li>
<p><code>java.lang.Short</code>;</p>
</li>
<li>
<p><code>java.lang.Integer</code>;</p>
</li>
<li>
<p><code>java.lang.Long</code>;</p>
</li>
<li>
<p><code>java.math.BigInteger</code>;</p>
</li>
<li>
<p><code>java.lang.Float</code>;</p>
</li>
<li>
<p><code>java.lang.Double</code>;</p>
</li>
<li>
<p><code>java.math.BigDecimal</code>;</p>
</li>
<li>
<p><code>java.lang.Character</code>;</p>
</li>
<li>
<p><code>java.lang.String</code>;</p>
</li>
<li>
<p><code>java.time.Instant</code>;</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For floating point numbers, it is suggested to use the <code>java.math.BigDecimal</code> type instead of <code>java.lang.Float</code> or <code>java.lang.Double</code>.</p>
</div>
<div class="paragraph">
<p>Using the <code>java.math.BigDecimal</code> allows excluding errors of decimal number notation.
<strong>This is particularly important if the decimal number is used to represent currency-related data!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="rest-client-internals-basic-section"><a class="anchor" href="#rest-client-internals-basic-section"></a><a class="link" href="#rest-client-internals-basic-section">6.7. Support of Internal Data Types</a></h3>
<div class="sect3">
<h4 id="basic_rules_8"><a class="anchor" href="#basic_rules_8"></a><a class="link" href="#basic_rules_8">6.7.1. Basic Rules</a></h4>
<div class="paragraph">
<p>The RxMicro framework works with internal data.
Due to this, the developer can extract additional information about the HTTP response.</p>
</div>
<div class="paragraph">
<p>To work with internal data, it is necessary to create a response model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Response {

    <i class="conum" data-value="1"></i><b>(1)</b>
    @ResponseStatusCode
    Integer status;

    <i class="conum" data-value="2"></i><b>(2)</b>
    HttpVersion version;

    <i class="conum" data-value="3"></i><b>(3)</b>
    HttpHeaders headers;

    <i class="conum" data-value="4"></i><b>(4)</b>
    @ResponseBody
    byte[] body;

    public Integer getStatus() {
        return status;
    }

    public HttpVersion getVersion() {
        return version;
    }

    public HttpHeaders getHeaders() {
        return headers;
    }

    public byte[] getBody() {
        return body;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To get the HTTP status code, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ResponseStatusCode.java" target="_blank" rel="noopener"><code>@ResponseStatusCode</code></a> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>To get the HTTP protocol version, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/HttpVersion.java" target="_blank" rel="noopener"><code>HttpVersion</code></a> type.<br>
<em>(Currently only <code>1.0</code> and <code>1.1</code> HTTP versions are supported.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>To get all HTTP headers, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/HttpHeaders.java" target="_blank" rel="noopener"><code>HttpHeaders</code></a> type.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>To get the response body content as a byte array, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ResponseBody.java" target="_blank" rel="noopener"><code>@ResponseBody</code></a> annotation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After creating model classes, it is necessary to create a REST client method that uses this model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
public interface RESTClient {

    @GET("/")
    CompletableFuture&lt;Response&gt; get();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>After creating the REST client, let&#8217;s check that everything works:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(RESTClient.class)
final class RESTClientTest {

    private RESTClient restClient;

    @Mock(answer = RETURNS_DEEP_STUBS)
    @Alternative
    private HttpClientFactory httpClientFactory;

    @Mock
    private HttpHeaders headers;

    private void prepare() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(GET)
                        .setPath("/")
                        .build(),
                new HttpResponseMock.Builder()
                        .setStatus(201)
                        .setVersion(HTTP_1_0)
                        .setHeaders(headers)
                        .setBody("&lt;BODY&gt;")
                        .build(),
                true
        );
    }

    @Test
    @BeforeThisTest(method = "prepare")
    void Should_support_internals() {
        final Response response = assertDoesNotThrow(() -&gt; restClient.get().join());

        assertEquals(201, response.getStatus());
        assertEquals(HTTP_1_0, response.getVersion());
        assertSame(headers, response.getHeaders());
        assertArrayEquals("&lt;BODY&gt;".getBytes(UTF_8), response.getBody());

    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-internals" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-internals</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="supported_internal_data_types_2"><a class="anchor" href="#supported_internal_data_types_2"></a><a class="link" href="#supported_internal_data_types_2">6.7.2. Supported Internal Data Types</a></h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. Supported internal data types for a response model.</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Java type</strong></th>
<th class="tableblock halign-left valign-top"><strong>RxMicro Annotation</strong></th>
<th class="tableblock halign-left valign-top"><strong>Is the annotation required?</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/HttpVersion.java" target="_blank" rel="noopener"><code>HttpVersion</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP protocol version</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/HttpHeaders.java" target="_blank" rel="noopener"><code>HttpHeaders</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP header model</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html" target="_blank" rel="noopener"><code>Integer</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ResponseStatusCode.java" target="_blank" rel="noopener"><code>@ResponseStatusCode</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Yes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP response status code</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>byte[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/ResponseBody.java" target="_blank" rel="noopener"><code>@ResponseBody</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Yes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP response body content</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Currently only <code>1.0</code> and <code>1.1</code> HTTP versions are supported.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="rest-client-versioning-section"><a class="anchor" href="#rest-client-versioning-section"></a><a class="link" href="#rest-client-versioning-section">6.8. Versioning of REST Clients</a></h3>
<div class="paragraph">
<p>The RxMicro framework supports versioning of REST Clients using two strategies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Versioning based on HTTP header analysis with the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/HttpStandardHeaderNames.java#L406" target="_blank" rel="noopener"><code>Api-Version</code></a> name.</p>
</li>
<li>
<p>Versioning based on URL Path fragment analysis.</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
<div class="sect3">
<h4 id="versioning_based_on_http_header_analysis_2"><a class="anchor" href="#versioning_based_on_http_header_analysis_2"></a><a class="link" href="#versioning_based_on_http_header_analysis_2">6.8.1. Versioning Based on HTTP Header Analysis</a></h4>
<div class="paragraph">
<p>The RxMicro framework allows creating identical REST clients that differ only in version:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
@Version(value = "v1", strategy = Version.Strategy.HEADER) <i class="conum" data-value="1"></i><b>(1)</b>
public interface OldRestClient {

    @PATCH("/patch")
    CompletableFuture&lt;Void&gt; update();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>REST client of the old <code>v1</code> version, using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Version.java#L89" target="_blank" rel="noopener"><code>Version.Strategy.HEADER</code></a> strategy;</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
@Version(value = "v2", strategy = Version.Strategy.HEADER) <i class="conum" data-value="1"></i><b>(1)</b>
public interface NewRestClient {

    @PATCH("/patch")
    CompletableFuture&lt;Void&gt; update();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>REST client of the new <code>v2</code> version, using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Version.java#L89" target="_blank" rel="noopener"><code>Version.Strategy.HEADER</code></a> strategy;</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The correctness of HTTP request generation for these REST clients can be checked with the following tests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(OldRestClient.class)
final class OldRestClientTest {

    private OldRestClient restClient;

    @Mock(answer = RETURNS_DEEP_STUBS)
    @Alternative
    private HttpClientFactory httpClientFactory;

    private void prepare() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(HttpMethod.PATCH)
                        .setPath("/patch")
                        .setHeaders(HttpHeaders.of(
                                API_VERSION, "v1"
                        ))
                        .build(),
                true
        );
    }

    @Test
    @BeforeThisTest(method = "prepare")
    void Should_add_version_url_path() {
        assertDoesNotThrow(() -&gt; restClient.update().join());
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(NewRestClient.class)
final class NewRestClientTest {

    private NewRestClient restClient;

    @Mock(answer = RETURNS_DEEP_STUBS)
    @Alternative
    private HttpClientFactory httpClientFactory;

    private void prepare() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(HttpMethod.PATCH)
                        .setPath("/patch")
                        .setHeaders(HttpHeaders.of(
                                API_VERSION, "v2"
                        ))
                        .build(),
                true
        );
    }

    @Test
    @BeforeThisTest(method = "prepare")
    void Should_add_version_url_path() {
        assertDoesNotThrow(() -&gt; restClient.update().join());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-versioning-header" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-versioning-header</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="versioning_based_on_url_path_fragment_analysis_2"><a class="anchor" href="#versioning_based_on_url_path_fragment_analysis_2"></a><a class="link" href="#versioning_based_on_url_path_fragment_analysis_2">6.8.2. Versioning Based on URL Path Fragment Analysis</a></h4>
<div class="paragraph">
<p>The RxMicro framework allows creating identical REST clients that differ only in version:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
@Version(value = "v1", strategy = Version.Strategy.URL_PATH) <i class="conum" data-value="1"></i><b>(1)</b>
public interface OldRestClient {

    @PATCH("/patch")
    CompletableFuture&lt;Void&gt; update();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>REST client of the old <code>v1</code> version, using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Version.java#L70" target="_blank" rel="noopener"><code>Version.Strategy.URL_PATH</code></a> strategy;</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
@Version(value = "v2", strategy = Version.Strategy.URL_PATH) <i class="conum" data-value="1"></i><b>(1)</b>
public interface NewRestClient {

    @PATCH("/patch")
    CompletableFuture&lt;Void&gt; update();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>REST client of the new <code>v2</code> version, using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/Version.java#L70" target="_blank" rel="noopener"><code>Version.Strategy.URL_PATH</code></a> strategy;</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The correctness of HTTP request generation for these REST clients can be checked with the following tests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(OldRestClient.class)
final class OldRestClientTest {

    private OldRestClient restClient;

    @Mock(answer = RETURNS_DEEP_STUBS)
    @Alternative
    private HttpClientFactory httpClientFactory;

    private void prepare() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(HttpMethod.PATCH)
                        .setPath("/v1/patch")
                        .build(),
                true
        );
    }

    @Test
    @BeforeThisTest(method = "prepare")
    void Should_add_version_url_path() {
        assertDoesNotThrow(() -&gt; restClient.update().join());
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(NewRestClient.class)
final class NewRestClientTest {

    private NewRestClient restClient;

    @Mock(answer = RETURNS_DEEP_STUBS)
    @Alternative
    private HttpClientFactory httpClientFactory;

    private void prepare() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(HttpMethod.PATCH)
                        .setPath("/v2/patch")
                        .build(),
                true
        );
    }

    @Test
    @BeforeThisTest(method = "prepare")
    void Should_add_version_url_path() {
        assertDoesNotThrow(() -&gt; restClient.update().join());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-versioning-url-path" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-versioning-url-path</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="rest-client-base-url-path-section"><a class="anchor" href="#rest-client-base-url-path-section"></a><a class="link" href="#rest-client-base-url-path-section">6.9. Base URL Path for All Handlers</a></h3>
<div class="paragraph">
<p>To configure a base URL Path for all methods sending an HTTP request, the RxMicro framework provides the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/BaseUrlPath.java" target="_blank" rel="noopener"><code>@BaseUrlPath</code></a> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
@BaseUrlPath("base-url-path")
public interface RESTClient {

    @GET("/path")
    CompletableFuture&lt;Void&gt; path();
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(RESTClient.class)
final class RESTClientTest {

    private RESTClient restClient;

    @Mock(answer = RETURNS_DEEP_STUBS)
    @Alternative
    private HttpClientFactory httpClientFactory;

    private void prepare() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(HttpMethod.GET)
                        .setPath("/base-url-path/path")
                        .build(),
                true
        );
    }

    @Test
    @BeforeThisTest(method = "prepare")
    void Should_support_base_url() {
        assertDoesNotThrow(() -&gt; restClient.path().join());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-base-url-path" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-base-url-path</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="rest-client-expressions-section"><a class="anchor" href="#rest-client-expressions-section"></a><a class="link" href="#rest-client-expressions-section">6.10. Expressions</a></h3>
<div class="paragraph">
<p>The RxMicro framework supports expressions for REST clients.</p>
</div>
<div class="paragraph">
<p>Expressions can be useful to send configuration parameters to the server.</p>
</div>
<div class="paragraph">
<p>To use expressions You need to create a configuration class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class CustomRestClientConfig extends RestClientConfig {

    private boolean useProxy = true;

    private Mode mode = Mode.PRODUCTION;

    public boolean isUseProxy() {
        return useProxy;
    }

    public CustomRestClientConfig setUseProxy(final boolean useProxy) {
        this.useProxy = useProxy;
        return this;
    }

    public Mode getMode() {
        return mode;
    }

    public CustomRestClientConfig setMode(final Mode mode) {
        this.mode = mode;
        return this;
    }

    @Override
    public CustomRestClientConfig setSchema(final ProtocolSchema schema) {
        return (CustomRestClientConfig) super.setSchema(schema);
    }

    @Override
    public CustomRestClientConfig setHost(final String host) {
        return (CustomRestClientConfig) super.setHost(host);
    }

    @Override
    public CustomRestClientConfig setPort(final int port) {
        return (CustomRestClientConfig) super.setPort(port);
    }

    public enum Mode {

        PRODUCTION,

        TEST
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>, which must meet the following requirements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The class must be public.</p>
</li>
<li>
<p>The class must contain a public constructor without parameters.</p>
</li>
<li>
<p>The class must extend the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-client/src/main/java/io/rxmicro/rest/client/RestClientConfig.java" target="_blank" rel="noopener"><code>RestClientConfig</code></a> class.</p>
</li>
<li>
<p>To set property values, the class must contain <a href="https://www.w3schools.com/java/java_encapsulation.asp" target="_blank" rel="noopener"><code>setters</code></a>.<br>
<em>(Only those fields, that will contain <code>setters</code>, can be initialized!)</em></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To attach this configuration class to a REST client, You must specify it in the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-client/src/main/java/io/rxmicro/rest/client/RestClient.java" target="_blank" rel="noopener"><code>@RestClient</code></a> annotation parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient(
        configClass = CustomRestClientConfig.class,    <i class="conum" data-value="1"></i><b>(1)</b>
        configNameSpace = "custom"                     <i class="conum" data-value="2"></i><b>(2)</b>
)
@AddHeader(name = "Use-Proxy", value = "${useProxy}")  <i class="conum" data-value="3"></i><b>(3)</b>
public interface RESTClient {

    @PUT("/")
    @AddHeader(name = "Debug", value = "Use-Proxy=${useProxy}, Mode=${mode}")             <i class="conum" data-value="3"></i><b>(3)</b>
    @AddHeader(name = "Endpoint", value = "Schema=${schema}, Host=${host}, Port=${port}") <i class="conum" data-value="3"></i><b>(3)</b>
    CompletableFuture&lt;Void&gt; put();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Attaching the configuration class to a REST client.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>name space</code> specification for this configuration file.<br>
<em>(For more information on <code>name space</code>, refer to the <a href="core.html#configuration-section">core.html</a> section)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>After attaching the configuration class, its <code>properties</code> can be used in expressions.</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><a href="#core-config-user-defined-config">All packages with custom config classes must be exported to <code>rxmicro.reflection</code> module!</a></p>
</div>
<div class="paragraph">
<p>So dont&#8217;t forget to add the following <code>opens</code> instruction to your <code>module-info.java</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">exports io.rxmicro.examples.rest.client.expressions to
        rxmicro.reflection;</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The functionality of expressions can be demonstrated through the test:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(RESTClient.class)
final class RESTClientTest {

    @WithConfig("custom")
    private static final CustomRestClientConfig config =
            new CustomRestClientConfig()
                    .setHost("rxmicro.io")
                    .setPort(8443)
                    .setSchema(ProtocolSchema.HTTPS)
                    .setUseProxy(false)
                    .setMode(CustomRestClientConfig.Mode.TEST);

    private RESTClient restClient;

    @Mock(answer = RETURNS_DEEP_STUBS)
    @Alternative
    private HttpClientFactory httpClientFactory;

    private void prepare() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(HttpMethod.PUT)
                        .setPath("/")
                        .setHeaders(HttpHeaders.of(
                                "Use-Proxy", "false",
                                "Debug", "Use-Proxy=false, Mode=TEST",
                                "Endpoint", "Schema=HTTPS, Host=rxmicro.io, Port=8443"
                        ))
                        .build(),
                true
        );
    }

    @Test
    @BeforeThisTest(method = "prepare")
    void Should_support_expressions() {
        assertDoesNotThrow(() -&gt; restClient.put().join());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-expressions" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-expressions</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="rest-controller-request-id-section"><a class="anchor" href="#rest-controller-request-id-section"></a><a class="link" href="#rest-controller-request-id-section">6.11. Request ID</a></h3>
<div class="paragraph">
<p>The Request Id feature described at <a href="{monitoring}.html#monitoring-request-id-section">Monitoring</a> section.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="rest-client-partial-implementation-section"><a class="anchor" href="#rest-client-partial-implementation-section"></a><a class="link" href="#rest-client-partial-implementation-section">6.12. Partial Implementation</a></h3>
<div class="paragraph">
<p>If the REST client generated by the <code>RxMicro Annotation Processor</code> contains errors, incorrect or non-optimized logic, the developer can use the <code>Partial Implementation</code> feature.</p>
</div>
<div class="paragraph">
<p>This feature allows You to implement HTTP request handlers for the REST client on Your own, instead of generating them by the RxMicro framework.</p>
</div>
<div class="paragraph">
<p>To activate this feature, You need to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-client/src/main/java/io/rxmicro/rest/client/PartialImplementation.java" target="_blank" rel="noopener"><code>@PartialImplementation</code></a>
annotation, and specify an abstract class that contains a partial implementation of HTTP request handler(s) for REST client:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
<i class="conum" data-value="1"></i><b>(1)</b>
@PartialImplementation(AbstractRESTClient.class)
public interface RESTClient {

    @GET("/")
    CompletableFuture&lt;Void&gt; generatedMethod();

    CompletableFuture&lt;Void&gt; userDefinedMethod();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-client/src/main/java/io/rxmicro/rest/client/PartialImplementation.java" target="_blank" rel="noopener"><code>@PartialImplementation</code></a>
annotation, the <code>AbstractRESTClient</code> class is specified.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An <code>AbstractRESTClient</code> contains the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">abstract class AbstractRESTClient extends AbstractRestClient implements RESTClient {

    @Override
    public final CompletableFuture&lt;Void&gt; userDefinedMethod() {
        return CompletableFuture.completedFuture(null);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An abstract class that contains a partial implementation must meet the following requirements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The class must be an <code>abstract</code> one.</p>
</li>
<li>
<p>The class must extend the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-client/src/main/java/io/rxmicro/rest/client/detail/AbstractRestClient.java" target="_blank" rel="noopener"><code>AbstractRestClient</code></a> one.</p>
</li>
<li>
<p>The class must implement the REST client interface.</p>
</li>
<li>
<p>The class must contain an implementation of all methods that are not generated automatically.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In terms of infrastructure, the HTTP request handlers generated and defined by the developer for REST client do not differ:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(RESTClient.class)
final class RESTClientTest {

    private RESTClient restClient;

    @Mock(answer = RETURNS_DEEP_STUBS)
    @Alternative
    private HttpClientFactory httpClientFactory;

    private void prepareGeneratedMethod() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(GET)
                        .setPath("/")
                        .build(),
                true
        );
    }

    @Test
    @BeforeThisTest(method = "prepareGeneratedMethod")
    void Should_invoke_generated_method() {
        assertDoesNotThrow(() -&gt; restClient.generatedMethod().join());
    }

    private void prepareUserDefinedMethod() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setAnyRequest()
                        .build(),
                true
        );
    }

    @Test
    @BeforeThisTest(method = "prepareUserDefinedMethod")
    void Should_invoke_user_defined_method() {
        assertDoesNotThrow(() -&gt; restClient.userDefinedMethod().join());

        final HttpClient httpClient = getPreparedHttpClientMock();
        verify(httpClient, never()).sendAsync(anyString(), anyString(), any());
        verify(httpClient, never()).sendAsync(anyString(), anyString(), any(), any());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-partial-implementation" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-client/rest-client-partial-implementation</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="rest-client-rest-client-generator-config-section"><a class="anchor" href="#rest-client-rest-client-generator-config-section"></a><a class="link" href="#rest-client-rest-client-generator-config-section">6.13. Configuring the Code Generation Process</a></h3>
<div class="paragraph">
<p>The RxMicro framework provides an option to configure the code generation process for REST client.
For this purpose, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-client/src/main/java/io/rxmicro/rest/client/RestClientGeneratorConfig.java" target="_blank" rel="noopener"><code>@RestClientGeneratorConfig</code></a>
annotation, that annotates the <code>module-info.java</code> module descriptor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.rxmicro.rest.client.RestClientGeneratorConfig;
import io.rxmicro.rest.model.ClientExchangeFormatModule;
import io.rxmicro.rest.model.GenerateOption;

@RestClientGeneratorConfig(
        exchangeFormat = ClientExchangeFormatModule.AUTO_DETECT,                    <i class="conum" data-value="1"></i><b>(1)</b>
        generateRequestValidators = GenerateOption.DISABLED,                        <i class="conum" data-value="2"></i><b>(2)</b>
        generateResponseValidators = GenerateOption.DISABLED,                       <i class="conum" data-value="3"></i><b>(3)</b>
        requestValidationMode =
                RestClientGeneratorConfig.RequestValidationMode.RETURN_ERROR_SIGNAL <i class="conum" data-value="4"></i><b>(4)</b>
)
module rest.client.generator {
    requires rxmicro.rest.client;
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>exchangeFormat</code> parameter allows You to specify a format for message exchange with a server.<br>
<em>(By default, it is used the message exchange format which added to the <code>module-info.java</code> descriptor.
If several modules supporting the message exchange format are added to the <code>module-info.java</code> descriptor, then using the <code>exchangeFormat</code>, You need to specify which module should be used for REST clients.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>generateRequestValidators</code> parameter allows enabling/disabling the option of generating HTTP request validators for all REST client methods in the project.<br>
<em>(The <code>DISABLED</code> value means that validators won&#8217;t be generated by the <code>RxMicro Annotation Processor</code>.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>generateResponseValidators</code> parameter allows enabling/disabling the option of generating HTTP response validators for all REST client methods in the project.<br>
<em>(The <code>AUTO_DETECT</code> value means that validators will be generated only if the developer adds the <a href="#validation-section"><code>rxmicro.validation</code></a> module to the <code>module-info.java</code> descriptor.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The <code>requestValidationMode</code> parameter specifies how the HTTP request parameters should be checked.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the <code>requestValidationMode</code> parameter is equal to the <code>RETURN_ERROR_SIGNAL</code>, then error handling should be performed in reactive style:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">restClient.put("not_valid_email")
        .exceptionally(throwable -&gt; {
            // do something with ValidationException
            return null;
        });</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>requestValidationMode</code> parameter is equal to the <code>THROW_EXCEPTION</code>, then it is necessary to catch the exception</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">try {
    restClient.put("not_valid_email");
} catch (final ValidationException e) {
    // do something with ValidationException
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The RxMicro team strong recommends using the <code>AUTO_DETECT</code> generate option always!
(This is default value for <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-client/src/main/java/io/rxmicro/rest/client/RestClientGeneratorConfig.java" target="_blank" rel="noopener"><code>@RestClientGeneratorConfig</code></a> annotation).</p>
</div>
<div class="paragraph">
<p><em>(HTTP request validation can be useful for identifying errors in business task implementation algorithms.
For example, instead of returning an incorrect request model to a server, the REST client will throw an error.
This approach increases the speed of error search and debugging of the source code that performs the business task.)</em></p>
</div>
<div class="paragraph">
<p><strong>FYI:</strong> By default the request validators are generated but not invoked!
To activate the validation of requests it is necessary to set <code>enableAdditionalValidations</code> property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">new Configs.Builder()
        .withConfigs(new RestClientConfig()
                .setEnableAdditionalValidations(true)) <i class="conum" data-value="1"></i><b>(1)</b>
        .build();</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Enables the requests validators</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">export rest-client.enableAdditionalValidations=true <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Enables the response validators</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>or using any other <a href="#core-config-types">supported config types</a></p>
</div>
<div class="paragraph">
<p>Thus the RxMicro team recommends the following approach:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Your project configuration must enable generation of validators for all possible model classes.</p>
</li>
<li>
<p>Your <code>development</code> and <code>staging</code> environment must enable additional validation.</p>
</li>
<li>
<p>Your <code>production</code> environment must disable additional validation!</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="validation-section"><a class="anchor" href="#validation-section"></a><a class="link" href="#validation-section">7. Validation</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The RxMicro framework supports validation of HTTP requests and responses.</p>
</div>
<div class="paragraph">
<p>All classes and annotations required for data validation are available in the
<a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-validation" target="_blank" rel="noopener"><code>rxmicro.validation</code></a> module.</p>
</div>
<div style="page-break-after: always;"></div>
<div class="sect2">
<h3 id="validation-prepare-section"><a class="anchor" href="#validation-prepare-section"></a><a class="link" href="#validation-prepare-section">7.1. Preparatory Steps</a></h3>
<div class="paragraph">
<p>To activate the validation module in a microservices project, the following steps must be taken:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add the required dependencies to <code>pom.xml</code>.</p>
</li>
<li>
<p>Add the <code>rxmicro.validation</code> module to <code>module-info.java</code>.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="adding_the_required_dependencies_3"><a class="anchor" href="#adding_the_required_dependencies_3"></a><a class="link" href="#adding_the_required_dependencies_3">7.1.1. Adding the Required Dependencies:</a></h4>
<div class="paragraph">
<p>To activate the validation module in a microservices project, it is necessary to add the <code>rxmicro-validation</code> library:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
        &lt;artifactId&gt;rxmicro-validation&lt;/artifactId&gt;
        &lt;version&gt;${rxmicro.version}&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="adding_the_rxmicro_validation_module_to_module_info_java"><a class="anchor" href="#adding_the_rxmicro_validation_module_to_module_info_java"></a><a class="link" href="#adding_the_rxmicro_validation_module_to_module_info_java">7.1.2. Adding the <code>rxmicro.validation</code> Module to <code>module-info.java</code></a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">module example {
    requires rxmicro.validation; <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Adding the request and response validation module.</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="validation-std-constraints-section"><a class="anchor" href="#validation-std-constraints-section"></a><a class="link" href="#validation-std-constraints-section">7.2. Built-in Constraints.</a></h3>
<div class="paragraph">
<p>The RxMicro framework supports the following built-in constraints, that are available at the
<a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint" target="_blank" rel="noopener"><code>io.rxmicro.validation.constraint</code></a> package:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. Supported Built-in Constraints.</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Annotation</strong></th>
<th class="tableblock halign-left valign-top"><strong>Supported Type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/AllowEmptyString.java" target="_blank" rel="noopener"><code>@AllowEmptyString</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element may be optional, i.e. <code>empty string</code> BUT must be not <code>null</code>!</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/AssertFalse.java" target="_blank" rel="noopener"><code>@AssertFalse</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Boolean.html" target="_blank" rel="noopener"><code>java.lang.Boolean</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be <code>false</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/AssertFalse.java" target="_blank" rel="noopener"><code>@AssertTrue</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Boolean.html" target="_blank" rel="noopener"><code>java.lang.Boolean</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be <code>true</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Base64URLEncoded.java" target="_blank" rel="noopener"><code>@Base64URLEncoded</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The annotated element must be a valid Base64 string:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://tools.ietf.org/html/rfc4648#section-4" target="_blank" rel="noopener">Base</a>;</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc4648#section-5" target="_blank" rel="noopener">URL</a></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/CountryCode.java" target="_blank" rel="noopener"><code>@CountryCode</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The annotated element must be a valid country code:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2" target="_blank" rel="noopener">ISO 3166-1 alpha2</a>;</p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-3" target="_blank" rel="noopener">ISO 3166-1 alpha3</a>;</p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/ISO_3166-1_numeric" target="_blank" rel="noopener">ISO 3166-1 numeric</a>;</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/DigitsOnly.java" target="_blank" rel="noopener"><code>@DigitsOnly</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a string value with digit characters only.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Email.java" target="_blank" rel="noopener"><code>@Email</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a <a href="https://tools.ietf.org/html/rfc5322#section-3.4.1" target="_blank" rel="noopener">well-formed email address</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/EndsWith.java" target="_blank" rel="noopener"><code>@EndsWith</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element value must end with the provided suffix.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Enumeration.java" target="_blank" rel="noopener"><code>@Enumeration</code></a></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Character.html" target="_blank" rel="noopener"><code>java.lang.Character</code></a></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be an element of the predefined enumeration.</p>
<p class="tableblock"><em>This validation rule is useful when a Java <code>enum</code> type is not applicable.</em>
<em>For example: if an enum item name equals to a Java keyword.</em>
<em>To solve this issue use <code>@Enumeration</code> annotation, otherwise use a Java <code>enum</code>.</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Future.java" target="_blank" rel="noopener"><code>@Future</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/time/Instant.html" target="_blank" rel="noopener"><code>java.time.Instant</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be an instant in the future.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/FutureOrPresent.java" target="_blank" rel="noopener"><code>@FutureOrPresent</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/time/Instant.html" target="_blank" rel="noopener"><code>java.time.Instant</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be an instant in the present or in the future.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/HostName.java" target="_blank" rel="noopener"><code>@HostName</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a valid <a href="https://tools.ietf.org/html/rfc1034#section-3.1" target="_blank" rel="noopener">host name</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/IP.java" target="_blank" rel="noopener"><code>@IP</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The annotated element must be a valid IP address:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/IPv4" target="_blank" rel="noopener">IP version 4</a>;</p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/IPv6" target="_blank" rel="noopener">IP version 6</a>;</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Lat.java" target="_blank" rel="noopener"><code>@Lat</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/math/BigDecimal.html" target="_blank" rel="noopener"><code>java.math.BigDecimal</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a <a href="https://en.wikipedia.org/wiki/Latitude" target="_blank" rel="noopener">valid latitude coordinate</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/LatinAlphabetOnly.java" target="_blank" rel="noopener"><code>@LatinAlphabetOnly</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a string with latin alphabet letters only.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Length.java" target="_blank" rel="noopener"><code>@Length</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must have the expected string length.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Lng.java" target="_blank" rel="noopener"><code>@Lng</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/math/BigDecimal.html" target="_blank" rel="noopener"><code>java.math.BigDecimal</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a <a href="https://en.wikipedia.org/wiki/Longitude" target="_blank" rel="noopener">valid longitude coordinate</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Lowercase.java" target="_blank" rel="noopener"><code>@Lowercase</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must a lowercase string.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/MaxDouble.java" target="_blank" rel="noopener"><code>@MaxDouble</code></a></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Float.html" target="_blank" rel="noopener"><code>java.lang.Float</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Double.html" target="_blank" rel="noopener"><code>java.lang.Double</code></a>;</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a double whose value must be lower to the specified maximum.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/MaxInt.java" target="_blank" rel="noopener"><code>@MaxInt</code></a></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Byte.html" target="_blank" rel="noopener"><code>java.lang.Byte</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Short.html" target="_blank" rel="noopener"><code>java.lang.Short</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html" target="_blank" rel="noopener"><code>java.lang.Integer</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Long.html" target="_blank" rel="noopener"><code>java.lang.Long</code></a>;</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a <code>byte</code> or <code>short</code> or <code>integer</code> or <code>long</code> whose value must be lower or equal to the specified maximum.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/MaxLength.java" target="_blank" rel="noopener"><code>@MaxLength</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must have a string length whose value must be lower or equal to the specified maximum.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/MaxNumber.java" target="_blank" rel="noopener"><code>@MaxNumber</code></a></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Byte.html" target="_blank" rel="noopener"><code>java.lang.Byte</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Short.html" target="_blank" rel="noopener"><code>java.lang.Short</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html" target="_blank" rel="noopener"><code>java.lang.Integer</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Long.html" target="_blank" rel="noopener"><code>java.lang.Long</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/math/BigInteger.html" target="_blank" rel="noopener"><code>java.math.BigInteger</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Float.html" target="_blank" rel="noopener"><code>java.lang.Float</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Double.html" target="_blank" rel="noopener"><code>java.lang.Double</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/math/BigDecimal.html" target="_blank" rel="noopener"><code>java.math.BigDecimal</code></a>;</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a number whose value must be lower or equal to the specified maximum.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/MaxSize.java" target="_blank" rel="noopener"><code>@MaxSize</code></a></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html" target="_blank" rel="noopener"><code>java.util.List</code></a></p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Set.html" target="_blank" rel="noopener"><code>java.util.Set</code></a></p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Map.html" target="_blank" rel="noopener"><code>java.util.Map</code></a></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must have a list size whose value must be lower or equal to the specified maximum.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/MinDouble.java" target="_blank" rel="noopener"><code>@MinDouble</code></a></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Float.html" target="_blank" rel="noopener"><code>java.lang.Float</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Double.html" target="_blank" rel="noopener"><code>java.lang.Double</code></a>;</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a double whose value must be higher or equal to the specified minimum.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/MinInt.java" target="_blank" rel="noopener"><code>@MinInt</code></a></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Byte.html" target="_blank" rel="noopener"><code>java.lang.Byte</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Short.html" target="_blank" rel="noopener"><code>java.lang.Short</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html" target="_blank" rel="noopener"><code>java.lang.Integer</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Long.html" target="_blank" rel="noopener"><code>java.lang.Long</code></a>;</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a <code>byte</code> or <code>short</code> or <code>integer</code> or <code>long</code> whose value must be higher or equal to the specified minimum.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/MinLength.java" target="_blank" rel="noopener"><code>@MinLength</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must have a string length whose value must be higher or equal to the specified minimum.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/MinNumber.java" target="_blank" rel="noopener"><code>@MinNumber</code></a></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Byte.html" target="_blank" rel="noopener"><code>java.lang.Byte</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Short.html" target="_blank" rel="noopener"><code>java.lang.Short</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html" target="_blank" rel="noopener"><code>java.lang.Integer</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Long.html" target="_blank" rel="noopener"><code>java.lang.Long</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/math/BigInteger.html" target="_blank" rel="noopener"><code>java.math.BigInteger</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Float.html" target="_blank" rel="noopener"><code>java.lang.Float</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Double.html" target="_blank" rel="noopener"><code>java.lang.Double</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/math/BigDecimal.html" target="_blank" rel="noopener"><code>java.math.BigDecimal</code></a>;</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a number whose value must be higher or equal to the specified minimum.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/MinSize.java" target="_blank" rel="noopener"><code>@MinSize</code></a></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html" target="_blank" rel="noopener"><code>java.util.List</code></a></p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Set.html" target="_blank" rel="noopener"><code>java.util.Set</code></a></p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Map.html" target="_blank" rel="noopener"><code>java.util.Map</code></a></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must have a list size whose value must be higher or equal to the specified minimum.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Nullable.java" target="_blank" rel="noopener"><code>@Nullable</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>? extends java.lang.Object</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element may be optional, i.e. <code>null</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/NullableArrayItem.java" target="_blank" rel="noopener"><code>@NullableArrayItem</code></a></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html" target="_blank" rel="noopener"><code>java.util.List</code></a></p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Set.html" target="_blank" rel="noopener"><code>java.util.Set</code></a></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated array element may be optional, i.e. <code>null</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Numeric.java" target="_blank" rel="noopener"><code>@Numeric</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/math/BigDecimal.html" target="_blank" rel="noopener"><code>java.math.BigDecimal</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a decimal within accepted range (scale and precision).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Past.java" target="_blank" rel="noopener"><code>@Past</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/time/Instant.html" target="_blank" rel="noopener"><code>java.time.Instant</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be an instant in the past.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/PastOrPresent.java" target="_blank" rel="noopener"><code>@PastOrPresent</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/time/Instant.html" target="_blank" rel="noopener"><code>java.time.Instant</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be an instant in the past or in the present.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Pattern.java" target="_blank" rel="noopener"><code>@Pattern</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated <code>String</code> must match the specified regular expression.
The regular expression follows the Java regular expression conventions.</p>
<p class="tableblock"><em>(See <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/regex/Pattern.html" target="_blank" rel="noopener"><code>java.util.regex.Pattern</code></a>)</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Phone.java" target="_blank" rel="noopener"><code>@Phone</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a <a href="https://en.wikipedia.org/wiki/National_conventions_for_writing_telephone_numbers" target="_blank" rel="noopener">valid phone number</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Size.java" target="_blank" rel="noopener"><code>@Size</code></a></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html" target="_blank" rel="noopener"><code>java.util.List</code></a></p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Set.html" target="_blank" rel="noopener"><code>java.util.Set</code></a></p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Map.html" target="_blank" rel="noopener"><code>java.util.Map</code></a></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must have the expected list size.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Skype.java" target="_blank" rel="noopener"><code>@Skype</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a valid <code>skype</code> number.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/StartsWith.java" target="_blank" rel="noopener"><code>@StartsWith</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element value must start with the provided prefix.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/SubEnum.java" target="_blank" rel="noopener"><code>@SubEnum</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Enum.html" target="_blank" rel="noopener"><code>? extends java.lang.Enum</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be an enumeration with predefined sub sequence.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Telegram.java" target="_blank" rel="noopener"><code>@Telegram</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a <a href="https://en.wikipedia.org/wiki/National_conventions_for_writing_telephone_numbers" target="_blank" rel="noopener">valid <code>telegram</code> number</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/TruncatedTime.java" target="_blank" rel="noopener"><code>@TruncatedTime</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/time/Instant.html" target="_blank" rel="noopener"><code>java.time.Instant</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be an instant with truncated time value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/UniqueItems.java" target="_blank" rel="noopener"><code>@UniqueItems</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html" target="_blank" rel="noopener"><code>java.util.List</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must contain unique items.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Uppercase.java" target="_blank" rel="noopener"><code>@Uppercase</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must an uppercase string.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/URI.java" target="_blank" rel="noopener"><code>@URI</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a valid <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/net/URI.html" target="_blank" rel="noopener"><code>java.net.URI</code></a> address.</p>
<p class="tableblock"><em>(See <a href="https://en.wikipedia.org/wiki/Uniform_Resource_Identifier" target="_blank" rel="noopener">Uniform Resource Identifier</a>)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/URLEncoded.java" target="_blank" rel="noopener"><code>@URLEncoded</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a <a href="https://en.wikipedia.org/wiki/Percent-encoding" target="_blank" rel="noopener">valid URL encoded value</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Viber.java" target="_blank" rel="noopener"><code>@Viber</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a <a href="https://en.wikipedia.org/wiki/National_conventions_for_writing_telephone_numbers" target="_blank" rel="noopener">valid <code>viber</code> number</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/WhatsApp.java" target="_blank" rel="noopener"><code>@WhatsApp</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" target="_blank" rel="noopener"><code>java.lang.String</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The annotated element must be a <a href="https://en.wikipedia.org/wiki/National_conventions_for_writing_telephone_numbers" target="_blank" rel="noopener">valid <code>whatsapp</code> number</a>.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The RxMicro framework analyzes built-in constraints when <a href="#project-documentation-section">drawing up the project documentation.</a></p>
</div>
<div class="paragraph">
<p><strong>Therefore, a properly selected annotation, in addition to its main purpose, makes it possible to automatically generate more accurate project documentation!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="http_requests_server_validation"><a class="anchor" href="#http_requests_server_validation"></a><a class="link" href="#http_requests_server_validation">7.3. HTTP Requests Server Validation</a></h3>
<div class="paragraph">
<p>After activation of the <code>rxmicro.validation</code> module in the <code>module-info.java</code> descriptor</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">module examples.validation.server.basic {
    requires rxmicro.rest.server.netty;
    requires rxmicro.rest.server.exchange.json;
    requires rxmicro.validation; <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>rxmicro.validation</code> is a module for request and response validation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>the developer can use <a href="#validation-std-constraints-section">built-in constraints</a> to validate HTTP request parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class MicroService {

    @PUT(value = "/", httpBody = false)
    void consume(final @Email String email) { <i class="conum" data-value="1"></i><b>(1)</b>
        System.out.println("Email: " + email);
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>email</code> parameter is annotated by the <code>@Email</code> annotation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Due to this annotation the <code>RxMicro Annotation Processor</code> will automatically generate a validator for <code>email</code> HTTP parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceTest {

    private BlockingHttpClient blockingHttpClient;

    private SystemOut systemOut;

    @ParameterizedTest
    @CsvSource({
            "/,                     Parameter \"email\" is required!",  <i class="conum" data-value="1"></i><b>(1)</b>
            "/?email=,              Parameter \"email\" is required!",
            "/?email=rxmicro,       Invalid parameter \"email\": Expected a valid email format!",
            "/?email=rxmicro.io,    Invalid parameter \"email\": Expected a valid email format!",
            "/?email=@rxmicro.io,   Invalid parameter \"email\": Expected a valid email format!",
            "/?email=rxmicro.io@,   Invalid parameter \"email\": Expected a valid email format!",
            "/?email=@.rxmicro.io,  Invalid parameter \"email\": Expected a valid email format!",
            "/?email=rxmicro.io@.,  Invalid parameter \"email\": Expected a valid domain name!"
    })
    void Should_return_invalid_request_status(final String path,
                                              final String expectedErrorMessage) {
        final ClientHttpResponse response = blockingHttpClient.put(path);

        assertEquals(jsonErrorObject(expectedErrorMessage), response.getBody()); <i class="conum" data-value="2"></i><b>(2)</b>
        assertEquals(400, response.getStatusCode()); <i class="conum" data-value="2"></i><b>(2)</b>
        assertTrue(systemOut.isEmpty(), "System.out is not empty: " + systemOut.asString()); <i class="conum" data-value="3"></i><b>(3)</b>
    }

    @Test
    void Should_handle_request() {
        final ClientHttpResponse response = blockingHttpClient.put("/?email=welcome@rxmicro.io");

        assertEquals("Email: welcome@rxmicro.io", systemOut.asString()); <i class="conum" data-value="4"></i><b>(4)</b>
        assertEquals(200, response.getStatusCode()); <i class="conum" data-value="4"></i><b>(4)</b>
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When activating the <code>rxmicro.validation</code> module, all query parameters are automatically considered as required.<br>
<em>(Therefore the <code>RxMicro Annotation Processor</code> automatically adds a <code>required</code> validator for each parameter.
If the parameter should be <code>optional</code>, the model field should be annotated with the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Nullable.java" target="_blank" rel="noopener"><code>@Nullable</code></a> annotation.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If request parameters are invalid, HTTP server automatically returns a status code <code>400</code> and JSON object of <a href="#rest-controller-errors-model-inline">standard structure with detailed error description.</a></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>If an HTTP request validation error occurs, the request handler isn&#8217;t invoked from the REST controller.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>If the request parameters are valid, control is transferred to the request handler from the REST controller.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-validation/validation-server-basic" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-validation/validation-server-basic</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="validation-response-section"><a class="anchor" href="#validation-response-section"></a><a class="link" href="#validation-response-section">7.4. HTTP Responses Server Validation</a></h3>
<div class="paragraph">
<p>In addition to validating HTTP requests, the RxMicro framework also provides the option to validate HTTP responses.</p>
</div>
<div class="paragraph">
<p><em>(HTTP response validation can be useful for identifying errors in business task implementation algorithms.
For example, instead of returning an incorrect response model to a client, the microservice will throw an error.
This approach increases the speed of error search and debugging of the source code that performs the business task.)</em></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If current implementation of the business task doesn&#8217;t contain any errors, then HTTP response validation will consume computing resources senselessly.
In this case, HTTP response validation must be disabled!</p>
</div>
<div class="paragraph">
<p><strong>By default the response validators are generated but not invoked!</strong></p>
</div>
<div class="paragraph">
<p>To activate the validation of responses it is necessary to set <code>enableAdditionalValidations</code> property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">new Configs.Builder()
        .withConfigs(new RestServerConfig()
                .setEnableAdditionalValidations(true)) <i class="conum" data-value="1"></i><b>(1)</b>
        .build();</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Enables the response validators</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">export rest-server.enableAdditionalValidations=true <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Enables the response validators</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>or using any other <a href="#core-config-types">supported config types</a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The HTTP response model class can contain any built-in or custom constraint annotations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Response {

    final String message; <i class="conum" data-value="1"></i><b>(1)</b>

    public Response(final String message) {
        this.message = message;
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>In this example, the <code>message</code> field doesn&#8217;t explicitly contain any constraint annotations.
But since to the <code>module-info.java</code> descriptor was added the <code>rxmicro.validation</code> module, then all model fields not marked with the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/constraint/Nullable.java" target="_blank" rel="noopener"><code>@Nullable</code></a> annotation are automatically required.
<em>(In other words, such fields are implicitly marked by a virtual constraint annotation <code>@Required</code>.)</em></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To emulate an incorrect business value, <code>null</code> value is passed in the request handler to the <code>message</code> field:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class MicroService {

    @GET("/")
    CompletableFuture&lt;Response&gt; get() {
        return CompletableFuture.completedFuture(new Response(null));
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In case of invalid HTTP response, the RxMicro framework returns HTTP response with a status <code>500</code> and <a href="#rest-controller-errors-model-inline">standard error model</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceTest {

    private BlockingHttpClient blockingHttpClient;

    @Test
    void Should_produce_internal_error() {
        final ClientHttpResponse response = blockingHttpClient.get("/");

        assertEquals(
                jsonErrorObject("Response is invalid: Parameter \"message\" is required!"),
                response.getBody()
        );
        assertEquals(500, response.getStatusCode());
    }

}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-validation/validation-server-response" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-validation/validation-server-response</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="http_responses_client_validation"><a class="anchor" href="#http_responses_client_validation"></a><a class="link" href="#http_responses_client_validation">7.5. HTTP Responses Client Validation</a></h3>
<div class="paragraph">
<p>After activation of the <code>rxmicro.validation</code> module in the <code>module-info.java</code> descriptor</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">module examples.validation.client.basic {
    requires rxmicro.rest.client;
    requires rxmicro.rest.client.exchange.json;
    requires rxmicro.validation; <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>rxmicro.validation</code> is a module for request and response validation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>the developer can use <a href="#validation-std-constraints-section">built-in constraints</a> to validate HTTP request parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Response {

    <i class="conum" data-value="1"></i><b>(1)</b>
    @Email
    String email;

    public String getEmail() {
        return email;
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>email</code> parameter is annotated by the <code>@Email</code> annotation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After setting up the model class, this model must be used in the REST client:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
public interface RESTClient {

    @GET("/")
    CompletableFuture&lt;Response&gt; get();

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When converting the content of an HTTP response to the <code>Response</code> class object, the validator will be invoked automatically:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(RESTClient.class)
final class RESTClientTest {

    private static final HttpRequestMock HTTP_REQUEST_MOCK = new HttpRequestMock.Builder()
            .setMethod(HttpMethod.GET)
            .setPath("/")
            .build();

    private RESTClient restClient;

    @Alternative
    @Mock
    private HttpClientFactory httpClientFactory;

    private void prepareValidResponse() {
        prepareHttpClientMock(
                httpClientFactory,
                HTTP_REQUEST_MOCK,
                jsonObject("email", "welcome@rxmicro.io") <i class="conum" data-value="1"></i><b>(1)</b>
        );
    }

    @Test
    @BeforeThisTest(method = "prepareValidResponse")
    void Should_return_received_email() {
        final Response response = restClient.get().join();
        assertEquals("welcome@rxmicro.io", response.getEmail()); <i class="conum" data-value="1"></i><b>(1)</b>
    }

    private void prepareInvalidResponse() {
        prepareHttpClientMock(
                httpClientFactory,
                HTTP_REQUEST_MOCK,
                jsonObject("email", "rxmicro.io") <i class="conum" data-value="2"></i><b>(2)</b>
        );
    }

    @Test
    @BeforeThisTest(method = "prepareInvalidResponse")
    void Should_throw_UnexpectedResponseException() {
        final Throwable throwable =
                <i class="conum" data-value="4"></i><b>(4)</b>
                getRealThrowable(assertThrows(RuntimeException.class, () -&gt; restClient.get().join())); <i class="conum" data-value="2"></i><b>(2)</b>
        assertEquals(UnexpectedResponseException.class, throwable.getClass()); <i class="conum" data-value="3"></i><b>(3)</b>
        assertEquals(
                "Response is invalid: " +
                        "Invalid parameter \"email\": Expected a valid email format!", <i class="conum" data-value="3"></i><b>(3)</b>
                throwable.getMessage()
        );
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If the REST client receives a valid HTTP response, no errors will occur.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If the <code>email</code> field is incorrect in the HTTP response, the REST client will return an error signal.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>If the HTTP response is incorrect, the <code>UnexpectedResponseException</code> class exception is returned with a detailed text message.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><strong>Since <code>CompletableFuture</code> when receiving an error signal ALWAYS returns the <code>CompletionException</code> class exception, to get the original exception class, which was thrown during the lazy evaluation, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-common/src/main/java/io/rxmicro/common/util/Exceptions.java#L123" target="_blank" rel="noopener"><code>Exceptions.getRealThrowable(Throwable)</code></a> utility method!</strong></td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Check out the following example to find out the features of the RxMicro framework for HTTP request validation in REST clients:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-validation/validation-client-all-types" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-validation/validation-client-all-types</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-validation/validation-client-basic" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-validation/validation-client-basic</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="http_requests_client_validation"><a class="anchor" href="#http_requests_client_validation"></a><a class="link" href="#http_requests_client_validation">7.6. HTTP Requests Client Validation</a></h3>
<div class="paragraph">
<p>In addition to validating HTTP responses, the RxMicro framework also provides the option to validate HTTP requests.</p>
</div>
<div class="paragraph">
<p><em>(HTTP request validation can be useful for identifying errors in business task implementation algorithms.
For example, instead of returning an incorrect request model to a server, the REST client will throw an error.
This approach increases the speed of error search and debugging of the source code that performs the business task.)</em></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If current implementation of the business task doesn&#8217;t contain any errors, then HTTP request validation will consume computing resources senselessly.
In this case, HTTP request validation must be disabled!</p>
</div>
<div class="paragraph">
<p><strong>By default the request validators are generated but not invoked!</strong>
To activate the validation of requests it is necessary to set <code>enableAdditionalValidations</code> property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">new Configs.Builder()
        .withConfigs(new RestClientConfig()
                .setEnableAdditionalValidations(true)) <i class="conum" data-value="1"></i><b>(1)</b>
        .build();</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Enables the requests validators</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">export rest-client.enableAdditionalValidations=true <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Enables the response validators</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>or using any other <a href="#core-config-types">supported config types</a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="creating_custom_constraints"><a class="anchor" href="#creating_custom_constraints"></a><a class="link" href="#creating_custom_constraints">7.7. Creating Custom Constraints</a></h3>
<div class="paragraph">
<p>If built-in constraints are not enough, the developer can create custom constraint.
To do so, the following steps must be taken:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a constraint annotation.</p>
</li>
<li>
<p>Implement a validator.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A validation annotation is an annotation that meets the following requirements:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@Retention(CLASS)
<i class="conum" data-value="2"></i><b>(2)</b>
@Target({FIELD, METHOD, PARAMETER})
<i class="conum" data-value="3"></i><b>(3)</b>
@ConstraintRule(
        supportedTypes = {
                BigDecimal.class                        <i class="conum" data-value="4"></i><b>(4)</b>
        },
        validatorClass = {
                ExpectedZeroConstraintValidator.class   <i class="conum" data-value="5"></i><b>(5)</b>
        }
)
public @interface ExpectedZero {

    boolean off() default false; <i class="conum" data-value="6"></i><b>(6)</b>

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The annotation is only available at the compilation level.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This annotation allows validating class fields, class methods (<code>setters</code> and <code>getters</code>) and method parameters.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/base/ConstraintRule.java" target="_blank" rel="noopener"><code>@ConstraintRule</code></a> annotation is used to indicate:</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>data type;</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>validator class.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Each constraint annotation requires a required <code>boolean off() default false;</code> parameter, that allows You to disable the validator.<br>
<em>(This feature is useful for model inheritance when a parameter from a child class should not be validated and a parameter from a parent class should be validated!)</em></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Validator is a class that meets the following requirements:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class ExpectedZeroConstraintValidator
        implements ConstraintValidator&lt;BigDecimal&gt; { <i class="conum" data-value="1"></i><b>(1)</b>

    @Override
    public void validateNonNull(final BigDecimal value,
                                final HttpModelType httpModelType,
                                final String modelName) throws ValidationException {
        if (value.compareTo(BigDecimal.ZERO) != 0) { <i class="conum" data-value="2"></i><b>(2)</b>
            throw new ValidationException(
                "Invalid ? \"?\": Expected a zero value!",
                httpModelType, modelName
            );
        }
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The validator class must implement the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/ConstraintValidator.java" target="_blank" rel="noopener"><code>ConstraintValidator</code></a> interface parameterized by the data type.<br>
<em>(If constraint annotation can be applied to different data types, a separate validator class must be created for each data type.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If the parameter is incorrect, the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/error/ValidationException.java" target="_blank" rel="noopener"><code>ValidationException</code></a> exception with a clear error message must be thrown.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Using a custom validator is no different from using a predefined validator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class MicroService {

    @PATCH("/")
    void consume(final @ExpectedZero BigDecimal value) {
        System.out.println(value);
    }

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ParameterizedTest
@CsvSource({
        "/,                     Parameter \"value\" is required!",
        "/?value=,              Parameter \"value\" is required!",
        "/?value=1.23,          Invalid parameter \"value\": Expected a zero value!",
        "/?value=-3.45,         Invalid parameter \"value\": Expected a zero value!"
})
void Should_return_invalid_request_status(final String path,
                                          final String expectedErrorMessage) {
    final ClientHttpResponse response = blockingHttpClient.patch(path);

    assertEquals(jsonErrorObject(expectedErrorMessage), response.getBody());
    assertEquals(400, response.getStatusCode());
    assertEquals("", systemOut.asString());
}

@ParameterizedTest
@ValueSource(strings = {"0", "0.0", "0.000", "-0.0"})
void Should_handle_request(final String value) {
    final ClientHttpResponse response = blockingHttpClient.patch("/?value=" + value);

    assertEquals(new BigDecimal(value).toString(), systemOut.asString());
    assertEquals(200, response.getStatusCode());
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-validation/validation-server-custom" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-validation/validation-server-custom</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="validation-disable-section"><a class="anchor" href="#validation-disable-section"></a><a class="link" href="#validation-disable-section">7.8. Disabling Validation</a></h3>
<div class="paragraph">
<p>To disable the generation of validators, You must perform one of the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Delete the <code>rxmicro.validation</code> module from the <code>module-info.java</code> descriptor.</p>
</li>
<li>
<p>Use <code>GenerateOption.DISABLED</code> options to disable specific categories of validators.</p>
</li>
<li>
<p>Use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/DisableValidation.java" target="_blank" rel="noopener"><code>@DisableValidation</code></a>
annotation to disable validators of a selected group of classes in the project.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="removing_the_rxmicro_validation_module"><a class="anchor" href="#removing_the_rxmicro_validation_module"></a><a class="link" href="#removing_the_rxmicro_validation_module">7.8.1. Removing the <code>rxmicro.validation</code> Module</a></h4>
<div class="paragraph">
<p>The easiest and fastest way to disable the generation of validators for <strong>all</strong> classes in the current module is to remove the <code>rxmicro.validation</code> module from the <code>module-info.java</code> descriptor.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>After deleting the <code>rxmicro.validation</code> module DON&#8217;T FORGET to recompile the whole project for the changes to take effect: <code>mvn clean compile</code>!</strong></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="using_generateoption_disabled_option"><a class="anchor" href="#using_generateoption_disabled_option"></a><a class="link" href="#using_generateoption_disabled_option">7.8.2. Using <code>GenerateOption.DISABLED</code> Option</a></h4>
<div class="paragraph">
<p>To disable the generation of validators by category, it is necessary to use annotations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#rest-controller-rest-server-generator-config-section"><code>@RestServerGeneratorConfig</code></a> (to set up the REST controllers).</p>
</li>
<li>
<p><a href="#rest-client-rest-client-generator-config-section"><code>@RestClientGeneratorConfig</code></a> (to set up the REST clients).</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestServerGeneratorConfig(
        generateRequestValidators = GenerateOption.DISABLED,    <i class="conum" data-value="1"></i><b>(1)</b>
        generateResponseValidators = GenerateOption.DISABLED    <i class="conum" data-value="2"></i><b>(2)</b>
)
@RestClientGeneratorConfig(
        generateRequestValidators = GenerateOption.DISABLED,    <i class="conum" data-value="3"></i><b>(3)</b>
        generateResponseValidators = GenerateOption.DISABLED    <i class="conum" data-value="4"></i><b>(4)</b>
)
module examples.validation {
    requires rxmicro.rest.server;
    requires rxmicro.rest.client;
    requires rxmicro.validation;
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Validators for all models of HTTP requests in the current project won&#8217;t be generated.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Validators for all models of HTTP responses in the current project won&#8217;t be generated.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Validators for all models of HTTP requests in the current project won&#8217;t be generated.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Validators for all models of HTTP responses in the current project won&#8217;t be generated.</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Upon activation of the <code>rxmicro.validation</code> module, by default the RxMicro framework generates only HTTP request validators for REST controllers and HTTP response validators for REST clients!</strong></p>
</div>
<div class="paragraph">
<p>All other categories of validators must be manually activated using the <code>@RestServerGeneratorConfig</code> and <code>@RestClientGeneratorConfig</code> annotations!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>After changing the settings using the <code>@RestServerGeneratorConfig</code> and <code>@RestClientGeneratorConfig</code> annotations DON&#8217;T FORGET to recompile the whole project for the changes to take effect: <code>mvn clean compile</code>!</strong></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="using_disablevalidation_annotation"><a class="anchor" href="#using_disablevalidation_annotation"></a><a class="link" href="#using_disablevalidation_annotation">7.8.3. Using <code>@DisableValidation</code> Annotation</a></h4>
<div class="paragraph">
<p>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-validation/src/main/java/io/rxmicro/validation/DisableValidation.java" target="_blank" rel="noopener"><code>@DisableValidation</code></a>
annotation provides an opportunity to disable the generation of validators for the selected group of classes in the project:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If a model class is annotated by this annotation, then <strong>only</strong> for this model class the validator won&#8217;t be generated.</p>
</li>
<li>
<p>If this annotation annotates the <code>package-info.java</code> class, then for <strong>all classes from the specified package and all its subpackages</strong> no validators will be generated.</p>
</li>
<li>
<p>If this annotation annotates the <code>module-info.java</code> descriptor, then for <strong>all classes in the current module</strong> no validators will be generated.<br>
<em>(This behavior is similar to the removal of the <code>rxmicro.validation</code> module from the <code>module-info.java</code> descriptor.)</em></p>
</li>
</ol>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>After adding the <code>@DisableValidation</code> annotation DON&#8217;T FORGET to recompile the whole project for the changes to take effect: <code>mvn clean compile</code>!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="project-documentation-section"><a class="anchor" href="#project-documentation-section"></a><a class="link" href="#project-documentation-section">8. REST-based Microservice Documentation</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>REST-based microservice documentation describes rules of interaction with REST-based microservices for fast and easy integration with them.</p>
</div>
<div class="paragraph">
<p>Currently, the RxMicro framework only supports specialized documentation format based on the <a href="https://asciidoc.org/" target="_blank" rel="noopener"><code>AsciiDoc</code></a> format.</p>
</div>
<div style="page-break-after: always;"></div>
<div class="sect2">
<h3 id="project-documentation-basic-usage-section"><a class="anchor" href="#project-documentation-basic-usage-section"></a><a class="link" href="#project-documentation-basic-usage-section">8.1. Basic Usage</a></h3>
<div class="paragraph">
<p>Default settings allow You to generate REST-based microservice documentation using minimal configurations.<br>
<em>(This advantage is achieved through close integration with other RxMicro modules.)</em></p>
</div>
<div class="sect3">
<h4 id="min_settings"><a class="anchor" href="#min_settings"></a><a class="link" href="#min_settings">8.1.1. Min Settings</a></h4>
<div class="paragraph">
<p>To generate REST-based microservice documentation during the compilation of the microservice project, the following two steps must be done:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add the <code>rxmicro-documentation-asciidoctor</code> dependency to <code>pom.xml</code> of the microservice project:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
    &lt;artifactId&gt;rxmicro-documentation-asciidoctor&lt;/artifactId&gt;
    &lt;version&gt;${rxmicro.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Add the <code>rxmicro.documentation.asciidoctor</code> module to the <code>module-info.java</code> descriptor of the microservice project:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">module examples.documentation.asciidoctor.quick.start {
    requires rxmicro.rest.server.netty;
    requires rxmicro.rest.server.exchange.json;
    requires static rxmicro.documentation.asciidoctor; <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>rxmicro.documentation.asciidoctor</code> must be added using the <code>static</code> modifier.<br>
<em>(For more information on the benefits of the <code>static</code> modifier, refer to the <a href="#project-documentation-basic-usage-maven-dependency-plugin">Section 8.1.3, &#8220;<code>Asciidoctor-dependency-plugin</code> Settings&#8221;</a>.)</em></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After performing these steps during compiling the microservice project, the <code>RxMicro Annotation Processor</code> will generate the <code>ExamplesDocumentationAsciidoctorQuickStartDocumentation.adoc</code> file.
The generated file will contain REST-based microservice documentation in the <a href="https://asciidoc.org/" target="_blank" rel="noopener"><code>AsciiDoc</code></a> format, and by default will be located in the <code>./src/main/asciidoc</code> folder.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In terms of the version control system, the <code>./src/main/asciidoc</code> folder is the source code, so it will be controlled by this system.
Therefore, if REST-based microservice documentation is to be dynamically generated, it is necessary to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>specify that files in the <code>./src/main/asciidoc</code> folder must be ignored by the version control system;</p>
</li>
<li>
<p>or configure the <code>rxmicro.documentation.asciidoctor</code> module, so that it generates REST-based microservice documentation in another folder, for example in the <code>target/docs</code>.<br>
<em>(To configure the folder in which REST-based microservice documentation should be generated, refer to the <a href="core.html#rxmicro-annotation-processor-options-section">core.html</a>.)</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using the <code>./src/main/asciidoc</code> folder by default provides the following benefits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>asciidoctor-maven-plugin</code>, which converts the <a href="https://asciidoc.org/" target="_blank" rel="noopener"><code>AsciiDoc</code></a> format to <a href="https://html.spec.whatwg.org/" target="_blank" rel="noopener"><code>HTML</code></a> or <a href="https://www.adobe.com/content/dam/acom/en/devnet/pdf/pdfs/PDF32000_2008.pdf" target="_blank" rel="noopener"><code>PDF</code></a>
, by default reads files from the <code>./src/main/asciidoc</code> folder.</p>
</li>
<li>
<p>Automatic building of REST-based microservice documentation can be used as an initial version of the document.
After formation of the initial version, the generation can be disabled and all changes to the documentation will be made manually by the developer and stored in the version control system.</p>
</li>
<li>
<p>Compared to the previous version, a more efficient way to keep REST-based microservice documentation up to date is to divide all documentation into fragments.
Static fragments (business task description, charts and figures) will be created manually by the developer.
Dynamic fragments will be generated by the <code>RxMicro Annotation Processor</code> at each project compilation.
As a result, a final document containing static and dynamic fragments will be compiled from these fragments.<br>
<em>(When using this approach, do not forget to add the all dynamic fragments to ignore list for Your version control system!)</em></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="asciidoctor_maven_plugin_settings"><a class="anchor" href="#asciidoctor_maven_plugin_settings"></a><a class="link" href="#asciidoctor_maven_plugin_settings">8.1.2. <code>Asciidoctor-maven-plugin</code> Settings</a></h4>
<div class="paragraph">
<p>The <code>asciidoctor-maven-plugin</code> plugin allows You to convert documentation from the <a href="https://asciidoc.org/" target="_blank" rel="noopener"><code>AsciiDoc</code></a> format to
<a href="https://html.spec.whatwg.org/" target="_blank" rel="noopener"><code>HTML</code></a>, <a href="https://www.adobe.com/content/dam/acom/en/devnet/pdf/pdfs/PDF32000_2008.pdf" target="_blank" rel="noopener"><code>PDF</code></a> and other formats.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;groupId&gt;org.asciidoctor&lt;/groupId&gt;
    &lt;artifactId&gt;asciidoctor-maven-plugin&lt;/artifactId&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;version&gt;${asciidoctor-maven-plugin.version}&lt;/version&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;id&gt;output-html5&lt;/id&gt;
            &lt;phase&gt;package&lt;/phase&gt; <i class="conum" data-value="2"></i><b>(2)</b>
            &lt;goals&gt;
                &lt;goal&gt;process-asciidoc&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
                &lt;backend&gt;html5&lt;/backend&gt; <i class="conum" data-value="3"></i><b>(3)</b>
                &lt;sourceHighlighter&gt;highlight.js&lt;/sourceHighlighter&gt; <i class="conum" data-value="4"></i><b>(4)</b>
                &lt;preserveDirectories&gt;true&lt;/preserveDirectories&gt;
                &lt;relativeBaseDir&gt;true&lt;/relativeBaseDir&gt;
                &lt;attributes&gt; <i class="conum" data-value="5"></i><b>(5)</b>
                    &lt;icons&gt;font&lt;/icons&gt;
                    &lt;pagenums/&gt;
                    &lt;toclevels&gt;3&lt;/toclevels&gt;
                &lt;/attributes&gt;
            &lt;/configuration&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><a href="https://mvnrepository.com/artifact/org.asciidoctor/asciidoctor-maven-plugin" target="_blank" rel="noopener">The latest stable version of the <code>asciidoctor-maven-plugin</code></a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>asciidoctor-maven-plugin</code> must convert REST-based microservice documentation at the <code>package</code> phase.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Using the <code>backend</code> directive, You can specify in which format the <a href="https://asciidoc.org/" target="_blank" rel="noopener"><code>AsciiDoc</code></a> document should be converted.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>If the <a href="https://asciidoc.org/" target="_blank" rel="noopener"><code>AsciiDoc</code></a> document contains examples of source code in a programming language, You need to add the js library for highlighting the syntax of that language.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Using the <code>attributes</code> directive, it is possible to override the attributes of the   <a href="https://asciidoc.org/" target="_blank" rel="noopener"><code>AsciiDoc</code></a> document.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more information about the <code>asciidoctor-maven-plugin</code> plugin features, refer to the documentation:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://asciidoctor.org/docs/asciidoctor-maven-plugin/" target="_blank" rel="noopener"><code>https://asciidoctor.org/docs/asciidoctor-maven-plugin/</code></a></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="project-documentation-basic-usage-maven-dependency-plugin"><a class="anchor" href="#project-documentation-basic-usage-maven-dependency-plugin"></a><a class="link" href="#project-documentation-basic-usage-maven-dependency-plugin">8.1.3. <code>Asciidoctor-dependency-plugin</code> Settings</a></h4>
<div class="paragraph">
<p>REST-based microservice documentation is generated during the compilation process, therefore the libraries used to configure the REST-based microservice documentation generation process are not required in <code>runtime</code>.
Therefore, the <code>maven-dependency-plugin</code> should not copy artifacts related to the generation of REST-based microservice documentation to the <code>lib</code> folder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;
    &lt;version&gt;${maven-dependency-plugin.version}&lt;/version&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;id&gt;copy-dependencies&lt;/id&gt;
            &lt;phase&gt;package&lt;/phase&gt;
            &lt;goals&gt;
                &lt;goal&gt;copy-dependencies&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
                &lt;outputDirectory&gt;${project.build.directory}/lib&lt;/outputDirectory&gt;
                &lt;includeScope&gt;compile&lt;/includeScope&gt;
                &lt;excludeArtifactIds&gt; <i class="conum" data-value="1"></i><b>(1)</b>
                    rxmicro-documentation,
                    rxmicro-documentation-asciidoctor
                &lt;/excludeArtifactIds&gt;
            &lt;/configuration&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>rxmicro-documentation</code> and <code>rxmicro-documentation-asciidoctor</code> artifacts are required <strong>only</strong> during the compilation process.</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In order that in <code>runtime</code> no errors occur when excluding the artifacts required for REST-based microservice documentation generation, it is required to use the <code>static</code> modifier in the <code>module-info.java</code> descriptor: <code>requires static rxmicro.documentation.asciidoctor;</code>.</p>
</div>
<div class="paragraph">
<p>Without this modifier the following error will occur when starting the microservice: <code>Module rxmicro.documentation.asciidoctor not found</code>!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When compiling a project, the RxMicro framework will generate the following project documentation according to the settings of the <code>rxmicro.documentation.asciidoctor</code> module defined in this section:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="project-documentation-examples/ExamplesDocumentationAsciidoctorQuickStartDocumentation.html" target="_blank" rel="noopener"><code>ExamplesDocumentationAsciidoctorQuickStartDocumentation.html</code></a></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-documentation-asciidoctor/documentation-asciidoctor-quick-start" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-documentation-asciidoctor/documentation-asciidoctor-quick-start</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="project-documentation-annotations-section"><a class="anchor" href="#project-documentation-annotations-section"></a><a class="link" href="#project-documentation-annotations-section">8.2. <code>RxMicro Annotations</code></a></h3>
<div class="paragraph">
<p>The RxMicro framework supports the following <code>RxMicro Annotations</code>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 14. Supported <code>RxMicro Annotations</code>.</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Annotation</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/Author.java" target="_blank" rel="noopener"><code>@Author</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#project-documentation-metadata-annotations-section">the author of the generated REST-based microservice documentation</a>.</p>
<p class="tableblock"><em>(Allows You to override the author specified in the <code>developer</code> directive to <code>pom.xml</code>.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/BaseEndpoint.java" target="_blank" rel="noopener"><code>@BaseEndpoint</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#project-documentation-metadata-annotations-section">the basic endpoint in the generated REST-based microservice documentation</a>.</p>
<p class="tableblock"><em>(Allows You to override the basic endpoint specified in the <code>url</code> directive to <code>pom.xml</code>.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/Description.java" target="_blank" rel="noopener"><code>@Description</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#project-documentation-metadata-annotations-section">the description of the generated REST-based microservice documentation</a>.</p>
<p class="tableblock"><em>(Allows You to override the description specified in the <code>description</code> directive to <code>pom.xml</code>.)</em></p>
<p class="tableblock">In addition to the description of all REST-based microservice documentation, this annotation also allows You to specify a description of separate elements: sections, model fields, etc.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/DocumentationDefinition.java" target="_blank" rel="noopener"><code>@DocumentationDefinition</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A composite annotation that specifies <a href="#project-documentation-section-customization-section">the settings for generating a whole document</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/DocumentationVersion.java" target="_blank" rel="noopener"><code>@DocumentationVersion</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#project-documentation-metadata-annotations-section">the version of REST-based microservice in the generated REST-based microservice documentation</a>.</p>
<p class="tableblock"><em>(Allows You to override the version of REST-based microservice specified in the <code>version</code> directive to <code>pom.xml</code>.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/Example.java" target="_blank" rel="noopener"><code>@Example</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#project-documentation-example-description-section">the model field value used as an example in the generated REST-based microservice documentation</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/IncludeDescription.java" target="_blank" rel="noopener"><code>@IncludeDescription</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#project-documentation-metadata-annotations-section">the AsciiDoc fragment to be imported into the generated REST-based microservice documentation</a>.</p>
<p class="tableblock">In addition to the description of all REST-based microservice documentation, this annotation also allows You to specify the AsciiDoc fragment for separate elements: sections, model fields, etc.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/IntroductionDefinition.java" target="_blank" rel="noopener"><code>@IntroductionDefinition</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A composite annotation that specifies <a href="#project-documentation-section-customization-section">the settings for generating the <code>Introduction</code> section</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/License.java" target="_blank" rel="noopener"><code>@License</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#project-documentation-metadata-annotations-section">the license of REST-based microservice in the generated REST-based microservice documentation</a>.</p>
<p class="tableblock"><em>(Allows You to override the license of REST-based microservice specified in the <code>license</code> directive to <code>pom.xml</code>.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/ModelExceptionErrorResponse.java" target="_blank" rel="noopener"><code>@ModelExceptionErrorResponse</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes the exception class to be analyzed by the <code>RxMicro Annotation Processor</code> for <a href="#project-documentation-errors-section">generating the unsuccessful HTTP response description of REST-based microservice</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/ResourceDefinition.java" target="_blank" rel="noopener"><code>@ResourceDefinition</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A composite annotation that specifies <a href="#project-documentation-section-customization-section">the settings for generating the <code>ResourceDefinition</code> section</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/ResourceGroupDefinition.java" target="_blank" rel="noopener"><code>@ResourceGroupDefinition</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A composite annotation that specifies <a href="#project-documentation-section-customization-section">the settings for generating the <code>ResourceGroupDefinition</code> section</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/SimpleErrorResponse.java" target="_blank" rel="noopener"><code>@SimpleErrorResponse</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains metadata about <a href="#project-documentation-errors-section">the unsuccessful HTTP response of REST-based microservice</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/Title.java" target="_blank" rel="noopener"><code>@Title</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#project-documentation-metadata-annotations-section">the name of the generated REST-based microservice documentation</a>.</p>
<p class="tableblock"><em>(Allows You to override the name of the generated REST-based microservice documentation specified in the <code>name</code> directive to <code>pom.xml</code>.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation-asciidoctor/src/main/java/io/rxmicro/documentation/asciidoctor/DocumentAttributes.java" target="_blank" rel="noopener"><code>@DocumentAttributes</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows You to specify <a href="https://asciidoctor.org/docs/user-manual/#attributes" target="_blank" rel="noopener">AsciiDoc attributes</a> for the generated REST-based microservice documentation.</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="project-documentation-example-description-section"><a class="anchor" href="#project-documentation-example-description-section"></a><a class="link" href="#project-documentation-example-description-section">8.3. <code>@Example</code> and <code>@Description</code> Usage</a></h3>
<div class="paragraph">
<p>Using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/Example.java" target="_blank" rel="noopener"><code>@Example</code></a>
annotation, the developer can specify the data that is as close to the real data as possible, which will be used to build examples of usage in REST-based microservice documentation.</p>
</div>
<div class="paragraph">
<p>Using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/Description.java" target="_blank" rel="noopener"><code>@Description</code></a>
annotation, the developer can specify the detailed description of separate model fields to be used in building REST-based microservice documentation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Echo {

    @Example("EchoExample")
    @Description("EchoDescription")
    String echo;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class MicroService {

    @GET("/")
    @POST("/")
    @POST(value = "/", httpBody = false)
    CompletableFuture&lt;Echo&gt; echo(final Echo echo) {
        return completedFuture(echo);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When compiling a project, the RxMicro framework will generate the following project documentation according to the settings of the <code>rxmicro.documentation.asciidoctor</code> module defined in this section:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="project-documentation-examples/ExamplesDocumentationAsciidoctorEchoDocumentation.html" target="_blank" rel="noopener"><code>ExamplesDocumentationAsciidoctorEchoDocumentation.html</code></a></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-documentation-asciidoctor/documentation-asciidoctor-echo" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-documentation-asciidoctor/documentation-asciidoctor-echo</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="project-documentation-section-customization-section"><a class="anchor" href="#project-documentation-section-customization-section"></a><a class="link" href="#project-documentation-section-customization-section">8.4. Sections Customization</a></h3>
<div class="paragraph">
<p>Using the following composite annotations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/DocumentationDefinition.java" target="_blank" rel="noopener"><code>@DocumentationDefinition</code></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/IncludeDescription.java" target="_blank" rel="noopener"><code>@IncludeDescription</code></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/ResourceGroupDefinition.java" target="_blank" rel="noopener"><code>@ResourceGroupDefinition</code></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/ResourceDefinition.java" target="_blank" rel="noopener"><code>@ResourceDefinition</code></a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>the developer can regroup standard sections of REST-based microservice documentation, as well as add his own fragments as sections.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@DocumentationDefinition(
        withGeneratedDate = false,
        introduction = @IntroductionDefinition(
                sectionOrder = {
                        IntroductionDefinition.Section.LICENSES,
                        IntroductionDefinition.Section.SPECIFICATION,
                        IntroductionDefinition.Section.CUSTOM_SECTION
                },
                customSection = {
                        "${PROJECT-DIR}/src/main/asciidoc/_fragment/" +
                                "custom-introduction-content.asciidoc"
                },
                includeMode = IncludeMode.INLINE_CONTENT
        ),
        resourceGroup = @ResourceGroupDefinition(
                sectionOrder = {
                        ResourceGroupDefinition.Section.CUSTOM_SECTION
                },
                customSection = {
                        "${PROJECT-DIR}/src/main/asciidoc/_fragment/" +
                                "custom-resource-group-content.asciidoc"
                },
                includeMode = IncludeMode.INLINE_CONTENT
        ),
        resource = @ResourceDefinition(
                withInternalErrorResponse = false,
                withJsonSchema = false,
                withRequestIdResponseHeader = false,
                withQueryParametersDescriptionTable = false,
                withBodyParametersDescriptionTable = false
        )
)
module examples.documentation.asciidoctor.custom.sections {
    requires rxmicro.rest.server.netty;
    requires rxmicro.rest.server.exchange.json;
    requires static rxmicro.documentation.asciidoctor;
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Besides generating the final <a href="https://asciidoc.org/" target="_blank" rel="noopener"><code>AsciiDoc</code></a> document, the <code>RxMicro Annotation Processor</code> allows You to generate separate dynamic fragments.</p>
</div>
<div class="paragraph">
<p>For more information on this feature, check out the following example:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-documentation-asciidoctor/documentation-asciidoctor-custom-sections" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-documentation-asciidoctor/documentation-asciidoctor-custom-sections</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When compiling a project, the RxMicro framework will generate the following project documentation according to the settings of the <code>rxmicro.documentation.asciidoctor</code> module defined in this section:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="project-documentation-examples/ExamplesDocumentationAsciidoctorCustomSectionsDocumentation.html" target="_blank" rel="noopener"><code>ExamplesDocumentationAsciidoctorCustomSectionsDocumentation.html</code></a></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-documentation-asciidoctor/documentation-asciidoctor-custom-sections" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-documentation-asciidoctor/documentation-asciidoctor-custom-sections</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="project-documentation-validation-section"><a class="anchor" href="#project-documentation-validation-section"></a><a class="link" href="#project-documentation-validation-section">8.5. Integration with <code>rxmicro.validation</code> Module</a></h3>
<div class="paragraph">
<p>The <code>rxmicro.documentation.asciidoctor</code> module is integrated with the <code>rxmicro.validation</code> module.
Thanks to this integration, when building the REST-based microservice documentation, the RxMicro framework analyzes all available built-in constraints for automatic generation of model fields description.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@DocumentationDefinition(
        introduction = @IntroductionDefinition(sectionOrder = {}),
        withGeneratedDate = false
)
module examples.documentation.asciidoctor.validation {
    requires rxmicro.rest.server.netty;
    requires rxmicro.rest.server.exchange.json;
    requires rxmicro.validation;
    requires static rxmicro.documentation.asciidoctor;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class MicroService {

    @PUT("/")
    void consume(final @Phone String phone) { <i class="conum" data-value="1"></i><b>(1)</b>
        // do something
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>phone</code> parameter must be validated via built-in constraint for phones.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Thus, when building the REST-based microservice documentation, the RxMicro framework will automatically generate a description for the <code>phone</code> parameter:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/project-documentation/validation-integration.jpg" alt="validation integration">
</div>
<div class="title">Figure 13. The <code>phone</code> field description, formed based on built-in constraints analysis</div>
</div>
<div class="paragraph">
<p>When compiling a project, the RxMicro framework will generate the following project documentation according to the settings of the <code>rxmicro.documentation.asciidoctor</code> module defined in this section:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="project-documentation-examples/ExamplesDocumentationAsciidoctorValidationDocumentation.html" target="_blank" rel="noopener"><code>ExamplesDocumentationAsciidoctorValidationDocumentation.html</code></a></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-documentation-asciidoctor/documentation-asciidoctor-validation" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-documentation-asciidoctor/documentation-asciidoctor-validation</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="rest_based_microservice_metadata_configuration"><a class="anchor" href="#rest_based_microservice_metadata_configuration"></a><a class="link" href="#rest_based_microservice_metadata_configuration">8.6. REST-based Microservice Metadata Configuration</a></h3>
<div class="paragraph">
<p>To obtain metadata while building REST-based microservice documentation, the RxMicro framework can use:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>pom.xml</code> file;</p>
</li>
<li>
<p>The <code>rxmicro.documentation</code> module annotations.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The REST-based microservice metadata is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the REST-based microservice name;</p>
</li>
<li>
<p>the REST-based microservice description;</p>
</li>
<li>
<p>the REST-based microservice version;</p>
</li>
<li>
<p>the list of licenses that cover the REST-based microservice;</p>
</li>
<li>
<p>the list of REST-based microservice developers;</p>
</li>
<li>
<p>the REST-based microservice basic endpoint.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="project-documentation-metadata-pomxml-section"><a class="anchor" href="#project-documentation-metadata-pomxml-section"></a><a class="link" href="#project-documentation-metadata-pomxml-section">8.6.1. Using <code>pom.xml</code></a></h4>
<div class="paragraph">
<p>To specify the metadata needed to generate the REST-based microservice documentation, You can use the <code>pom.xml</code> file</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;project&gt;
    &lt;name&gt;Metadata Pom Xml&lt;/name&gt;
    &lt;description&gt;*Project* _Description_&lt;/description&gt;
    &lt;developers&gt;
        &lt;developer&gt;
            &lt;name&gt;Richard Hendricks&lt;/name&gt;
            &lt;email&gt;richard.hendricks@piedpiper.com&lt;/email&gt;
        &lt;/developer&gt;
        &lt;developer&gt;
            &lt;name&gt;Bertram Gilfoyle&lt;/name&gt;
            &lt;email&gt;bertram.gilfoyle@piedpiper.com&lt;/email&gt;
        &lt;/developer&gt;
        &lt;developer&gt;
            &lt;name&gt;Dinesh Chugtai&lt;/name&gt;
            &lt;email&gt;dinesh.chugtai@piedpiper.com&lt;/email&gt;
        &lt;/developer&gt;
    &lt;/developers&gt;
    &lt;url&gt;https://api.rxmicro.io&lt;/url&gt;
    &lt;licenses&gt;
        &lt;license&gt;
            &lt;name&gt;Apache License 2.0&lt;/name&gt;
            &lt;url&gt;https://github.com/rxmicro/rxmicro/blob/master/LICENSE&lt;/url&gt;
        &lt;/license&gt;
    &lt;/licenses&gt;
&lt;/project&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>When compiling a project, the RxMicro framework will generate the following project documentation according to the settings of the <code>rxmicro.documentation.asciidoctor</code> module defined in this section:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="project-documentation-examples/MetadataPomXmlDocumentation.html" target="_blank" rel="noopener"><code>MetadataPomXmlDocumentation.html</code></a></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-documentation-asciidoctor/documentation-asciidoctor-metadata-pomxml" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-documentation-asciidoctor/documentation-asciidoctor-metadata-pomxml</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="project-documentation-metadata-annotations-section"><a class="anchor" href="#project-documentation-metadata-annotations-section"></a><a class="link" href="#project-documentation-metadata-annotations-section">8.6.2. Using Annotations</a></h4>
<div class="paragraph">
<p>To specify the metadata needed to generate the REST-based microservice documentation, You can use the <code>rxmicro.documentation</code> module annotations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Title("Metadata Annotations")
@Description("*Project* _Description_")
@DocumentationVersion("0.0.1")
@Author(
        name = "Richard Hendricks",
        email = "richard.hendricks@piedpiper.com"
)
@Author(
        name = "Bertram Gilfoyle",
        email = "bertram.gilfoyle@piedpiper.com"
)
@Author(
        name = "Dinesh Chugtai",
        email = "dinesh.chugtai@piedpiper.com"
)
@BaseEndpoint("https://api.rxmicro.io")
@License(
        name = "Apache License 2.0",
        url = "https://github.com/rxmicro/rxmicro/blob/master/LICENSE"
)
@DocumentationDefinition(
        introduction = @IntroductionDefinition(
                sectionOrder = {
                        IntroductionDefinition.Section.BASE_ENDPOINT,
                        IntroductionDefinition.Section.LICENSES
                }
        ),
        resource = @ResourceDefinition(
                withInternalErrorResponse = false
        ),
        withGeneratedDate = false
)
module examples.documentation.asciidoctor.metadata.annotations {
    requires rxmicro.rest.server.netty;
    requires rxmicro.rest.server.exchange.json;
    requires static rxmicro.documentation.asciidoctor;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When compiling a project, the RxMicro framework will generate the following project documentation according to the settings of the <code>rxmicro.documentation.asciidoctor</code> module defined in this section:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="project-documentation-examples/MetadataAnnotationsDocumentation.html" target="_blank" rel="noopener"><code>MetadataAnnotationsDocumentation.html</code></a></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-documentation-asciidoctor/documentation-asciidoctor-metadata-annotations" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-documentation-asciidoctor/documentation-asciidoctor-metadata-annotations</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="project-documentation-errors-section"><a class="anchor" href="#project-documentation-errors-section"></a><a class="link" href="#project-documentation-errors-section">8.7. Error Documentation</a></h3>
<div class="paragraph">
<p>To describe unsuccessful HTTP responses, the <code>rxmicro.documentation</code> module provides two annotations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/SimpleErrorResponse.java" target="_blank" rel="noopener"><code>@SimpleErrorResponse</code></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/ModelExceptionErrorResponse.java" target="_blank" rel="noopener"><code>@ModelExceptionErrorResponse</code></a>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Unresolved directive in _fragment/_project-documentation/errors.adoc - include::../../../../../../examples/group-documentation-asciidoctor/documentation-asciidoctor-errors/src/main/java/io/rxmicro/examples/documentation/asciidoctor/errors/ProxyMicroService.java[tags=content]</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/SimpleErrorResponse.java" target="_blank" rel="noopener"><code>@SimpleErrorResponse</code></a> annotation allows You to explicitly specify the HTTP response description.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>status</code> parameter describes the HTTP status code.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>description</code> parameter describes the text description.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The <code>exampleErrorMessage</code> parameter denotes the value used as an example in the generated REST-based microservice documentation.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/ModelExceptionErrorResponse.java" target="_blank" rel="noopener"><code>@ModelExceptionErrorResponse</code></a> annotation allows You to specify the exception class of the standard</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>or custom type.</td>
</tr>
</table>
</div>
<div id="project-documentation-custom-error-requirements" class="paragraph">
<p>When using the custom exception type, this class contains all necessary parameters for building REST-based microservice documentation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Unresolved directive in _fragment/_project-documentation/errors.adoc - include::../../../../../../examples/group-documentation-asciidoctor/documentation-asciidoctor-errors/src/main/java/io/rxmicro/examples/documentation/asciidoctor/errors/model/NotAcceptableException.java[tags=content]</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The required <code>STATUS_CODE</code> static field describes the HTTP status code.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/Description.java" target="_blank" rel="noopener"><code>@Description</code></a> annotation describes the text description.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/Example.java" target="_blank" rel="noopener"><code>@Example</code></a> annotation describes the value used as an example in the generated REST-based microservice documentation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The custom exception class can contain not string parameter(s).
For such classes the RxMicro framework returns custom JSON model instead of <a href="#rest-controller-errors-model-inline">standard one</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Unresolved directive in _fragment/_project-documentation/errors.adoc - include::../../../../../../examples/group-documentation-asciidoctor/documentation-asciidoctor-errors/src/main/java/io/rxmicro/examples/documentation/asciidoctor/errors/model/CustomErrorModelException.java[tags=content]</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/Description.java" target="_blank" rel="noopener"><code>@Description</code></a> annotation describes the text description.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The required <code>STATUS_CODE</code> static field describes the HTTP status code.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The custom field can contain <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/Example.java" target="_blank" rel="noopener"><code>@Example</code></a> and
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-documentation/src/main/java/io/rxmicro/documentation/Description.java" target="_blank" rel="noopener"><code>@Description</code></a> annotations.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The custom field(s) must be initialized via constructor.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>For custom exception classes with custom field(s) the RxMicro Annotation Processor does not generate <code>Writer</code>, so You must override the <code>getResponseData</code> method manually!</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Overridden method must return values from all declared fields at custom exception class.</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If <a href="#rxmicro-annotation-processor-options-section"><code>RX_MICRO_STRICT_MODE</code></a> option is enabled, the RxMicro Annotation Processor validates the overidden <code>getResponseData</code> method and throws compilation error if some field values not returned!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When compiling a project, the RxMicro framework will generate the following project documentation according to the settings of the <code>rxmicro.documentation.asciidoctor</code> module defined in this section:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="project-documentation-examples/ExamplesDocumentationAsciidoctorErrorsDocumentation.html" target="_blank" rel="noopener"><code>ExamplesDocumentationAsciidoctorErrorsDocumentation.html</code></a></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-documentation-asciidoctor/documentation-asciidoctor-errors" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-documentation-asciidoctor/documentation-asciidoctor-errors</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="data-postgresql-section"><a class="anchor" href="#data-postgresql-section"></a><a class="link" href="#data-postgresql-section">9. Postgre SQL Data Repositories</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The RxMicro framework supports creation of dynamic repositories for interaction with databases.</p>
</div>
<div class="paragraph">
<p>To interact with <a href="https://www.postgresql.org/" target="_blank" rel="noopener"><code>PostgreSQL DB</code></a>, using the <a href="https://github.com/pgjdbc/r2dbc-postgresql" target="_blank" rel="noopener">reactive R2DBC PostgreSQL driver</a>, the RxMicro framework provides the <code>rxmicro.data.sql.r2dbc.postgresql</code> module.</p>
</div>
<div style="page-break-after: always;"></div>
<div class="sect2">
<h3 id="data-postgresql-basic-section"><a class="anchor" href="#data-postgresql-basic-section"></a><a class="link" href="#data-postgresql-basic-section">9.1. Basic Usage</a></h3>
<div class="paragraph">
<p>To use the <code>rxmicro.data.sql.r2dbc.postgresql</code> module in the project, the following two steps must be taken:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Inject the <code>rxmicro.data.sql.r2dbc.postgresql</code> dependency to the <code>pom.xml</code> file:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
    &lt;artifactId&gt;rxmicro-data-sql-r2dbc-postgresql&lt;/artifactId&gt;
    &lt;version&gt;${rxmicro.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Add the <code>rxmicro.data.sql.r2dbc.postgresql</code> module to the <code>module-info.java</code> descriptor:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">module examples.data.r2dbc.postgresql.basic {
    requires rxmicro.data.sql.r2dbc.postgresql;
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By default, the <a href="https://github.com/pgjdbc/r2dbc-postgresql" target="_blank" rel="noopener">reactive R2DBC PostgreSQL driver</a> uses the <a href="https://projectreactor.io/docs/core/release/reference/index.html" target="_blank" rel="noopener"><strong>Project Reactor</strong></a> library, so when adding the <code>rxmicro.data.sql.r2dbc.postgresql</code> module, the <code>reactor.core</code> module is automatically added and available for usage!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After adding the <code>rxmicro.data.sql.r2dbc.postgresql</code> module, You can create a data model class and dynamic repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Table
<i class="conum" data-value="1"></i><b>(1)</b>
@ColumnMappingStrategy
public final class Account {

    @Column(length = Column.UNLIMITED_LENGTH)
    String firstName;

    @Column(length = Column.UNLIMITED_LENGTH)
    String lastName;

    public String getFirstName() {
        return firstName;
    }

    public String getLastName() {
        return lastName;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data/src/main/java/io/rxmicro/data/ColumnMappingStrategy.java" target="_blank" rel="noopener"><code>@ColumnMappingStrategy</code></a>
annotation sets the strategy of forming column names of the relational database table based on the analysis of the Java model class field names.<br>
<em>(Thus, the <code>firstName</code> field corresponds to the <code>first_name</code> column, and the <code>lastName</code> field corresponds to the <code>last_name</code> column.)</em></td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@PostgreSQLRepository
public interface DataRepository {

    <i class="conum" data-value="2"></i><b>(2)</b>
    @Select("SELECT * FROM ${table} WHERE email = ?")
    Mono&lt;Account&gt; findByEmail(String email);
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>In order for a standard interface to be recognized by the RxMicro framework as a dynamic repository for interaction with <a href="https://www.postgresql.org/" target="_blank" rel="noopener"><code>PostgreSQL DB</code></a>, this interface should be annotated by <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql-r2dbc-postgresql/src/main/java/io/rxmicro/data/sql/r2dbc/postgresql/PostgreSQLRepository.java" target="_blank" rel="noopener"><code>@PostgreSQLRepository</code></a> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The dynamic repository may contain methods that form a query to the <a href="https://www.postgresql.org/" target="_blank" rel="noopener"><code>PostgreSQL DB</code></a>.<br>
<em>(The query that used for a request for data uses the <a href="https://en.wikipedia.org/wiki/SQL" target="_blank" rel="noopener"><code>SQL</code></a> and is specified in the annotation parameters.)</em></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Since the dynamic repository is a RxMicro component, for its testing You need to use <a href="testing.html#testing-component-tests-section">the microservice component testing approach</a>:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The common approach recommended for testing dynamic repositories, that interact with <a href="https://www.postgresql.org/" target="_blank" rel="noopener"><code>PostgreSQL DB</code></a>, is described in the <a href="#data-postgresql-test-templates-section">Section 9.3.2, &#8220;Test Templates&#8221;</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Testcontainers
@RxMicroComponentTest(DataRepository.class)
final class DataRepositoryTest {

    @Container
    private final GenericContainer&lt;?&gt; postgresqlTestDb =
            new GenericContainer&lt;&gt;("rxmicro/postgres-test-db")
                    .withExposedPorts(5432);

    @WithConfig
    private final PostgreSQLConfig config = new PostgreSQLConfig()
            .setDatabase("rxmicro")
            .setUser("rxmicro")
            .setPassword("password");

    private DataRepository dataRepository;

    @BeforeEach
    void beforeEach() {
        config
                .setHost(postgresqlTestDb.getHost())
                .setPort(postgresqlTestDb.getFirstMappedPort());
    }

    @Test
    void Should_find_account() {
        final Account account = requireNonNull(
                dataRepository.findByEmail("richard.hendricks@piedpiper.com").block()
        );

        assertEquals("Richard", account.getFirstName());
        assertEquals("Hendricks", account.getLastName());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-basic" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-basic</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="data-postgresql-annotations-section"><a class="anchor" href="#data-postgresql-annotations-section"></a><a class="link" href="#data-postgresql-annotations-section">9.2. <code>RxMicro Annotations</code></a></h3>
<div class="paragraph">
<p>The RxMicro framework supports the following <code>RxMicro Annotations</code>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 15. Supported <code>RxMicro Annotations</code>.</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Annotation</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data/src/main/java/io/rxmicro/data/Column.java" target="_blank" rel="noopener"><code>@Column</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets mapping between the column name in the <code>PostgreSQL DB</code> table and the Java model class field name.</p>
<p class="tableblock"><em>(By default, the RxMicro framework uses the Java model class field name as the column name in the <code>PostgreSQL DB</code> table.
If the name should differ for some reason, (for example, as a column name in the <code>PostgreSQL DB</code> table the keyword Java is used), it should be specified using this annotation!)</em></p>
<p class="tableblock">Required <code>length</code> parameter must contain the max character count that can be stored to table column.
If actual length will be more that expected length, value will be trimmed automatically.</p>
<p class="tableblock">The <code>nullable</code> parameter does not disable any validation.
It used as the descriptive characteristic only.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data/src/main/java/io/rxmicro/data/ColumnMappingStrategy.java" target="_blank" rel="noopener"><code>@ColumnMappingStrategy</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the strategy of column name formation in the <code>PostgreSQL DB</code> table, based on the analysis of the Java model class field names.</p>
<p class="tableblock"><em>(If this annotation annotates the Java model class, then the set strategy will be used for <strong>all</strong> fields in this class.
For example, if You set the default <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-model/src/main/java/io/rxmicro/model/MappingStrategy.java#L41" target="_blank" rel="noopener"><code>LOWERCASE_WITH_UNDERSCORED</code></a> strategy,
then the <code>parentId</code> field in the Java class will correspond to the <code>parent_id</code> column in the <code>PostgreSQL DB</code> table.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data/src/main/java/io/rxmicro/data/DataRepositoryGeneratorConfig.java" target="_blank" rel="noopener"><code>@DataRepositoryGeneratorConfig</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows You to configure the repository generation process.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data/src/main/java/io/rxmicro/data/RepeatParameter.java" target="_blank" rel="noopener"><code>@RepeatParameter</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows setting <a href="#data-postgres-repeat-parameter-section">mapping between one method parameter marked with this annotation and several universal placeholders that are used in the query to <code>PostgreSQL DB</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/operation/Select.java" target="_blank" rel="noopener"><code>@Select</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a repository method that must execute <a href="#data-postgresql-select-section">a <code>SELECT</code> SQL operation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/operation/CustomSelect.java" target="_blank" rel="noopener"><code>@CustomSelect</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a <a href="#data-postgresql-select-custom-section">string parameter of repository method, the value of that must be used as custom SELECT.</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/operation/Insert.java" target="_blank" rel="noopener"><code>@Insert</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a repository method that must execute <a href="#data-postgresql-insert-section">a <code>INSERT</code> SQL operation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/operation/Update.java" target="_blank" rel="noopener"><code>@Update</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a repository method that must execute <a href="#data-postgresql-update-section">a <code>UPDATE</code> SQL operation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/operation/Delete.java" target="_blank" rel="noopener"><code>@Delete</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a repository method that must execute <a href="#data-postgresql-delete-section">a <code>DELETE</code> SQL operation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/ExpectedUpdatedRowsCount.java" target="_blank" rel="noopener"><code>@ExpectedUpdatedRowsCount</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables <a href="#data-postgresql-expected-updated-rows-count-section">validation for updated rows count during DML operation, like <code>Insert</code>, <code>Update</code> and <code>Delete</code> operations</a>.</p>
<p class="tableblock">If current database has invalid state the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/model/InvalidDatabaseStateException.java" target="_blank" rel="noopener"><code>InvalidDatabaseStateException</code></a> will be thrown!</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/NotInsertable.java" target="_blank" rel="noopener"><code>@NotInsertable</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a model field, the value of that ignored during <code>INSERT</code> SQL operation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/NotUpdatable.java" target="_blank" rel="noopener"><code>@NotUpdatable</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a model field, the value of that ignored during <code>UPDATE</code> SQL operation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/PrimaryKey.java" target="_blank" rel="noopener"><code>@PrimaryKey</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#data-postgresql-primary-keys-section">a model field that must be used as primary key.</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/Schema.java" target="_blank" rel="noopener"><code>@Schema</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a schema of a database table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/SequenceGenerator.java" target="_blank" rel="noopener"><code>@SequenceGenerator</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="https://www.postgresql.org/docs/current/functions-sequence.html" target="_blank" rel="noopener">a sequence that must be used to get the next unique value for model field</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/Table.java" target="_blank" rel="noopener"><code>@Table</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a table name for entity.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/EnumType.java" target="_blank" rel="noopener"><code>@EnumType</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a db type name for enum.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/VariableValues.java" target="_blank" rel="noopener"><code>@VariableValues</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a <a href="#data-postgresql-variables-section">storage with the values of the predefined variables</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql-r2dbc-postgresql/src/main/java/io/rxmicro/data/sql/r2dbc/postgresql/PostgreSQLRepository.java" target="_blank" rel="noopener"><code>@PostgreSQLRepository</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes that an interface is a dynamic generated PostgreSQL data repository.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql-r2dbc-postgresql/src/main/java/io/rxmicro/data/sql/r2dbc/postgresql/PartialImplementation.java" target="_blank" rel="noopener"><code>@PartialImplementation</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes an abstract class that contains <a href="#data-postgresql-partial-implementation-section">a partial implementation of the annotated by this annotation a PostgreSQL Data Repository interface</a>.</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="data-postgresql-testing-section"><a class="anchor" href="#data-postgresql-testing-section"></a><a class="link" href="#data-postgresql-testing-section">9.3. Repositories Testing</a></h3>
<div class="paragraph">
<p>For successful functional testing of dynamic repositories, that interact with <a href="https://www.postgresql.org/" target="_blank" rel="noopener"><code>PostgreSQL DB</code></a>, it is required:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Presence of a script that creates a test database.</p>
</li>
<li>
<p>Mechanism for preparing a database for testing: creating a database before starting the test and deleting a database after completing the test.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="data-postgresql-test-database-section"><a class="anchor" href="#data-postgresql-test-database-section"></a><a class="link" href="#data-postgresql-test-database-section">9.3.1. Test Database</a></h4>
<div class="paragraph">
<p>A test database was created for testing the <code>rxmicro.data.sql.r2dbc.postgresql</code> module features, which are described in this section.</p>
</div>
<div class="paragraph">
<p>The test database contains three tables: <code>account</code>, <code>product</code> and <code>order</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/data-postgresql/rxmicro-test-db-er-diagram.jpg" alt="rxmicro test db er diagram">
</div>
<div class="title">Figure 14. ER-Diagram for Test Database</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>SQL scripts for creating a test database are available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/docker-image-postgres-test-db/src/main/sql" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/blob/master/examples/docker-image-postgres-test-db/src/main/sql/</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following classes of Java models correspond to the tables created in the test database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Table
@ColumnMappingStrategy
public final class Account {

    @PrimaryKey
    @SequenceGenerator
    Long id;

    @Column(length = Column.UNLIMITED_LENGTH)
    @NotUpdatable
    String email;

    @Column(length = Column.UNLIMITED_LENGTH)
    String firstName;

    @Column(length = Column.UNLIMITED_LENGTH)
    String lastName;

    BigDecimal balance;

    Role role;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Table
@ColumnMappingStrategy
public final class Order {

    @PrimaryKey
    Long id;

    Long idAccount;

    Integer idProduct;

    Integer count;

    @NotInsertable
    Instant created;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Table
@ColumnMappingStrategy
public final class Product {

    @PrimaryKey(autoGenerated = false)
    Integer id;

    @Column(length = Column.UNLIMITED_LENGTH)
    String name;

    BigDecimal price;

    Integer count;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public enum Role {

    CEO,

    Lead_Engineer,

    Systems_Architect
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For ease of studying the <code>rxmicro.data.sql.r2dbc.postgresql</code> module, You can use the ready-made <a href="https://www.postgresql.org/" target="_blank" rel="noopener"><code>PostgreSQL DB</code></a> image with the <a href="https://hub.docker.com/r/rxmicro/postgres-test-db" target="_blank" rel="noopener"><code>rxmicro/postgres-test-db</code></a> test database.</p>
</div>
<div class="paragraph">
<p>The source code of the project used as a base for building this <code>docker</code> image, is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/docker-image-postgres-test-db" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/docker-image-postgres-test-db</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="data-postgresql-test-templates-section"><a class="anchor" href="#data-postgresql-test-templates-section"></a><a class="link" href="#data-postgresql-test-templates-section">9.3.2. Test Templates</a></h4>
<div class="paragraph">
<p>As a mechanism for preparing a database for testing (creating a database before starting the test and deleting a database after completing the test), it is most convenient to use <a href="https://www.docker.com/" target="_blank" rel="noopener"><code>docker</code></a>.</p>
</div>
<div class="paragraph">
<p>To start <code>docker</code> containers in the functional test it is convenient to use the <a href="https://www.testcontainers.org/" target="_blank" rel="noopener"><code>Testcontainers</code></a> Java library:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@Testcontainers
<i class="conum" data-value="2"></i><b>(2)</b>
@RxMicroComponentTest(DataRepository.class)
final class DataRepositoryTestTemplate1 {

    <i class="conum" data-value="3"></i><b>(3)</b>
    @Container
    private static final GenericContainer&lt;?&gt; POSTGRESQL_TEST_DB =
            new GenericContainer&lt;&gt;("rxmicro/postgres-test-db")
                    .withExposedPorts(5432); <i class="conum" data-value="4"></i><b>(4)</b>

    <i class="conum" data-value="5"></i><b>(5)</b>
    @WithConfig
    private static final PostgreSQLConfig CONFIG = new PostgreSQLConfig()
            .setDatabase("rxmicro")
            .setUser("rxmicro")
            .setPassword("password"); <i class="conum" data-value="6"></i><b>(6)</b>

    @BeforeAll
    static void beforeAll() {
        POSTGRESQL_TEST_DB.start(); <i class="conum" data-value="7"></i><b>(7)</b>
        CONFIG
                .setHost(POSTGRESQL_TEST_DB.getHost()) <i class="conum" data-value="8"></i><b>(8)</b>
                .setPort(POSTGRESQL_TEST_DB.getFirstMappedPort());
    }

    private DataRepository dataRepository; <i class="conum" data-value="9"></i><b>(9)</b>

    // ... test methods must be here

    @AfterAll
    static void afterAll() {
        POSTGRESQL_TEST_DB.stop(); <i class="conum" data-value="10"></i><b>(10)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="https://github.com/testcontainers/testcontainers-java/blob/main/modules/junit-jupiter/src/main/java/org/testcontainers/junit/jupiter/Testcontainers.java" target="_blank" rel="noopener"><code>@Testcontainers</code></a>
annotation activates the start and stop of the <code>docker</code> containers to be used in this test.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Since the dynamic repository is a RxMicro component, for its testing You need to use <a href="testing.html#testing-component-tests-section">the microservice component testing approach</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <a href="https://github.com/testcontainers/testcontainers-java/blob/main/modules/junit-jupiter/src/main/java/org/testcontainers/junit/jupiter/Container.java" target="_blank" rel="noopener"><code>@Container</code></a>
annotation indicates the <code>docker</code> container that will be used in this test.
As an image on the basis of which it is necessary to create the <code>docker</code> container, the <a href="https://www.postgresql.org/" target="_blank" rel="noopener"><code>PostgreSQL DB</code></a> ready-made image with the
<a href="https://hub.docker.com/r/rxmicro/postgres-test-db" target="_blank" rel="noopener"><code>rxmicro/postgres-test-db</code></a> test database is used.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>When starting the <code>docker</code> container, You need to open the standard port for <a href="https://www.postgresql.org/" target="_blank" rel="noopener"><code>PostgreSQL DB</code></a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Using the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/WithConfig.java" target="_blank" rel="noopener"><code>@WithConfig</code></a>
annotation, the configuration available only during the test is declared.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Setting up the configuration to interact with the test database.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Before running all tests, You must start the <code>docker</code> container.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>After starting the <code>docker</code> container, You need to read the random IP address and port that will be used when connecting to the running <code>docker</code> container.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>When testing <a href="testing.html#testing-component-tests-section">microservice components</a>, it is necessary to specify a reference to the component in which the RxMicro framework will inject the tested component.</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>After completing all the tests, You must stop the <code>docker</code> container.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The main advantage of this template is the speed of testing.
Since the <code>docker</code> container is created once before starting <strong>all</strong> test methods, the total runtime of all test methods is reduced.
The main disadvantage of this template is that if any test method changes the <a href="https://www.postgresql.org/" target="_blank" rel="noopener"><code>PostgreSQL DB</code></a> state, the following test method may end with an error.</p>
</div>
<div class="paragraph">
<p><strong>Therefore, this functional test template should be used for queries to <a href="https://www.postgresql.org/" target="_blank" rel="noopener"><code>PostgreSQL DB</code></a> that do not change the database state!</strong></p>
</div>
<div class="paragraph">
<p>If You need to test methods that change the <a href="https://www.postgresql.org/" target="_blank" rel="noopener"><code>PostgreSQL DB</code></a> state, You should use another template:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@Testcontainers
<i class="conum" data-value="2"></i><b>(2)</b>
@RxMicroComponentTest(DataRepository.class)
final class DataRepositoryTestTemplate2 {

    <i class="conum" data-value="3"></i><b>(3)</b>
    @Container
    private final GenericContainer&lt;?&gt; postgresqlTestDb =
            new GenericContainer&lt;&gt;("rxmicro/postgres-test-db")
                    .withExposedPorts(5432); <i class="conum" data-value="4"></i><b>(4)</b>

    <i class="conum" data-value="5"></i><b>(5)</b>
    @WithConfig
    private final PostgreSQLConfig config = new PostgreSQLConfig()
            .setDatabase("rxmicro")
            .setUser("rxmicro")
            .setPassword("password"); <i class="conum" data-value="6"></i><b>(6)</b>

    private DataRepository dataRepository; <i class="conum" data-value="7"></i><b>(7)</b>

    @BeforeEach
    void beforeEach() {
        config
                .setHost(postgresqlTestDb.getHost()) <i class="conum" data-value="8"></i><b>(8)</b>
                .setPort(postgresqlTestDb.getFirstMappedPort());
    }

    // ... test methods must be here
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="https://github.com/testcontainers/testcontainers-java/blob/main/modules/junit-jupiter/src/main/java/org/testcontainers/junit/jupiter/Testcontainers.java" target="_blank" rel="noopener"><code>@Testcontainers</code></a>
annotation activates the start and stop of the <code>docker</code> containers to be used in this test.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Since the dynamic repository is a RxMicro component, for its testing You need to use <a href="testing.html#testing-component-tests-section">the microservice component testing approach</a></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <a href="https://github.com/testcontainers/testcontainers-java/blob/main/modules/junit-jupiter/src/main/java/org/testcontainers/junit/jupiter/Container.java" target="_blank" rel="noopener"><code>@Container</code></a>
annotation indicates the <code>docker</code> container that will be used in this test.
As an image on the basis of which it is necessary to create the <code>docker</code> container, the <a href="https://www.postgresql.org/" target="_blank" rel="noopener"><code>PostgreSQL DB</code></a> ready-made image with the
<a href="https://hub.docker.com/r/rxmicro/postgres-test-db" target="_blank" rel="noopener"><code>rxmicro/postgres-test-db</code></a> test database is used.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>When starting the <code>docker</code> container, You need to open the standard port for <a href="https://www.postgresql.org/" target="_blank" rel="noopener"><code>PostgreSQL DB</code></a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Using the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/WithConfig.java" target="_blank" rel="noopener"><code>@WithConfig</code></a>
annotation, the configuration available only during the test is declared.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Setting up the configuration to interact with the test database.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>When testing <a href="testing.html#testing-component-tests-section">microservice components</a>, it is necessary to specify a reference to the component in which the RxMicro framework will inject the tested component.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>After starting the <code>docker</code> container, You need to read the random IP address and port that will be used when connecting to the running <code>docker</code> container.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This template <strong>for each test method</strong> will create and drop the <code>docker</code> container, which may increase the total runtime of all test methods.</p>
</div>
<div class="paragraph">
<p><strong>Therefore, select the most appropriate functional test template based on the requirements of the tested functionality!</strong></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <a href="https://www.testcontainers.org/" target="_blank" rel="noopener"><code>Testcontainers</code></a> library starts the <code>docker</code> container before running the test and stops the <code>docker</code> container automatically after completing the test!</p>
</div>
<div class="paragraph">
<p>So You should start and stop the <code>docker</code> container manually only if You want to use one <code>docker</code> container for <strong>all</strong> test methods!</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="data-postgresql-model-section"><a class="anchor" href="#data-postgresql-model-section"></a><a class="link" href="#data-postgresql-model-section">9.4. DataBase Models</a></h3>
<div class="paragraph">
<p>The RxMicro framework supports the following database model types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#data-postgresql-model-primitives-section">primitives</a>;</p>
</li>
<li>
<p><a href="#data-postgresql-model-entities-section">entities</a>.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="data-postgresql-model-primitives-section"><a class="anchor" href="#data-postgresql-model-primitives-section"></a><a class="link" href="#data-postgresql-model-primitives-section">9.4.1. Primitives</a></h4>
<div class="paragraph">
<p>A primitive is a supported Java type that can be mapped to database table column.</p>
</div>
<div class="paragraph">
<p>The <code>rxmicro.data.sql.r2dbc.postgresql</code> module supports the following primitive type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>? extends Enum&lt;?&gt;</code>;</p>
</li>
<li>
<p><code>java.lang.Boolean</code>;</p>
</li>
<li>
<p><code>java.lang.Byte</code>;</p>
</li>
<li>
<p><code>java.lang.Short</code>;</p>
</li>
<li>
<p><code>java.lang.Integer</code>;</p>
</li>
<li>
<p><code>java.lang.Long</code>;</p>
</li>
<li>
<p><code>java.math.BigInteger</code>;</p>
</li>
<li>
<p><code>java.lang.Float</code>;</p>
</li>
<li>
<p><code>java.lang.Double</code>;</p>
</li>
<li>
<p><code>java.math.BigDecimal</code>;</p>
</li>
<li>
<p><code>java.lang.Character</code>;</p>
</li>
<li>
<p><code>java.lang.String</code>;</p>
</li>
<li>
<p><code>java.time.Instant</code>;</p>
</li>
<li>
<p><code>java.time.LocalTime</code>;</p>
</li>
<li>
<p><code>java.time.LocalDate</code>;</p>
</li>
<li>
<p><code>java.time.LocalDateTime</code>;</p>
</li>
<li>
<p><code>java.time.OffsetDateTime</code>;</p>
</li>
<li>
<p><code>java.time.ZonedDateTime</code>;</p>
</li>
<li>
<p><code>java.net.InetAddress</code>;</p>
</li>
<li>
<p><code>java.util.UUID</code>;</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For floating point numbers, it is suggested to use the <code>java.math.BigDecimal</code> type instead of <code>java.lang.Float</code> or <code>java.lang.Double</code>.</p>
</div>
<div class="paragraph">
<p>Using the <code>java.math.BigDecimal</code> allows excluding errors of decimal number notation.
<strong>This is particularly important if the decimal number is used to represent currency-related data!</strong></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="data-postgresql-model-entities-section"><a class="anchor" href="#data-postgresql-model-entities-section"></a><a class="link" href="#data-postgresql-model-entities-section">9.4.2. Entities</a></h4>
<div class="paragraph">
<p>An entity is a composition of <a href="#data-postgresql-model-primitives-section">primitives</a> only.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Table
@ColumnMappingStrategy
public final class Account {

    @PrimaryKey
    @SequenceGenerator
    Long id;

    @Column(length = Column.UNLIMITED_LENGTH)
    @NotUpdatable
    String email;

    @Column(length = Column.UNLIMITED_LENGTH)
    String firstName;

    @Column(length = Column.UNLIMITED_LENGTH)
    String lastName;

    BigDecimal balance;

    Role role;
}</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="data-postgres-universal-placeholder-section"><a class="anchor" href="#data-postgres-universal-placeholder-section"></a><a class="link" href="#data-postgres-universal-placeholder-section">9.5. Universal Placeholder</a></h3>
<div class="paragraph">
<p>The RxMicro framework recommends using the universal placeholder (<code>?</code>) as parameter value placeholder in the SQL queries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Select("SELECT * FROM ${table} WHERE email=?")
Mono&lt;Account&gt; findByEmail(String email);</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If this method invoked with the following parameter:<br>
<code>repository.findByEmail("<a href="mailto:welcome@rxmicro.io">welcome@rxmicro.io</a>");</code>,</p>
</div>
<div class="paragraph">
<p>the RxMicro framework will generate the following <code>PostgreSQL DB</code> query:<br>
<code>SELECT * FROM account WHERE email='<a href="mailto:welcome@rxmicro.io">welcome@rxmicro.io</a>'</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="data-postgres-repeat-parameter-section"><a class="anchor" href="#data-postgres-repeat-parameter-section"></a><a class="link" href="#data-postgres-repeat-parameter-section">9.6. <code>@RepeatParameter</code> Annotation</a></h3>
<div class="paragraph">
<p>The universal placeholder (<code>?</code>) is the simplest type of placeholders.</p>
</div>
<div class="paragraph">
<p>But unfortunately, it has one disadvantage: if a query parameter must be repeated, a developer must define a copy of this parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Select("SELECT * FROM ${table} WHERE firstName=? OR lastName=?")
Mono&lt;Account&gt; findByFirstOrLastNames(String name1, String name2);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data/src/main/java/io/rxmicro/data/RepeatParameter.java" target="_blank" rel="noopener"><code>@RepeatParameter</code></a> annotation fixes this disadvantage.</p>
</div>
<div class="paragraph">
<p>The following code is an equivalent to the code with a copy of the <code>name</code> parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Select("SELECT * FROM ${table} WHERE firstName=? OR lastName=?")
Mono&lt;Account&gt; findByFirstOrLastNames(@RepeatParameter(2) String name);</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="data-postgresql-sql-operations-section"><a class="anchor" href="#data-postgresql-sql-operations-section"></a><a class="link" href="#data-postgresql-sql-operations-section">9.7. SQL Operations</a></h3>
<div style="page-break-after: always;"></div>
<div class="sect3">
<h4 id="data-postgresql-select-section"><a class="anchor" href="#data-postgresql-select-section"></a><a class="link" href="#data-postgresql-select-section">9.7.1. <code>@Select</code></a></h4>
<div class="paragraph">
<p>The <code>rxmicro.data.sql.r2dbc.postgresql</code> module supports the <a href="https://www.postgresql.org/docs/current/sql-select.html" target="_blank" rel="noopener"><code>SELECT</code></a> SQL operation.</p>
</div>
<div class="sect4">
<h5 id="data-postgresql-select-return-section"><a class="anchor" href="#data-postgresql-select-return-section"></a><a class="link" href="#data-postgresql-select-return-section">9.7.1.1. Returning Types Support</a></h5>
<div class="sect5">
<h6 id="data-postgresql-select-return-reactive-types-section"><a class="anchor" href="#data-postgresql-select-return-reactive-types-section"></a><a class="link" href="#data-postgresql-select-return-reactive-types-section">9.7.1.1.1. Reactive Types Support</a></h6>
<div class="paragraph">
<p>PostgreSQL Data Repositories that generated by the RxMicro frameworks support the following return reactive types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If expected an asynchronous <code>0</code>-<code>1</code> result:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Mono.html" target="_blank" rel="noopener"><code>Mono&lt;MODEL&gt;</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html" target="_blank" rel="noopener"><code>CompletableFuture&lt;MODEL&gt;</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletionStage.html" target="_blank" rel="noopener"><code>CompletionStage&lt;MODEL&gt;</code></a>;</p>
</li>
<li>
<p><a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Single.html" target="_blank" rel="noopener"><code>Single&lt;MODEL&gt;</code></a>;</p>
</li>
<li>
<p><a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Maybe.html" target="_blank" rel="noopener"><code>Maybe&lt;MODEL&gt;</code></a>.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostgreSQLRepository
public interface SelectSingleDataRepository {

    @Select("SELECT * FROM ${table} WHERE email = ?")
    Mono&lt;Account&gt; findByEmail1(String email);

    @Select("SELECT * FROM ${table} WHERE email = ?")
    CompletableFuture&lt;Account&gt; findByEmail2(String email);

    @Select("SELECT * FROM ${table} WHERE email = ?")
    CompletionStage&lt;Account&gt; findByEmail3(String email);

    @Select("SELECT * FROM ${table} WHERE email = ?")
    CompletableFuture&lt;Optional&lt;Account&gt;&gt; findByEmail4(String email);

    @Select("SELECT * FROM ${table} WHERE email = ?")
    CompletionStage&lt;Optional&lt;Account&gt;&gt; findByEmail5(String email);

    @Select("SELECT * FROM ${table} WHERE email = ?")
    Single&lt;Account&gt; findByEmail6(String email);

    @Select("SELECT * FROM ${table} WHERE email = ?")
    Maybe&lt;Account&gt; findByEmail7(String email);
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>If expected an asynchronous <code>0</code>-<code>n</code> result:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Mono.html" target="_blank" rel="noopener"><code>Mono&lt;java.util.List&lt;MODEL&gt;&gt;</code></a>;</p>
</li>
<li>
<p><a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Flux.html" target="_blank" rel="noopener"><code>Flux&lt;MODEL&gt;</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html" target="_blank" rel="noopener"><code>CompletableFuture&lt;java.util.List&lt;MODEL&gt;&gt;</code></a>;</p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletionStage.html" target="_blank" rel="noopener"><code>CompletionStage&lt;java.util.List&lt;MODEL&gt;&gt;</code></a>;</p>
</li>
<li>
<p><a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Single.html" target="_blank" rel="noopener"><code>Single&lt;java.util.List&lt;MODEL&gt;&gt;</code></a>;</p>
</li>
<li>
<p><a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Flowable.html" target="_blank" rel="noopener"><code>Flowable&lt;MODEL&gt;</code></a>.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostgreSQLRepository
public interface SelectManyDataRepository {

    @Select("SELECT * FROM ${table} ORDER BY id")
    Mono&lt;List&lt;Account&gt;&gt; findAll1();

    @Select("SELECT * FROM ${table} ORDER BY id")
    Flux&lt;Account&gt; findAll2();

    @Select("SELECT * FROM ${table} ORDER BY id")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findAll3();

    @Select("SELECT * FROM ${table} ORDER BY id")
    CompletionStage&lt;List&lt;Account&gt;&gt; findAll4();

    @Select("SELECT * FROM ${table} ORDER BY id")
    Single&lt;List&lt;Account&gt;&gt; findAll5();

    @Select("SELECT * FROM ${table} ORDER BY id")
    Flowable&lt;Account&gt; findAll6();
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-select-return-reactive-types" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-select-return-reactive-types</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect5">
<h6 id="data-postgresql-select-return-model-types-section"><a class="anchor" href="#data-postgresql-select-return-model-types-section"></a><a class="link" href="#data-postgresql-select-return-model-types-section">9.7.1.1.2. Model Types Support</a></h6>
<div class="paragraph">
<p>PostgreSQL Data Repositories that generated by the RxMicro frameworks support the following return model types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If expected an asynchronous <code>0</code>-<code>1</code> result:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><a href="#data-postgresql-model-entities-section">Entity</a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/model/EntityFieldMap.java" target="_blank" rel="noopener"><code>EntityFieldMap</code></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/model/EntityFieldList.java" target="_blank" rel="noopener"><code>EntityFieldList</code></a>;</p>
</li>
<li>
<p><a href="#data-postgresql-model-primitives-section">Primitive</a>.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostgreSQLRepository
@VariableValues({
        "${table}", "account"
})
public interface SelectSingleDataRepository {

    @Select("SELECT * FROM ${table} " +
            "WHERE email='richard.hendricks@piedpiper.com'")
    CompletableFuture&lt;Account&gt; findSingleAccount();

    @Select("SELECT first_name, last_name FROM ${table} " +
            "WHERE email='richard.hendricks@piedpiper.com'")
    CompletableFuture&lt;EntityFieldMap&gt; findSingleEntityFieldMap();

    @Select("SELECT first_name, last_name FROM ${table} " +
            "WHERE email='richard.hendricks@piedpiper.com'")
    CompletableFuture&lt;EntityFieldList&gt; findSingleEntityFieldList();

    @Select("SELECT email FROM ${table} " +
            "WHERE email='richard.hendricks@piedpiper.com'")
    CompletableFuture&lt;String&gt; findSingleEmail();

    @Select("SELECT role FROM ${table} " +
            "WHERE email='richard.hendricks@piedpiper.com'")
    CompletableFuture&lt;Role&gt; findSingleRole();

    @Select("SELECT balance FROM ${table} " +
            "WHERE email='richard.hendricks@piedpiper.com'")
    CompletableFuture&lt;BigDecimal&gt; findSingleBalance();
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>If expected an asynchronous <code>0</code>-<code>n</code> result:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>A list of <a href="#data-postgresql-model-entities-section">entities</a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/model/EntityFieldMap.java" target="_blank" rel="noopener"><code>java.util.List&lt;EntityFieldMap&gt;</code></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/model/EntityFieldList.java" target="_blank" rel="noopener"><code>java.util.List&lt;EntityFieldList&gt;</code></a>;</p>
</li>
<li>
<p>A list of <a href="#data-postgresql-model-primitives-section">primitives</a>.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostgreSQLRepository
public interface SelectManyDataRepository {

    @Select("SELECT first_name, last_name FROM ${table} ORDER BY id")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findAllAccounts();

    @Select(
            value = "SELECT first_name, last_name FROM ${table} ORDER BY id",
            entityClass = Account.class
    )
    CompletableFuture&lt;List&lt;EntityFieldMap&gt;&gt; findAllEntityFieldMapList();

    @Select(
            value = "SELECT first_name, last_name FROM ${table} ORDER BY id",
            entityClass = Account.class
    )
    CompletableFuture&lt;List&lt;EntityFieldList&gt;&gt; findAllEntityFieldList();

    @Select(
            value = "SELECT email FROM ${table} ORDER BY id",
            entityClass = Account.class
    )
    CompletableFuture&lt;List&lt;String&gt;&gt; findAllEmails();

    @Select(
            value = "SELECT DISTINCT role FROM ${table} ORDER BY role",
            entityClass = Account.class
    )
    CompletableFuture&lt;List&lt;Role&gt;&gt; findAllRoles();

    @Select(
            value = "SELECT DISTINCT balance FROM ${table} ORDER BY balance",
            entityClass = Account.class
    )
    CompletableFuture&lt;List&lt;BigDecimal&gt;&gt; findAllBalances();
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-select-return-model-types" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-select-return-model-types</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect5">
<h6 id="data-postgresql-select-return-all-types-section"><a class="anchor" href="#data-postgresql-select-return-all-types-section"></a><a class="link" href="#data-postgresql-select-return-all-types-section">9.7.1.1.3. All Supported Return Types</a></h6>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more information, we recommend that You familiarize yourself with the following examples:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-return-types/src/main/java/io/rxmicro/examples/data/r2dbc/postgresql/returntypes/select" target="_blank" rel="noopener">All Supported Return Types</a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect4">
<h5 id="data-postgresql-select-parameters-section"><a class="anchor" href="#data-postgresql-select-parameters-section"></a><a class="link" href="#data-postgresql-select-parameters-section">9.7.1.2. <code>WHERE</code>, <code>ORDER BY</code> and Other <code>SELECT</code> Operations</a></h5>
<div class="paragraph">
<p>The <code>rxmicro.data.sql.r2dbc.postgresql</code> module supports all SQL nested operators that are supported by the <a href="https://www.postgresql.org/docs/current/sql-select.html" target="_blank" rel="noopener"><code>SELECT</code></a> operation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>WHERE</code> operator:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostgreSQLRepository
public interface SelectByFilterRepository {

    @Select("SELECT * FROM ${table} WHERE role=?")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findByRole(Role role);

    @Select("SELECT * FROM ${table} WHERE first_name=? OR first_name=? OR first_name=?")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findByFirstName(
            String firstName1, String firstName2, String firstName3
    );

    @Select("SELECT * FROM ${table} WHERE balance BETWEEN ? AND ?")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findByBalance(BigDecimal minBalance, BigDecimal maxBalance);

    @Select("SELECT * FROM ${table} WHERE first_name=? OR last_name=?")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findByFirstOrLastName(String name1, String name2);

    @Select("SELECT * FROM ${table} WHERE first_name ILIKE ? OR last_name ILIKE ?")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findByFirstOrLastName(@RepeatParameter(2) String name);
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>IN</code> operator:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostgreSQLRepository
public interface SelectByFilterUsingINOperatorRepository {

    @Select("SELECT * FROM ${table} WHERE role IN ('CEO'::role, 'Systems_Architect'::role)")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findByRole();

    @Select("SELECT * FROM ${table} WHERE email NOT IN (SELECT email FROM blocked_accounts)")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findNotBlockedAccount();

    @Select("SELECT * FROM ${table} WHERE email in ?")
    CompletableFuture&lt;Optional&lt;Account&gt;&gt; findByEmail(String email);

    @Select("SELECT * FROM ${table} WHERE email in ?")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findByEmail(List&lt;String&gt; emails);

    @Select("SELECT * FROM ${table} WHERE role in (?)")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findByRole(Role role);

    @Select("SELECT * FROM ${table} WHERE role in (?)")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findByRole(List&lt;Role&gt; roles);

    @Select("SELECT * FROM ${table} WHERE balance in (?)")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findByBalance(BigDecimal balance);

    @Select("SELECT * FROM ${table} WHERE balance in ?")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findByBalance(List&lt;BigDecimal&gt; balances);
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ORDER BY</code> operator:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostgreSQLRepository
public interface SelectOrderedDataRepository {

    @Select("SELECT * FROM ${table} ORDER BY id")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findAllOrderedById();

    @Select("SELECT * FROM ${table} ORDER BY ( id ? )")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findAllOrderedById(SortOrder sortOrder);

    @Select("SELECT * FROM ${table} ORDER BY ? ?")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findAllOrderedBy(String columnName, SortOrder sortOrder);

    @Select("SELECT * FROM ${table} ORDER BY (id ?, email ?) LIMIT 10")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findAllOrderedByIdAndEmail(
            @RepeatParameter(2) SortOrder sortOrder
    );
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>LIMIT</code> and/or <code>OFFSET</code> operator(s):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostgreSQLRepository
public interface SelectLimitedDataRepository {

    @Select("SELECT * FROM ${table} ORDER BY id LIMIT 2")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findFirst2Accounts();

    @Select("SELECT * FROM ${table} ORDER BY id LIMIT ?")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findAccounts(int limit);

    @Select("SELECT * FROM ${table} ORDER BY id LIMIT ? OFFSET ?")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findAccounts(int limit, int offset);

    @Select("SELECT * FROM ${table} ORDER BY id LIMIT ? OFFSET ?")
    CompletableFuture&lt;List&lt;Account&gt;&gt; findAccounts(Pageable pageable);
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Composition of <code>WHERE</code>, <code>ORDER BY</code>, <code>LIMIT</code> and <code>OFFSET</code> operators:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostgreSQLRepository
public interface SelectComplexDataRepository {

    @Select("SELECT * FROM ${table} WHERE " +
            "first_name ILIKE ? AND role IN (?) AND balance &lt; ? " +
            "ORDER BY (id ?, email ?) " +
            "LIMIT ? " +
            "OFFSET ?")
    CompletableFuture&lt;List&lt;Account&gt;&gt; find01(
            String firstNameTemplate,
            List&lt;Role&gt; roles,
            BigDecimal balance,
            @RepeatParameter(2) SortOrder sortOrder,
            int limit,
            int offset
    );
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>etc.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-select-parameters" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-select-parameters</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect4">
<h5 id="data-postgresql-select-projection-section"><a class="anchor" href="#data-postgresql-select-projection-section"></a><a class="link" href="#data-postgresql-select-projection-section">9.7.1.3. Selected Projections</a></h5>
<div class="paragraph">
<p>The <code>rxmicro.data.sql.r2dbc.postgresql</code> module supports projections from selected table(s).</p>
</div>
<div class="paragraph">
<p>To use projections, developer must specify required columns at <code>SELECT</code> query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostgreSQLRepository
public interface SelectProjectionDataRepository {

    @Select("SELECT * FROM ${table} " +
            "WHERE email='richard.hendricks@piedpiper.com'")
    CompletableFuture&lt;Account&gt; findAllColumns();

    @Select("SELECT id, email, first_name, last_name, balance FROM ${table} " +
            "WHERE email='richard.hendricks@piedpiper.com'")
    CompletableFuture&lt;Account&gt; findAllColumnsExceptRole1();

    @Select("SELECT id, email, last_name, first_name, balance FROM ${table} " +
            "WHERE email='richard.hendricks@piedpiper.com'")
    CompletableFuture&lt;Account&gt; findAllColumnsExceptRole2();

    @Select("SELECT 1 as id, " +
            "'richard.hendricks@piedpiper.com' as email, " +
            "'Hendricks' as last_name, " +
            "'Richard' as first_name, " +
            "70000.00 as balance")
    CompletableFuture&lt;Account&gt; findAllColumnsExceptRole3();

    @Select("SELECT first_name, last_name FROM ${table} " +
            "WHERE email='richard.hendricks@piedpiper.com'")
    CompletableFuture&lt;Account&gt; findFirstAndLastName();

    @Select("SELECT id, " +
            "'***@***' as email, " +
            "upper(last_name) as last_name, " +
            "first_name, " +
            "(20000 + 50000.00) as balance " +
            "FROM ${table} " +
            "WHERE email='richard.hendricks@piedpiper.com'")
    CompletableFuture&lt;Account&gt; findModifiedColumns();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For each nonstandard projection, the RxMicro framework generates a separate converter method.</p>
</div>
<div class="paragraph">
<p>For example for <code>SelectProjectionDataRepository</code> the RxMicro framework generates the following converter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class $$AccountEntityFromDBConverter
        extends EntityFromDBConverter&lt;Row, RowMetadata, Account&gt; {

    <i class="conum" data-value="1"></i><b>(1)</b>
    public Account fromDB(final Row dbRow,
                          final RowMetadata metadata) {
        final Account model = new Account();
        model.id = dbRow.get(0, Long.class);
        model.email = dbRow.get(1, String.class);
        model.firstName = dbRow.get(2, String.class);
        model.lastName = dbRow.get(3, String.class);
        model.balance = dbRow.get(4, BigDecimal.class);
        model.role = toEnum(Role.class, dbRow.get(5, String.class), "role");
        return model;
    }

    public Account fromDBFirst_nameLast_name(final Row dbRow,
                                             final RowMetadata metadata) {
        final Account model = new Account();
        model.firstName = dbRow.get(0, String.class);
        model.lastName = dbRow.get(1, String.class);
        return model;
    }

    public Account fromDBIdEmailFirst_nameLast_nameBalance(final Row dbRow,
                                                           final RowMetadata metadata) {
        final Account model = new Account();
        model.id = dbRow.get(0, Long.class);
        model.email = dbRow.get(1, String.class);
        model.firstName = dbRow.get(2, String.class);
        model.lastName = dbRow.get(3, String.class);
        model.balance = dbRow.get(4, BigDecimal.class);
        return model;
    }

    public Account fromDBIdEmailLast_nameFirst_nameBalance(final Row dbRow,
                                                           final RowMetadata metadata) {
        final Account model = new Account();
        model.id = dbRow.get(0, Long.class);
        model.email = dbRow.get(1, String.class);
        model.lastName = dbRow.get(2, String.class);
        model.firstName = dbRow.get(3, String.class);
        model.balance = dbRow.get(4, BigDecimal.class);
        return model;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>It is standard converter example.<br>
<em>(This converter is a standard one, because an order of the selected columns is defined by the order of fields of Java model class.
(<code>Account</code> class for current example.))</em></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-select-projection" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-select-projection</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect4">
<h5 id="data-postgresql-select-custom-section"><a class="anchor" href="#data-postgresql-select-custom-section"></a><a class="link" href="#data-postgresql-select-custom-section">9.7.1.4. Custom Select</a></h5>
<div class="paragraph">
<p>The <code>rxmicro.data.sql.r2dbc.postgresql</code> module introduces a <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/operation/CustomSelect.java" target="_blank" rel="noopener"><code>@CustomSelect</code></a>
annotation that allows working with a <code>Custom SELECT</code>.</p>
</div>
<div class="paragraph">
<p>The <code>Custom SELECT</code> is a string parameter that sends to a repository method and contains a SQL, built dynamically during an execution of a microservice:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostgreSQLRepository
public interface CustomSelectRepository {

    @Select
    CompletableFuture&lt;List&lt;EntityFieldMap&gt;&gt; findAll(
            @CustomSelect String sql <i class="conum" data-value="1"></i><b>(1)</b>
    );

    @Select
    CompletableFuture&lt;Optional&lt;Account&gt;&gt; findAccount(
            @CustomSelect(supportUniversalPlaceholder = false) String sql, <i class="conum" data-value="2"></i><b>(2)</b>
            String firstName
    );

    @Select
    CompletableFuture&lt;Optional&lt;Account&gt;&gt; findFirstAndLastName(
            @CustomSelect(selectedColumns = {"first_name", "last_name"}) String sql, <i class="conum" data-value="3"></i><b>(3)</b>
            String firstName
    );

    @Select
    CompletableFuture&lt;Optional&lt;Account&gt;&gt; findLastAndFirstName(
            @CustomSelect(selectedColumns = {"last_name", "first_name"}) String sql, <i class="conum" data-value="4"></i><b>(4)</b>
            String firstName
    );
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This is example of a repository method that can execute any <code>SELECT</code> query.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This repository method selects all columns defined at <code>Account</code> entity.<br>
<em>(Disabling of universal placeholder means that developer must use postgres specific placeholder (<code>$1</code>, <code>$2</code>, etc) instead of universal placeholder (<code>?</code>).
Otherwise error will be thrown!)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This repository method selects only selected columns (<code>first_name</code> and <code>last_name</code>) from <code>account</code> table.<br>
<em>(This method supports universal placeholder!)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>This repository method selects only selected columns (<code>last_name</code> and <code>first_name</code>) from <code>account</code> table.<br>
<em>(This method supports universal placeholder!)</em></td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Using of the <code>Custom SELECT</code> feature requires that dynamic built SQL contains the predefined selected columns, otherwise the model converter will convert a table row to the instance of Java class incorrectly!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following test describes how the <code>Custom SELECT</code> feature can be tested:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
void findAll() {
    final List&lt;EntityFieldMap&gt; entityFieldMaps = dataRepository.findAll(
            "SELECT email, first_name, last_name FROM account WHERE id = 1"
    ).join();
    assertEquals(
            List.of(
                    orderedMap(
                            "email", "richard.hendricks@piedpiper.com",
                            "first_name", "Richard",
                            "last_name", "Hendricks"
                    )
            ),
            entityFieldMaps
    );
}

@Test
void findAccount() {
    final Optional&lt;Account&gt; optionalAccount = dataRepository.findAccount(
            "SELECT * FROM account WHERE first_name = $1",
            "Richard"
    ).join();
    assertEquals(
            Optional.of(
                    new Account(
                            1L,
                            "richard.hendricks@piedpiper.com",
                            "Richard",
                            "Hendricks",
                            new BigDecimal("70000.00")
                    )
            ),
            optionalAccount
    );
}

@Test
void findFirstAndLastName() {
    final Optional&lt;Account&gt; optionalAccount = dataRepository.findFirstAndLastName(
            "SELECT first_name, last_name FROM account WHERE first_name = ?",
            "Richard"
    ).join();
    assertEquals(
            Optional.of(new Account("Richard", "Hendricks")),
            optionalAccount
    );
}

@Test
void findLastAndFirstName() {
    final Optional&lt;Account&gt; optionalAccount = dataRepository.findLastAndFirstName(
            "SELECT last_name, first_name FROM account WHERE first_name = ?",
            "Richard"
    ).join();
    assertEquals(
            Optional.of(new Account("Richard", "Hendricks")),
            optionalAccount
    );
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-select-custom" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-select-custom</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect3">
<h4 id="data-postgresql-insert-section"><a class="anchor" href="#data-postgresql-insert-section"></a><a class="link" href="#data-postgresql-insert-section">9.7.2. <code>@Insert</code></a></h4>
<div class="paragraph">
<p>The <code>rxmicro.data.sql.r2dbc.postgresql</code> module supports the <a href="https://www.postgresql.org/docs/current/sql-insert.html" target="_blank" rel="noopener"><code>INSERT</code></a> SQL operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostgreSQLRepository
public interface DataRepository {

    @Insert
    CompletableFuture&lt;Boolean&gt; insert1(Account account);

    @Insert
    CompletableFuture&lt;Account&gt; insert2(Account account);

    @Insert("INSERT INTO ${table} VALUES(nextval('account_seq'),?,?,?,?,?)")
    <i class="conum" data-value="1"></i><b>(1)</b>
    @VariableValues({
            "${table}", "account"
    })
    CompletableFuture&lt;Long&gt; insert3(
            String email, String firstName, String lastName, BigDecimal balance, Role role
    );

    @Insert("INSERT INTO ${table} VALUES(nextval('account_seq'),?,?,?,?,?) RETURNING *")
    CompletableFuture&lt;Account&gt; insert4(
            String email, String firstName, String lastName, BigDecimal balance, Role role
    );

    @Insert(
            value = "INSERT INTO ${table} VALUES(nextval('account_seq'),?,?,?,?,?)",
            entityClass = Account.class
    )
    CompletableFuture&lt;Long&gt; insert5(
            String email, String firstName, String lastName, BigDecimal balance, Role role
    );

    @Insert(
            value = "INSERT INTO ${table} VALUES(nextval('account_seq'),?,?,?,?,?) RETURNING *",
            entityClass = Account.class
    )
    CompletableFuture&lt;EntityFieldMap&gt; insert6(
            String email, String firstName, String lastName, BigDecimal balance, Role role
    );

    @Insert("INSERT INTO ${table}(${inserted-columns}) VALUES(${values}) " +
            "RETURNING ${returning-columns}")
    CompletableFuture&lt;AccountResult&gt; insert7(Account account);

    @Insert("INSERT INTO ${table}(${inserted-columns}) VALUES(${values}) " +
            "ON CONFLICT (${id-columns}) DO UPDATE SET ${on-conflict-update-inserted-columns}" +
            "RETURNING ${returning-columns}")
    CompletableFuture&lt;AccountResult&gt; insert8(Account account);

    @Insert("INSERT INTO ${table}(${inserted-columns}) VALUES(${values}) " +
            "ON CONFLICT (${id-columns}) DO UPDATE SET ${on-conflict-update-inserted-columns}")
    CompletableFuture&lt;Void&gt; insert9(Account account);

    @Insert("INSERT INTO ${table}(${inserted-columns}) VALUES(${values}) " +
            "ON CONFLICT (${id-columns}) DO NOTHING")
    CompletableFuture&lt;Void&gt; insert10(Account account);

    @Insert("INSERT INTO ${table} SELECT * FROM dump RETURNING *")
    CompletableFuture&lt;List&lt;Account&gt;&gt; insertMany1();

    @Insert("INSERT INTO account SELECT * FROM dump")
    CompletableFuture&lt;Long&gt; insertMany2();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The variable values are used to resolve predefined variables at the SQL query.<br>
<em>(Read more about the algorithm of the variables resolving at <a href="#data-postgresql-variables-section">Section 9.8, &#8220;Variables Support&#8221;</a>.)</em></td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more information, we recommend that You familiarize yourself with the following examples:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-return-types/src/main/java/io/rxmicro/examples/data/r2dbc/postgresql/returntypes/insert" target="_blank" rel="noopener">All Supported Return Types</a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-insert" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-insert</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="data-postgresql-update-section"><a class="anchor" href="#data-postgresql-update-section"></a><a class="link" href="#data-postgresql-update-section">9.7.3. <code>@Update</code></a></h4>
<div class="paragraph">
<p>The <code>rxmicro.data.sql.r2dbc.postgresql</code> module supports the <a href="https://www.postgresql.org/docs/current/sql-update.html" target="_blank" rel="noopener"><code>UPDATE</code></a> SQL operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostgreSQLRepository
public interface DataRepository {

    @Update
    CompletableFuture&lt;Boolean&gt; update1(Account account);

    @Update("UPDATE ${table} SET first_name=?, last_name=? WHERE id=?")
    <i class="conum" data-value="1"></i><b>(1)</b>
    @VariableValues({
            "${table}", "account"
    })
    CompletableFuture&lt;Long&gt; update2(String firstName, String lastName, Long id);

    @Update("UPDATE ${table} SET first_name=?, last_name=? WHERE ${by-id-filter} RETURNING *")
    CompletableFuture&lt;Account&gt; update3(String firstName, String lastName, Long id);

    @Update(
            value = "UPDATE ${table} SET first_name=?, last_name=? " +
                    "WHERE id = ?",
            entityClass = Account.class
    )
    CompletableFuture&lt;Long&gt; update4(String firstName, String lastName, Long id);

    @Update(
            value = "UPDATE ${table} SET first_name=?, last_name=? " +
                    "WHERE ${by-id-filter} RETURNING *",
            entityClass = Account.class
    )
    CompletableFuture&lt;EntityFieldMap&gt; update5(String firstName, String lastName, Long id);
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The variable values are used to resolve predefined variables at the SQL query.<br>
<em>(Read more about the algorithm of the variables resolving at <a href="#data-postgresql-variables-section">Section 9.8, &#8220;Variables Support&#8221;</a>.)</em></td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more information, we recommend that You familiarize yourself with the following examples:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-return-types/src/main/java/io/rxmicro/examples/data/r2dbc/postgresql/returntypes/update" target="_blank" rel="noopener">All Supported Return Types</a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-update" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-update</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="data-postgresql-delete-section"><a class="anchor" href="#data-postgresql-delete-section"></a><a class="link" href="#data-postgresql-delete-section">9.7.4. <code>@Delete</code></a></h4>
<div class="paragraph">
<p>The <code>rxmicro.data.sql.r2dbc.postgresql</code> module supports the <a href="https://www.postgresql.org/docs/current/sql-delete.html" target="_blank" rel="noopener"><code>DELETE</code></a> SQL operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostgreSQLRepository
public interface DataRepository {

    @Delete
    CompletableFuture&lt;Boolean&gt; delete1(Account account);

    @Delete("DELETE FROM ${table} WHERE balance &lt; ?")
    <i class="conum" data-value="1"></i><b>(1)</b>
    @VariableValues({
            "${table}", "account"
    })
    CompletableFuture&lt;Long&gt; delete2(BigDecimal minRequiredBalance);

    @Delete("DELETE FROM ${table} WHERE ${by-id-filter} RETURNING *")
    CompletableFuture&lt;Account&gt; delete3(Long id);

    @Delete(entityClass = Account.class)
    CompletableFuture&lt;Long&gt; delete4(Long id);

    @Delete(
            value = "DELETE FROM ${table} WHERE ${by-id-filter} RETURNING *",
            entityClass = Account.class
    )
    CompletableFuture&lt;EntityFieldMap&gt; delete5(Long id);
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The variable values are used to resolve predefined variables at the SQL query.<br>
<em>(Read more about the algorithm of the variables resolving at <a href="#data-postgresql-variables-section">Section 9.8, &#8220;Variables Support&#8221;</a>.)</em></td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more information, we recommend that You familiarize yourself with the following examples:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-return-types/src/main/java/io/rxmicro/examples/data/r2dbc/postgresql/returntypes/delete" target="_blank" rel="noopener">All Supported Return Types</a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-delete" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-delete</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="data-postgresql-variables-section"><a class="anchor" href="#data-postgresql-variables-section"></a><a class="link" href="#data-postgresql-variables-section">9.8. Variables Support</a></h3>
<div class="paragraph">
<p>When building SQL queries, sometimes it is necessary to specify the table name as a string constant.
This feature provides the developer with more flexibility: the table names may vary depending on the environment.</p>
</div>
<div class="paragraph">
<p>For better readability of SQL query, the RxMicro framework recommends using predefined variables instead of string concatenation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
public static final String TABLE_NAME = "table1";

<i class="conum" data-value="2"></i><b>(2)</b>
@Select("SELECT id, value FROM " + TABLE_NAME + " WHERE id = ?")
CompletableFuture&lt;EntityFieldMap&gt; findById1(long id);

<i class="conum" data-value="3"></i><b>(3)</b>
@Select("SELECT id, value FROM ${table} WHERE id = ?")
@VariableValues({
        "${table}", TABLE_NAME
})
CompletableFuture&lt;EntityFieldMap&gt; findById2(long id);</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>String constant with table name.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>When strings are concatenated, the readability of an entire SQL query gets worse.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Instead of string concatenation, the RxMicro framework recommends using predefined variables.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All predefined variables supported by the RxMicro framework are declared in the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/SupportedVariables.java" target="_blank" rel="noopener"><code>SupportedVariables</code></a> class</p>
</div>
<div class="paragraph">
<p>To determine the value of the predefined variable used in the query specified for the repository method, the RxMicro framework uses the following algorithm:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If the repository method returns or accepts the entity model as a parameter, the entity model class is used to define the variable value.</p>
</li>
<li>
<p>Otherwise, the RxMicro framework analyzes the optional <code>entityClass</code> parameter defined in the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/operation/Select.java" target="_blank" rel="noopener"><code>@Select</code></a>,
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/operation/Insert.java" target="_blank" rel="noopener"><code>@Insert</code></a>,
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/operation/Update.java" target="_blank" rel="noopener"><code>@Update</code></a> and
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/operation/Delete.java" target="_blank" rel="noopener"><code>@Delete</code></a> annotations.</p>
</li>
<li>
<p>If the optional <code>entityClass</code> parameter is set, the class specified in this parameter is used to define the variable value.</p>
</li>
<li>
<p>If the optional <code>entityClass</code> parameter is missing, the RxMicro framework tries to extract the variable value from the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/VariableValues.java" target="_blank" rel="noopener"><code>@VariableValues</code></a> annotation, which annotates this repository method.</p>
</li>
<li>
<p>If the repository method is not annotated with the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/VariableValues.java" target="_blank" rel="noopener"><code>@VariableValues</code></a>
annotation or the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/VariableValues.java" target="_blank" rel="noopener"><code>@VariableValues</code></a>
annotation does not contain the value of a predefined variable, then the RxMicro framework tries to extract the value of this variable from the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/VariableValues.java" target="_blank" rel="noopener"><code>@VariableValues</code></a> annotation, which annotates the repository interface.</p>
</li>
<li>
<p>If the variable value is undefined in all specified places, then the RxMicro framework notifies the developer about the error.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostgreSQLRepository
@VariableValues({
        "${table}", SelectDataRepository.GLOBAL_TABLE
})
public interface SelectDataRepository {

    public static final String GLOBAL_TABLE = "global_table";

    public static final String ENTITY_TABLE = "entity_table";

    public static final String LOCAL_TABLE = "local_table";

    <i class="conum" data-value="1"></i><b>(1)</b>
    @Select("SELECT * FROM ${table}")
    CompletableFuture&lt;List&lt;Entity&gt;&gt; findFromEntityTable1();

    <i class="conum" data-value="2"></i><b>(2)</b>
    @Select(value = "SELECT * FROM ${table}", entityClass = Entity.class)
    CompletableFuture&lt;List&lt;EntityFieldMap&gt;&gt; findFromEntityTable2();

    <i class="conum" data-value="3"></i><b>(3)</b>
    @Select("SELECT * FROM ${table}")
    CompletableFuture&lt;List&lt;EntityFieldMap&gt;&gt; findFromGlobalTable();

    <i class="conum" data-value="4"></i><b>(4)</b>
    @Select("SELECT * FROM ${table}")
    @VariableValues({
            "${table}", SelectDataRepository.LOCAL_TABLE
    })
    CompletableFuture&lt;List&lt;EntityFieldMap&gt;&gt; findFromLocalTable();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>${table}</code> variable value will be equal to <code>entity_table</code>.<br>
<em>(The variable value is read from the <code>Entity</code> class, which is returned by this method.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>${table}</code> variable value will be equal to <code>entity_table</code>.<br>
<em>(The variable value is read from the <code>Entity</code> class, since this class is specified in the <code>entityClass</code> parameter.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>${table}</code> variable value will be equal to <code>global_table</code>.<br>
<em>(The variable value is read from the <code>@VariableValues</code> annotation, which annotates the repository interface.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The <code>${table}</code> variable value will be equal to <code>local_table</code>.<br>
<em>(The variable value is read from the <code>@VariableValues</code> annotation, which annotates the repository method.)</em></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-variables" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-variables</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="data-postgresql-primary-keys-section"><a class="anchor" href="#data-postgresql-primary-keys-section"></a><a class="link" href="#data-postgresql-primary-keys-section">9.9. Primary Keys Support</a></h3>
<div class="paragraph">
<p>The <code>rxmicro.data.sql.r2dbc.postgresql</code> module supports four types of the primary keys:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Auto generated primary key. (<a href="https://www.postgresql.org/docs/current/datatype-numeric.html#DATATYPE-SERIAL" target="_blank" rel="noopener"><code>SERIAL</code> type.</a>)<br>
<em>(A uniqueness of this type of primary key is controlled by the database server!)</em>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PrimaryKey
Long id;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Auto generated primary key that uses <a href="https://www.postgresql.org/docs/current/functions-sequence.html" target="_blank" rel="noopener">a sequence to get the next unique value</a>.<br>
<em>(A uniqueness of this type of primary key is controlled by the database server!)</em>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PrimaryKey
@SequenceGenerator
Long id;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Manually set primary key.<br>
<em>(A developer must control a uniqueness of this type of primary key!)</em>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PrimaryKey(autoGenerated = false)
Integer id;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Complex primary key:<br>
<em>(A developer must control a uniqueness of this type of primary key!)</em>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PrimaryKey(autoGenerated = false)
Long idCategory;

@PrimaryKey(autoGenerated = false)
@Column(length = Column.UNLIMITED_LENGTH)
String idType;

@PrimaryKey(autoGenerated = false)
Role idRole;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-primary-keys" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-primary-keys</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="data-postgresql-expected-updated-rows-count-section"><a class="anchor" href="#data-postgresql-expected-updated-rows-count-section"></a><a class="link" href="#data-postgresql-expected-updated-rows-count-section">9.10. <code>@ExpectedUpdatedRowsCount</code> annotation</a></h3>
<div class="paragraph">
<p>Enables validation for updated rows count during DML operation, like <code>Insert</code>, <code>Update</code> and <code>Delete</code> operations.
This annotation adds additional runtime validator that validates the actual updated rows during SQL operation.</p>
</div>
<div class="paragraph">
<p>If current database has invalid state the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/model/InvalidDatabaseStateException.java" target="_blank" rel="noopener"><code>InvalidDatabaseStateException</code></a> will be thrown!</p>
</div>
<div class="paragraph">
<p>The following examples demonstrate the <code>@ExpectedUpdatedRowsCount</code> annotation usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ExpectedUpdatedRowsCount(10)
@Insert("INSERT INTO ${table} SELECT * FROM dump")
Mono&lt;Long&gt; insert12();

@ExpectedUpdatedRowsCount(1)
@Insert("INSERT INTO ${table} VALUES(nextval('account_seq'),?,?)")
Mono&lt;Boolean&gt; insert13(String firstName, String lastName);

@ExpectedUpdatedRowsCount(1)
@Insert("INSERT INTO ${table} VALUES(nextval('account_seq'),?,?) RETURNING *")
Mono&lt;Account&gt; insert14(String firstName, String lastName);

@ExpectedUpdatedRowsCount(0)
@Insert("INSERT INTO ${table} VALUES(nextval('account_seq'),?,?) RETURNING *")
Mono&lt;Account&gt; insert15(String firstName, String lastName);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ExpectedUpdatedRowsCount(10)
@Update("UPDATE ${table} SET first_name=?, last_name=? WHERE email=?")
Mono&lt;Long&gt; update12(String firstName, String lastName, String email);

@ExpectedUpdatedRowsCount(1)
@Update("UPDATE ${table} SET first_name=?, last_name=? WHERE id=?")
Mono&lt;Boolean&gt; update13(String firstName, String lastName, Long id);

@ExpectedUpdatedRowsCount(1)
@Update("UPDATE ${table} SET first_name=?, last_name=? WHERE ${by-id-filter} RETURNING *")
Mono&lt;Account&gt; update14(String firstName, String lastName, Long id);

@ExpectedUpdatedRowsCount(0)
@Update("UPDATE ${table} SET first_name=?, last_name=? WHERE ${by-id-filter} RETURNING *")
Mono&lt;Account&gt; update15(String firstName, String lastName, Long id);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ExpectedUpdatedRowsCount(1)
@Delete(entityClass = Account.class)
Mono&lt;Void&gt; delete11(Long id);

@ExpectedUpdatedRowsCount(10)
@Delete("DELETE FROM ${table} WHERE first_name ILIKE ? OR last_name ILIKE ?")
Mono&lt;Long&gt; delete12(Transaction transaction, @RepeatParameter(2) String name);

@ExpectedUpdatedRowsCount(1)
@Delete(entityClass = Account.class)
Mono&lt;Boolean&gt; delete13(Long id);

@ExpectedUpdatedRowsCount(1)
@Delete("DELETE FROM ${table} WHERE ${by-id-filter} RETURNING *")
Mono&lt;Account&gt; delete14(Long id);

@ExpectedUpdatedRowsCount(0)
@Delete("DELETE FROM ${table} WHERE ${by-id-filter} RETURNING *")
Mono&lt;Account&gt; delete15(Long id);</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-expected-updated-rows-count" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-expected-updated-rows-count</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="data-postgresql-transactional-section"><a class="anchor" href="#data-postgresql-transactional-section"></a><a class="link" href="#data-postgresql-transactional-section">9.11. Transactions Support</a></h3>
<div class="sect3">
<h4 id="data-postgresql-transactional-transaction-section"><a class="anchor" href="#data-postgresql-transactional-transaction-section"></a><a class="link" href="#data-postgresql-transactional-transaction-section">9.11.1. DataBase Transactions</a></h4>
<div class="paragraph">
<p>To work with database transactions the RxMicro framework introduces a basic transaction model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface Transaction {

    ReactiveType commit();

    ReactiveType rollback();

    ReactiveType create(SavePoint savePoint);

    ReactiveType release(SavePoint savePoint);

    ReactiveType rollback(SavePoint savePoint);

    IsolationLevel getIsolationLevel();

    ReactiveType setIsolationLevel(IsolationLevel isolationLevel);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>ReactiveType</code> can be <a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Mono.html" target="_blank" rel="noopener"><code>Mono&lt;Void&gt;</code></a>,
<a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Completable.html" target="_blank" rel="noopener"><code>Completable</code></a> or <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html" target="_blank" rel="noopener"><code>CompletableFuture&lt;Void&gt;</code></a>.</p>
</div>
<div class="paragraph">
<p>This basic transaction model has adaptation for <a href="core.html#core-reactive-libraries-support">all supported reactive libraries</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If You want to use the <a href="https://projectreactor.io/docs/core/release/reference/index.html" target="_blank" rel="noopener"><strong>Project Reactor</strong></a> library:</p>
<div class="ulist">
<ul>
<li>
<p><code>ReactiveType</code> will be a <a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Mono.html" target="_blank" rel="noopener"><code>Mono&lt;Void&gt;</code></a>.</p>
</li>
<li>
<p>You must use the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/model/reactor/Transaction.java" target="_blank" rel="noopener"><code>io.rxmicro.data.sql.model.reactor.Transaction</code></a> interface.</p>
</li>
<li>
<p>A repository method that creates a new transaction must return <code>Mono&lt;io.rxmicro.data.sql.model.reactor.Transaction&gt;</code> reactive type:</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.rxmicro.data.sql.model.reactor.Transaction;

@PostgreSQLRepository
public interface BeginReactorTransactionRepository {

    Mono&lt;Transaction&gt; beginTransaction();

    Mono&lt;Transaction&gt; beginTransaction(IsolationLevel isolationLevel);
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>If You want to use the <a href="https://github.com/ReactiveX/RxJava/blob/3.x/README.md" target="_blank" rel="noopener"><strong>RxJava</strong></a> library:</p>
<div class="ulist">
<ul>
<li>
<p><code>ReactiveType</code> will be a <a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Completable.html" target="_blank" rel="noopener"><code>Completable</code></a>.</p>
</li>
<li>
<p>You must use the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/model/rxjava3/Transaction.java" target="_blank" rel="noopener"><code>io.rxmicro.data.sql.model.rxjava3.Transaction</code></a> interface.</p>
</li>
<li>
<p>A repository method that creates a new transaction must return <code>Single&lt;io.rxmicro.data.sql.model.rxjava3.Transaction&gt;</code> reactive type:</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.rxmicro.data.sql.model.rxjava3.Transaction;

@PostgreSQLRepository
public interface BeginRxJava3TransactionRepository {

    Single&lt;Transaction&gt; beginTransaction();

    Single&lt;Transaction&gt; beginTransaction(IsolationLevel isolationLevel);
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>If You want to use the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/package-summary.html" target="_blank" rel="noopener"><strong>java.util.concurrent</strong></a> library:</p>
<div class="ulist">
<ul>
<li>
<p><code>ReactiveType</code> will be a <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html" target="_blank" rel="noopener"><code>CompletableFuture&lt;Void&gt;</code></a>.</p>
</li>
<li>
<p>You must use the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql/src/main/java/io/rxmicro/data/sql/model/completablefuture/Transaction.java" target="_blank" rel="noopener"><code>io.rxmicro.data.sql.model.completablefuture.Transaction</code></a> interface.</p>
</li>
<li>
<p>A repository method that creates a new transaction must return <code>CompletableFuture&lt;io.rxmicro.data.sql.model.completablefuture.Transaction&gt;</code> reactive type:</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.rxmicro.data.sql.model.completablefuture.Transaction;

@SuppressWarnings("unused")
@PostgreSQLRepository
public interface BeginCompletableFutureTransactionRepository {

    CompletionStage&lt;Transaction&gt; beginTransaction1();

    CompletionStage&lt;Transaction&gt; beginTransaction1(IsolationLevel isolationLevel);

    CompletableFuture&lt;Transaction&gt; beginTransaction2();

    CompletableFuture&lt;Transaction&gt; beginTransaction2(IsolationLevel isolationLevel);
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-transactional" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-transactional</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="data-postgresql-transactional-concurrent-section"><a class="anchor" href="#data-postgresql-transactional-concurrent-section"></a><a class="link" href="#data-postgresql-transactional-concurrent-section">9.11.2. Concurrent Access Example</a></h4>
<div class="paragraph">
<p>The following example demonstrates how developer can use the RxMicro framework to build microservice that requires concurrent access:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostgreSQLRepository
public interface ConcurrentRepository {

    Mono&lt;Transaction&gt; beginTransaction();

    @Select("SELECT * FROM ${table} WHERE id=? FOR UPDATE")
    Mono&lt;Account&gt; findAccountById(Transaction transaction, long id);

    @Select("SELECT * FROM ${table} WHERE id=? FOR UPDATE")
    Mono&lt;Product&gt; findProductById(Transaction transaction, int id);

    @Update(value = "UPDATE ${table} SET balance=? WHERE id=?", entityClass = Account.class)
    Mono&lt;Void&gt; updateAccountBalance(Transaction transaction, BigDecimal balance, long id);

    @Update(value = "UPDATE ${table} SET count=? WHERE id=?", entityClass = Product.class)
    Mono&lt;Void&gt; updateProductCount(Transaction transaction, int count, long id);

    @Insert
    Mono&lt;Order&gt; createOrder(Transaction transaction, Order order);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class ConcurrentBusinessService {

    private final ConcurrentRepository repository = getRepository(ConcurrentRepository.class);

    /**
     * @return order id if purchase is successful or
     *         error signal if:
     *                  - account not found or
     *                  - product not found or
     *                  - products ran out or
     *                  - money ran out
     */
    public Mono&lt;Long&gt; tryToBuy(final long idAccount,
                               final int idProduct,
                               final int count) {
        return repository.beginTransaction()
                .flatMap(transaction -&gt; repository.findAccountById(transaction, idAccount)
                        .flatMap(account -&gt; repository.findProductById(transaction, idProduct)
                                .flatMap(product -&gt;
                                        tryToBuy(transaction, account, product, count))
                                .switchIfEmpty(Mono.error(() -&gt;
                                        // product not found
                                        new ProductNotFoundException(idProduct))))
                        // account not found
                        .switchIfEmpty(Mono.error(() -&gt; new AccountNotFoundException(idAccount)))
                        .onErrorResume(transaction.createRollbackThenReturnErrorFallback())
                );
    }

    private Mono&lt;Long&gt; tryToBuy(final Transaction transaction,
                                final Account account,
                                final Product product,
                                final int count) {
        if (count &lt;= product.getCount()) {
            final BigDecimal cost = product.getPrice().multiply(BigDecimal.valueOf(count));
            if (cost.compareTo(account.getBalance()) &lt;= 0) {
                return buy(transaction, account, product, count, cost);
            } else {
                // money ran out
                return Mono.error(new NotEnoughFundsException(cost, account.getBalance()));
            }
        } else {
            // products ran out
            return Mono.error(new NotEnoughProductCountException(count, product.getCount()));
        }
    }

    // purchase is successful, returns order id
    private Mono&lt;Long&gt; buy(final Transaction transaction,
                           final Account account,
                           final Product product,
                           final int count,
                           final BigDecimal cost) {
        final int newProductCount = product.getCount() - count;
        final BigDecimal newBalance = account.getBalance().subtract(cost);
        final Order order = new Order(account.getId(), product.getId(), count);

        return repository.updateProductCount(transaction, newProductCount, product.getId())
                .then(repository.updateAccountBalance(transaction, newBalance, account.getId())
                        .then(repository.createOrder(transaction, order)
                                .map(Order::getId)
                                .flatMap(id -&gt; transaction.commit()
                                        .thenReturn(id))
                        )
                );
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more information, we recommend that You familiarize yourself with the following examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-concurrent-reactor" target="_blank" rel="noopener"><strong>Concurrent Example Using Spring Reactor Library</strong></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-concurrent-rxjava3" target="_blank" rel="noopener"><strong>Concurrent Example Using RxJava 3 Library</strong></a>;</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="data-postgresql-partial-implementation-section"><a class="anchor" href="#data-postgresql-partial-implementation-section"></a><a class="link" href="#data-postgresql-partial-implementation-section">9.12. Partial Implementation</a></h3>
<div class="paragraph">
<p>If the Postgre SQL data repository generated by the <code>RxMicro Annotation Processor</code> contains errors, incorrect or non-optimized logic, the developer can use the <code>Partial Implementation</code> feature.</p>
</div>
<div class="paragraph">
<p>This feature allows You to implement methods for the Postgre SQL data repository on Your own, instead of generating them by the RxMicro framework.</p>
</div>
<div class="paragraph">
<p>To activate this feature, You need to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql-r2dbc-postgresql/src/main/java/io/rxmicro/data/sql/r2dbc/postgresql/PartialImplementation.java" target="_blank" rel="noopener"><code>@PartialImplementation</code></a>
annotation, and specify an abstract class that contains a partial implementation of method(s) for Postgre SQL data repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostgreSQLRepository
<i class="conum" data-value="1"></i><b>(1)</b>
@PartialImplementation(AbstractDataRepository.class)
public interface DataRepository {

    @Select("SELECT 1 + 1")
    CompletableFuture&lt;Long&gt; generatedMethod();

    CompletableFuture&lt;Long&gt; userDefinedMethod();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql-r2dbc-postgresql/src/main/java/io/rxmicro/data/sql/r2dbc/postgresql/PartialImplementation.java" target="_blank" rel="noopener"><code>@PartialImplementation</code></a>
annotation, the <code>AbstractDataRepository</code> class is specified.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An <code>AbstractDataRepository</code> contains the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public abstract class AbstractDataRepository extends AbstractPostgreSQLRepository
        implements DataRepository {

    protected AbstractDataRepository(final Class&lt;?&gt; repositoryClass, final ConnectionPool pool) {
        super(repositoryClass, pool);
    }

    @Override
    public CompletableFuture&lt;Long&gt; userDefinedMethod() {
        return CompletableFuture.completedFuture(100L);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An abstract class that contains a partial implementation must meet the following requirements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The class must be an <code>abstract</code> one.</p>
</li>
<li>
<p>The class must extend the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql-r2dbc-postgresql/src/main/java/io/rxmicro/data/sql/r2dbc/postgresql/detail/AbstractPostgreSQLRepository.java" target="_blank" rel="noopener"><code>AbstractPostgreSQLRepository</code></a> one.</p>
</li>
<li>
<p>The class must implement the PostgreSQL data repository interface.</p>
</li>
<li>
<p>The class must contain an implementation of all methods that are not generated automatically.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In terms of infrastructure, the repository methods generated and defined by the developer for Postgre SQL data repository do not differ:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
void generatedMethod() {
    assertEquals(2L, dataRepository.generatedMethod().join());
}

@Test
void userDefinedMethod() {
    assertEquals(100L, dataRepository.userDefinedMethod().join());
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-partial-implementation" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-r2dbc-postgresql/data-r2dbc-postgresql-partial-implementation</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="data-postgresql-logging-section"><a class="anchor" href="#data-postgresql-logging-section"></a><a class="link" href="#data-postgresql-logging-section">9.13. Logging</a></h3>
<div class="paragraph">
<p>PostgreSQL Data Repositories use the <a href="https://github.com/pgjdbc/r2dbc-postgresql#reactive-relational-database-connectivity-postgresql-implementation--" target="_blank" rel="noopener"><strong>R2DBC PostgreSQL Driver</strong></a>, so in order to activate database request logging, You must configure the <strong>R2DBC PostgreSQL Driver Logger</strong>:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/pgjdbc/r2dbc-postgresql#logging" target="_blank" rel="noopener"><code>https://github.com/pgjdbc/r2dbc-postgresql#logging</code></a>.</p>
</div>
<div class="paragraph">
<p>For example, if to the <code>classpath</code> of the current project add the <a href="core.html#core-logger-config-file-inline"><code>jul.properties</code></a> resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">io.r2dbc.postgresql.QUERY.level=TRACE</code></pre>
</div>
</div>
<div class="paragraph">
<p>,then PostgreSQL Data Repositories will generate request logs to the database while working:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">[DEBUG] io.r2dbc.postgresql.QUERY : Executing query: <strong>SHOW TRANSACTION ISOLATION LEVEL</strong>
[DEBUG] io.r2dbc.postgresql.QUERY : Executing query: <strong>SELECT 2+2</strong>
[DEBUG] io.r2dbc.postgresql.QUERY : Executing query: <strong>SELECT first_name, last_name FROM account WHERE email = $1</strong></code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="data-mongo-section"><a class="anchor" href="#data-mongo-section"></a><a class="link" href="#data-mongo-section">10. Mongo Data Repositories</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The RxMicro framework supports creation of dynamic repositories for interaction with databases.</p>
</div>
<div class="paragraph">
<p>To interact with <a href="https://www.mongodb.com/" target="_blank" rel="noopener"><code>Mongo DB</code></a>, the RxMicro framework provides the <code>rxmicro.data.mongo</code> module.</p>
</div>
<div style="page-break-after: always;"></div>
<div class="sect2">
<h3 id="data-mongo-basic-section"><a class="anchor" href="#data-mongo-basic-section"></a><a class="link" href="#data-mongo-basic-section">10.1. Basic Usage</a></h3>
<div class="paragraph">
<p>To use the <code>rxmicro.data.mongo</code> module in the project, the following two steps must be taken:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Inject the <code>rxmicro.data.mongo</code> dependency to the <code>pom.xml</code> file:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
    &lt;artifactId&gt;rxmicro-data-mongo&lt;/artifactId&gt;
    &lt;version&gt;${rxmicro.version}&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;io.projectreactor&lt;/groupId&gt;
    &lt;artifactId&gt;reactor-core&lt;/artifactId&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;version&gt;${projectreactor.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Besides the <code>rxmicro.data.mongo</code> dependency, it is also recommended to add the reactive programming library.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Instead of adding a third-party reactive programming library, You can also use the
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/package-summary.html" target="_blank" rel="noopener"><strong>java.util.concurrent</strong></a> library built into the JDK, but often in practice the
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/package-summary.html" target="_blank" rel="noopener"><strong>java.util.concurrent</strong></a> library&#8217;s features are not enough.</p>
</div>
<div class="paragraph">
<p>Therefore, it is recommended to use the <a href="https://projectreactor.io/docs/core/release/reference/index.html" target="_blank" rel="noopener"><strong>Project Reactor</strong></a> or the <a href="https://github.com/ReactiveX/RxJava/blob/3.x/README.md" target="_blank" rel="noopener"><strong>RxJava</strong></a> library!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Add the <code>rxmicro.data.mongo</code> module to the <code>module-info.java</code> descriptor:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">module examples.data.mongo.basic {
    requires rxmicro.data.mongo;
    requires reactor.core;       <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When using a third-party reactive programming library, do not forget to add the corresponding module.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once the <code>rxmicro.data.mongo</code> module is added, You can create a data model class and a dynamic repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Account {

    String firstName;

    String lastName;

    public String getFirstName() {
        return firstName;
    }

    public String getLastName() {
        return lastName;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@MongoRepository(collection = "account")
public interface DataRepository {

    <i class="conum" data-value="2"></i><b>(2)</b>
    @Find(query = "{email: ?}")
    Mono&lt;Account&gt; findByEmail(String email);
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>In order for a standard interface to be recognized by the RxMicro framework as a dynamic repository for interaction with <a href="https://www.mongodb.com/" target="_blank" rel="noopener"><code>Mongo DB</code></a>, this interface should be annotated with the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-mongo/src/main/java/io/rxmicro/data/mongo/MongoRepository.java" target="_blank" rel="noopener"><code>@MongoRepository</code></a> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The dynamic repository may contain methods that form a query to the <a href="https://www.mongodb.com/" target="_blank" rel="noopener"><code>Mongo DB</code></a>.
<em>(The query that used for a request for data uses the JSON format (Specialized request format for <a href="https://www.mongodb.com/" target="_blank" rel="noopener"><code>Mongo DB</code></a>) and is specified in the annotation parameters.
For each operation supported by <a href="https://www.mongodb.com/" target="_blank" rel="noopener"><code>Mongo DB</code></a>, the RxMicro framework defines a separate annotation:
The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-mongo/src/main/java/io/rxmicro/data/mongo/operation/Find.java" target="_blank" rel="noopener"><code>@Find</code></a> annotation describes the
<a href="https://docs.mongodb.com/manual/reference/method/db.collection.find/" target="_blank" rel="noopener"><code>db.collection.find()</code></a>operation.)</em></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Since the dynamic repository is a RxMicro component, for its testing You need to use <a href="testing.html#testing-component-tests-section">the microservice component testing approach</a>:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The common approach recommended for testing dynamic repositories, that interact with <a href="https://www.mongodb.com/" target="_blank" rel="noopener"><code>Mongo DB</code></a>, is described in the <a href="#data-mongo-test-templates-section">Section 10.3.2, &#8220;Test Templates&#8221;</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Testcontainers
@RxMicroComponentTest(DataRepository.class)
final class DataRepositoryTest {

    @Container
    private final GenericContainer&lt;?&gt; mongoTestDb =
            new GenericContainer&lt;&gt;("rxmicro/mongo-test-db")
                    .withExposedPorts(27017);

    @WithConfig
    private final MongoConfig mongoConfig = new MongoConfig()
            .setDatabase("rxmicro");

    private DataRepository dataRepository;

    @BeforeEach
    void beforeEach() {
        mongoConfig
                .setHost(mongoTestDb.getHost())
                .setPort(mongoTestDb.getFirstMappedPort());
    }

    @Test
    void Should_find_account() {
        final Account account =
                dataRepository.findByEmail("richard.hendricks@piedpiper.com")
                        .blockOptional()
                        .orElseThrow();

        assertEquals("Richard", account.getFirstName());
        assertEquals("Hendricks", account.getLastName());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-basic" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-basic</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="data-mongo-annotations-section"><a class="anchor" href="#data-mongo-annotations-section"></a><a class="link" href="#data-mongo-annotations-section">10.2. <code>RxMicro Annotations</code></a></h3>
<div class="paragraph">
<p>The RxMicro framework supports the following <code>RxMicro Annotations</code>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 16. Supported <code>RxMicro Annotations</code>.</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Annotation</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data/src/main/java/io/rxmicro/data/Column.java" target="_blank" rel="noopener"><code>@Column</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets mapping between the field name in the <code>Mongo DB</code> document and the Java model class field name.</p>
<p class="tableblock"><em>(By default, the RxMicro framework uses the Java model class field name as the field name in the <code>Mongo DB</code> document.
If the name should differ for some reason, (for example, as a field name in the <code>Mongo DB</code> document the keyword Java is used), it should be specified using this annotation!)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data/src/main/java/io/rxmicro/data/ColumnMappingStrategy.java" target="_blank" rel="noopener"><code>@ColumnMappingStrategy</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the strategy of field name formation in the <code>Mongo DB</code> document, based on the analysis of the Java model class field names.</p>
<p class="tableblock"><em>(If this annotation annotates the Java model class, then the set strategy will be used for <strong>all</strong> fields in this class.
For example, if You set the default <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-model/src/main/java/io/rxmicro/model/MappingStrategy.java#L41" target="_blank" rel="noopener"><code>LOWERCASE_WITH_UNDERSCORED</code></a> strategy,
then the <code>parentId</code> field in the Java class will correspond to the <code>parent_id</code> field in the <code>Mongo DB</code> document.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data/src/main/java/io/rxmicro/data/DataRepositoryGeneratorConfig.java" target="_blank" rel="noopener"><code>@DataRepositoryGeneratorConfig</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows You to configure the repository generation process.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data/src/main/java/io/rxmicro/data/RepeatParameter.java" target="_blank" rel="noopener"><code>@RepeatParameter</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows setting <a href="#data-mongo-repeat-parameter-section">mapping between one method parameter marked with this annotation and several universal placeholders that are used in the request to <code>Mongo DB</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-mongo/src/main/java/io/rxmicro/data/mongo/operation/Find.java" target="_blank" rel="noopener"><code>@Find</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a repository method that must execute <a href="#data-mongo-find-section">a <code>db.collection.find()</code> operation</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-mongo/src/main/java/io/rxmicro/data/mongo/operation/Aggregate.java" target="_blank" rel="noopener"><code>@Aggregate</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a repository method that must execute <a href="#data-mongo-aggregate-section">a <code>db.collection.aggregate()</code> operation</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-mongo/src/main/java/io/rxmicro/data/mongo/operation/Distinct.java" target="_blank" rel="noopener"><code>@Distinct</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a repository method that must execute <a href="#data-mongo-distinct-section">a <code>db.collection.distinct()</code> operation</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-mongo/src/main/java/io/rxmicro/data/mongo/operation/CountDocuments.java" target="_blank" rel="noopener"><code>@CountDocuments</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a repository method that must execute <a href="#data-mongo-countDocuments-section">a <code>db.collection.countDocuments()</code> operation</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-mongo/src/main/java/io/rxmicro/data/mongo/operation/EstimatedDocumentCount.java" target="_blank" rel="noopener"><code>@EstimatedDocumentCount</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a repository method that must execute <a href="#data-mongo-estimatedDocumentCount-section">a <code>db.collection.estimatedDocumentCount()</code> operation</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-mongo/src/main/java/io/rxmicro/data/mongo/operation/Insert.java" target="_blank" rel="noopener"><code>@Insert</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a repository method that must execute <a href="#data-mongo-insert-section">a <code>db.collection.insertOne()</code> operation</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-mongo/src/main/java/io/rxmicro/data/mongo/operation/Update.java" target="_blank" rel="noopener"><code>@Update</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a repository method that must execute <a href="#data-mongo-update-section">a <code>db.collection.updateOne()</code> operation</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-mongo/src/main/java/io/rxmicro/data/mongo/operation/Delete.java" target="_blank" rel="noopener"><code>@Delete</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a repository method that must execute <a href="#data-mongo-delete-section">a <code>db.collection.deleteOne()</code> operation</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-mongo/src/main/java/io/rxmicro/data/mongo/DocumentId.java" target="_blank" rel="noopener"><code>@DocumentId</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes a model field that must be used as <a href="https://docs.mongodb.com/manual/core/data-modeling-introduction/" target="_blank" rel="noopener">document unique identifier</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-mongo/src/main/java/io/rxmicro/data/mongo/MongoRepository.java" target="_blank" rel="noopener"><code>@MongoRepository</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes that an interface is a dynamic generated Mongo data repository.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-mongo/src/main/java/io/rxmicro/data/mongo/PartialImplementation.java" target="_blank" rel="noopener"><code>@PartialImplementation</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes an abstract class that contains <a href="#data-mongo-partial-implementation-section">a partial implementation of the annotated by this annotation a Mongo Data Repository interface</a>.</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="data-mongo-testing-section"><a class="anchor" href="#data-mongo-testing-section"></a><a class="link" href="#data-mongo-testing-section">10.3. Repositories Testing</a></h3>
<div class="paragraph">
<p>For successful functional testing of dynamic repositories, that interact with <a href="https://www.mongodb.com/" target="_blank" rel="noopener"><code>Mongo DB</code></a>, it is required:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Presence of a script that creates a test database.</p>
</li>
<li>
<p>Mechanism for preparing a database for testing: creating a database before starting the test and deleting a database after completing the test.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="data-mongo-test-database-section"><a class="anchor" href="#data-mongo-test-database-section"></a><a class="link" href="#data-mongo-test-database-section">10.3.1. Test Database</a></h4>
<div class="paragraph">
<p>A test database was created for testing the <code>rxmicro.data.mongo</code>, module features, which are described in this section.</p>
</div>
<div class="paragraph">
<p>The test database consists of one <code>account</code> collection, which contains 6 documents describing the accounts of the test users:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/data-mongo/mongo-test-db.jpg" alt="mongo test db">
</div>
<div class="title">Figure 15. Mongo Test Database</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Scripts for creating a test database are available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/docker-image-mongo-test-db/src/main/js" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/blob/master/examples/docker-image-mongo-test-db/src/main/js/</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following classes of Java models correspond to the documents created in the test database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class Account {
    @DocumentId
    Long id;

    String email;

    String firstName;

    String lastName;

    BigDecimal balance;

    Role role;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public enum Role {

    CEO,

    Systems_Architect,

    Lead_Engineer,

    Engineer
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For ease of studying the <code>rxmicro.data.mongo</code> module, You can use the ready-made <a href="https://www.mongodb.com/" target="_blank" rel="noopener"><code>Mongo DB</code></a> image with the <a href="https://hub.docker.com/r/rxmicro/mongo-test-db" target="_blank" rel="noopener"><code>rxmicro/mongo-test-db</code></a> test database.</p>
</div>
<div class="paragraph">
<p>The source code of the project used as a base for building this <code>docker</code> image, is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/docker-image-mongo-test-db" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/docker-image-mongo-test-db</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="data-mongo-test-templates-section"><a class="anchor" href="#data-mongo-test-templates-section"></a><a class="link" href="#data-mongo-test-templates-section">10.3.2. Test Templates</a></h4>
<div class="paragraph">
<p>As a mechanism for preparing a database for testing (creating a database before starting the test and deleting a database after completing the test), it is most convenient to use <a href="https://www.docker.com/" target="_blank" rel="noopener"><code>docker</code></a>.</p>
</div>
<div class="paragraph">
<p>To start <code>docker</code> containers in the functional test it is convenient to use the <a href="https://www.testcontainers.org/" target="_blank" rel="noopener"><code>Testcontainers</code></a> Java library:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@Testcontainers
<i class="conum" data-value="2"></i><b>(2)</b>
@RxMicroComponentTest(DataRepository.class)
final class DataRepositoryTestTemplate1 {

    <i class="conum" data-value="3"></i><b>(3)</b>
    @Container
    private static final GenericContainer&lt;?&gt; MONGO_TEST_DB =
            new GenericContainer&lt;&gt;("rxmicro/mongo-test-db")
                    .withExposedPorts(27017); <i class="conum" data-value="4"></i><b>(4)</b>

    <i class="conum" data-value="5"></i><b>(5)</b>
    @WithConfig
    private static final MongoConfig MONGO_CONFIG = new MongoConfig()
            .setDatabase("rxmicro"); <i class="conum" data-value="6"></i><b>(6)</b>

    @BeforeAll
    static void beforeAll() {
        MONGO_TEST_DB.start(); <i class="conum" data-value="7"></i><b>(7)</b>
        MONGO_CONFIG
                .setHost(MONGO_TEST_DB.getHost()) <i class="conum" data-value="8"></i><b>(8)</b>
                .setPort(MONGO_TEST_DB.getFirstMappedPort());
    }

    private DataRepository dataRepository; <i class="conum" data-value="9"></i><b>(9)</b>

    // ... test methods must be here

    @AfterAll
    static void afterAll() {
        MONGO_TEST_DB.stop(); <i class="conum" data-value="10"></i><b>(10)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="https://github.com/testcontainers/testcontainers-java/blob/main/modules/junit-jupiter/src/main/java/org/testcontainers/junit/jupiter/Testcontainers.java" target="_blank" rel="noopener"><code>@Testcontainers</code></a>
annotation activates the start and stop of the <code>docker</code> containers to be used in this test.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Since the dynamic repository is a RxMicro component, for its testing You need to use <a href="testing.html#testing-component-tests-section">the microservice component testing approach</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <a href="https://github.com/testcontainers/testcontainers-java/blob/main/modules/junit-jupiter/src/main/java/org/testcontainers/junit/jupiter/Container.java" target="_blank" rel="noopener"><code>@Container</code></a>
annotation indicates the <code>docker</code> container that will be used in this test.
As an image on the basis of which it is necessary to create the <code>docker</code> container, the <a href="https://www.mongodb.com/" target="_blank" rel="noopener"><code>Mongo DB</code></a> ready-made image with the
<a href="https://hub.docker.com/r/rxmicro/mongo-test-db" target="_blank" rel="noopener"><code>rxmicro/mongo-test-db</code></a> test database is used.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>When starting the <code>docker</code> container, You need to open the standard port for <a href="https://www.mongodb.com/" target="_blank" rel="noopener"><code>Mongo DB</code></a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Using the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/WithConfig.java" target="_blank" rel="noopener"><code>@WithConfig</code></a>
annotation, the configuration available only during the test is declared.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Setting up the configuration to interact with the test database.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Before running all tests, You must start the <code>docker</code> container.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>After starting the <code>docker</code> container, You need to read the random IP address and port that will be used when connecting to the running <code>docker</code> container.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>When testing <a href="testing.html#testing-component-tests-section">microservice components</a>, it is necessary to specify a reference to the component in which the RxMicro framework will inject the tested component.</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>After completing all the tests, You must stop the <code>docker</code> container.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The main advantage of this template is the speed of testing.
Since the <code>docker</code> container is created once before starting <strong>all</strong> test methods, the total runtime of all test methods is reduced.
The main disadvantage of this template is that if any test method changes the <a href="https://www.mongodb.com/" target="_blank" rel="noopener"><code>Mongo DB</code></a> state, the following test method may end with an error.</p>
</div>
<div class="paragraph">
<p><strong>Therefore, this functional test template should be used for queries to <a href="https://www.mongodb.com/" target="_blank" rel="noopener"><code>Mongo DB</code></a> that do not change the database state!</strong></p>
</div>
<div class="paragraph">
<p>If You need to test methods that change the <a href="https://www.mongodb.com/" target="_blank" rel="noopener"><code>Mongo DB</code></a> state, You should use another template:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@Testcontainers
<i class="conum" data-value="2"></i><b>(2)</b>
@RxMicroComponentTest(DataRepository.class)
final class DataRepositoryTestTemplate2 {

    <i class="conum" data-value="3"></i><b>(3)</b>
    @Container
    private final GenericContainer&lt;?&gt; mongoTestDb =
            new GenericContainer&lt;&gt;("rxmicro/mongo-test-db")
                    .withExposedPorts(27017); <i class="conum" data-value="4"></i><b>(4)</b>

    <i class="conum" data-value="5"></i><b>(5)</b>
    @WithConfig
    private final MongoConfig mongoConfig = new MongoConfig()
            .setDatabase("rxmicro"); <i class="conum" data-value="6"></i><b>(6)</b>

    private DataRepository dataRepository; <i class="conum" data-value="7"></i><b>(7)</b>

    @BeforeEach
    void beforeEach() {
        mongoConfig
                .setHost(mongoTestDb.getHost()) <i class="conum" data-value="8"></i><b>(8)</b>
                .setPort(mongoTestDb.getFirstMappedPort());
    }

    // ... test methods must be here
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="https://github.com/testcontainers/testcontainers-java/blob/main/modules/junit-jupiter/src/main/java/org/testcontainers/junit/jupiter/Testcontainers.java" target="_blank" rel="noopener"><code>@Testcontainers</code></a>
annotation activates the start and stop of the <code>docker</code> containers to be used in this test.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Since the dynamic repository is a RxMicro component, for its testing You need to use <a href="testing.html#testing-component-tests-section">the microservice component testing approach</a></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <a href="https://github.com/testcontainers/testcontainers-java/blob/main/modules/junit-jupiter/src/main/java/org/testcontainers/junit/jupiter/Container.java" target="_blank" rel="noopener"><code>@Container</code></a>
annotation indicates the <code>docker</code> container that will be used in this test.
As an image on the basis of which it is necessary to create the <code>docker</code> container, the <a href="https://www.mongodb.com/" target="_blank" rel="noopener"><code>Mongo DB</code></a> ready-made image with the
<a href="https://hub.docker.com/r/rxmicro/mongo-test-db" target="_blank" rel="noopener"><code>rxmicro/mongo-test-db</code></a> test database is used.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>When starting the <code>docker</code> container, You need to open the standard port for <a href="https://www.mongodb.com/" target="_blank" rel="noopener"><code>Mongo DB</code></a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Using the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/WithConfig.java" target="_blank" rel="noopener"><code>@WithConfig</code></a>
annotation, the configuration available only during the test is declared.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Setting up the configuration to interact with the test database.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>When testing <a href="testing.html#testing-component-tests-section">microservice components</a>, it is necessary to specify a reference to the component in which the RxMicro framework will inject the tested component.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>After starting the <code>docker</code> container, You need to read the random IP address and port that will be used when connecting to the running <code>docker</code> container.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This template <strong>for each test method</strong> will create and drop the <code>docker</code> container, which may increase the total runtime of all test methods.</p>
</div>
<div class="paragraph">
<p><strong>Therefore, select the most appropriate functional test template based on the requirements of the tested functionality!</strong></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <a href="https://www.testcontainers.org/" target="_blank" rel="noopener"><code>Testcontainers</code></a> library starts the <code>docker</code> container before running the test and stops the <code>docker</code> container automatically after completing the test!</p>
</div>
<div class="paragraph">
<p>So You should start and stop the <code>docker</code> container manually only if You want to use one <code>docker</code> container for <strong>all</strong> test methods!</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="data-mongo-universal-placeholder-section"><a class="anchor" href="#data-mongo-universal-placeholder-section"></a><a class="link" href="#data-mongo-universal-placeholder-section">10.4. Universal Placeholder</a></h3>
<div class="paragraph">
<p>The RxMicro framework recommends using the universal placeholder (<code>?</code>) as parameter value placeholder in the <code>Mongo DB</code> queries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Find(query = "{email: ?}")
Mono&lt;Account&gt; findByEmail(String email);</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If this method invoked with the following parameter:<br>
<code>repository.findByEmail("<a href="mailto:welcome@rxmicro.io">welcome@rxmicro.io</a>");</code>,</p>
</div>
<div class="paragraph">
<p>the RxMicro framework will generate the following <code>Mongo DB</code> query:<br>
<code>{email: "<a href="mailto:welcome@rxmicro.io">welcome@rxmicro.io</a>"}</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="data-mongo-repeat-parameter-section"><a class="anchor" href="#data-mongo-repeat-parameter-section"></a><a class="link" href="#data-mongo-repeat-parameter-section">10.5. <code>@RepeatParameter</code> Annotation</a></h3>
<div class="paragraph">
<p>The universal placeholder (<code>?</code>) is the simplest type of placeholders.</p>
</div>
<div class="paragraph">
<p>But unfortunately, it has one disadvantage: if a query parameter must be repeated, a developer must define a copy of this parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Find(query = "{$or: [{firstName: ?}, {lastName: ?}]}")
Mono&lt;Account&gt; findByFirstOrLastNames(String name1, String name2);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data/src/main/java/io/rxmicro/data/RepeatParameter.java" target="_blank" rel="noopener"><code>@RepeatParameter</code></a> annotation fixes this disadvantage.</p>
</div>
<div class="paragraph">
<p>The following code is an equivalent to the code with a copy of the <code>name</code> parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Find(query = "{$or: [{firstName: ?}, {lastName: ?}]}")
Mono&lt;Account&gt; findByFirstOrLastNames(@RepeatParameter(2) String name);</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="data-mongo-operations-section"><a class="anchor" href="#data-mongo-operations-section"></a><a class="link" href="#data-mongo-operations-section">10.6. Mongo Operations</a></h3>
<div style="page-break-after: always;"></div>
<div class="sect3">
<h4 id="data-mongo-find-section"><a class="anchor" href="#data-mongo-find-section"></a><a class="link" href="#data-mongo-find-section">10.6.1. <code>@Find</code></a></h4>
<div class="paragraph">
<p>The <code>rxmicro.data.mongo</code> module supports the <a href="https://docs.mongodb.com/manual/reference/method/db.collection.find/" target="_blank" rel="noopener"><code>db.collection.find()</code></a> operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Find(query = "{_id: ?}")
Mono&lt;Account&gt; findById(long id);

@Find(query = "{_id: ?}", projection = "{firstName: 1, lastName: 1}")
Mono&lt;Account&gt; findWithProjectionById(long id);

@Find(query = "{role: ?}", sort = "{role: 1, balance: 1}")
Flux&lt;Account&gt; findByRole(Role role, Pageable pageable);

@Find(query = "{role: ?}", sort = "{role: ?, balance: ?}")
Flux&lt;Account&gt; findByRole(Role role, @RepeatParameter(2) SortOrder sortOrder, Pageable pageable);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more information, we recommend that You familiarize yourself with the following examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-data-mongo/data-mongo-all-operations/src/main/java/io/rxmicro/examples/data/mongo/all/operations/FindDataRepository.java" target="_blank" rel="noopener">All Supported Return Types</a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-data-mongo/data-mongo-supported-types/src/main/java/io/rxmicro/examples/data/mongo/supported/types/GetDataRepository.java#L130" target="_blank" rel="noopener">All Supported Parameter Types</a>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-find" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-find</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="data-mongo-aggregate-section"><a class="anchor" href="#data-mongo-aggregate-section"></a><a class="link" href="#data-mongo-aggregate-section">10.6.2. <code>@Aggregate</code></a></h4>
<div class="paragraph">
<p>The <code>rxmicro.data.mongo</code> module supports the <a href="https://docs.mongodb.com/manual/reference/method/db.collection.aggregate/" target="_blank" rel="noopener"><code>db.collection.aggregate()</code></a> operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Report {

    @DocumentId
    Role id;

    BigDecimal total;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Aggregate(pipeline = {
        "{ $group : { _id: '$role', total : { $sum: '$balance'}} }",
        "{ $sort: {total: -1, _id: -1} }"
})
Flux&lt;Report&gt; aggregate();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more information, we recommend that You familiarize yourself with the following examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-data-mongo/data-mongo-all-operations/src/main/java/io/rxmicro/examples/data/mongo/all/operations/AggregateDataRepository.java" target="_blank" rel="noopener">All Supported Return Types</a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-data-mongo/data-mongo-supported-types/src/main/java/io/rxmicro/examples/data/mongo/supported/types/GetDataRepository.java#L41" target="_blank" rel="noopener">All Supported Parameter Types</a>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-aggregate" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-aggregate</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="data-mongo-distinct-section"><a class="anchor" href="#data-mongo-distinct-section"></a><a class="link" href="#data-mongo-distinct-section">10.6.3. <code>@Distinct</code></a></h4>
<div class="paragraph">
<p>The <code>rxmicro.data.mongo</code> module supports the <a href="https://docs.mongodb.com/manual/reference/method/db.collection.distinct/" target="_blank" rel="noopener"><code>db.collection.distinct()</code></a> operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Distinct(field = "email", query = "{_id: ?}")
Mono&lt;String&gt; getEmailById(long id);

@Distinct(field = "role")
Flux&lt;Role&gt; getAllUsedRoles();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more information, we recommend that You familiarize yourself with the following examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-data-mongo/data-mongo-all-operations/src/main/java/io/rxmicro/examples/data/mongo/all/operations/DistinctDataRepository.java" target="_blank" rel="noopener">All Supported Return Types</a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-data-mongo/data-mongo-supported-types/src/main/java/io/rxmicro/examples/data/mongo/supported/types/GetDataRepository.java#L354" target="_blank" rel="noopener">All Supported Parameter Types</a>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-distinct" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-distinct</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="data-mongo-countDocuments-section"><a class="anchor" href="#data-mongo-countDocuments-section"></a><a class="link" href="#data-mongo-countDocuments-section">10.6.4. <code>@CountDocuments</code></a></h4>
<div class="paragraph">
<p>The <code>rxmicro.data.mongo</code> module supports the <a href="https://docs.mongodb.com/manual/reference/method/db.collection.countDocuments/" target="_blank" rel="noopener"><code>db.collection.countDocuments()</code></a> operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@CountDocuments
Mono&lt;Long&gt; countDocuments();

@CountDocuments(query = "{role:?}", skip = 0, limit = 100)
Mono&lt;Long&gt; countDocuments(Role role);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more information, we recommend that You familiarize yourself with the following examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-data-mongo/data-mongo-all-operations/src/main/java/io/rxmicro/examples/data/mongo/all/operations/CountDocumentsDataRepository.java" target="_blank" rel="noopener">All Supported Return Types</a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-data-mongo/data-mongo-supported-types/src/main/java/io/rxmicro/examples/data/mongo/supported/types/GetDataRepository.java#L266" target="_blank" rel="noopener">All Supported Parameter Types</a>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-count-documents" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-count-documents</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="data-mongo-estimatedDocumentCount-section"><a class="anchor" href="#data-mongo-estimatedDocumentCount-section"></a><a class="link" href="#data-mongo-estimatedDocumentCount-section">10.6.5. <code>@EstimatedDocumentCount</code></a></h4>
<div class="paragraph">
<p>The <code>rxmicro.data.mongo</code> module supports the <a href="https://docs.mongodb.com/manual/reference/method/db.collection.estimatedDocumentCount/" target="_blank" rel="noopener"><code>db.collection.estimatedDocumentCount()</code></a> operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@EstimatedDocumentCount
Mono&lt;Long&gt; estimatedDocumentCount();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more information, we recommend that You familiarize yourself with the following examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-data-mongo/data-mongo-all-operations/src/main/java/io/rxmicro/examples/data/mongo/all/operations/EstimatedDocumentCountDataRepository.java" target="_blank" rel="noopener">All Supported Return Types</a>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-estimated-document-count" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-estimated-document-count</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="data-mongo-insert-section"><a class="anchor" href="#data-mongo-insert-section"></a><a class="link" href="#data-mongo-insert-section">10.6.6. <code>@Insert</code></a></h4>
<div class="paragraph">
<p>The <code>rxmicro.data.mongo</code> module supports the <a href="https://docs.mongodb.com/manual/reference/method/db.collection.insertOne/" target="_blank" rel="noopener"><code>db.collection.insertOne()</code></a> operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Insert
Mono&lt;Void&gt; insert(Account account);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more information, we recommend that You familiarize yourself with the following examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-data-mongo/data-mongo-all-operations/src/main/java/io/rxmicro/examples/data/mongo/all/operations/InsertDataRepository.java" target="_blank" rel="noopener">All Supported Return Types</a>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-insert" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-insert</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="data-mongo-update-section"><a class="anchor" href="#data-mongo-update-section"></a><a class="link" href="#data-mongo-update-section">10.6.7. <code>@Update</code></a></h4>
<div class="paragraph">
<p>The <code>rxmicro.data.mongo</code> module supports the <a href="https://docs.mongodb.com/manual/reference/method/db.collection.updateOne/" target="_blank" rel="noopener"><code>db.collection.updateOne()</code></a> operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Update
Mono&lt;Boolean&gt; updateEntity(AccountEntity accountEntity);

@Update(filter = "{_id: ?}")
Mono&lt;Void&gt; updateDocument(AccountDocument accountDocument, long id);

@Update(update = "{$set: {balance: ?}}", filter = "{_id: ?}")
Mono&lt;Long&gt; updateById(BigDecimal balance, long id);

@Update(update = "{$set: {balance: ?}}", filter = "{role: ?}")
Mono&lt;UpdateResult&gt; updateByRole(BigDecimal balance, Role role);

@Update(update = "{$set: {balance: ?}}")
Mono&lt;UpdateResult&gt; updateAll(BigDecimal balance);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more information, we recommend that You familiarize yourself with the following examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-data-mongo/data-mongo-all-operations/src/main/java/io/rxmicro/examples/data/mongo/all/operations/UpdateDataRepository.java" target="_blank" rel="noopener">All Supported Return Types</a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-data-mongo/data-mongo-supported-types/src/main/java/io/rxmicro/examples/data/mongo/supported/types/UpdateDataRepository.java" target="_blank" rel="noopener">All Supported Parameter Types</a>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-update" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-update</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="data-mongo-delete-section"><a class="anchor" href="#data-mongo-delete-section"></a><a class="link" href="#data-mongo-delete-section">10.6.8. <code>@Delete</code></a></h4>
<div class="paragraph">
<p>The <code>rxmicro.data.mongo</code> module supports the <a href="https://docs.mongodb.com/manual/reference/method/db.collection.deleteOne/" target="_blank" rel="noopener"><code>db.collection.deleteOne()</code></a>
and <a href="https://docs.mongodb.com/manual/reference/method/db.collection.deleteMany/"><code>db.collection.deleteMany()</code></a> operations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Delete
Mono&lt;Boolean&gt; deleteById(Long id);

@Delete(filter = "{role: ?}")
Mono&lt;Long&gt; deleteByRole(Role role);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more information, we recommend that You familiarize yourself with the following examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-data-mongo/data-mongo-all-operations/src/main/java/io/rxmicro/examples/data/mongo/all/operations/DeleteDataRepository.java" target="_blank" rel="noopener">All Supported Return Types</a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/blob/master/examples/group-data-mongo/data-mongo-supported-types/src/main/java/io/rxmicro/examples/data/mongo/supported/types/DeleteDataRepository.java" target="_blank" rel="noopener">All Supported Parameter Types</a>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-delete" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-delete</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="data-mongo-partial-implementation-section"><a class="anchor" href="#data-mongo-partial-implementation-section"></a><a class="link" href="#data-mongo-partial-implementation-section">10.7. Partial Implementation</a></h3>
<div class="paragraph">
<p>If the Mongo data repository generated by the <code>RxMicro Annotation Processor</code> contains errors, incorrect or non-optimized logic, the developer can use the <code>Partial Implementation</code> feature.</p>
</div>
<div class="paragraph">
<p>This feature allows You to implement methods for the Mongo data repository on Your own, instead of generating them by the RxMicro framework.</p>
</div>
<div class="paragraph">
<p>To activate this feature, You need to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-mongo/src/main/java/io/rxmicro/data/mongo/PartialImplementation.java" target="_blank" rel="noopener"><code>@PartialImplementation</code></a>
annotation, and specify an abstract class that contains a partial implementation of method(s) for Mongo data repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@MongoRepository(collection = DataRepository.COLLECTION_NAME)
<i class="conum" data-value="1"></i><b>(1)</b>
@PartialImplementation(AbstractDataRepository.class)
public interface DataRepository {

    String COLLECTION_NAME = "account";

    @CountDocuments
    CompletableFuture&lt;Long&gt; generatedMethod();

    CompletableFuture&lt;Long&gt; userDefinedMethod();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-mongo/src/main/java/io/rxmicro/data/mongo/PartialImplementation.java" target="_blank" rel="noopener"><code>@PartialImplementation</code></a>
annotation, the <code>AbstractDataRepository</code> class is specified.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An <code>AbstractDataRepository</code> contains the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public abstract class AbstractDataRepository extends AbstractMongoRepository
        implements DataRepository {

    protected AbstractDataRepository(final Class&lt;?&gt; repositoryClass,
                                     final MongoCollection&lt;Document&gt; collection) {
        super(repositoryClass, collection);
    }

    @Override
    public CompletableFuture&lt;Long&gt; userDefinedMethod() {
        return CompletableFuture.completedFuture(100L);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An abstract class that contains a partial implementation must meet the following requirements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The class must be an <code>abstract</code> one.</p>
</li>
<li>
<p>The class must extend the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-mongo/src/main/java/io/rxmicro/data/mongo/detail/AbstractMongoRepository.java" target="_blank" rel="noopener"><code>AbstractMongoRepository</code></a> one.</p>
</li>
<li>
<p>The class must implement the Mongo data repository interface.</p>
</li>
<li>
<p>The class must contain an implementation of all methods that are not generated automatically.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In terms of infrastructure, the repository methods generated and defined by the developer for Mongo data repository do not differ:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
void generatedMethod() {
    assertEquals(6L, dataRepository.generatedMethod().join());
}

@Test
void userDefinedMethod() {
    assertEquals(100L, dataRepository.userDefinedMethod().join());
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-partial-implementation" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-data-mongo/data-mongo-partial-implementation</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="data-mongo-logging-section"><a class="anchor" href="#data-mongo-logging-section"></a><a class="link" href="#data-mongo-logging-section">10.8. Logging</a></h3>
<div class="paragraph">
<p>Mongo Data Repositories use the <a href="http://mongodb.github.io/mongo-java-driver/4.0/driver/" target="_blank" rel="noopener"><strong>MongoDB Async Driver</strong></a>, so in order to activate database request logging to the Mongo DB, You must configure the <strong>MongoDB Async Driver Logger</strong>:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="http://mongodb.github.io/mongo-java-driver/4.0/driver/reference/logging/" target="_blank" rel="noopener"><code>http://mongodb.github.io/mongo-java-driver/4.0/driver/reference/logging/</code></a>.</p>
</div>
<div class="paragraph">
<p>For example, if to the <code>classpath</code> of the current project add the <a href="core.html#core-logger-config-file-inline"><code>jul.properties</code></a> resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">org.mongodb.driver.protocol.level=TRACE</code></pre>
</div>
</div>
<div class="paragraph">
<p>,then Mongo Data Repositories will generate request logs to the Mongo DB while working:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">2020-03-08 13:15:03.912 [DEBUG] org.mongodb.driver.protocol.command : Sending command <strong>'{"find": "account", "filter": {"_id": 1}, "batchSize": 2147483647, "$db": "rxmicro"}'</strong> with request <strong>id 6</strong> to database rxmicro on connection [<strong>connectionId{localValue:2, serverValue:4}</strong>] to server <strong>localhost:27017</strong>

2020-03-08 13:15:03.914 [DEBUG] org.mongodb.driver.protocol.command : Execution of command with request <strong>id 6</strong> completed successfully <strong>in 3.11 ms</strong> on connection [<strong>connectionId{localValue:2, serverValue:4}</strong>] to server <strong>localhost:27017</strong></code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cdi-section"><a class="anchor" href="#cdi-section"></a><a class="link" href="#cdi-section">11. Contexts and Dependency Injection</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>rxmicro.cdi</code> module is an implementation of the <a href="https://en.wikipedia.org/wiki/Dependency_injection" target="_blank" rel="noopener"><strong>Dependency Injection</strong></a> design pattern, that is integrated to the RxMicro framework.</p>
</div>
<div style="page-break-after: always;"></div>
<div class="sect2">
<h3 id="cdi-basic-section"><a class="anchor" href="#cdi-basic-section"></a><a class="link" href="#cdi-basic-section">11.1. Basic Usage</a></h3>
<div class="paragraph">
<p>To use the <code>rxmicro.cdi</code> module in the project, the following two steps must be taken:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add the <code>rxmicro-cdi</code> dependency to the <code>pom.xml</code> file:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
    &lt;artifactId&gt;rxmicro-cdi&lt;/artifactId&gt;
    &lt;version&gt;${rxmicro.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Add the <code>rxmicro.cdi</code> module to the <code>module-info.java</code> descriptor:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">module examples.cdi.basic {
    requires rxmicro.rest.server.netty;
    requires rxmicro.rest.server.exchange.json;
    requires rxmicro.cdi; <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>After adding the <code>rxmicro.cdi</code> module, You can create a business service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface BusinessService {

    String getValue();
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BusinessServiceImpl implements BusinessService {

    @Override
    public String getValue() {
        return "IMPL";
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to inject a business service implementation, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Inject.java" target="_blank" rel="noopener"><code>@Inject</code></a> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class RestController {

    <i class="conum" data-value="1"></i><b>(1)</b>
    @Inject
    BusinessService businessService;

    @PATCH("/")
    void handle() {
        System.out.println(businessService.getValue());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The usage of the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Inject.java" target="_blank" rel="noopener"><code>@io.rxmicro.cdi.Inject</code></a>
annotation does not differ fundamentally from that of the
<a href="https://docs.oracle.com/javaee/6/api/javax/inject/Inject.html" target="_blank" rel="noopener"><code>@javax.inject.Inject</code></a> or
<a href="https://google.github.io/guice/api-docs/latest/javadoc/index.html?com/google/inject/Inject.html" target="_blank" rel="noopener"><code>@com.google.inject.Inject</code></a> annotations.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The correctness of injection can be checked using <a href="testing.html#testing-rest-based-microservice-tests-section">REST-based microservice test</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(RestController.class)
final class RestControllerTest {

    private BlockingHttpClient blockingHttpClient;

    private SystemOut systemOut;

    @Test
    void Should_print_to_system_out() {
        blockingHttpClient.patch("/");

        assertEquals("IMPL", systemOut.asString());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Business service implementation can be injected not only into REST controller, but into any component:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BusinessServiceFacade {

    @Inject
    BusinessService businessService;

    public String getValue() {
        return businessService.getValue();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the injection is performed into any component, it is necessary to use <a href="testing.html#testing-component-tests-section">the microservice component testing approach</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroComponentTest(BusinessServiceFacade.class)
final class BusinessServiceFacadeTest {

    private BusinessServiceFacade businessServiceFacade;

    @Test
    void Should_invoke_BusinessService_getValue() {
        assertEquals("IMPL", businessServiceFacade.getValue());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-basic" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-basic</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="cdi-annotations-section"><a class="anchor" href="#cdi-annotations-section"></a><a class="link" href="#cdi-annotations-section">11.2. <code>RxMicro Annotations</code></a></h3>
<div class="paragraph">
<p>The RxMicro framework supports the following <code>RxMicro Annotations</code>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 17. Supported <code>RxMicro Annotations</code>.</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Annotation</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Inject.java" target="_blank" rel="noopener"><code>@Inject</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the need to inject the component implementation into the annotated class field or method parameter.</p>
<p class="tableblock"><em>(Is a synonym of the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Autowired.java" target="_blank" rel="noopener"><code>@Autowired</code></a>
annotation, and is recommended for developers who have used JEE or Google Guice as CDI implementation in their previous projects.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Named.java" target="_blank" rel="noopener"><code>@Named</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows <a href="#cdi-named">to customize an injection point by specifying a string value or custom annotation.</a>
This annotation can also be used to specify a component name.</p>
<p class="tableblock"><em>(Is a synonym of the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Qualifier.java" target="_blank" rel="noopener"><code>@Qualifier</code></a>
annotation, and is recommended for developers who have used JEE or Google Guice as CDI implementation in their previous projects.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Autowired.java" target="_blank" rel="noopener"><code>@Autowired</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the need to inject the component implementation into the annotated class field or method parameter.</p>
<p class="tableblock"><em>(Is a synonym of the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Inject.java" target="_blank" rel="noopener"><code>@Inject</code></a>
annotation, and is recommended for developers who have used Spring DI as CDI implementation in their previous projects.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Qualifier.java" target="_blank" rel="noopener"><code>@Qualifier</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows <a href="#cdi-named">to customize an injection point by specifying a string value or custom annotation.</a>
This annotation can also be used to specify a component name.</p>
<p class="tableblock"><em>(Is a synonym of the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Named.java" target="_blank" rel="noopener"><code>@Named</code></a>
annotation, and is recommended for developers who have used Spring DI as CDI implementation in their previous projects.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/PostConstruct.java" target="_blank" rel="noopener"><code>@PostConstruct</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#cdi-post-construct-section">a method, that should be invoked automatically after all dependencies have been injected into the current component.</a></p>
<p class="tableblock"><em>(In its semantics, it completely corresponds to the <a href="https://docs.oracle.com/javaee/7/api/javax/annotation/PostConstruct.html" target="_blank" rel="noopener"><code>@javax.annotation.PostConstruct</code></a> annotation.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Factory.java" target="_blank" rel="noopener"><code>@Factory</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Denotes <a href="#cdi-factory-method-section">a factory method</a> or <a href="#cdi-factory-class-section">a factory, that creates instances of the specified class</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Resource.java" target="_blank" rel="noopener"><code>@Resource</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates <a href="#cdi-resource-section">the need to inject the external resource</a> into the annotated class field or method parameter.</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="cdi-singletons-section"><a class="anchor" href="#cdi-singletons-section"></a><a class="link" href="#cdi-singletons-section">11.3. All Beans are Singletons!</a></h3>
<div class="paragraph">
<p>The RxMicro framework focuses on creating microservice projects.
One of the key features of microservices is their simplicity.
That&#8217;s why <code>singleton</code> scope was chosen as the main and only one.</p>
</div>
<div class="paragraph">
<p>Thus, <strong>all CDI components are <code>singletons</code>!</strong></p>
</div>
<div class="paragraph">
<p>It means that when starting a microservice project, <strong>only one instance</strong> of the component implementation class is created and injected into all necessary injection points.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If it is necessary to inject a separate implementation class instance (<code>prototype</code> scope) to each injection point, then You must use  <a href="#cdi-factory-class-section">the factory that creates instances of the given class</a>!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This behavior can be checked with the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BusinessServiceImpl implements BusinessService1, BusinessService2 {
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BusinessServiceFacade {

    @Inject
    BusinessService1 businessService1;

    @Inject
    BusinessService2 businessService2;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroComponentTest(BusinessServiceFacade.class)
final class BusinessServiceFacadeTest {

    private BusinessServiceFacade facade;

    @Test
    void Should_use_singleton_instance() {
        assertSame(facade.businessService1, facade.businessService2); <i class="conum" data-value="1"></i><b>(1)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Since the <code>BusinessServiceImpl</code> class implements two interfaces, the same implementation instance is injected when injecting different types of interfaces!</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-singletons" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-singletons</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="cdi-constructor-injection-section"><a class="anchor" href="#cdi-constructor-injection-section"></a><a class="link" href="#cdi-constructor-injection-section">11.4. Constructor Injection</a></h3>
<div class="paragraph">
<p>The RxMicro framework also supports constructor injection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BusinessServiceFacade {

    private final BusinessService businessService;

    <i class="conum" data-value="1"></i><b>(1)</b>
    @Inject
    public BusinessServiceFacade(final BusinessService businessService) {
        System.out.println(businessService.getClass().getSimpleName());
        this.businessService = businessService;
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To enable constructor injection, it is necessary to create a constructor with parameters and annotate it by the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Inject.java" target="_blank" rel="noopener"><code>@Inject</code></a> or
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Autowired.java" target="_blank" rel="noopener"><code>@Autowired</code></a> annotation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When using the constructor injection mechanism, this constructor is automatically invoked by the RxMicro framework:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroComponentTest(BusinessServiceFacade.class)
final class BusinessServiceFacadeTest {

    private SystemOut systemOut;

    @Test
    void Should_support_constructor_injection() {
        assertEquals(BusinessServiceImpl.class.getSimpleName(), systemOut.asString());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Constructor injection requires more code to be written, but also allows You to create <code>final</code> fields as injection points.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-constructor-injection" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-constructor-injection</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="cdi-method-injection-section"><a class="anchor" href="#cdi-method-injection-section"></a><a class="link" href="#cdi-method-injection-section">11.5. Method Injection</a></h3>
<div class="paragraph">
<p>The RxMicro framework also supports injection with <a href="https://www.w3schools.com/java/java_encapsulation.asp" target="_blank" rel="noopener"><code>setters</code> (method injection)</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BusinessServiceFacade {

    private BusinessService businessService;

    <i class="conum" data-value="1"></i><b>(1)</b>
    @Inject
    public void setBusinessService(final BusinessService businessService) {
        System.out.println(businessService.getClass().getSimpleName());
        this.businessService = businessService;
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To enable the injection with <a href="https://www.w3schools.com/java/java_encapsulation.asp" target="_blank" rel="noopener"><code>setters</code></a>, it is necessary to create <code>setter</code> and annotate it by the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Inject.java" target="_blank" rel="noopener"><code>@Inject</code></a> or
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Autowired.java" target="_blank" rel="noopener"><code>@Autowired</code></a> annotation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When using the injection mechanism with <a href="https://www.w3schools.com/java/java_encapsulation.asp" target="_blank" rel="noopener"><code>setters</code></a>, this method is invoked automatically by the RxMicro framework:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroComponentTest(BusinessServiceFacade.class)
final class BusinessServiceFacadeTest {

    private SystemOut systemOut;

    @Test
    void Should_support_constructor_injection() {
        assertEquals(BusinessServiceImpl.class.getSimpleName(), systemOut.asString());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-method-injection" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-method-injection</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="ambiguity_resolving"><a class="anchor" href="#ambiguity_resolving"></a><a class="link" href="#ambiguity_resolving">11.6. Ambiguity Resolving</a></h3>
<div class="paragraph">
<p>If there are two or more implementations of the same interface in the current project module, the problem of ambiguity resolving may arise in the process of dependencies injection.
In the field with the interface type potentially can be injected an implementation of any of the child classes of this interface, that&#8217;s why such a problem occurs.</p>
</div>
<div class="paragraph">
<p>In order to solve such problems definitively, the RxMicro framework uses the ambiguity resolving algorithm by default.</p>
</div>
<div class="sect3">
<h4 id="default_ambiguity_resolving"><a class="anchor" href="#default_ambiguity_resolving"></a><a class="link" href="#default_ambiguity_resolving">11.6.1. Default Ambiguity Resolving</a></h4>
<div class="paragraph">
<p>If there are two or more implementations of the same interface in the current project module, then the RxMicro framework implicitly sets the name for each implementation.
This name corresponds to a simple class name starting with a small letter, for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For the <code>io.rxmicro.examples.cdi.ProductionBusinessService</code> class, the name is equal to <code>productionBusinessService</code>.</p>
</li>
<li>
<p>For the <code>io.rxmicro.examples.cdi.DevelopmentBusinessService</code> class, the name is equal to <code>developmentBusinessService</code>.</p>
</li>
<li>
<p>For the <code>io.rxmicro.ProductionBusinessService</code> class, the name is equal to <code>productionBusinessService</code>.</p>
</li>
<li>
<p>For the <code>ProductionBusinessService</code> class, the name is equal to <code>productionBusinessService</code>.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The ambiguity resolving problem may occur <strong>only between classes implementing the same interface!</strong>.</p>
</div>
<div class="paragraph">
<p>This means that if there are two following interfaces in the project:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>package1.BusinessService</code> and</p>
</li>
<li>
<p><code>package2.BusinessService</code>;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and four implementation classes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>package1.impl.ProductionBusinessService implements package1.BusinessService</code>;</p>
</li>
<li>
<p><code>package1.impl.DevelopmentBusinessService implements package1.BusinessService</code>;</p>
</li>
<li>
<p><code>package2.impl.ProductionBusinessService implements package2.BusinessService</code>;</p>
</li>
<li>
<p><code>package2.impl.DevelopmentBusinessService implements package2.BusinessService</code>;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>then despite the same names for different classes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>productionBusinessService</code> for <code>package1.impl.ProductionBusinessService</code> and <code>package2.impl.ProductionBusinessService</code>;</p>
</li>
<li>
<p><code>developmentBusinessService</code> for <code>package1.impl.DevelopmentBusinessService</code> and <code>package2.impl.DevelopmentBusinessService</code>;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>no implementation errors will occur!
Everything will work correctly as the same component names are created for <strong>different data types!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Thus, for <code>ProductionBusinessService</code> and <code>DevelopmentBusinessService</code> implementation classes, the following names are set accordingly: <code>productionBusinessService</code> and <code>developmentBusinessService</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class ProductionBusinessService implements BusinessService {

    @Override
    public String getValue() {
        return "PRODUCTION";
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class DevelopmentBusinessService implements BusinessService {

    @Override
    public String getValue() {
        return "DEVELOPMENT";
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When injecting implementations, the RxMicro framework reads the name of the class or method parameter field.
If the names of the class fields correspond to the names of implementation components, the successful injection is performed:</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If there is <strong>only one implementation class</strong>, in the current module, then regardless of the class field names or method parameters, the instance of this class will be successfully injected!</p>
</div>
<div class="paragraph">
<p>In other words, the ambiguity resolving algorithm is enabled by default <strong>only if there are such ambiguities!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BusinessServiceFacade {

    @Inject
    BusinessService productionBusinessService; <i class="conum" data-value="1"></i><b>(1)</b>

    @Inject
    BusinessService developmentBusinessService; <i class="conum" data-value="2"></i><b>(2)</b>

    public String getValue(final boolean production) {
        if (production) {
            return productionBusinessService.getValue();
        } else {
            return developmentBusinessService.getValue();
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>In the <code>productionBusinessService</code> field, the <code>ProductionBusinessService</code> class instance is injected.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>In the <code>developmentBusinessService</code> field, the <code>DevelopmentBusinessService</code> class instance is injected.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This behavior can be tested with the following test:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroComponentTest(BusinessServiceFacade.class)
final class BusinessServiceFacadeTest {

    private BusinessServiceFacade businessServiceFacade;

    @Test
    void Should_return_PRODUCTION() {
        assertEquals("PRODUCTION", businessServiceFacade.getValue(true));
    }

    @Test
    void Should_return_DEVELOPMENT() {
        assertEquals("DEVELOPMENT", businessServiceFacade.getValue(false));
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-ambiguty-resolving-by-impl-classname-and-field-name" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-ambiguty-resolving-by-impl-classname-and-field-name</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="cdi-named"><a class="anchor" href="#cdi-named"></a><a class="link" href="#cdi-named">11.6.2. The <code>@Named</code> (<code>@Qualifier</code>) Annotation Usage</a></h4>
<div class="paragraph">
<p>In case if the ambiguity resolving algorithm by default does not meet the needs of a business task, the developer can set up the implementation process using the following annotations: <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Named.java" target="_blank" rel="noopener"><code>@Named</code></a> or
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Qualifier.java" target="_blank" rel="noopener"><code>@Qualifier</code></a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BusinessServiceFacade {

    @Inject
    <i class="conum" data-value="1"></i><b>(1)</b>
    @Named("productionBusinessService")
    BusinessService businessService1;

    @Inject
    <i class="conum" data-value="2"></i><b>(2)</b>
    @Named("developmentBusinessService")
    BusinessService businessService2;

    public String getValue(final boolean production) {
        if (production) {
            return businessService1.getValue();
        } else {
            return businessService2.getValue();
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To inject the <code>ProductionBusinessService</code> class instance to the <code>businessService1</code> field, in the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Named.java" target="_blank" rel="noopener"><code>@Named</code></a>
annotation parameter, You need to specify the <code>productionBusinessService</code> name.<br>
<em>(This is an implicit name that is set by the RxMicro framework for the <code>ProductionBusinessService</code> class!)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>To inject the <code>DevelopmentBusinessService</code> class instance to the <code>businessService2</code> field, in the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Named.java" target="_blank" rel="noopener"><code>@Named</code></a>
annotation parameter, You need to specify the <code>developmentBusinessService</code> name.<br>
<em>(This is an implicit name that is set by the RxMicro framework for the <code>DevelopmentBusinessService</code> class!)</em></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This behavior can be tested with the following test:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroComponentTest(BusinessServiceFacade.class)
final class BusinessServiceFacadeTest {

    private BusinessServiceFacade businessServiceFacade;

    @Test
    void Should_return_PRODUCTION() {
        assertEquals("PRODUCTION", businessServiceFacade.getValue(true));
    }

    @Test
    void Should_return_DEVELOPMENT() {
        assertEquals("DEVELOPMENT", businessServiceFacade.getValue(false));
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-ambiguty-resolving-by-impl-classname-and-Named-annotation" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-ambiguty-resolving-by-impl-classname-and-Named-annotation</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An implicitly created name for an implementation class can be set explicitly using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Named.java" target="_blank" rel="noopener"><code>@Named</code></a> or
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Qualifier.java" target="_blank" rel="noopener"><code>@Qualifier</code></a> annotations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Named("Production")
public final class ProductionBusinessService implements BusinessService {

    @Override
    public String getValue() {
        return "PRODUCTION";
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Named("Development")
public final class DevelopmentBusinessService implements BusinessService {

    @Override
    public String getValue() {
        return "DEVELOPMENT";
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using explicit names for implementation classes, it is necessary to specify these explicit names as the qualifier of an injection point:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BusinessServiceFacade {

    @Inject
    <i class="conum" data-value="1"></i><b>(1)</b>
    @Named("Production")
    BusinessService businessService1;

    @Inject
    <i class="conum" data-value="2"></i><b>(2)</b>
    @Named("Development")
    BusinessService businessService2;

    public String getValue(final boolean production) {
        if (production) {
            return businessService1.getValue();
        } else {
            return businessService2.getValue();
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To inject the <code>ProductionBusinessService</code> class instance to the <code>businessService1</code> field, in the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Named.java" target="_blank" rel="noopener"><code>@Named</code></a>
annotation parameter, You need to specify the <code>Production</code> name.<br>
<em>(This name is explicitly set for the <code>ProductionBusinessService</code> class, using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Named.java" target="_blank" rel="noopener"><code>@Named</code></a> annotation!)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>To inject the <code>DevelopmentBusinessService</code> class instance to the <code>businessService2</code> field, in the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Named.java" target="_blank" rel="noopener"><code>@Named</code></a>
annotation parameter, You need to specify the <code>Development</code> name.<br>
<em>(This name is explicitly set for the <code>DevelopmentBusinessService</code> class, using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Named.java" target="_blank" rel="noopener"><code>@Named</code></a> annotation!)</em></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-ambiguty-resolving-by-Named-implementation-and-Named-field" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-ambiguty-resolving-by-Named-implementation-and-Named-field</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="custom_annotations_usage"><a class="anchor" href="#custom_annotations_usage"></a><a class="link" href="#custom_annotations_usage">11.6.3. Custom Annotations Usage</a></h4>
<div class="paragraph">
<p>When using string names for implementation classes and injection points, the developer may make a mistake.
Since the compiler does not check the specified names, the error can be detected only during runtime.</p>
</div>
<div class="paragraph">
<p>If such a situation is unacceptable, custom annotations should be used as qualifiers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Documented
@Retention(CLASS)
@Target({FIELD, METHOD, TYPE})
<i class="conum" data-value="1"></i><b>(1)</b>
@Named("")
public @interface EnvironmentType {

    Type value(); <i class="conum" data-value="2"></i><b>(2)</b>

    enum Type {

        PRODUCTION,

        DEVELOPMENT
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>For a custom annotation to be defined by the RxMicro framework as a qualifier, it must be annotated by the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Named.java" target="_blank" rel="noopener"><code>@Named</code></a> or
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Qualifier.java" target="_blank" rel="noopener"><code>@Qualifier</code></a> annotation with an empty string value.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>To control the component names with the compiler, it is recommended to use enumerations.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After creating the custom annotation that serves as a qualifier, it is necessary to annotate the implementation classes by it</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@EnvironmentType(EnvironmentType.Type.PRODUCTION)
public final class ProductionBusinessService implements BusinessService {

    @Override
    public String getValue() {
        return "PRODUCTION";
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@EnvironmentType(EnvironmentType.Type.DEVELOPMENT)
public final class DevelopmentBusinessService implements BusinessService {

    @Override
    public String getValue() {
        return "DEVELOPMENT";
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and injection points:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BusinessServiceFacade {

    @Inject
    <i class="conum" data-value="1"></i><b>(1)</b>
    @EnvironmentType(EnvironmentType.Type.PRODUCTION)
    BusinessService businessService1;

    @Inject
    <i class="conum" data-value="2"></i><b>(2)</b>
    @EnvironmentType(EnvironmentType.Type.DEVELOPMENT)
    BusinessService businessService2;

    public String getValue(final boolean production) {
        if (production) {
            return businessService1.getValue();
        } else {
            return businessService2.getValue();
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using custom annotations, the result of ambiguity resolving will be the same as when using string names:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroComponentTest(BusinessServiceFacade.class)
final class BusinessServiceFacadeTest {

    private BusinessServiceFacade businessServiceFacade;

    @Test
    void Should_return_PRODUCTION() {
        assertEquals("PRODUCTION", businessServiceFacade.getValue(true));
    }

    @Test
    void Should_return_DEVELOPMENT() {
        assertEquals("DEVELOPMENT", businessServiceFacade.getValue(false));
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-ambiguty-resolving-using-custom-Named-annotation" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-ambiguty-resolving-using-custom-Named-annotation</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="cdi-spring-style-section"><a class="anchor" href="#cdi-spring-style-section"></a><a class="link" href="#cdi-spring-style-section">11.7. Dependency Injection Using Spring Style</a></h3>
<div class="paragraph">
<p>The developers with a rich experience in using Spring in their previous projects can instead of the following annotations:
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Inject.java" target="_blank" rel="noopener"><code>@Inject</code></a> and
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Named.java" target="_blank" rel="noopener"><code>@Named</code></a>
use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Autowired.java" target="_blank" rel="noopener"><code>@Autowired</code></a> and
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Qualifier.java" target="_blank" rel="noopener"><code>@Qualifier</code></a> annotations respectively, which are absolutely similar in features:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Qualifier("Production")
public final class ProductionBusinessService implements BusinessService {

    @Override
    public String getValue() {
        return "PRODUCTION";
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Qualifier("Development")
public final class DevelopmentBusinessService implements BusinessService {

    @Override
    public String getValue() {
        return "DEVELOPMENT";
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BusinessServiceFacade {

    @Autowired
    <i class="conum" data-value="1"></i><b>(1)</b>
    @Qualifier("Production")
    BusinessService businessService1;

    @Autowired
    <i class="conum" data-value="2"></i><b>(2)</b>
    @Qualifier("Development")
    BusinessService businessService2;

    public String getValue(final boolean production) {
        if (production) {
            return businessService1.getValue();
        } else {
            return businessService2.getValue();
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To inject the <code>ProductionBusinessService</code> class instance in the <code>businessService1</code> field, it is necessary in the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Qualifier.java" target="_blank" rel="noopener"><code>@Qualifier</code></a>
annotation parameter specify the <code>Production</code> name.<br>
<em>(This is the name that is set explicitly for the <code>ProductionBusinessService</code> class by the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Qualifier.java" target="_blank" rel="noopener"><code>@Qualifier</code></a> annotation!)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>To inject the <code>DevelopmentBusinessService</code> class instance in the <code>businessService2</code> field, it is necessary in the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Qualifier.java" target="_blank" rel="noopener"><code>@Qualifier</code></a>
annotation parameter specify the <code>Development</code> name.<br>
<em>(This is the name that is set explicitly for the <code>DevelopmentBusinessService</code> class by the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Qualifier.java" target="_blank" rel="noopener"><code>@Qualifier</code></a> annotation!)</em></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-spring-style" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-spring-style</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="cdi-post-construct-section"><a class="anchor" href="#cdi-post-construct-section"></a><a class="link" href="#cdi-post-construct-section">11.8. <code>@PostConstruct</code></a></h3>
<div class="paragraph">
<p>If You need to run some code while creating a class instance, Java provides a special method for doing so, namely the constructor.
However, when using the dependency injection mechanisms, the dependencies are injected after creating an instance, and accordingly after invoking the constructor.
<em>(Except for the constructor injection mechanism!)</em>.
In order to run some code while creating an instance, but only after introducing all dependencies into this instance, the RxMicro framework provides a special
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/PostConstruct.java" target="_blank" rel="noopener"><code>@PostConstruct</code></a> annotation.</p>
</div>
<div class="paragraph">
<p>Thus, if there is a class method, annotated by the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/PostConstruct.java" target="_blank" rel="noopener"><code>@PostConstruct</code></a> annotation, then this method is automatically invoked after all dependencies are injected into the created instance of this class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BusinessService2Facade {

    @Inject
    BusinessService businessService;

    @PostConstruct
    void anyName() { <i class="conum" data-value="1"></i><b>(1)</b>
        System.out.println(businessService.getClass().getSimpleName());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>After injection of the implementation class instance in the <code>businessService</code> field, the RxMicro framework will automatically invoke the <code>anyName</code> method, since this method is annotated by the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/PostConstruct.java" target="_blank" rel="noopener"><code>@PostConstruct</code></a> annotation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For the convenience of developers, the RxMicro framework introduces an additional convention:</p>
</div>
<div class="paragraph">
<p><strong>If there is a method with the <code>postConstruct</code> name in the class, this method may not be annotated by the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/PostConstruct.java" target="_blank" rel="noopener"><code>@PostConstruct</code></a> annotation!</strong></p>
</div>
<div class="paragraph">
<p>The method with the specified name will be invoked automatically after all dependencies are injected:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BusinessService1Facade {

    @Inject
    BusinessService businessService;

    void postConstruct() { <i class="conum" data-value="1"></i><b>(1)</b>
        System.out.println(businessService.getClass().getSimpleName());
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Thus, for any method in the class to be defined by the RxMicro framework as the method to be invoked automatically after all dependencies are injected, it is necessary to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>to annotate this method by the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/PostConstruct.java" target="_blank" rel="noopener"><code>@PostConstruct</code></a> annotation;</p>
</li>
<li>
<p>or has the predefined <code>postConstruct</code> name.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>postConstruct</code> method must meet the following requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>This method should be a single method in the class.</p>
</li>
<li>
<p>The method must not be <code>static</code>.</p>
</li>
<li>
<p>The method must not be <code>abstract</code>.</p>
</li>
<li>
<p>The method must be non-<code>native</code>.</p>
</li>
<li>
<p>The method must not be <code>synchronized</code>.</p>
</li>
<li>
<p>The method must not contain parameters.</p>
</li>
<li>
<p>The method must return the <code>void</code> type.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The facts of invoking the <code>postConstruct</code> and <code>anyName</code> methods can be checked using the following tests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroComponentTest(BusinessService1Facade.class)
final class BusinessService1FacadeTest {

    private SystemOut systemOut;

    @Test
    void Should_invoke_postConstruct_method() {
        assertEquals(BusinessServiceImpl.class.getSimpleName(), systemOut.asString());
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroComponentTest(BusinessService2Facade.class)
final class BusinessService2FacadeTest {

    private SystemOut systemOut;

    @Test
    void Should_invoke_postConstruct_method() {
        assertEquals(BusinessServiceImpl.class.getSimpleName(), systemOut.asString());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-post-construct" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-post-construct</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In many frameworks implementing the <a href="https://en.wikipedia.org/wiki/Dependency_injection" target="_blank" rel="noopener"><strong>Dependency Injection</strong></a> design template, besides the <code>postConstruct</code> methods, there are also the <code>preDestroy</code> methods.
These methods are invoked automatically, and usually clear resources when deleting an instance from the CDI container.</p>
</div>
<div class="paragraph">
<p>For a microservice project that uses the RxMicro framework, there is no need for the <code>preDestroy</code> methods.
Since the instances are removed from the CDI container when the java process ends.
And upon completion of any process in the operating system, the operating system automatically clears <strong>all</strong> occupied resources!</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="cdi-rx-micro-component-injection-section"><a class="anchor" href="#cdi-rx-micro-component-injection-section"></a><a class="link" href="#cdi-rx-micro-component-injection-section">11.9. RxMicro Components Injection</a></h3>
<div class="sect3">
<h4 id="basic_usage"><a class="anchor" href="#basic_usage"></a><a class="link" href="#basic_usage">11.9.1. Basic Usage</a></h4>
<div class="paragraph">
<p>Besides custom classes, the RxMicro framework supports the RxMicro components injection.</p>
</div>
<div class="paragraph">
<p>For example, if a declarative REST client is declared in the project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
public interface RESTClient {

    @PATCH("/")
    CompletableFuture&lt;Void&gt; patch();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>then instead of getting an explicit reference to the implementation class instance using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-client/src/main/java/io/rxmicro/rest/client/RestClientFactory.java#L48" target="_blank" rel="noopener"><code>RestClientFactory.getRestClient(Class&lt;?&gt;)</code></a>, the developer can use the dependency injection mechanism:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BusinessServiceFacade {

    <i class="conum" data-value="1"></i><b>(1)</b>
    @Inject
    RESTClient restClient;

    <i class="conum" data-value="2"></i><b>(2)</b>
    @Inject
    RestClientConfig config;

    void postConstruct() {
        System.out.println(restClient.getClass().getSimpleName());
        System.out.println(config.getClass().getSimpleName());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To get a reference to the REST client implementation class, the developer can use the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Inject.java" target="_blank" rel="noopener"><code>@Inject</code></a> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Besides injecting REST clients, the RxMicro framework also supports the configuration injection.<br>
<em>(A list of all supported RxMicro components that can be injected is described in the <a href="#cdi-rx-micro-component-injection-all-supported-components-section">Section 11.9.2, &#8220;All Supported RxMicro Components&#8221;</a>.)</em></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-rxmicro-component" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-rxmicro-component</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="cdi-rx-micro-component-injection-all-supported-components-section"><a class="anchor" href="#cdi-rx-micro-component-injection-all-supported-components-section"></a><a class="link" href="#cdi-rx-micro-component-injection-all-supported-components-section">11.9.2. All Supported RxMicro Components</a></h4>
<div class="paragraph">
<p>This section describes all supported RxMicro components that can be injected in any class using the injection mechanisms.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 18. All Supported RxMicro Components.</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Feature</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Config instance.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any class that extends the basic configuration class: <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/Config.java" target="_blank" rel="noopener"><code>Config</code></a>.</p>
<p class="tableblock"><em>(For example: <code>MongoConfig</code>, <code>HttpClientConfig</code>, <code>HttpServerConfig</code>, etc.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mongo repository.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The interface annotated by the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-mongo/src/main/java/io/rxmicro/data/mongo/MongoRepository.java" target="_blank" rel="noopener"><code>@MongoRepository</code></a> annotation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mongo client.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Predefined type: <a href="https://mongodb.github.io/mongo-java-driver-reactivestreams/1.13/javadoc/com/mongodb/reactivestreams/client/MongoClient.html" target="_blank" rel="noopener"><code>com.mongodb.reactivestreams.client.MongoClient</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PostgreSQL repository.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The interface annotated by the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-data-sql-r2dbc-postgresql/src/main/java/io/rxmicro/data/sql/r2dbc/postgresql/PostgreSQLRepository.java" target="_blank" rel="noopener"><code>@PostgreSQLRepository</code></a> annotation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">R2DBC connection factory.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Predefined type: <a href="https://r2dbc.io/spec/1.0.0.RELEASE/api/io/r2dbc/spi/ConnectionFactory.html" target="_blank" rel="noopener"><code>io.r2dbc.spi.ConnectionFactory</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">R2DBC connection pool.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Predefined type: <a href="https://javadoc.io/static/io.r2dbc/r2dbc-pool/1.0.0.RELEASE/io/r2dbc/pool/ConnectionPool.html" target="_blank" rel="noopener"><code>io.r2dbc.pool.ConnectionPool</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST client.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The interface annotated by the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-client/src/main/java/io/rxmicro/rest/client/RestClient.java" target="_blank" rel="noopener"><code>@RestClient</code></a> annotation.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The source code of the project demonstrating all supported for injection RxMicro components is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-all-rxmicro-components" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-all-rxmicro-components</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="cdi-factory-method-section"><a class="anchor" href="#cdi-factory-method-section"></a><a class="link" href="#cdi-factory-method-section">11.10. Factory Method</a></h3>
<div class="paragraph">
<p>When using the dependency injection mechanisms, the RxMicro framework creates instances of the specified classes and injects references to them to injection points.
For successful implementation of this behavior, each class, the instance of which should be injected, must contain an accessible constructor without parameters or a constructor annotated by the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Inject.java" target="_blank" rel="noopener"><code>@Inject</code></a> or
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Autowired.java" target="_blank" rel="noopener"><code>@Autowired</code></a> annotation.</p>
</div>
<div class="paragraph">
<p>In other words, the RxMicro framework determines the instance of which class should be created and creates this instance automatically at the start of the CDI container.
If it is necessary to get more control over creation of the implementation instance, it is necessary to use the Factory Method template:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BusinessServiceFacade {

    @Inject
    BusinessService businessService;

    <i class="conum" data-value="1"></i><b>(1)</b>
    @Factory
    static BusinessServiceFacade create() {
        System.out.println("Use factory method");
        return new BusinessServiceFacade();
    }

    <i class="conum" data-value="2"></i><b>(2)</b>
    private BusinessServiceFacade() {
    }

    void postConstruct() {
        System.out.println(businessService.getClass().getSimpleName());
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The class must contain the static method annotated by the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Factory.java" target="_blank" rel="noopener"><code>@Factory</code></a>annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The private constructor restricts the possibility of creating the instance of this class externally.
Thus, the instance of this class can only be created using the <code>create()</code> factory method.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the RxMicro framework detects a method in the class, annotated by the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Factory.java" target="_blank" rel="noopener"><code>@Factory</code></a>annotation, then this method is used instead of the constructor when creating the instance of this class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroComponentTest(BusinessServiceFacade.class)
final class BusinessServiceFacadeTest {

    private SystemOut systemOut;

    @Test
    void Should_support_constructor_injection() {
        assertEquals(
                List.of(
                        "Use factory method",
                        BusinessServiceImpl.class.getSimpleName()
                ),
                systemOut.asStrings()
        );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The factory method must meet the following requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The method must be <code>static</code>.</p>
</li>
<li>
<p>The method must be non-<code>native</code>.</p>
</li>
<li>
<p>The method must not be <code>synchronized</code>.</p>
</li>
<li>
<p>The method must return the class instance in which it is declared.</p>
</li>
<li>
<p>The method must not contain parameters.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-factory-method" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-factory-method</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="cdi-factory-class-section"><a class="anchor" href="#cdi-factory-class-section"></a><a class="link" href="#cdi-factory-class-section">11.11. Factory Class</a></h3>
<div class="paragraph">
<p>The RxMicro framework supports creation of factory classes, that can be used to create instances of other types.</p>
</div>
<div class="paragraph">
<p>By using factory classes, it is possible to get the following benefits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create dynamic classes.
<em>(For example, using the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/reflect/Proxy.html" target="_blank" rel="noopener"><code>Proxy</code></a> class.)</em></p>
</li>
<li>
<p>Implement a <code>prototype</code> scope.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To create a factory class, it is necessary:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a class implementing the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/Supplier.html" target="_blank" rel="noopener"><code>Supplier</code></a> interface.</p>
</li>
<li>
<p>Annotate this class by the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Factory.java" target="_blank" rel="noopener"><code>@Factory</code></a>annotation.</p>
</li>
<li>
<p>Implement the <code>get</code> method, which should return the instance of the created class.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, to create a dynamic class, it is necessary to use the following factory class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Factory
public final class BusinessServiceFactoryImpl implements Supplier&lt;BusinessService&gt; {

    @Override
    public BusinessService get() {
        final Object o = new Object();
        return (BusinessService) Proxy.newProxyInstance(
                BusinessService.class.getClassLoader(),
                new Class[]{BusinessService.class},
                (proxy, method, args) -&gt; {
                    if ("getValue".equals(method.getName())) {
                        return "PROXY";
                    } else {
                        return method.invoke(o, args);
                    }
                }
        );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Injection of an instance created by the factory class does not differ from injection of an instance automatically created by the RxMicro framework:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BusinessServiceFacade {

    @Inject
    BusinessService businessService;

    public String getValue() {
        return businessService.getValue();
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When invoking the <code>getValue</code> method, the dynamic class returns a predefined value:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroComponentTest(BusinessServiceFacade.class)
final class BusinessServiceFacadeTest {

    private BusinessServiceFacade businessServiceFacade;

    @Test
    void Should_support_factory_classes() {
        assertEquals("PROXY", businessServiceFacade.getValue());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-factory-class" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-factory-class</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="cdi-resource-section"><a class="anchor" href="#cdi-resource-section"></a><a class="link" href="#cdi-resource-section">11.12. External resource injection</a></h3>
<div class="sect3">
<h4 id="basic_usage_2"><a class="anchor" href="#basic_usage_2"></a><a class="link" href="#basic_usage_2">11.12.1. Basic Usage</a></h4>
<div class="paragraph">
<p>Indicates the need to inject the external resource into the annotated class field or method parameter.</p>
</div>
<div class="paragraph">
<p>External resource is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>File.</p>
</li>
<li>
<p>Directory.</p>
</li>
<li>
<p>Classpath resource.</p>
</li>
<li>
<p>URL Resource.</p>
</li>
<li>
<p>etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>The RxMicro framework uses blocking API to inject resource during startup!</strong></p>
</div>
<div class="paragraph">
<p>To inject external resource it is necessary to use
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Resource.java" target="_blank" rel="noopener"><code>@Resource</code></a> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class Component {

    @Resource("classpath:resources.properties")
    Map&lt;String, String&gt; resources;

    public Map&lt;String, String&gt; getResources() {
        return resources;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Content of the <code>classpath:resources.properties</code> is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">name=value</code></pre>
</div>
</div>
<div class="paragraph">
<p>After startup external resource is injected successful:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroComponentTest(Component.class)
final class ComponentTest {

    private Component component;

    @Test
    void Should_the_resources_be_injected() {
        assertEquals(Map.of("name", "value"), component.getResources());
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="additional_info"><a class="anchor" href="#additional_info"></a><a class="link" href="#additional_info">11.12.2. Additional Info</a></h4>
<div class="paragraph">
<p>To customize resource injection mechanism it is necessary to use <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Resource.java" target="_blank" rel="noopener"><code>@Resource</code></a> annotation.</p>
</div>
<div class="paragraph">
<p>Example of valid resource paths:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>/home/rxmicro/config.json</code>;</p>
</li>
<li>
<p><code>/home/rxmicro/config.properties</code>;</p>
</li>
<li>
<p><code><a href="file:///home/rxmicro/config.json" class="bare">file:///home/rxmicro/config.json</a></code>;</p>
</li>
<li>
<p><code><a href="file:///home/rxmicro/config.properties" class="bare">file:///home/rxmicro/config.properties</a></code>;</p>
</li>
<li>
<p><code>classpath:config.json</code>;</p>
</li>
<li>
<p><code>classpath:config.properties</code>;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If converter class is not specified, the RxMicro framework tries to detect valid resource converter automatically using the following algorithm:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>io.rxmicro.cdi.resource.ClasspathJsonArrayResourceConverter</code> is used if:</p>
<div class="ulist">
<ul>
<li>
<p>Resource path starts with <code>classpath:</code> prefix.</p>
</li>
<li>
<p>Resource path ends with <code>json</code> extension.</p>
</li>
<li>
<p>Annotated by <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Resource.java" target="_blank" rel="noopener"><code>@Resource</code></a> annotation field has <code>java.util.List&lt;Object&gt;</code> type.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>io.rxmicro.cdi.resource.ClasspathJsonObjectResourceConverter</code> is used if:</p>
<div class="ulist">
<ul>
<li>
<p>Resource path starts with <code>classpath:</code> prefix.</p>
</li>
<li>
<p>Resource path ends with <code>json</code> extension.</p>
</li>
<li>
<p>Annotated by <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Resource.java" target="_blank" rel="noopener"><code>@Resource</code></a> annotation field has <code>java.util.Map&lt;String, Object&gt;</code> type.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>io.rxmicro.cdi.resource.ClasspathPropertiesResourceConverter</code> is used if:</p>
<div class="ulist">
<ul>
<li>
<p>Resource path starts with <code>classpath:</code> prefix.</p>
</li>
<li>
<p>Resource path ends with <code>properties</code> extension.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>io.rxmicro.cdi.resource.FileJsonArrayResourceConverter</code> is used if:</p>
<div class="ulist">
<ul>
<li>
<p>Resource path starts with <code>file://</code> prefix or prefix is missing.</p>
</li>
<li>
<p>Resource path ends with <code>json</code> extension.</p>
</li>
<li>
<p>Annotated by <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Resource.java" target="_blank" rel="noopener"><code>@Resource</code></a> annotation field has <code>java.util.List&lt;Object&gt;</code> type.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>io.rxmicro.cdi.resource.FileJsonObjectResourceConverter</code> is used if:</p>
<div class="ulist">
<ul>
<li>
<p>Resource path starts with <code>file://</code> prefix or prefix is missing.</p>
</li>
<li>
<p>Resource path ends with <code>json</code> extension.</p>
</li>
<li>
<p>Annotated by <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Resource.java" target="_blank" rel="noopener"><code>@Resource</code></a> annotation field has <code>java.util.Map&lt;String, Object&gt;</code> type.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>io.rxmicro.cdi.resource.FilePropertiesResourceConverter</code> is used if:</p>
<div class="ulist">
<ul>
<li>
<p>Resource path starts with <code>file://</code> prefix or prefix is missing.</p>
</li>
<li>
<p>Resource path ends with <code>properties</code> extension.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="cdi-optional-injection-section"><a class="anchor" href="#cdi-optional-injection-section"></a><a class="link" href="#cdi-optional-injection-section">11.13. Optional Injection</a></h3>
<div class="paragraph">
<p>By default, all injection points are required.
Thus, if during the process of dependencies injection, the RxMicro framework does not find a suitable instance, an error will occur.</p>
</div>
<div class="paragraph">
<p>If the current project allows the situation when a suitable instance may be missing, then the <code>optional injection</code> mode should be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BusinessServiceFacade {

    <i class="conum" data-value="1"></i><b>(1)</b>
    @Inject(optional = true)
    BusinessService productionBusinessService = null;

    <i class="conum" data-value="2"></i><b>(2)</b>
    @Autowired(required = false)
    BusinessService developmentBusinessService = new BusinessService() {
        @Override
        public String toString() {
            return "DefaultImpl";
        }
    };

    void postConstruct() {
        System.out.println(productionBusinessService);
        System.out.println(developmentBusinessService);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When using the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Inject.java" target="_blank" rel="noopener"><code>@Inject</code></a> annotation, the <code>optional = true</code> parameter must be set to enable the <code>optional injection</code> mode.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>When using the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-cdi/src/main/java/io/rxmicro/cdi/Autowired.java" target="_blank" rel="noopener"><code>@Autowired</code></a> annotation, the <code>required = false</code> parameter must be set to enable the <code>optional injection</code> mode.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the <code>optional injection</code> mode is enabled, the RxMicro framework uses the following injection algorithm:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If the dependency is found, it will be successfully injected.</p>
</li>
<li>
<p>If there&#8217;s no dependency, nothing happens.<br>
<em>(In this case, the behaviour appears to be as if the field is not annotated by any annotation!)</em></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The correctness of this algorithm can be checked with the following test:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroComponentTest(BusinessServiceFacade.class)
final class BusinessServiceFacadeTest {

    private SystemOut systemOut;

    @Test
    void Should_support_optional_injection() {
        assertEquals(
                List.of(
                        "null",
                        "DefaultImpl"
                ),
                systemOut.asStrings()
        );
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-optional-injection" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-optional-injection</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="cdi-multibindings-section"><a class="anchor" href="#cdi-multibindings-section"></a><a class="link" href="#cdi-multibindings-section">11.14. Multibindings</a></h3>
<div class="paragraph">
<p>The RxMicro framework supports <strong>Multibindings</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Multibindings</strong> is a function of the CDI container, that allows You to find all implementations of this type and inject them.</p>
</div>
<div class="paragraph">
<p>For example, if there are two implementation classes of the <code>BusinessService</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class ProductionBusinessService implements BusinessService {

    @Override
    public String getValue() {
        return "PRODUCTION";
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class DevelopmentBusinessService implements BusinessService {

    @Override
    public String getValue() {
        return "DEVELOPMENT";
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>then the instances of these classes can be injected by the RxMicro framework into the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Set.html" target="_blank" rel="noopener"><code>java.util.Set</code></a> type field:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class BusinessServiceFacade {

    @Inject
    Set&lt;BusinessService&gt; businessServices;

    void postConstruct() {
        System.out.println(
                businessServices.stream()
                        .map(s -&gt; s.getClass().getSimpleName())
                        .collect(joining(", "))
        );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>After successful injection, the <code>businessServices</code> field will contain the <code>ProductionBusinessService</code> and <code>DevelopmentBusinessService</code> class instances:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroComponentTest(BusinessServiceFacade.class)
final class BusinessServiceFacadeTest {

    private SystemOut systemOut;

    @Test
    void Should_support_multibinder() {
        assertEquals(
                "DevelopmentBusinessService, ProductionBusinessService",
                systemOut.asString()
        );
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-multibinder" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-cdi/cdi-multibinder</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="monitoring-section"><a class="anchor" href="#monitoring-section"></a><a class="link" href="#monitoring-section">12. Monitoring</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>TODO</p>
</div>
<div style="page-break-after: always;"></div>
<div class="sect2">
<h3 id="monitoring-request-id-section"><a class="anchor" href="#monitoring-request-id-section"></a><a class="link" href="#monitoring-request-id-section">12.1. Request Id</a></h3>
<div class="paragraph">
<p>To track an HTTP request when using a microservice architecture, the RxMicro framework provides an HTTP request identification feature.</p>
</div>
<div class="sect3">
<h4 id="basic_rules_9"><a class="anchor" href="#basic_rules_9"></a><a class="link" href="#basic_rules_9">12.1.1. Basic Rules</a></h4>
<div class="paragraph">
<p>If the current request is identified, the provided unique id is used during the life-cycle of the current request.
If the request is not identified, the RxMicro framework generates a unique id, which is further used in the life-cycle of the current request.</p>
</div>
<div class="paragraph">
<p>To store the request id, the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/HttpStandardHeaderNames.java#L400" target="_blank" rel="noopener"><code>Request-Id</code></a> HTTP additional header is used.</p>
</div>
<div class="paragraph">
<p>If the HTTP request id is necessary for business logic, a separate field in the HTTP request Java model must be created:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Request {

    <i class="conum" data-value="1"></i><b>(1)</b>
    //@Header(HttpHeaders.REQUEST_ID)
    <i class="conum" data-value="2"></i><b>(2)</b>
    @RequestId
    String requestId;

    public String getRequestId() {
        return requestId;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>For convenience, instead of specifying an HTTP header using the <code>@Header</code> annotation and the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/HttpStandardHeaderNames.java#L400" target="_blank" rel="noopener"><code>Request-Id</code></a> name,</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>the special <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest/src/main/java/io/rxmicro/rest/RequestId.java" target="_blank" rel="noopener"><code>@RequestId</code></a> annotation can be used, which is an alternative to the <code>@Header(HttpHeaders.REQUEST_ID)</code> configuration.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Having declared a field in the HTTP request Java model, You can use its value in the handler:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class MicroService {

    @GET("/")
    void handle(final Request request) {
        System.out.println(request.getRequestId()); <i class="conum" data-value="1"></i><b>(1)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Displaying the value of the current request id in the console.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following test describes the basic requirements for the behavior of the request id function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceTest {

    @WithConfig
    private static final RestServerConfig CONFIG = new RestServerConfig()
            .setRequestIdGeneratorProvider(restServerConfig -&gt; () -&gt; "TestRequestId") <i class="conum" data-value="6"></i><b>(6)</b>
            .setDevelopmentMode(true);

    private BlockingHttpClient blockingHttpClient;

    private SystemOut systemOut;

    @Test
    void Should_generate_RequestId_automatically() {
        final ClientHttpResponse response = blockingHttpClient.get("/");
        assertEquals("TestRequestId", systemOut.asString()); <i class="conum" data-value="1"></i><b>(1)</b>
        assertEquals("TestRequestId", response.getHeaders().getValue(REQUEST_ID));  <i class="conum" data-value="2"></i><b>(2)</b>
    }

    @Test
    void Should_use_provided_RequestId() {
        final ClientHttpResponse response =
                blockingHttpClient.get("/", HttpHeaders.of(REQUEST_ID, "Qwerty")); <i class="conum" data-value="3"></i><b>(3)</b>

        assertEquals("Qwerty", systemOut.asString()); <i class="conum" data-value="4"></i><b>(4)</b>
        assertEquals("Qwerty", response.getHeaders().getValue(REQUEST_ID));  <i class="conum" data-value="5"></i><b>(5)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>For HTTP requests without id, the RxMicro framework must generate a unique id automatically.
<em>(This id can be used in the HTTP request handler body.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Each HTTP response must contain the required
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/HttpStandardHeaderNames.java#L400" target="_blank" rel="noopener"><code>Request-Id</code></a>
HTTP header with the value of the generated request id.<br>
<em>(If the configuration parameter <code>RestServerConfig.returnGeneratedRequestId = false</code>, the HTTP response will not contain the <code>Request-Id</code> header.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>If the current HTTP request already contains an id, the RxMicro framework must use it instead of generating a new value.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The id set by the client can be used in the HTTP request handler body.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Each HTTP response must contain the required
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-http/src/main/java/io/rxmicro/http/HttpStandardHeaderNames.java#L400" target="_blank" rel="noopener"><code>Request-Id</code></a>
HTTP header with a client specified request id value.<br>
<em>(If the configuration parameter <code>RestServerConfig.returnGeneratedRequestId = false</code>, the HTTP response will not contain the <code>Request-Id</code> header.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>For test purposes it is necessary to set deterministic request id provider with constant value.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-request-id" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-rest-controller/rest-controller-request-id</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="supported_generator_providers"><a class="anchor" href="#supported_generator_providers"></a><a class="link" href="#supported_generator_providers">12.1.2. Supported Generator Providers</a></h4>
<div class="paragraph">
<p>The RxMicro framework provides the following predefined request id generator providers.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 19. Generator name and its implementation class.</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Implementation class</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/PredefinedRequestIdGeneratorProvider.java#L54" target="_blank" rel="noopener"><code>UUID_128_BIT</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/feature/request/id/generator/RandomRequestIdGenerator.java" target="_blank" rel="noopener"><code>RandomRequestIdGenerator</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Generates unique 16 bytes (128 bits) request id</strong></p>
<p class="tableblock">According to specification this generator is similar to the
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/UUID.html#randomUUID()" target="_blank" rel="noopener"><code>UUID.randomUUID()</code></a> generation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/PredefinedRequestIdGeneratorProvider.java#L65" target="_blank" rel="noopener"><code>RANDOM_96_BIT</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/feature/request/id/generator/RandomRequestIdGenerator.java" target="_blank" rel="noopener"><code>RandomRequestIdGenerator</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Generates unique 12 bytes (96 bits) request id</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/PredefinedRequestIdGeneratorProvider.java#L75" target="_blank" rel="noopener"><code>PARTLY_RANDOM_96_BIT</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/feature/request/id/generator/PartlyRandom96BitsRequestIdGenerator.java" target="_blank" rel="noopener"><code>PartlyRandom96BitsRequestIdGenerator</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Generates unique 12 bytes (96 bits) request id</strong></p>
<p class="tableblock">Each request id contains 52 random and 44 deterministic bits.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/PredefinedRequestIdGeneratorProvider.java#L90" target="_blank" rel="noopener"><code>DETERMINISTIC_96_BIT</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/feature/request/id/generator/Deterministic96BitsRequestIdGenerator.java" target="_blank" rel="noopener"><code>Deterministic96BitsRequestIdGenerator</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Generates unique 12 bytes (96 bits) request id</strong></p>
<p class="tableblock">Each request id contains 44 deterministic bits + 24 incremental counter bits + 28 checksum bits.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/PredefinedRequestIdGeneratorProvider.java#L110" target="_blank" rel="noopener"><code>DEFAULT_96_BIT</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/feature/request/id/generator/PartlyRandom96BitsRequestIdGenerator.java" target="_blank" rel="noopener"><code>PartlyRandom96BitsRequestIdGenerator</code></a>,
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/feature/request/id/generator/Deterministic96BitsRequestIdGenerator.java" target="_blank" rel="noopener"><code>Deterministic96BitsRequestIdGenerator</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Generates unique 12 bytes (96 bits) request id</strong></p>
<p class="tableblock">This is default request id generator provider.</p>
<p class="tableblock">By default this request id generator provider tries to use <code>PARTLY_RANDOM_96_BIT</code> request id generator.
But if during predefined timeout the <code>java.security.SecureRandom</code> instance can&#8217;t generate random bytes, the <code>DETERMINISTIC_96_BIT</code> request id generator will be used.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>To change the request id generator provider, You must use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-rest-server/src/main/java/io/rxmicro/rest/server/RestServerConfig.java" target="_blank" rel="noopener"><code>RestServerConfig</code></a> configuration class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">new Configs.Builder()
        .withConfigs(new RestServerConfig()
                .setRequestIdGeneratorProvider(
                        PredefinedRequestIdGeneratorProvider.UUID_128_BITS <i class="conum" data-value="1"></i><b>(1)</b>
                )
        )
        .build();</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">export rest-server.requestIdGeneratorProvider=\
@io.rxmicro.rest.server.PredefinedRequestIdGeneratorProvider:UUID_128_BIT</code></pre>
</div>
</div>
<div class="paragraph">
<p>or using any other <a href="#core-config-types">supported config types</a></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To get additional information about how custom type can be used as valid config parameters read <a href="#core_config_supported_custom_parameter_types">Section 4.8.6.2, &#8220;Supported Custom Parameter Types&#8221;</a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="monitoring-request-tracing-usage-example"><a class="anchor" href="#monitoring-request-tracing-usage-example"></a><a class="link" href="#monitoring-request-tracing-usage-example">12.2. Request Tracing Usage Example</a></h3>
<div class="paragraph">
<p>The following example demonstrates how request tracing feature can be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Request implements RequestIdSupplier { <i class="conum" data-value="1"></i><b>(1)</b>

    <i class="conum" data-value="2"></i><b>(2)</b>
    @RequestId
    String requestId;

    @PathVariable
    Long id;

    @Override
    public String getRequestId() {
        return requestId;
    }

    public Long getId() {
        return id;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class AccountController {

    @Inject
    private AccountService accountService;

    @GET("/account/${id}")
    Mono&lt;Response&gt; findById(final Request request) {
        return accountService.findById(request);
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class AccountService {

    <i class="conum" data-value="1"></i><b>(1)</b>
    private static final Logger LOGGER = LoggerFactory.getLogger(AccountService.class);

    @Inject
    private AccountRepository accountRepository;

    public Mono&lt;Response&gt; findById(final Request request) {
        LOGGER.debug(
                request, <i class="conum" data-value="2"></i><b>(2)</b>
                "Finding account by id=?...", request.getId()
        );
        return accountRepository.findById(request, request.getId())
                .switchIfEmpty(Mono.error(() -&gt; {
                    LOGGER.error(
                            request, <i class="conum" data-value="3"></i><b>(3)</b>
                            "Account not found by id=?!", request.getId()
                    );
                    return new AccountNotFound404Exception();
                }))
                .map(account -&gt; {
                    LOGGER.debug(
                            request, <i class="conum" data-value="4"></i><b>(4)</b>
                            "Account exists by id=?: ?",
                            request.getId(), account
                    );
                    return new Response(
                            account.getEmail(), account.getFirstName(), account.getLastName()
                    );
                });
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostgreSQLRepository
public interface AccountRepository {

    @Select("SELECT * FROM ${table} WHERE ${by-id-filter}")
    Mono&lt;Account&gt; findById(RequestIdSupplier requestIdSupplier, long id); <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The `jul.properties' config classpath resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties"><i class="conum" data-value="1"></i><b>(1)</b>
io.rxmicro.logger.jul.PatternFormatter.pattern=%date{HH:mm:ss.SSS} {%id} [%level] %logger{0}: %message%n

io.rxmicro.rest.server.level=TRACE
io.rxmicro.examples.monitoring.request.tracing.level=TRACE</code></pre>
</div>
</div>
<div class="paragraph">
<p>Invoke the test request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">:$ curl -v localhost:8080/account/1
*   Trying 127.0.0.1...
* TCP_NODELAY set
* Connected to localhost (127.0.0.1) port 8080 (#0)
&gt; GET /account/1 HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.58.0
&gt; Accept: <strong>/</strong>
&gt;
&lt; HTTP/1.1 200 OK
&lt; Content-Length: 88
&lt; Server: RxMicro-NettyServer/0.7-SNAPSHOT
&lt; Date: Wed, 25 Nov 2020 17:30:51 GMT
&lt; Content-Type: application/json
&lt; Request-Id: AkinnfVzx1752012 <i class="conum" data-value="1"></i><b>(1)</b>
&lt;
* Connection #0 to host localhost left intact
{"email":"richard.hendricks@piedpiper.com","firstName":"Richard","lastName":"Hendricks"}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The log output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">19:30:50.494 {null} [TRACE] NettyClientConnectionController: Client connection created: Channel=eaaf0399, IP=/127.0.0.1:33312

19:30:50.589 {AkinnfVzx1752012} [TRACE] NettyRequestHandler: HTTP request:  (Channel=eaaf0399, IP=/127.0.0.1:33312):
GET /account/1 HTTP/1.1
Host: localhost:8080
User-Agent: curl/7.58.0
Accept: <strong>/</strong>
content-length: 0


19:30:50.591 {AkinnfVzx1752012} [DEBUG] AccountService: Finding account by id=1...

19:30:50.998 {AkinnfVzx1752012} [TRACE] AccountRepository: Execute SQL 'SELECT id, email, first_name, last_name FROM account WHERE id = $1' with params: [1] using connection: class='PooledConnection', id='c1275307250'...

19:30:51.074 {AkinnfVzx1752012} [TRACE] AccountRepository: SQL 'SELECT id, email, first_name, last_name FROM account WHERE id = $1' with params: [1] executed successful

19:30:51.148 {AkinnfVzx1752012} [DEBUG] AccountService: Account exists by id=1: Account{id=1, email=richard.hendricks@piedpiper.com, firstName=Richard, lastName=Hendricks}

19:30:51.166 {AkinnfVzx1752012} [TRACE] AccountRepository: Connection closed: class='PooledConnection', id='c1275307250', signal='onComplete'

19:30:51.167 {AkinnfVzx1752012} [TRACE] NettyRequestHandler: HTTP response: (Channel=eaaf0399, Duration=588.093042ms):
HTTP/1.1 200 OK
Content-Length: 88
Server: RxMicro-NettyServer/0.7-SNAPSHOT
Date: Wed, 25 Nov 2020 17:30:51 GMT
Content-Type: application/json
Request-Id: AkinnfVzx1752012

{"email":"richard.hendricks@piedpiper.com","firstName":"Richard","lastName":"Hendricks"}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more information, we recommend that You familiarize yourself with the following examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-monitoring/monitoring-request-tracing" target="_blank" rel="noopener"><strong>Request tracing usage example</strong></a>;</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="java-integration-section"><a class="anchor" href="#java-integration-section"></a><a class="link" href="#java-integration-section">13. Java EcoSystem Integration</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="java-integration-unnamed-module"><a class="anchor" href="#java-integration-unnamed-module"></a><a class="link" href="#java-integration-unnamed-module">13.1. Unnamed Modules Support</a></h3>
<div class="paragraph">
<p><a href="https://openjdk.java.net/projects/jdk9/">On September 21, 2017</a>, Java 9 has introduced <a href="https://www.oracle.com/corporate/features/understanding-java-9-modules.html" target="_blank" rel="noopener"><code>JPMS</code></a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There are four types of modules in the <a href="https://www.oracle.com/corporate/features/understanding-java-9-modules.html" target="_blank" rel="noopener"><code>JPMS</code></a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>System Modules</strong> - There are the Java SE and JDK modules.<br>
<em>(For example <code>java.base</code>, <code>java.logging</code>, <code>java.net.http</code>, etc)</em></p>
</li>
<li>
<p><strong>Application Modules</strong> - The default modules, that are built using JPMS.<br>
They are <code>named</code> and defined in the compiled <code>module-info.class</code> file included in the assembled JAR.</p>
</li>
<li>
<p><strong>Automatic Modules</strong> - The modules that are created automatically from all unmodularized jar files at the module path.
The name of the modules will be derived from the name of the appropriate JAR files.</p>
</li>
<li>
<p><strong>Unnamed Modules</strong> - The modules that are created automatically if JAR files are loaded onto the classpath instead of the module path.
Unnamed modules disable the JPMS and allow to run any code that does not support the JPMS on Java 9 or higher.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Currently, the majority of existing frameworks and libraries are focused on <a href="https://openjdk.java.net/projects/jdk8/">JDK 8</a> and do not support <a href="https://www.oracle.com/corporate/features/understanding-java-9-modules.html" target="_blank" rel="noopener"><code>JPMS</code></a>.</p>
</div>
<div class="paragraph">
<p>To support compatibility with libraries that do not support <a href="https://www.oracle.com/corporate/features/understanding-java-9-modules.html" target="_blank" rel="noopener"><code>JPMS</code></a>, Java 9 provides the <code>unnamed modules</code> mechanism.</p>
</div>
<div class="paragraph">
<p>The feature of this mechanism is that the code written in Java 9 and higher does not use the <code>module-info.java</code> module descriptor, and uses <code>class-path</code> instead of <code>module-path</code>.
For integration with libraries that do not support <a href="https://www.oracle.com/corporate/features/understanding-java-9-modules.html" target="_blank" rel="noopener"><code>JPMS</code></a>, the RxMicro framework allows You to enable the <code>unnamed module</code> mode for the <code>RxMicro Annotation Processor</code>.</p>
</div>
<div class="paragraph">
<p>To enable this mode, You need to add the <code>RX_MICRO_BUILD_UNNAMED_MODULE</code> configuration parameter to the <code>maven-compiler-plugin</code> settings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
    &lt;version&gt;${maven-compiler-plugin.version}&lt;/version&gt;
    &lt;configuration&gt;
        &lt;release&gt;11&lt;/release&gt;
        &lt;!-- ... --&gt;
        &lt;compilerArgs&gt;
            &lt;arg&gt;-ARX_MICRO_BUILD_UNNAMED_MODULE=true&lt;/arg&gt; <i class="conum" data-value="1"></i><b>(1)</b>
        &lt;/compilerArgs&gt;
    &lt;/configuration&gt;
    &lt;!-- ... --&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>RxMicro Annotation Processor</code> will use the <code>unnamed module</code> mode for the current microservice project.</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
<div class="sect3">
<h4 id="java-integration-unnamed-module-uber-jar"><a class="anchor" href="#java-integration-unnamed-module-uber-jar"></a><a class="link" href="#java-integration-unnamed-module-uber-jar">13.1.1. Uber Jar</a></h4>
<div class="paragraph">
<p>An uber JAR (also known as a fat JAR or JAR with dependencies) is a JAR file that contains not only a Java program, but embeds its dependencies as well.
This means that the JAR functions as an "all-in-one" distribution of the software, without needing any other Java code.</p>
</div>
<div class="paragraph">
<p><em>(You still need a Java runtime, and an underlying operating system, of course.)</em></p>
</div>
<div class="paragraph">
<p>To build a microservice project in the form of <code>uber.jar</code>, You need to enable the <code>unnamed module</code> mode and configure the <code>maven-shade-plugin</code>.</p>
</div>
<div class="sect4">
<h5 id="enable_the_unnamed_module_mode"><a class="anchor" href="#enable_the_unnamed_module_mode"></a><a class="link" href="#enable_the_unnamed_module_mode">13.1.1.1. Enable the <code>unnamed module</code> Mode</a></h5>
<div class="paragraph">
<p>To enable the <code>unnamed module</code> mode, add the <code>RX_MICRO_BUILD_UNNAMED_MODULE</code> compiler option to <code>maven-compiler-plugin</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
    &lt;version&gt;${maven-compiler-plugin.version}&lt;/version&gt;
    &lt;configuration&gt;
        &lt;release&gt;11&lt;/release&gt;
        &lt;!-- ... --&gt;
        &lt;compilerArgs&gt;
            &lt;arg&gt;-ARX_MICRO_BUILD_UNNAMED_MODULE=true&lt;/arg&gt; <i class="conum" data-value="1"></i><b>(1)</b>
        &lt;/compilerArgs&gt;
    &lt;/configuration&gt;
    &lt;!-- ... --&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>RxMicro Annotation Processor</code> will use the <code>unnamed module</code> mode for the current microservice project.</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="configuration_of_maven_shade_plugin"><a class="anchor" href="#configuration_of_maven_shade_plugin"></a><a class="link" href="#configuration_of_maven_shade_plugin">13.1.1.2. Configuration of <code>maven-shade-plugin</code></a></h5>
<div id="java-integration-unnamed-module-uber-jar-maven-shade-plugin" class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;
    &lt;version&gt;${maven-shade-plugin.version}&lt;/version&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;phase&gt;package&lt;/phase&gt;
            &lt;goals&gt;
                &lt;goal&gt;shade&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
                &lt;createDependencyReducedPom&gt;false&lt;/createDependencyReducedPom&gt;
                &lt;transformers&gt;
                    &lt;transformer implementation=
                                         "org.apache.maven.plugins.shade.resource.ManifestResourceTransformer"&gt;
                        &lt;manifestEntries&gt;
                            &lt;Main-Class&gt;
                                io.rxmicro.examples.unnamed.module.uber.jar.HelloWorldMicroService <i class="conum" data-value="1"></i><b>(1)</b>
                            &lt;/Main-Class&gt;
                        &lt;/manifestEntries&gt;
                    &lt;/transformer&gt;
                &lt;/transformers&gt;
                &lt;filters&gt;
                    &lt;filter&gt;
                        &lt;artifact&gt;*:*&lt;/artifact&gt;
                        &lt;excludes&gt;
                            &lt;exclude&gt;ModuleInfo.*&lt;/exclude&gt; <i class="conum" data-value="2"></i><b>(2)</b>
                        &lt;/excludes&gt;
                    &lt;/filter&gt;
                &lt;/filters&gt;
                &lt;minimizeJar&gt;true&lt;/minimizeJar&gt; <i class="conum" data-value="3"></i><b>(3)</b>
            &lt;/configuration&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>It is necessary to specify a class with the <code>main</code> method, which will be used as an entry point into the microservice.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The resulting <code>uber.jar</code> must not contain the module virtual descriptor, as this descriptor is only needed at the compilation level.
<em>(More information about the virtual descriptor can be found in <a href="#java-integration-unnamed-module-module-config">Section 13.1.2, &#8220;Module Configuration&#8221;</a>.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The resulting <code>uber.jar</code> can be reduced by excluding unused classes and packages.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>maven-shade-plugin</code> plugin automatically removes all <code>module-info.class</code> from the resulting <code>uber.jar</code>, so all RxMicro modules will work in the <code>unnamed module</code> mode!</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="rebuild_project"><a class="anchor" href="#rebuild_project"></a><a class="link" href="#rebuild_project">13.1.1.3. Rebuild Project</a></h5>
<div class="paragraph">
<p>After <code>pom.xml</code> setting, it is necessary to rebuild the project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-txt" data-lang="txt"><strong>mvn</strong> clean package</code></pre>
</div>
</div>
<div class="paragraph">
<p>As a result, the <code>uber.jar</code> with all the necessary dependencies will be created:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-txt" data-lang="txt">:$ <strong>ls</strong> -lh

-rw-rw-r-- 1 nedis nedis <strong>1,4M</strong> Mar 28 11:03 <strong>unnamed-module-uber-jar-1.0-SNAPSHOT.jar</strong>          <i class="conum" data-value="1"></i><b>(1)</b>
-rw-rw-r-- 1 nedis nedis <strong>9,8K</strong> Mar 28 11:03 original-unnamed-module-uber-jar-1.0-SNAPSHOT.jar <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>uber.jar</code> size is equal to <strong>1,4 MB</strong>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The size of the original jar file is equal to <strong>9.8 KB</strong>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>uber.jar</code> contains the source code of the microservice project, the code of the RxMicro and the Netty frameworks:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/java-integration/uber-jar-content.jpg" alt="uber jar content">
</div>
<div class="title">Figure 16. The <code>uber.jar</code> content for a simple microservice project</div>
</div>
</div>
<div class="sect4">
<h5 id="run_uber_jar"><a class="anchor" href="#run_uber_jar"></a><a class="link" href="#run_uber_jar">13.1.1.4. Run <code>uber.jar</code></a></h5>
<div class="paragraph">
<p>To run <code>uber.jar</code> it is necessary to provider jar file only:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-txt" data-lang="txt">&gt; <strong>java</strong> -jar unnamed-module-uber-jar-1.0-SNAPSHOT.jar

2020-02-02 20:14:11.707 [INFO] io.rxmicro.rest.server.netty.internal.component.NettyServer :
Server started at 0.0.0.0:8080 using NETTY transport in 500 millis <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>Server started in &#8230;&#8203; millis</code> message format means that the RxMicro HTTP server has been successfully started.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To run a modularized micro service project the java requires more arguments:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-txt" data-lang="txt"><strong>java</strong> -p ./classes:lib -m <strong>examples.quick.start/io.rxmicro.examples.quick.start.HelloWorldMicroService</strong></code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-unnamed-module/unnamed-module-uber-jar" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-unnamed-module/unnamed-module-uber-jar</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect3">
<h4 id="java-integration-unnamed-module-module-config"><a class="anchor" href="#java-integration-unnamed-module-module-config"></a><a class="link" href="#java-integration-unnamed-module-module-config">13.1.2. Module Configuration</a></h4>
<div class="paragraph">
<p>Some RxMicro modules allow You to set the common configuration with <code>RxMicro Annotations</code>, which annotate the <code>module-info.java</code> module descriptor.
But for the <code>unnamed module</code>, the <code>module-info.java</code> module descriptor does not exist!</p>
</div>
<div class="paragraph">
<p>In such cases a virtual descriptor must be created:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Retention(CLASS)
@Target({})
public @interface ModuleInfo {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A virtual descriptor is a custom annotation that meets the following requirements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The name of the virtual descriptor is fixed and equal to: <code>ModuleInfo</code>.</p>
</li>
<li>
<p>The annotation must be contained in the default package (<code>unnamed package</code>).</p>
</li>
<li>
<p>The annotation should be available only during the compilation process: <code>@Retention(CLASS)</code>.</p>
</li>
<li>
<p>The annotation must contain an empty list of targets: <code>@Target({})</code>.</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Since the virtual descriptor is available only during the compilation process, then during the <code>uber.jar</code> build process this annotation can be excluded from the resulting <code>jar</code>.</p>
</div>
<div class="paragraph">
<p>Therefore, <a href="#java-integration-unnamed-module-uber-jar-maven-shade-plugin">when setting the <code>maven-shade-plugin</code>, the following setting was added</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;filters&gt;
    &lt;filter&gt;
        &lt;artifact&gt;*:*&lt;/artifact&gt;
        &lt;excludes&gt;
            &lt;exclude&gt;ModuleInfo.*&lt;/exclude&gt;
        &lt;/excludes&gt;
    &lt;/filter&gt;
&lt;/filters&gt;</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="configuration_of_the_code_generation_process_for_rest_controller"><a class="anchor" href="#configuration_of_the_code_generation_process_for_rest_controller"></a><a class="link" href="#configuration_of_the_code_generation_process_for_rest_controller">13.1.2.1. Configuration of the Code Generation Process for Rest Controller</a></h5>
<div class="paragraph">
<p>The RxMicro framework provides the option to configure the code generation process for REST controllers.
For this purpose, the <code>@RestServerGeneratorConfig</code> annotation should be used to annotate the
<a href="rest-controller.html#rest-controller-rest-server-generator-config-section"><code>module-info.java</code> module descriptor</a>.</p>
</div>
<div class="paragraph">
<p>For the <code>unnamed module</code> instead of the <code>module-info.java</code> module descriptor, use the <code>ModuleInfo</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Retention(CLASS)
@Target({})
@RestServerGeneratorConfig(
        exchangeFormat = ServerExchangeFormatModule.JSON,
        generateRequestValidators = GenerateOption.DISABLED,
        generateResponseValidators = GenerateOption.AUTO_DETECT
)
public @interface ModuleInfo {
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-unnamed-module/unnamed-module-rest-controller-generator" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-unnamed-module/unnamed-module-rest-controller-generator</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect4">
<h5 id="configuration_of_the_code_generation_process_for_rest_client"><a class="anchor" href="#configuration_of_the_code_generation_process_for_rest_client"></a><a class="link" href="#configuration_of_the_code_generation_process_for_rest_client">13.1.2.2. Configuration of the Code Generation Process for Rest Client</a></h5>
<div class="paragraph">
<p>The RxMicro framework provides the option to configure the code generation process for REST clients.
For this purpose, the <code>@RestClientGeneratorConfig</code> annotation should be used to annotate the
<a href="rest-client.html#rest-client-rest-client-generator-config-section"><code>module-info.java</code> module descriptor</a>.</p>
</div>
<div class="paragraph">
<p>For the <code>unnamed module</code> instead of the <code>module-info.java</code> module descriptor, use the <code>ModuleInfo</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Retention(CLASS)
@Target({})
@RestClientGeneratorConfig(
        exchangeFormat = ClientExchangeFormatModule.JSON,
        generateRequestValidators = GenerateOption.AUTO_DETECT,
        requestValidationMode = RestClientGeneratorConfig.RequestValidationMode.RETURN_ERROR_SIGNAL,
        generateResponseValidators = GenerateOption.DISABLED
)
public @interface ModuleInfo {
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-unnamed-module/unnamed-module-rest-client-generator" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-unnamed-module/unnamed-module-rest-client-generator</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect4">
<h5 id="rest_based_microservice_metadata_configuration_2"><a class="anchor" href="#rest_based_microservice_metadata_configuration_2"></a><a class="link" href="#rest_based_microservice_metadata_configuration_2">13.1.2.3. REST-based Microservice Metadata Configuration</a></h5>
<div class="paragraph">
<p>The RxMicro framework provides the option to configure the REST-based microservice documentation generation process, using the annotations.
These annotations annotate the <a href="project-documentation.html#project-documentation-metadata-annotations-section"><code>module-info.java</code> module descriptor</a>.</p>
</div>
<div class="paragraph">
<p>For the <code>unnamed module</code> instead of the <code>module-info.java</code> module descriptor, use the <code>ModuleInfo</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Retention(CLASS)
@Target({})
@Title("Metadata Annotations")
@Description("*Project* _Description_")
@Author(
        name = "Richard Hendricks",
        email = "richard.hendricks@piedpiper.com"
)
@Author(
        name = "Bertram Gilfoyle",
        email = "bertram.gilfoyle@piedpiper.com"
)
@Author(
        name = "Dinesh Chugtai",
        email = "dinesh.chugtai@piedpiper.com"
)
@BaseEndpoint("https://api.rxmicro.io")
@License(
        name = "Apache License 2.0",
        url = "https://github.com/rxmicro/rxmicro/blob/master/LICENSE"
)
@DocumentationDefinition(
        introduction = @IntroductionDefinition(
                sectionOrder = {
                        IntroductionDefinition.Section.BASE_ENDPOINT,
                        IntroductionDefinition.Section.LICENSES
                }
        ),
        resource = @ResourceDefinition(
                withInternalErrorResponse = false
        ),
        withGeneratedDate = false
)
public @interface ModuleInfo {
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-unnamed-module/unnamed-module-documentation-asciidoctor-metadata-annotations" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-unnamed-module/unnamed-module-documentation-asciidoctor-metadata-annotations</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="java-integration-graalvm-native-image"><a class="anchor" href="#java-integration-graalvm-native-image"></a><a class="link" href="#java-integration-graalvm-native-image">13.2. Using GraalVM to Build a Native Image</a></h3>
<div class="paragraph">
<p><a href="https://www.graalvm.org/" target="_blank" rel="noopener">GraalVM</a> is a universal virtual machine for running applications written in different languages.</p>
</div>
<div class="paragraph">
<p>GraalVM contains a <a href="https://www.graalvm.org/docs/reference-manual/native-image/" target="_blank" rel="noopener">Native Image Tool</a>, that allows You to ahead-of-time compile Java code to a standalone executable, called a native image.</p>
</div>
<div class="paragraph">
<p>The GraalVM Native Image Tool can be used to build a native image of any RxMicro microservice project.
Before build a native image it is necessary to setup a GraalVM developer environment.</p>
</div>
<div class="sect3">
<h4 id="setup_a_graalvm"><a class="anchor" href="#setup_a_graalvm"></a><a class="link" href="#setup_a_graalvm">13.2.1. Setup a GraalVM</a></h4>
<div class="paragraph">
<p>GraalVM is distributed as Community Edition and Enterprise Edition.</p>
</div>
<div class="paragraph">
<p><strong>Current guide describes a use of the GraalVM Community Edition (GraalVM CE)!</strong></p>
</div>
<div class="paragraph">
<p>Setup of the GraalVM CE contains a few simple steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make a GraalVM Home Directory.</p>
</li>
<li>
<p>Select a GraalVM CE Distribution for Your Platform.</p>
</li>
<li>
<p>Download the GraalVM CE Distribution.</p>
</li>
<li>
<p>Unzip the GraalVM CE Distribution.</p>
</li>
<li>
<p>Set a <code>GRAALVM_HOME</code> Environment Variable.</p>
</li>
<li>
<p>Install a Native Image Module.</p>
</li>
<li>
<p>Add the Native Image Tool to <code>PATH</code>.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="make_a_graalvm_home_directory"><a class="anchor" href="#make_a_graalvm_home_directory"></a><a class="link" href="#make_a_graalvm_home_directory">13.2.1.1. Make a GraalVM Home Directory</a></h5>
<div class="paragraph">
<p>Make a directory, that will contain a GraalVM distribution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-txt" data-lang="txt"><strong>mkdir</strong> ~/GraalVM</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="select_a_graalvm_ce_distribution_for_your_platform"><a class="anchor" href="#select_a_graalvm_ce_distribution_for_your_platform"></a><a class="link" href="#select_a_graalvm_ce_distribution_for_your_platform">13.2.1.2. Select a GraalVM CE Distribution for Your Platform</a></h5>
<div class="paragraph">
<p>Visit the github release page
<a href="https://github.com/graalvm/graalvm-ce-builds/releases" target="_blank" rel="noopener"><code>https://github.com/graalvm/graalvm-ce-builds/releases</code></a>
and select a distribution for Your platform.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Please select a GraalVM CE based on Java 11!</strong></p>
</div>
<div class="paragraph">
<p><em>A GraalVM CE based on Java 8 is not supported by the RxMicro framework!</em></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="download_the_graalvm_ce_distribution"><a class="anchor" href="#download_the_graalvm_ce_distribution"></a><a class="link" href="#download_the_graalvm_ce_distribution">13.2.1.3. Download the GraalVM CE Distribution</a></h5>
<div class="paragraph">
<p>Download the selected GraalVM CE distribution onto the GraalVM home directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-txt" data-lang="txt"><strong>wget</strong> -P ~/GraalVM https://github.com/graalvm/graalvm-ce-builds/releases/download/vm-20.0.0/graalvm-ce-java11-linux-amd64-20.0.0.tar.gz</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="unzip_the_graalvm_ce_distribution"><a class="anchor" href="#unzip_the_graalvm_ce_distribution"></a><a class="link" href="#unzip_the_graalvm_ce_distribution">13.2.1.4. Unzip the GraalVM CE Distribution</a></h5>
<div class="paragraph">
<p>Unzip the GraalVM CE distribution onto the GraalVM home directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-txt" data-lang="txt"><strong>tar</strong> --strip-components=1 -vzxf ~/GraalVM/graalvm-ce-java11-linux-amd64-20.0.0.tar.gz -C ~/GraalVM
<strong>rm</strong> ~/GraalVM/graalvm-ce-java11-linux-amd64-20.0.0.tar.gz</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="set_a_graalvm_home_environment_variable"><a class="anchor" href="#set_a_graalvm_home_environment_variable"></a><a class="link" href="#set_a_graalvm_home_environment_variable">13.2.1.5. Set a <code>GRAALVM_HOME</code> Environment Variable</a></h5>
<div class="paragraph">
<p>Set a <code>GRAALVM_HOME</code> environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-txt" data-lang="txt"><strong>export</strong> GRAALVM_HOME=~/GraalVM</code></pre>
</div>
</div>
<div class="paragraph">
<p>and verify the installation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-txt" data-lang="txt"><strong>$GRAALVM_HOME/bin/java</strong> -version

openjdk version <strong>"11.0.6"</strong> 2020-01-14
OpenJDK Runtime Environment <strong>GraalVM CE</strong> 20.0.0 (build 11.0.6+9-jvmci-20.0-b02)
OpenJDK 64-Bit Server VM <strong>GraalVM CE</strong> 20.0.0 (build 11.0.6+9-jvmci-20.0-b02, mixed mode, sharing)</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If You would use the GraalVM CE only, You can add the <code>$GRAALVM_HOME/bin</code> path to the <code>PATH</code> variable!</p>
</div>
<div class="paragraph">
<p>If You use any other version of JDK, add only the separate utils to <code>PATH</code> variable.
For example only <code>gu</code> or <code>native-image</code>!</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="install_a_native_image_module"><a class="anchor" href="#install_a_native_image_module"></a><a class="link" href="#install_a_native_image_module">13.2.1.6. Install a Native Image Module</a></h5>
<div class="paragraph">
<p>Starting from GraalVM 19.0, Native Image was extracted from the base distribution.
So the <strong>Native Image Tool</strong> must be installed to GraalVM using a GraalVM Updater utility:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-txt" data-lang="txt"><strong>$GRAALVM_HOME/bin/gu</strong> install native-image

Downloading: Component catalog from www.graalvm.org
Processing Component: Native Image
Downloading: Component native-image: Native Image  from github.com
Installing new component: Native Image (org.graalvm.native-image, version 20.0.0)</code></pre>
</div>
</div>
<div class="paragraph">
<p>To verify the installation show a version of the native Native Image Tool:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-txt" data-lang="txt"><strong>$GRAALVM_HOME/bin/native-image</strong> --version

GraalVM Version 20.0.0 CE</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="add_the_native_image_tool_to_path"><a class="anchor" href="#add_the_native_image_tool_to_path"></a><a class="link" href="#add_the_native_image_tool_to_path">13.2.1.7. Add the Native Image Tool to <code>PATH</code></a></h5>
<div class="paragraph">
<p>In order not to indicate the folder where the <strong>Native Image Tool</strong> was installed, add the <strong>Native Image Tool</strong> to the <code>PATH</code> variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-txt" data-lang="txt"><strong>ln</strong> -s $GRAALVM_HOME/bin/native-image ~/bin</code></pre>
</div>
</div>
<div class="paragraph">
<p>After that logout and login to the system again.
The <strong>Native Image Tool</strong> must be available at the terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-txt" data-lang="txt"><strong>native-image</strong> --version

GraalVM Version 20.0.0 CE</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rxmicro_project_configuration"><a class="anchor" href="#rxmicro_project_configuration"></a><a class="link" href="#rxmicro_project_configuration">13.2.2. RxMicro Project Configuration</a></h4>
<div class="paragraph">
<p>The first release of GraalVM based on Java 11 is <a href="https://www.graalvm.org/docs/release-notes/19_3/#1930" target="_blank" rel="noopener"><strong>19.3.0</strong> (2019-11-19)</a>.
But unfortunately the GraalVM Native Image Tool does not support <a href="https://www.oracle.com/corporate/features/understanding-java-9-modules.html" target="_blank" rel="noopener"><code>JPMS</code></a> yet.</p>
</div>
<div class="paragraph">
<p>Thus we need to use the <code>unnamed module</code> mode for RxMicro project.</p>
</div>
<div class="sect4">
<h5 id="setup_pom_xml"><a class="anchor" href="#setup_pom_xml"></a><a class="link" href="#setup_pom_xml">13.2.2.1. Setup <code>pom.xml</code></a></h5>
<div class="sect5">
<h6 id="using_rx_micro_build_unnamed_module_option"><a class="anchor" href="#using_rx_micro_build_unnamed_module_option"></a><a class="link" href="#using_rx_micro_build_unnamed_module_option">13.2.2.1.1. Using <code>RX_MICRO_BUILD_UNNAMED_MODULE</code> Option</a></h6>
<div class="paragraph">
<p>To enable the <code>unnamed module</code> mode, it is necessary to add <code>RX_MICRO_BUILD_UNNAMED_MODULE</code> option to the <code>maven-compiler-plugin</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
    &lt;configuration&gt;
        &lt;!-- ... --&gt;
        &lt;compilerArgs&gt;
            &lt;arg&gt;-ARX_MICRO_BUILD_UNNAMED_MODULE=true&lt;/arg&gt;
        &lt;/compilerArgs&gt;
    &lt;/configuration&gt;
    &lt;!-- ... --&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="maven_shade_plugin_configuration"><a class="anchor" href="#maven_shade_plugin_configuration"></a><a class="link" href="#maven_shade_plugin_configuration">13.2.2.1.2. <code>Maven-shade-plugin</code> Configuration</a></h6>
<div class="paragraph">
<p>To build a native image we need a <code>uber jar</code>.
For that it is necessary to add <code>maven-shade-plugin</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;
    &lt;version&gt;${maven-shade-plugin.version}&lt;/version&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;phase&gt;package&lt;/phase&gt;
            &lt;goals&gt;
                &lt;goal&gt;shade&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
                &lt;createDependencyReducedPom&gt;false&lt;/createDependencyReducedPom&gt;
                &lt;transformers&gt;
                    &lt;transformer implementation=
                        "org.apache.maven.plugins.shade.resource.ManifestResourceTransformer"&gt;
                        &lt;manifestEntries&gt;
                            &lt;Main-Class&gt;
                        io.rxmicro.examples.graalvm.nativeimage.quick.start.HelloWorldMicroService
                            &lt;/Main-Class&gt;
                        &lt;/manifestEntries&gt;
                    &lt;/transformer&gt;
                &lt;/transformers&gt;
            &lt;/configuration&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="exec_maven_plugin_configuration"><a class="anchor" href="#exec_maven_plugin_configuration"></a><a class="link" href="#exec_maven_plugin_configuration">13.2.2.1.3. <code>Exec-maven-plugin</code> Configuration</a></h6>
<div class="paragraph">
<p>To build a native image from <code>maven</code> it is necessary to use <code>exec-maven-plugin</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
    &lt;artifactId&gt;exec-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;${exec-maven-plugin.version}&lt;/version&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;phase&gt;package&lt;/phase&gt;
            &lt;goals&gt;
                &lt;goal&gt;exec&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
                &lt;executable&gt;native-image&lt;/executable&gt; <i class="conum" data-value="1"></i><b>(1)</b>
                &lt;arguments&gt;
                    &lt;argument&gt;--verbose&lt;/argument&gt;
                    &lt;argument&gt;-jar&lt;/argument&gt;
                    &lt;argument&gt;--install-exit-handlers&lt;/argument&gt; <i class="conum" data-value="2"></i><b>(2)</b>
                    &lt;argument&gt;${project.build.directory}/${project.build.finalName}.jar&lt;/argument&gt;
                &lt;/arguments&gt;
            &lt;/configuration&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>An executable will be the <code>native-image</code> tool with specified arguments.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This option adds the exit handler for native image.</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Native Image Tool (<code>native-image</code>) must be available via <code>PATH</code> variable!</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="microservice_source_code"><a class="anchor" href="#microservice_source_code"></a><a class="link" href="#microservice_source_code">13.2.2.2. Microservice Source Code</a></h5>
<div class="paragraph">
<p>A microservice source code contains two classes only:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class Response {

    final String message;

    Response(final String message) {
        this.message = requireNonNull(message);
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class HelloWorldMicroService {

    @GET("/")
    CompletableFuture&lt;Response&gt; sayHelloWorld() {
        return CompletableFuture.supplyAsync(() -&gt;
                new Response("Hello World!"));
    }

    public static void main(final String[] args) {
        new Configs.Builder()
                .withContainerConfigSources() <i class="conum" data-value="1"></i><b>(1)</b>
                .build();
        RxMicroRestServer.startRestServer(HelloWorldMicroService.class);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Docker based configuration activates the configuration via annotations and environment variables only.</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="classpath_resources"><a class="anchor" href="#classpath_resources"></a><a class="link" href="#classpath_resources">13.2.2.3. Classpath Resources</a></h5>
<div class="paragraph">
<p>A RxMicro logger is configured using <code>jul.properties</code> classpath resource.</p>
</div>
<div class="paragraph">
<p><code>jul.properties</code> contains the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">io.rxmicro.rest.server.level=TRACE</code></pre>
</div>
</div>
<div class="paragraph">
<p>A native image is configured using <code>META-INF/native-image</code> classpath directory with two files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>native-image.properties</code></p>
</li>
<li>
<p><code>resource-config.json</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>(Read more about native image configuration: <a href="https://www.graalvm.org/docs/reference-manual/native-image/#native-image-configuration" target="_blank" rel="noopener">https://www.graalvm.org/docs/reference-manual/native-image/#native-image-configuration</a>)</em></p>
</div>
<div class="paragraph">
<p><code>native-image.properties</code> contains the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">Args = --no-fallback \
       --allow-incomplete-classpath \
       -H:ResourceConfigurationResources=${.}/resource-config.json</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>resource-config.json</code> contains the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "resources":[
    {"pattern":"\\Qjul.properties\\E"}
  ],
  "bundles":[]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="creation_of_the_native_image"><a class="anchor" href="#creation_of_the_native_image"></a><a class="link" href="#creation_of_the_native_image">13.2.3. Creation of the Native Image</a></h4>
<div class="paragraph">
<p>To build a native image run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-txt" data-lang="txt"><strong>mvn</strong> clean package</code></pre>
</div>
</div>
<div class="paragraph">
<p>The built native image executable will be available at the project home directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-txt" data-lang="txt"><strong>ls</strong> -lh

drwxrwxr-x 5 nedis nedis 4,0K Mar 25 20:44 <strong>src</strong>
drwxrwxr-x 8 nedis nedis 4,0K Mar 28 21:30 <strong>target</strong>
-rw-rw-r-- 1 nedis nedis 8,8K Mar 28 21:02 <strong>pom.xml</strong>
<strong>-rwxrwxr-x 1 nedis nedis  17M Mar 28 21:32 HelloWorldMicroService</strong> <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The built native image executable</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="verification_of_the_native_image"><a class="anchor" href="#verification_of_the_native_image"></a><a class="link" href="#verification_of_the_native_image">13.2.4. Verification of the Native Image</a></h4>
<div class="paragraph">
<p>To verify the built native image run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-txt" data-lang="txt"><strong>./HelloWorldMicroService</strong></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-graalvm/graalvm-native-image-quick-start" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-graalvm/graalvm-native-image-quick-start</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tesing-section"><a class="anchor" href="#tesing-section"></a><a class="link" href="#tesing-section">14. Testing</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>To help You write tests efficiently, the RxMicro framework provides the following modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-test" target="_blank" rel="noopener"><code>rxmicro.test</code></a> is a basic module designed for test writing using any modern testing framework;</p>
</li>
<li>
<p>The <a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-test-junit" target="_blank" rel="noopener"><code>rxmicro.test.junit</code></a> is a module designed for test writing using the <a href="https://junit.org/junit5/" target="_blank" rel="noopener">JUnit 5</a> framework;</p>
</li>
<li>
<p>The <a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-test-mockito" target="_blank" rel="noopener"><code>rxmicro.test.mockito</code></a> is a module designed for test writing using the <a href="https://site.mockito.org/" target="_blank" rel="noopener">Mockito</a> framework;</p>
</li>
<li>
<p>The <a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-test-mockito-junit" target="_blank" rel="noopener"><code>rxmicro.test.mockito.junit</code></a> is a module designed for test writing using the <a href="https://junit.org/junit5/" target="_blank" rel="noopener">JUnit 5</a> and <a href="https://site.mockito.org/" target="_blank" rel="noopener">Mockito</a> frameworks.</p>
</li>
<li>
<p>The <a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-test-dbunit" target="_blank" rel="noopener"><code>rxmicro.test.dbunit</code></a> is a module designed for test writing using the <a href="http://dbunit.sourceforge.net/" target="_blank" rel="noopener">DbUnit</a> framework;</p>
</li>
<li>
<p>The <a href="https://github.com/rxmicro/rxmicro/tree/v0.11/rxmicro-test-dbunit-junit" target="_blank" rel="noopener"><code>rxmicro.test.dbunit.junit</code></a> is a module designed for test writing using the <a href="http://dbunit.sourceforge.net/" target="_blank" rel="noopener">DbUnit</a> and <a href="https://junit.org/junit5/" target="_blank" rel="noopener">JUnit 5</a> frameworks;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using these modules, the developer can create the following types of tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="testing.html#testing-rest-based-microservice-tests-section">REST-based microservice test</a>;</p>
</li>
<li>
<p><a href="testing.html#testing-component-tests-section">Component unit test</a>;</p>
</li>
<li>
<p><a href="testing.html#testing-integration-tests-section">Integration test of REST-based microservices</a>.</p>
</li>
<li>
<p><a href="testing.html#testing-dbunit-tests-section">Database Testing Using DBUnit</a>.</p>
</li>
</ol>
</div>
<div style="page-break-after: always;"></div>
<div class="sect2">
<h3 id="testing-prepare-section"><a class="anchor" href="#testing-prepare-section"></a><a class="link" href="#testing-prepare-section">14.1. Preparatory Steps</a></h3>
<div class="paragraph">
<p>Before writing tests, using the RxMicro framework, the following steps must be taken:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Define the versions of used libraries.</p>
</li>
<li>
<p>Add the required dependencies to the <code>pom.xml</code>.</p>
</li>
<li>
<p>Configure the <code>maven-compiler-plugin</code>.</p>
</li>
<li>
<p>Configure the <code>maven-surefire-plugin</code>.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="testing-prepare-lib-versions-section"><a class="anchor" href="#testing-prepare-lib-versions-section"></a><a class="link" href="#testing-prepare-lib-versions-section">14.1.1. Definition the Versions of the Used Libraries:</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;properties&gt;
    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
    &lt;rxmicro.version&gt;0.11&lt;/rxmicro.version&gt; <i class="conum" data-value="1"></i><b>(1)</b>

    &lt;maven-compiler-plugin.version&gt;3.10.1&lt;/maven-compiler-plugin.version&gt; <i class="conum" data-value="2"></i><b>(2)</b>
    &lt;maven-surefire-plugin.version&gt;3.0.0-M7&lt;/maven-surefire-plugin.version&gt;<i class="conum" data-value="3"></i><b>(3)</b>
&lt;/properties&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><a href="https://mvnrepository.com/artifact/io.rxmicro" target="_blank" rel="noopener">The latest stable version of the RxMicro framework</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><a href="https://mvnrepository.com/artifact/org.apache.maven.plugins/maven-compiler-plugin" target="_blank" rel="noopener">The latest stable version of the <code>maven-compiler-plugin</code></a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><a href="https://mvnrepository.com/artifact/org.apache.maven.plugins/maven-surefire-plugin" target="_blank" rel="noopener">The latest stable version of the <code>maven-surefire-plugin</code></a>.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="testing-prepare-add-required-dependencies-section"><a class="anchor" href="#testing-prepare-add-required-dependencies-section"></a><a class="link" href="#testing-prepare-add-required-dependencies-section">14.1.2. Adding the Required Dependencies:</a></h4>
<div class="paragraph">
<p>Before using the RxMicro modules for testing, You need to add the following dependencies to the project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
        &lt;artifactId&gt;rxmicro-test-junit&lt;/artifactId&gt; <i class="conum" data-value="1"></i><b>(1)</b>
        &lt;version&gt;${rxmicro.version}&lt;/version&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
        &lt;artifactId&gt;rxmicro-test-mockito-junit&lt;/artifactId&gt; <i class="conum" data-value="2"></i><b>(2)</b>
        &lt;version&gt;${rxmicro.version}&lt;/version&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
        &lt;artifactId&gt;rxmicro-rest-client-exchange-json&lt;/artifactId&gt; <i class="conum" data-value="3"></i><b>(3)</b>
        &lt;version&gt;${rxmicro.version}&lt;/version&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>rxmicro-test-junit</code> - a unit testing library based on the <a href="https://junit.org/junit5/" target="_blank" rel="noopener">JUnit 5</a> framework.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>rxmicro-test-mockito-junit</code> - a unit testing library based on the <a href="https://junit.org/junit5/" target="_blank" rel="noopener">JUnit 5</a> framework with integration of the <a href="https://site.mockito.org/" target="_blank" rel="noopener">Mockito</a> framework.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>rxmicro-rest-client-exchange-json</code> - a library for converting Java models to <a href="https://www.json.org/" target="_blank" rel="noopener">JSON</a> format and vice versa on the HTTP client side.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>rxmicro-rest-client-exchange-json</code> libraries are required only during writing the
<a href="testing.html#testing-rest-based-microservice-tests-section">REST-based microservice tests</a> and <a href="testing.html#testing-integration-tests-section">integration tests</a>.
These dependencies can be omitted during writing the <a href="testing.html#testing-component-tests-section">component unit tests</a>.</p>
</div>
<div class="paragraph">
<p>The <code>rxmicro-test-mockito-junit</code> library depends on the <code>rxmicro-test-junit</code>, so only one of them needs to be added:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If only the <a href="https://junit.org/junit5/" target="_blank" rel="noopener">JUnit 5</a> framework is required, use the <code>rxmicro-test-junit</code> library.</p>
</li>
<li>
<p>If You still need to create mocks, then use the <code>rxmicro-test-mockito-junit</code> library.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="testing-prepare-maven-compiler-plugin-settings-section"><a class="anchor" href="#testing-prepare-maven-compiler-plugin-settings-section"></a><a class="link" href="#testing-prepare-maven-compiler-plugin-settings-section">14.1.3. Configuring the <code>maven-compiler-plugin</code>:</a></h4>
<div class="paragraph">
<p>To solve <a href="#testing-how-it-works-section">problems with the Java module system</a> when writing the tests, it is necessary to add the additional execution to the <code>maven-compiler-plugin</code> configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
    &lt;version&gt;${maven-compiler-plugin.version}&lt;/version&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;configuration&gt;
        &lt;release&gt;11&lt;/release&gt;
        &lt;annotationProcessorPaths&gt;
            &lt;annotationProcessorPath&gt;
                &lt;groupId&gt;io.rxmicro&lt;/groupId&gt;
                &lt;artifactId&gt;rxmicro-annotation-processor&lt;/artifactId&gt;
                &lt;version&gt;${rxmicro.version}&lt;/version&gt;
            &lt;/annotationProcessorPath&gt;
        &lt;/annotationProcessorPaths&gt;
    &lt;/configuration&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;id&gt;source-compile&lt;/id&gt;
            &lt;goals&gt;
                &lt;goal&gt;compile&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
                &lt;annotationProcessors&gt;
                    &lt;annotationProcessor&gt;
                        io.rxmicro.annotation.processor.RxMicroAnnotationProcessor
                    &lt;/annotationProcessor&gt;
                &lt;/annotationProcessors&gt;
                &lt;generatedSourcesDirectory&gt;
                    ${project.build.directory}/generated-sources/
                &lt;/generatedSourcesDirectory&gt;
            &lt;/configuration&gt;
        &lt;/execution&gt;
        &lt;execution&gt;
            &lt;id&gt;test-compile&lt;/id&gt; <i class="conum" data-value="2"></i><b>(2)</b>
            &lt;goals&gt;
                &lt;goal&gt;testCompile&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
                &lt;annotationProcessors&gt;
                    &lt;annotationProcessor&gt;
                        io.rxmicro.annotation.processor.RxMicroTestsAnnotationProcessor <i class="conum" data-value="3"></i><b>(3)</b>
                    &lt;/annotationProcessor&gt;
                &lt;/annotationProcessors&gt;
                &lt;generatedTestSourcesDirectory&gt;
                    ${project.build.directory}/generated-test-sources/ <i class="conum" data-value="4"></i><b>(4)</b>
                &lt;/generatedTestSourcesDirectory&gt;
            &lt;/configuration&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The plugin version defined in the <a href="#testing-prepare-lib-versions-section"><code>properties</code></a> section.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The separate configuration is required for the tests, so a new <code>execution</code> must be added.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The annotation processor class that handles the test configuration.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Location of Java classes generated by the <code>RxMicro Test Annotation Processor</code>.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>io.rxmicro.annotation.processor.RxMicroTestsAnnotationProcessor</code> generates additional classes required <strong>only during testing</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Therefore, You must always specify a separate folder for the generated classes!</strong></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="testing-prepare-maven-surefire-plugin-settings-section"><a class="anchor" href="#testing-prepare-maven-surefire-plugin-settings-section"></a><a class="link" href="#testing-prepare-maven-surefire-plugin-settings-section">14.1.4. Configuring the  <code>maven-surefire-plugin</code>:</a></h4>
<div class="paragraph">
<p>For a successful tests launch while building a project with <code>maven</code> it is necessary to update <code>maven-surefire-plugin</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
    &lt;version&gt;${maven-surefire-plugin.version}&lt;/version&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;configuration&gt;
        &lt;properties&gt;
            &lt;!-- https://junit.org/junit5/docs/5.5.1/api/org/junit/jupiter/api/Timeout.html --&gt;
            &lt;configurationParameters&gt;
                junit.jupiter.execution.timeout.default = 60                <i class="conum" data-value="2"></i><b>(2)</b>
                junit.jupiter.execution.timeout.mode = disabled_on_debug    <i class="conum" data-value="3"></i><b>(3)</b>
                junit.jupiter.execution.parallel.enabled = false            <i class="conum" data-value="4"></i><b>(4)</b>
            &lt;/configurationParameters&gt;
        &lt;/properties&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><a href="https://mvnrepository.com/artifact/org.apache.maven.plugins/maven-surefire-plugin" target="_blank" rel="noopener">Last stable version of <code>maven-surefire-plugin</code></a>.<br>
<em>(The plugin version must be <code>2.22.1</code> or higher, otherwise <code>maven</code> will ignore the tests!.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>In case of an error in the code which uses reactive programming, an infinite function execution may occur.
In order to detect such cases, it is necessary to set a global timeout for all methods in the tests.
<em>(By default, timeout is set in seconds.
More detailed information on timeouts configuration is available <a href="https://junit.org/junit5/docs/current/user-guide/user-guide/#writing-tests-declarative-timeouts" target="_blank" rel="noopener">in official JUnit5 documentation</a>.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>While debugging, timeouts can be turned off.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>This property is useful for the tests debugging from IDE or <code>maven</code>.<br>
<em>(By setting this property the speed of test performance will decrease, so use this property for debugging only!)</em></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>At the end of each subsection describing any the RxMicro framework feature, there is a link to the project, the source codes of which were used in this subsection.</p>
</div>
<div class="paragraph">
<p>Use these links to access a working example demonstrating the RxMicro framework feature described above!</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="testing-annotations-section"><a class="anchor" href="#testing-annotations-section"></a><a class="link" href="#testing-annotations-section">14.2. <code>RxMicro Test Annotations</code></a></h3>
<div class="paragraph">
<p>The RxMicro framework supports additional <code>RxMicro Test annotations</code>, that extend the features of the <a href="https://junit.org/junit5/" target="_blank" rel="noopener">JUnit 5</a>, <a href="https://site.mockito.org/" target="_blank" rel="noopener">Mockito</a> and <a href="http://dbunit.sourceforge.net/" target="_blank" rel="noopener">DbUnit</a>
test frameworks and add additional features required for efficient writing of all supported test types.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The RxMicro framework supports two types of annotations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>RxMicro Annotations</code> used by the <code>RxMicro Annotation Processor</code> during the compiling and therefore available <strong>only during the compilation process</strong>.</p>
</li>
<li>
<p>The <code>RxMicro Test Annotations</code> used by the test framework during the test run and therefore available using the <code>reflection</code> mechanism.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These types of annotations do not complement each other!
Each of these types is designed to perform its tasks.</p>
</div>
<div class="paragraph">
<p><strong>So when writing tests, be careful not to use the <code>RxMicro Annotations</code> as they are not available for the test framework!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 20. Supported <code>RxMicro Test Annotations</code></caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Annotation</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/Alternative.java" target="_blank" rel="noopener"><code>@Alternative</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the test class field as an <a href="#testing-alternatives-section">alternative</a>.</p>
<p class="tableblock"><em>The RxMicro framework supports alternatives only for <a href="#testing-rest-based-microservice-tests-section">REST-based microservice tests</a> and <a href="#testing-component-tests-section">component unit tests</a>.</em></p>
<p class="tableblock"><a id="testing-annotations-WithConfig-inline"></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/WithConfig.java" target="_blank" rel="noopener"><code>@WithConfig</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the <strong>static</strong> field of the test class as a configuration which must be registered in the configuration manager before starting the test.</p>
<p class="tableblock"><em>This annotation allows declaring a configuration using <a href="#core-config-java-classes-section">Java classes</a>.</em>
<em>(The configuration defined in this way is only available while the test is running.)</em></p>
<p class="tableblock">The source code of the project that uses the <code>@WithConfig</code> annotation, is available at the following link:</p>
<p class="tableblock"><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-microservice-with-config" target="_blank" rel="noopener"><code>testing-microservice-with-config</code></a></p>
<p class="tableblock"><em>The RxMicro framework supports test configuration only for <a href="#testing-rest-based-microservice-tests-section">REST-based microservice tests</a> and <a href="#testing-component-tests-section">component unit tests</a>.</em></p>
<p class="tableblock"><a id="testing-annotations-SetConfigValue-inline"></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/SetConfigValue.java" target="_blank" rel="noopener"><code>@SetConfigValue</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows overriding the default value for any configuration available only for the test environment.</p>
<p class="tableblock"><em>This annotation allows declaring a configuration using <a href="#core-config-annotations-section">annotations</a>.</em>
<em>(The configuration defined in this way is only available while the test is running.
It means that this annotation is analogous to the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-config/src/main/java/io/rxmicro/config/DefaultConfigValue.java" target="_blank" rel="noopener"><code>DefaultConfigValue</code></a> annotation!)</em></p>
<p class="tableblock"><em>The RxMicro framework supports test configuration only for <a href="#testing-rest-based-microservice-tests-section">REST-based microservice tests</a> and <a href="#testing-component-tests-section">component unit tests</a>.</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClientSettings.java" target="_blank" rel="noopener"><code>@BlockingHttpClientSettings</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows to <a href="#testing-BlockingHttpClient-settings-section">configure the following component:</a>
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a>, in order to execute HTTP requests in tests.</p>
<p class="tableblock"><em>(This annotation applies only to the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a> type fields.)</em></p>
<p class="tableblock"><em>The RxMicro framework supports the <code>BlockingHttpClient</code> component only for <a href="#testing-rest-based-microservice-tests-section">REST-based microservice tests</a> and <a href="#testing-integration-tests-section">REST-based microservice integration tests</a>.</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/RxMicroRestBasedMicroServiceTest.java" target="_blank" rel="noopener"><code>@RxMicroRestBasedMicroServiceTest</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the test class as a <a href="#testing-rest-based-microservice-tests-section">REST-based microservice test</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/RxMicroComponentTest.java" target="_blank" rel="noopener"><code>@RxMicroComponentTest</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the test class as a <a href="#testing-component-tests-section">component unit test</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/RxMicroIntegrationTest.java" target="_blank" rel="noopener"><code>@RxMicroIntegrationTest</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the test class as a <a href="#testing-integration-tests-section">REST-based microservice integration test</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-dbunit-junit/src/main/java/io/rxmicro/test/dbunit/junit/DbUnitTest.java" target="_blank" rel="noopener"><code>@DbUnitTest</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the test class as a <a href="#testing-integration-tests-section">DBUnit integration test</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/BeforeThisTest.java" target="_blank" rel="noopener"><code>@BeforeThisTest</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">It is used to specify the method to be invoked by the RxMicro framework <a href="#testing-before-test-section">before running the test method</a>.</p>
<p class="tableblock"><em>The RxMicro framework supports the <code>@BeforeThisTest</code> annotation only for <a href="#testing-rest-based-microservice-tests-section">REST-based microservice tests</a> and <a href="#testing-component-tests-section">component unit tests</a>.</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/BeforeIterationMethodSource.java" target="_blank" rel="noopener"><code>@BeforeIterationMethodSource</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">It is used to specify the methods to be invoked by the RxMicro framework before <a href="#testing-before-test-section">performing each iteration of the parameterized test</a>.</p>
<p class="tableblock"><em>The RxMicro framework supports the <code>@BeforeIterationMethodSource</code> annotation only for <a href="#testing-rest-based-microservice-tests-section">REST-based microservice tests</a> and <a href="#testing-component-tests-section">component unit tests</a>.</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-mockito-junit/src/main/java/io/rxmicro/test/mockito/junit/InitMocks.java" target="_blank" rel="noopener"><code>@InitMocks</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informs the test framework about the need to <a href="#InitMocks-inline">create mocks and inject them into the test class fields</a>, annotated by the
<a href="https://javadoc.io/doc/org.mockito/mockito-core/latest/org/mockito/Mock.html" target="_blank" rel="noopener"><code>@Mock</code></a> annotation.</p>
<p class="tableblock"><em>(Using the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-mockito-junit/src/main/java/io/rxmicro/test/mockito/junit/InitMocks.java" target="_blank" rel="noopener"><code>@InitMocks</code></a>
annotation is preferable to the analogous
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-mockito-junit/src/main/java/io/rxmicro/test/mockito/junit/InitMocks.java#L60" target="_blank" rel="noopener"><code>@ExtendWith(MockitoExtension.class)</code></a> construction.)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-dbunit/src/main/java/io/rxmicro/test/dbunit/InitialDataSet.java" target="_blank" rel="noopener"><code>@InitialDataSet</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides <a href="#testing-dbunit-initial-data-set">the init state of tested database before execution of the test method</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-dbunit/src/main/java/io/rxmicro/test/dbunit/ExpectedDataSet.java" target="_blank" rel="noopener"><code>@ExpectedDataSet</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides <a href="#testing-dbunit-expected-data-set">the expected state of tested database after execution of the test method</a>.</p>
<p class="tableblock">If expected state does not match to the actual database state the <code>java.lang.AssertionError</code> will be thrown.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-dbunit/src/main/java/io/rxmicro/test/dbunit/RollbackChanges.java" target="_blank" rel="noopener"><code>@RollbackChanges</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the <a href="#testing-dbunit-rollback-changes">transactional test</a>.</p>
<p class="tableblock">The transaction test means that all changes made by test will rolled back after the test execution.</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="testing-alternatives-section"><a class="anchor" href="#testing-alternatives-section"></a><a class="link" href="#testing-alternatives-section">14.3. Alternatives</a></h3>
<div class="paragraph">
<p>For efficient unit testing, the RxMicro framework supports the mechanism of alternatives.</p>
</div>
<div class="paragraph">
<p><strong>Alternatives</strong> are test components, usually being mocks with predefined behaviors, that are injected by the RxMicro framework into the tested classes.
Alternatives are a powerful mechanism for writing unit tests.</p>
</div>
<div class="paragraph">
<p>The RxMicro framework supports alternatives only for <a href="#testing-rest-based-microservice-tests-section">REST-based microservice tests</a> and <a href="#testing-component-tests-section">component unit tests</a>.</p>
</div>
<div class="paragraph">
<p>When developing a microservice project, two types of components are distinguished:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>RxMicro component</em> - a class that is part of the RxMicro framework (for example, <code>HttpClientFactory</code>) or a class generated by the <code>RxMicro Annotation Processor</code> (Data Repository, Rest client, etc).</p>
</li>
<li>
<p><em>Custom component</em> - a developer-written class that is part of a microservice project.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These two types of components have different life cycles:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The instances of the RxMicro components are created in the classes generated by the <code>RxMicro Annotation Processor</code>, and are registered in the runtime container.
When a reference to the RxMicro component is required, the custom class requests it in the runtime container.</p>
</li>
<li>
<p>The instances of custom components are created independently by the developer in the code.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Due to the difference in life cycles between the two types of the RxMicro components, the RxMicro framework also supports two types of alternatives:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>alternatives of the RxMicro components</strong>;</p>
</li>
<li>
<p><strong>alternatives of custom components</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These types of alternatives differ in the algorithms of injection into the tested class.</p>
</div>
<div style="page-break-after: always;"></div>
<div class="sect3">
<h4 id="injection_algorithm_for_the_alternative_of_the_rxmicro_component"><a class="anchor" href="#injection_algorithm_for_the_alternative_of_the_rxmicro_component"></a><a class="link" href="#injection_algorithm_for_the_alternative_of_the_rxmicro_component">14.3.1. Injection Algorithm for the Alternative of the RxMicro Component</a></h4>
<div class="paragraph">
<p>To inject the alternative of the RxMicro component, the RxMicro framework uses the following algorithm:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The alternative instance is created by the developer in the test code or by the testing framework automatically.</p>
</li>
<li>
<p>Once all alternatives have been created, they are registered in the runtime container.</p>
</li>
<li>
<p>Once all alternatives have been registered, the RxMicro framework creates an instance of the tested class.</p>
</li>
<li>
<p>In the constructor or static section of the tested class, a request to the runtime container to get a reference to the RxMicro component is executed.</p>
</li>
<li>
<p>Since the runtime container already contains an alternative instead of the real component, the alternative is injected into the instance of the tested class.</p>
</li>
<li>
<p>After initialization, the instance of the tested class contains references to alternatives instead of the real RxMicro components.</p>
</li>
</ol>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="injection_algorithm_for_the_alternative_of_the_custom_component"><a class="anchor" href="#injection_algorithm_for_the_alternative_of_the_custom_component"></a><a class="link" href="#injection_algorithm_for_the_alternative_of_the_custom_component">14.3.2. Injection Algorithm for the Alternative of the Custom Component</a></h4>
<div class="paragraph">
<p>To inject the alternative of the custom component, the RxMicro framework uses the following algorithm:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The alternative instance is created by the developer in the test code or by the testing framework automatically.</p>
</li>
<li>
<p>The RxMicro framework creates an instance of the tested class.</p>
</li>
<li>
<p>In the constructor or static section of the tested class, instances of the real custom components are created.</p>
</li>
<li>
<p>After initialization, the instance of the tested class contains references to the real custom components.</p>
</li>
<li>
<p>After creating an instance of the tested class, the RxMicro framework injects the custom component alternatives using the  <code>reflection</code> mechanism.<br>
<em>(I.e. the alternatives replace the real instances already after creating an instance of the tested class.)</em>;</p>
</li>
<li>
<p>After alternative injection, the instance of the tested class contains references to the alternatives of the RxMicro components instead of the real RxMicro components.<br>
<em>(The real component instances will be removed by the garbage collector later.)</em>;</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Thus, the main difference of the injection algorithm for the custom component alternatives is that during the injection process, the real component instances are always created.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the real component creates a reference to an external resource, then this resource <strong>will not be</strong> released automatically when injecting the alternative!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is recommended to use the <a href="#cdi-section"><code>rxmicro.cdi</code></a> module to create the custom component alternatives that work with external resources.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the <a href="#cdi-section"><code>rxmicro.cdi</code></a> module is used by the developer to create the custom component instances, then <strong>all</strong> custom components are injected using the algorithm of the RxMicro component alternative injection.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="testing-alternatives-usage-section"><a class="anchor" href="#testing-alternatives-usage-section"></a><a class="link" href="#testing-alternatives-usage-section">14.3.3. Alternative Usage</a></h4>
<div class="paragraph">
<p>The alternative mechanism is a universal tool that can be applied to the simplest project, which doesn&#8217;t use the <code>RxMicro Annotations</code>.<br>
Let&#8217;s look at the project consisting of two components: the <code>ChildComponent</code> interface and the <code>ParentComponent</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface ChildComponent {

    String getValue();
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class ParentComponent {

    private final ChildComponent childComponent = () -&gt; "production"; <i class="conum" data-value="1"></i><b>(1)</b>

    public String getEnvironment() {
        return childComponent.getValue();
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>ParentComponent</code> class depends on the <code>ChildComponent</code>.<br>
<em>(This dependency specified explicitly in the source code.)</em></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When writing a unit test for the <code>ParentComponent</code>, it is necessary to replace the real <code>ChildComponent</code> with a mock.
Otherwise, it wouldn&#8217;t be a unit test, but an integration one.</p>
</div>
<div class="paragraph">
<p>For this replacement, it is most convenient to use the alternative:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@RxMicroComponentTest(ParentComponent.class)
final class ParentComponent1Test {

    <i class="conum" data-value="3"></i><b>(3)</b>
    @Alternative
    private final ChildComponent childComponent = () -&gt; "test"; <i class="conum" data-value="4"></i><b>(4)</b>

    private ParentComponent parentComponent; <i class="conum" data-value="2"></i><b>(2)</b>

    @Test
    void Should_use_alternative() {
        assertEquals("test", parentComponent.getEnvironment()); <i class="conum" data-value="5"></i><b>(5)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The alternatives are supported by the RxMicro framework only during component unit tests or REST-based microservice tests.
Therefore, it must be declared that this test is a test of the <code>ParentComponent</code> component.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The instance of the tested component will be created by the RxMicro framework automatically.<br>
<em>(The instance is created using the <code>reflection</code> mechanism, so the tested class must contain an available constructor without parameters.)</em><br>
In order to invoke any method of the tested component, a reference to that component is required.
Therefore, the RxMicro framework requires that the developer declares an uninitialized field of the tested component.
After starting the test, a reference to the instance of the tested component will be injected into this field using the <code>reflection</code> mechanism.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>In order to use the alternative mechanism, it is necessary to declare test field as alternative by using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/Alternative.java" target="_blank" rel="noopener"><code>@Alternative</code></a> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Alternative is a test component with predefined behavior.
Therefore, it is necessary to define what value should be returned when invoking the <code>getValue</code> method.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>When testing the <code>getEnvironment</code> method, the alternative method is invoked instead of the real component one.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If You would like to inject the alternative to the <strong>final</strong> field, don&#8217;t forget to configure <code>maven-surefire-plugin</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
    &lt;configuration&gt;
        &lt;argLine&gt;
            --add-opens java.base/java.lang.reflect=rxmicro.reflection <i class="conum" data-value="1"></i><b>(1)</b>
        &lt;/argLine&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>- It is necessary to add this <code>opens</code> instruction.</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When using alternatives it is very convenient to use a dynamic class with programmable behavior.
For this purpose, it is very convenient to use the <a href="https://site.mockito.org/" target="_blank" rel="noopener">Mockito</a> framework:</p>
</div>
<div id="InitMocks-inline" class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="2"></i><b>(2)</b>
@InitMocks
@RxMicroComponentTest(ParentComponent.class)
final class ParentComponent2Test {

    private ParentComponent parentComponent;

    <i class="conum" data-value="1"></i><b>(1)</b>
    @Mock
    @Alternative
    private ChildComponent childComponent;

    @Test
    void Should_use_alternative() {
        when(childComponent.getValue()).thenReturn("test"); <i class="conum" data-value="3"></i><b>(3)</b>
        assertEquals("test", parentComponent.getEnvironment()); <i class="conum" data-value="4"></i><b>(4)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To create a mock instance, it is necessary to use the <a href="https://javadoc.io/doc/org.mockito/mockito-core/latest/org/mockito/Mock.html" target="_blank" rel="noopener"><code>@Mock</code></a> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>In order for JUnit to handle all fields annotated by the <a href="https://javadoc.io/doc/org.mockito/mockito-core/latest/org/mockito/Mock.html" target="_blank" rel="noopener"><code>@Mock</code></a> annotation before invoking test methods, it is necessary to annotate the test class by the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-mockito-junit/src/main/java/io/rxmicro/test/mockito/junit/InitMocks.java" target="_blank" rel="noopener"><code>@InitMocks</code></a> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Before testing, it is necessary to program the behavior of the <code>getValue</code> method of the declared mock.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>When testing the <code>getEnvironment</code> method, the method from the alternative is invoked instead of the real component one.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If You would like to inject the alternative to the <strong>final</strong> field, don&#8217;t forget to configure <code>maven-surefire-plugin</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
    &lt;configuration&gt;
        &lt;argLine&gt;
            --add-opens java.base/java.lang.reflect=rxmicro.reflection <i class="conum" data-value="1"></i><b>(1)</b>
        &lt;/argLine&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>- It is necessary to add this <code>opens</code> instruction.</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When creating mock alternatives, the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-mockito-junit/src/main/java/io/rxmicro/test/mockito/junit/InitMocks.java" target="_blank" rel="noopener"><code>@InitMocks</code></a>
annotation should be over the <code>@RxMicroComponentTest</code> annotation (or <code>@RxMicroRestBasedMicroServiceTest</code> when writing REST-based microservice tests), otherwise, <strong>the alternative will be injected before creating a mock instance, (i.e. injection of the <code>null</code> instance), which will cause an error!</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-component-alternatives-simplest" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-component-alternatives-simplest</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="components_with_custom_constructors"><a class="anchor" href="#components_with_custom_constructors"></a><a class="link" href="#components_with_custom_constructors">14.3.4. Components with Custom Constructors</a></h4>
<div class="paragraph">
<p>In case the custom component does not contain an available constructor without parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class ParentComponent {

    private final String prefix;

    private final ChildComponent childComponent = () -&gt; "production"; <i class="conum" data-value="1"></i><b>(1)</b>

    public ParentComponent(final String prefix) { <i class="conum" data-value="2"></i><b>(2)</b>
        this.prefix = requireNonNull(prefix);
    }

    public String getEnvironment() {
        return prefix + " " + childComponent.getValue();
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>ParentComponent</code> depends on the <code>ChildComponent</code>.<br>
<em>(This dependency is specified explicitly in the source code.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>When creating the <code>ParentComponent</code> class instance in the constructor, the value of the <code>prefix</code> parameter must be passed.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>then the RxMicro framework won&#8217;t be able to create an instance of this class.</p>
</div>
<div class="paragraph">
<p><strong>Therefore, the developer should create an instance of this class in one of the following methods: <a href="https://junit.org/junit5/docs/current/user-guide/api/org.junit.jupiter.api/org/junit/jupiter/api/BeforeEach.html" target="_blank" rel="noopener"><code>@BeforeEach</code></a>,
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/BeforeThisTest.java" target="_blank" rel="noopener"><code>@BeforeThisTest</code></a> or
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/BeforeIterationMethodSource.java" target="_blank" rel="noopener"><code>@BeforeIterationMethodSource</code></a></strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(ParentComponent.class)
final class ParentComponentTest {

    private ParentComponent parentComponent;

    <i class="conum" data-value="2"></i><b>(2)</b>
    @Mock
    @Alternative
    private ChildComponent childComponent;

    @BeforeEach
    void beforeEach() {
        parentComponent = new ParentComponent("prefix"); <i class="conum" data-value="1"></i><b>(1)</b>
    }

    @Test
    void Should_use_alternative() {
        when(childComponent.getValue()).thenReturn("test");
        assertEquals("prefix test", parentComponent.getEnvironment()); <i class="conum" data-value="3"></i><b>(3)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>ParentComponent</code> class instance is created inside the method annotated by the <a href="https://junit.org/junit5/docs/current/user-guide/api/org.junit.jupiter.api/org/junit/jupiter/api/BeforeEach.html" target="_blank" rel="noopener"><code>@BeforeEach</code></a> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>childComponent</code> alternative will be injected into the <code>ParentComponent</code> class instance after invoking the <code>beforeEach()</code> method and before the <code>Should_use_alternative()</code> test method.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>When testing the <code>getEnvironment</code> method, the alternative method is invoked instead of the real component one.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If You would like to inject the alternative to the <strong>final</strong> field, don&#8217;t forget to configure <code>maven-surefire-plugin</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
    &lt;configuration&gt;
        &lt;argLine&gt;
            --add-opens java.base/java.lang.reflect=rxmicro.reflection <i class="conum" data-value="1"></i><b>(1)</b>
        &lt;/argLine&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>- It is necessary to add this <code>opens</code> instruction.</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-component-alternatives-simplest" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-component-alternatives-simplest</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="ambiguity_resolving_2"><a class="anchor" href="#ambiguity_resolving_2"></a><a class="link" href="#ambiguity_resolving_2">14.3.5. Ambiguity Resolving</a></h4>
<div class="paragraph">
<p>The alternative created by the developer can be injected by the RxMicro framework not only in the tested component, but also in any of its child components.</p>
</div>
<div class="paragraph">
<p>During such injection, the ambiguity problem may occur.</p>
</div>
<div class="sect4">
<h5 id="ambiguity_resolving_demonstration"><a class="anchor" href="#ambiguity_resolving_demonstration"></a><a class="link" href="#ambiguity_resolving_demonstration">14.3.5.1. Ambiguity Resolving Demonstration</a></h5>
<div class="paragraph">
<p>Let&#8217;s assume there is some business service in the project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface BusinessService {

    String getValue();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This business service is a dependency for three interdependent components: <code>Child</code>, <code>Parent</code>, <code>GrandParent</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Child {

    private final BusinessService childBusinessService = () -&gt; "Child";

    public String getValue() {
        return childBusinessService.getValue();
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Parent {

    private final Child child = new Child();

    private final BusinessService parentBusinessService = () -&gt; "Parent";

    public String getValue() {
        return parentBusinessService.getValue() + " : " + child.getValue();
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class GrandParent {

    private final Parent parent = new Parent();

    private final BusinessService grandParentBusinessService = () -&gt; "GrandParent";

    public String getValue() {
        return grandParentBusinessService.getValue() + " : " + parent.getValue();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When invoking the <code>GrandParent.getValue</code> method, this method is invoked on the business services of all <code>Child</code>, <code>Parent</code> and <code>GrandParent</code> dependent components according to the dependency hierarchy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class GrandParent1Test {

    private final GrandParent grandParent = new GrandParent();

    @Test
    void Should_return_default_values() {
        assertEquals("GrandParent : Parent : Child", grandParent.getValue());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using an alternative, the behavior of the <code>GrandParent.getValue</code> method is changed:</p>
</div>
<div id="GrandParent2Test-inline" class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(GrandParent.class)
final class GrandParent2Test {

    private GrandParent grandParent;

    @Mock
    <i class="conum" data-value="1"></i><b>(1)</b>
    @Alternative
    private BusinessService businessService;

    @Test
    void Should_inject_alternatives_correctly() {
        when(businessService.getValue()).thenReturn("Mock"); <i class="conum" data-value="2"></i><b>(2)</b>

        assertEquals("Mock : Mock : Mock", grandParent.getValue()); <i class="conum" data-value="3"></i><b>(3)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>An alternative to the business service is created.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Before testing, the behavior of the <code>getValue</code> method of created mock is programmed.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>As a result of the test, You can see that this alternative is injected into <strong>all</strong> <code>Child</code>, <code>Parent</code> and <code>GrandParent</code> dependent components.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If You would like to inject the alternative to the <strong>final</strong> field, don&#8217;t forget to configure <code>maven-surefire-plugin</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
    &lt;configuration&gt;
        &lt;argLine&gt;
            --add-opens java.base/java.lang.reflect=rxmicro.reflection <i class="conum" data-value="1"></i><b>(1)</b>
        &lt;/argLine&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>- It is necessary to add this <code>opens</code> instruction.</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If You create 2 or more (no more than 3 in this test example) alternatives, then each alternative can be injected in a separate business component:</p>
</div>
<div id="GrandParent3Test-inline" class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(GrandParent.class)
final class GrandParent3Test {

    private GrandParent grandParent;

    @Mock
    @Alternative
    private BusinessService grandParentBusinessService;

    @Mock
    @Alternative(name = "childBusinessService")
    private BusinessService businessService;

    @Test
    void Should_inject_alternatives_correctly() {
        when(grandParentBusinessService.getValue()).thenReturn("GrandParentMock");
        when(businessService.getValue()).thenReturn("ChildMock");

        assertEquals("GrandParentMock : Parent : ChildMock", grandParent.getValue()); <i class="conum" data-value="1"></i><b>(1)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>grandParentBusinessService</code> alternative is injected into the <code>GrandParent</code> component, and the <code>businessService</code> alternative is injected into the <code>Child</code> component;</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If You would like to inject the alternative to the <strong>final</strong> field, don&#8217;t forget to configure <code>maven-surefire-plugin</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
    &lt;configuration&gt;
        &lt;argLine&gt;
            --add-opens java.base/java.lang.reflect=rxmicro.reflection <i class="conum" data-value="1"></i><b>(1)</b>
        &lt;/argLine&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>- It is necessary to add this <code>opens</code> instruction.</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-component-alternatives-ambiguty-resolving" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-component-alternatives-ambiguty-resolving</code></a></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="ambiguity_resolving_algorithm"><a class="anchor" href="#ambiguity_resolving_algorithm"></a><a class="link" href="#ambiguity_resolving_algorithm">14.3.5.2. Ambiguity Resolving Algorithm</a></h5>
<div class="paragraph">
<p>To resolve ambiguities, the RxMicro framework uses the following algorithm:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>For each tested component, a search for injection candidates is performed.</p>
</li>
<li>
<p>As a result, a map is formed with a user type as its key and a list of candidates for injection as its value.
<strong>(The RxMicro framework does not support polymorphism rules when injecting alternatives.
Thus, the alternative of the <code>A</code> type can only be injected in the field with the <code>A</code> type)</strong>.</p>
</li>
<li>
<p>After receiving a map with candidates for injection, the RxMicro framework passes through this map.</p>
</li>
<li>
<p>For each user type, a list of candidates and a list of alternatives is requested.</p>
</li>
<li>
<p>If there is only one alternative and only one candidate for the user type, the RxMicro framework injects this alternative into the candidate field;</p>
</li>
<li>
<p>If more than one alternative and only one candidate is found, the RxMicro framework will throw out an error;</p>
</li>
<li>
<p>If there is more than one candidate and only one alternative, then:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The RxMicro framework analyzes the injection candidate field name:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>if the candidate field name matches the alternative field name, the RxMicro framework injects this alternative;</p>
</li>
<li>
<p>if the candidate field name matches the value of the <code>name</code> parameter of the <code>@Alternative</code> annotation, the RxMicro framework injects this alternative;</p>
</li>
<li>
<p>otherwise this candidate will be skipped;</p>
</li>
</ol>
</div>
</li>
<li>
<p>if no alternative has been injected, the RxMicro framework injects this alternative in <strong>all</strong> candidate fields.<br>
<em>(This is the behavior that occurs in the <a href="#GrandParent2Test-inline"><code>GrandParent2Test</code></a> test.)</em></p>
</li>
</ol>
</div>
</li>
<li>
<p>If there is more than one candidate and more than one alternative, then:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The RxMicro framework analyzes the injection candidate field name:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>if the candidate field name matches the alternative field name, the RxMicro framework injects this alternative;<br>
<em>(In the <a href="#GrandParent3Test-inline"><code>GrandParent3Test</code></a> test, the <code>grandParentBusinessService</code> alternative is injected in the <code>GrandParent</code> component field, because the names of the alternative and component fields are equal.)</em>;</p>
</li>
<li>
<p>if the candidate field name matches the value of the <code>name</code> parameter of the <code>@Alternative</code> annotation, the RxMicro framework injects this alternative;<br>
<em>(In the <a href="#GrandParent3Test-inline"><code>GrandParent3Test</code></a> test, the <code>businessService</code> alternative is injected in the <code>Child</code> component field, because the <code>name</code> parameter of the <code>@Alternative</code> annotation is equal to the <code>childBusinessService</code>.</em> <em>And in the <code>Child</code> class, the field name with the <code>BusinessService</code> type is also equal to the <code>childBusinessService</code>.)</em></p>
</li>
<li>
<p>otherwise this candidate will be skipped;</p>
</li>
</ol>
</div>
</li>
<li>
<p><em>(When more than one candidate and more than one alternative is found, it is possible that none of the alternatives will be injected.)</em></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect3">
<h4 id="cdi_beans_alternatives"><a class="anchor" href="#cdi_beans_alternatives"></a><a class="link" href="#cdi_beans_alternatives">14.3.6. CDI Beans Alternatives</a></h4>
<div class="paragraph">
<p>If the developer uses the <a href="#cdi-section"><code>rxmicro.cdi</code></a> module in the project, then <strong>all</strong> custom components are considered as beans and follow the injection algorithm for the alternatives of the RxMicro components.</p>
</div>
<div class="paragraph">
<p><em>When using the <code>rxmicro.cdi</code> module, <strong>You must always inject dependencies using the CDI mechanism only</strong>:</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class ParentComponent {

    @Inject
    ChildComponent childComponent; <i class="conum" data-value="1"></i><b>(1)</b>

    @Inject
    ChildComponentImpl childComponentImpl; <i class="conum" data-value="1"></i><b>(1)</b>

    public String getEnvironment() {
        return childComponent.getValue() + " " + childComponentImpl.getValue();
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>ParentComponent</code> class depends on the <code>ChildComponent</code> and <code>ChildComponentImpl</code> components.<br>
<em>(These dependencies are injected using the CDI mechanisms.)</em></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The above example is a demonstration of the features of alternatives of custom components if <a href="#cdi-section"><code>rxmicro.cdi</code></a> module enabled.
That&#8217;s why the <code>ChildComponentImpl</code> implementation is injected in the <code>ParentComponent</code> component.
In real projects, it&#8217;s recommended to inject only interfaces to ensure greater flexibility.</p>
</div>
<div class="paragraph">
<p><em>Please note that since the <code>ChildComponentImpl</code> class implements the <code>ChildComponent</code>  interface, and <a href="#cdi-singletons-section">all CDI beans are singletons</a>, the <code>childComponent</code> and <code>childComponentImpl</code> fields will contain references to the same <code>ChildComponentImpl</code> instance!</em></p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class ChildComponentImpl implements ChildComponent {

    public ChildComponentImpl() {
        System.out.println("ChildComponentImpl created"); <i class="conum" data-value="1"></i><b>(1)</b>
    }

    @Override
    public String getValue() {
        return "production";
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When creating the <code>ChildComponentImpl</code> instance, an information message is displayed in the console.<br>
<em>(This message is required to ensure that no real custom instance is created when CDI bean alternatives are used!)</em></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When testing, if no alternatives are created, the tested component uses the real custom component instances:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(ParentComponent.class)
final class ParentComponent1Test {

    private ParentComponent parentComponent;

    private SystemOut systemOut;

    @Test
    void Should_use_alternatives() {
        assertEquals("production production", parentComponent.getEnvironment());              <i class="conum" data-value="1"></i><b>(1)</b>
        assertEquals("ChildComponentImpl created", systemOut.asString()); <i class="conum" data-value="2"></i><b>(2)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When invoking the <code>getEnvironment</code> method, the real instances of custom components are used.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>When starting the test, only one <code>ChildComponentImpl</code> class instance is created.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When testing, if alternatives are created, the tested component uses them instead of the real custom component instances:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(ParentComponent.class)
final class ParentComponent2Test {

    private ParentComponent parentComponent;

    @Mock
    @Alternative
    private ChildComponent childComponent;

    @Mock
    @Alternative
    private ChildComponentImpl childComponentImpl;

    private SystemOut systemOut;

    @Test
    void Should_use_alternatives() {
        when(childComponent.getValue()).thenReturn("mock");
        when(childComponentImpl.getValue()).thenReturn("mock");

        assertEquals("mock mock", parentComponent.getEnvironment());   <i class="conum" data-value="1"></i><b>(1)</b>
        assertTrue(
                systemOut.isEmpty(),   <i class="conum" data-value="2"></i><b>(2)</b>
                format("Output not empty: '?'", systemOut.asString())
        );
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When invoking the <code>getEnvironment</code> method, the alternatives of the real custom component instances are used.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>When starting the test, the <code>ChildComponentImpl</code> class instance is not created.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When using alternatives for complex components, it is possible to use alternatives together with real components:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(ParentComponent.class)
final class ParentComponent3Test {

    private ParentComponent parentComponent;

    @Mock
    @Alternative
    private ChildComponent childComponent;

    private SystemOut systemOut;

    @Test
    void Should_use_alternatives() {
        when(childComponent.getValue()).thenReturn("mock");

        assertEquals("mock production", parentComponent.getEnvironment());                    <i class="conum" data-value="1"></i><b>(1)</b>
        assertEquals("ChildComponentImpl created", systemOut.asString()); <i class="conum" data-value="2"></i><b>(2)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When invoking the <code>getEnvironment</code> method, an alternative and a real instance are used.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>When starting the test, only one <code>ChildComponentImpl</code> class instance is created.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-component-alternatives-cdi" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-component-alternatives-cdi</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="testing-how-it-works-section"><a class="anchor" href="#testing-how-it-works-section"></a><a class="link" href="#testing-how-it-works-section">14.4. How It Works</a></h3>
<div class="paragraph">
<p>Java 9 has introduced the <a href="https://www.oracle.com/corporate/features/understanding-java-9-modules.html" target="_blank" rel="noopener"><code>JPMS</code></a>.</p>
</div>
<div class="paragraph">
<p>This system requires that a developer defines the <code>module-info.java</code> descriptor for each project.
In this descriptor, the developer must describe all the dependencies of the current project.
In the context of the unit module system, the tests required for each project should be configured as a separate module, since they depend on libraries that should not be available in the <code>runtime</code>.
Usually such libraries are unit testing libraries (e.g. <a href="https://junit.org/junit5/" target="_blank" rel="noopener">JUnit 5</a>), mock creation libraries (e.g. <a href="https://site.mockito.org/" target="_blank" rel="noopener">Mockito</a>), etc.</p>
</div>
<div class="paragraph">
<p>When trying to create a separate <code>module-info.java</code> descriptor available only for unit tests, many modern IDEs report an error.</p>
</div>
<div class="paragraph">
<p><strong>Therefore, the simplest and most common solution to this problem is to organize unit tests in the form of
<a href="https://www.logicbig.com/tutorials/core-java-tutorial/modules/automatic-modules.html" target="_blank" rel="noopener">automatic module</a>.<br>
This solution allows You to correct compilation errors, but when starting tests, there will be runtime errors.<br>
To fix runtime errors, when starting the Java virtual machine, You must add
<a href="https://nipafx.dev/five-command-line-options-hack-java-module-system/" target="_blank" rel="noopener">options that configure the Java module system at runtime</a>.</strong></p>
</div>
<div class="paragraph">
<p>In case the tests are run, these options must be added to the <code>maven-surefire-plugin</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
    &lt;version&gt;2.22.1&lt;/version&gt;
    &lt;configuration&gt;
        &lt;argLine&gt;
            @{argLine}
            --add-exports ...
            --add-opens ...
            --patch-module ...
            --add-modules ...
            --add-reads ...
        &lt;/argLine&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The specified configuration options for the Java module system at runtime can also be added using the features of the
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Module.html" target="_blank" rel="noopener"><code>java.lang.Module</code></a> class.</p>
</div>
<div class="paragraph">
<p><strong>In order the developer is relieved of the need to add the necessary options to the <code>maven-surefire-plugin</code> configuration, the RxMicro framework provides a special
<code>io.rxmicro.annotation.processor.RxMicroTestsAnnotationProcessor</code> component.</strong></p>
</div>
<div class="paragraph">
<p>To activate this component, it is necessary to add a new execution to the <code>maven-compiler-plugin</code> configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;execution&gt;
    &lt;id&gt;test-compile&lt;/id&gt;
    &lt;goals&gt;
        &lt;goal&gt;testCompile&lt;/goal&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;/goals&gt;
    &lt;configuration&gt;
        &lt;annotationProcessors&gt;
            &lt;annotationProcessor&gt;
                io.rxmicro.annotation.processor.RxMicroTestsAnnotationProcessor <i class="conum" data-value="2"></i><b>(2)</b>
            &lt;/annotationProcessor&gt;
        &lt;/annotationProcessors&gt;
        &lt;generatedTestSourcesDirectory&gt;
            ${project.build.directory}/generated-test-sources/  <i class="conum" data-value="3"></i><b>(3)</b>
        &lt;/generatedTestSourcesDirectory&gt;
    &lt;/configuration&gt;
&lt;/execution&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The separate configuration is required for the tests, so a new <code>execution</code> must be added.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The annotation processor class that handles the test configuration.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Location of Java classes generated by the <code>RxMicro Test Annotation Processor</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This annotation processor generates one single <code>rxmicro.$$ComponentTestFixer</code> class, that automatically opens access to all packages of the current project to unnamed modules:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class $$ComponentTestFixer {

    static {
        final Module currentModule = $$ComponentTestFixer.class.getModule();
        currentModule.addExports("rxmicro", RX_MICRO_REFLECTION_MODULE);
    }

    public $$ComponentTestFixer() {
        final Module currentModule = getClass().getModule();
        if (currentModule.isNamed()) {
            logInfoTestMessage("Fix the environment for componnet test(s)...");
            final Module unnamedModule = getClass().getClassLoader().getUnnamedModule(); <i class="conum" data-value="1"></i><b>(1)</b>
            final Set&lt;Module&gt; modules = unmodifiableOrderedSet(
                    unnamedModule, RX_MICRO_REFLECTION_MODULE
            );
            for (final Module module : modules) {
                for (final String packageName : currentModule.getPackages()) {
                    currentModule.addOpens(packageName, module); <i class="conum" data-value="2"></i><b>(2)</b>
                    logInfoTestMessage(
                            "opens ?/? to ?", <i class="conum" data-value="3"></i><b>(3)</b>
                            currentModule.getName(),
                            packageName,
                            module.isNamed() ? module.getName() : "ALL-UNNAMED"
                    );
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Using the standard Java API, the RxMicro framework retrieves the references to the current and unnamed modules.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Using the features of the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Module.html" target="_blank" rel="noopener"><code>java.lang.Module</code></a> class, the RxMicro framework opens the full access to all classes from all packages from the current module.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>To inform the developer about the successful performance of the  <code>rxmicro.$$ComponentTestFixer</code> class, the RxMicro framework displays to the console the information that access was successfully provided.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When running different types of tests, sometimes a different configuration of the Java module system is required.
Thus, for each type of test, the RxMicro framework creates a separate class in the <code>rxmicro</code> system package:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 21. Names of generated classes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Test type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Name of the generated class</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST-based microservice test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$$RestBasedMicroServiceTestFixer</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Component unit test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$$ComponentTestFixer</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST-based microservice integration test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$$IntegrationTestFixer</code></p></td>
</tr>
</tbody>
</table>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Before starting tests, the RxMicro framework uses a generated class to configure the module system for the test environment:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">[INFO] -------------------------------------------------------
[INFO]  <strong>T E S T S</strong>
[INFO] -------------------------------------------------------
...
[INFO] Fix the environment for component test(s)...
[INFO] <strong>opens</strong> examples.testing/io.rxmicro.examples.testing to ALL-UNNAMED <i class="conum" data-value="1"></i><b>(1)</b>
[INFO] <strong>opens</strong> examples.testing/rxmicro to ALL-UNNAMED
[INFO] Running <strong>io.rxmicro.examples.testing.ParentComponent1Test</strong> <i class="conum" data-value="2"></i><b>(2)</b>
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.278 s
[INFO] Running <strong>io.rxmicro.examples.testing.ParentComponent2Test</strong>
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.378 s
[INFO]
[INFO] Results:
[INFO]
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] <strong>BUILD SUCCESS</strong>
[INFO] ------------------------------------------------------------------------</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>All packages of the current module are opened before starting tests.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>After configuring the module system for the test environment, Unit tests are started.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Thus, for the successful writing of tests using the RxMicro framework, besides adding the required libraries, do not forget to configure the <code>maven-compiler-plugin</code> by adding the following annotation processor for the test environment: <code>io.rxmicro.annotation.processor.RxMicroTestsAnnotationProcessor</code>.</strong></p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="testing-before-test-section"><a class="anchor" href="#testing-before-test-section"></a><a class="link" href="#testing-before-test-section">14.5. The <code>@BeforeThisTest</code> and <code>@BeforeIterationMethodSource</code> Annotations</a></h3>
<div class="paragraph">
<p>In order to perform any actions before invoking the test method, the
<a href="https://junit.org/junit5/" target="_blank" rel="noopener">JUnit 5</a> framework provides a special <a href="https://junit.org/junit5/docs/current/user-guide/api/org.junit.jupiter.api/org/junit/jupiter/api/BeforeEach.html" target="_blank" rel="noopener"><code>@BeforeEach</code></a> annotation.</p>
</div>
<div class="paragraph">
<p>According to the working rules of the <a href="https://junit.org/junit5/" target="_blank" rel="noopener">JUnit 5</a> framework, if the test class contains a method annotated by the
<a href="https://junit.org/junit5/docs/current/user-guide/api/org.junit.jupiter.api/org/junit/jupiter/api/BeforeEach.html" target="_blank" rel="noopener"><code>@BeforeEach</code></a> annotation, then this method should be invoked before invoking each test method in the test class.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s consider the possibilities of using the <a href="https://junit.org/junit5/docs/current/user-guide/api/org.junit.jupiter.api/org/junit/jupiter/api/BeforeEach.html" target="_blank" rel="noopener"><code>@BeforeEach</code></a> annotation.
We&#8217;ll use the example of a project consisting of two components: ChildComponent interface and ParentComponent class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface ChildComponent {

    String getValue();
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class ParentComponent {

    private final ChildComponent childComponent = () -&gt; "production";

    public String getEnvironment() {
        return childComponent.getValue();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using the mock alternative, it is possible to program the behavior in the method annotated by the <a href="https://junit.org/junit5/docs/current/user-guide/api/org.junit.jupiter.api/org/junit/jupiter/api/BeforeEach.html" target="_blank" rel="noopener"><code>@BeforeEach</code></a> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(ParentComponent.class)
final class ParentComponent1Test {

    private ParentComponent parentComponent;

    @Mock
    @Alternative
    private ChildComponent childComponent;

    <i class="conum" data-value="1"></i><b>(1)</b>
    @BeforeEach
    void beforeEach() {
        when(childComponent.getValue()).thenReturn("mock");
    }

    @Test
    void Should_use_alternative() {
        assertEquals("mock", parentComponent.getEnvironment());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Since the <code>beforeEach()</code> method will be surely invoked by the <a href="https://junit.org/junit5/" target="_blank" rel="noopener">JUnit 5</a>
framework before invoking the <code>Should_use_alternative()</code> test method, the programmed mock behavior will be used during the test;</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The weak point in using the method annotated by the <a href="https://junit.org/junit5/docs/current/user-guide/api/org.junit.jupiter.api/org/junit/jupiter/api/BeforeEach.html" target="_blank" rel="noopener"><code>@BeforeEach</code></a>
annotation, is that it is impossible to program different behavior for two or more test methods in the same class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@BeforeEach
void beforeEach() {
    when(childComponent.getValue()).thenReturn("mock");
}

@Test
void Should_use_alternative1() {
    assertEquals("mock1", parentComponent.getEnvironment()); // failed
}

@Test
void Should_use_alternative2() {
    assertEquals("mock2", parentComponent.getEnvironment()); // failed
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The standard solution to this problem consists in programming behavior in the test method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
void Should_use_alternative1() {
    when(childComponent.getValue()).thenReturn("mock1");
    assertEquals("mock1", parentComponent.getEnvironment());
}

@Test
void Should_use_alternative2() {
    when(childComponent.getValue()).thenReturn("mock2");
    assertEquals("mock2", parentComponent.getEnvironment());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, the alternative configuration in the test method is not always convenient.<br>
<strong>This can cause a problem, especially when it is necessary to configure the RxMicro component alternative before its registration in the runtime container!</strong></p>
</div>
<div class="paragraph">
<p>To solve this problem, the RxMicro framework provides two additional annotations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/BeforeThisTest.java" target="_blank" rel="noopener"><code>@BeforeThisTest</code></a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/BeforeIterationMethodSource.java" target="_blank" rel="noopener"><code>@BeforeIterationMethodSource</code></a>;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/BeforeThisTest.java" target="_blank" rel="noopener"><code>@BeforeThisTest</code></a>
annotation allows You to specify the method to be invoked before invoking a specific test method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(ParentComponent.class)
final class ParentComponent4Test {

    private ParentComponent parentComponent;

    @Mock
    @Alternative
    private ChildComponent childComponent;

    void beforeTest1() { <i class="conum" data-value="1"></i><b>(1)</b>
        when(childComponent.getValue()).thenReturn("mock1");
    }

    @Test
    <i class="conum" data-value="2"></i><b>(2)</b>
    @BeforeThisTest(method = "beforeTest1")
    void Should_use_alternative1() {
        assertEquals("mock1", parentComponent.getEnvironment());
    }

    void beforeTest2() {
        when(childComponent.getValue()).thenReturn("mock2");
    }

    @Test
    @BeforeThisTest(method = "beforeTest2")
    void Should_use_alternative2() {
        assertEquals("mock2", parentComponent.getEnvironment());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To configure the mock alternative, it is necessary to create a method in the test class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If this method needs to be invoked before the test method, it is necessary to specify the name of this method using the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/BeforeThisTest.java" target="_blank" rel="noopener"><code>@BeforeThisTest</code></a> annotation.<br>
<em>(The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/BeforeThisTest.java" target="_blank" rel="noopener"><code>@BeforeThisTest</code></a> annotation must annotate the test method!)</em>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When creating parametrized tests, it is necessary to use the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/BeforeIterationMethodSource.java" target="_blank" rel="noopener"><code>@BeforeIterationMethodSource</code></a>
annotation instead of the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/BeforeThisTest.java" target="_blank" rel="noopener"><code>@BeforeThisTest</code></a> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(ParentComponent.class)
final class ParentComponent5Test {

    private ParentComponent parentComponent;

    @Mock
    @Alternative
    private ChildComponent childComponent;

    void beforeEachPreparer1() {
        when(childComponent.getValue()).thenReturn(new BigDecimal("23").toString());
    }

    void beforeEachPreparer2() {
        when(childComponent.getValue()).thenReturn("23");
    }

    @ParameterizedTest
    <i class="conum" data-value="1"></i><b>(1)</b>
    @BeforeIterationMethodSource(methods = {
            "beforeEachPreparer1",
            "beforeEachPreparer2"
    })
    void Should_use_alternative2(final String method) { <i class="conum" data-value="2"></i><b>(2)</b>
        assertEquals("23", parentComponent.getEnvironment());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Using the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/BeforeIterationMethodSource.java" target="_blank" rel="noopener"><code>@BeforeIterationMethodSource</code></a>
annotation, the developer specifies an array of methods.
Each method in this array must be invoked before executing a new iteration of the parameterized test.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>For reporting it is recommended to specify the <code>final String method</code> parameter of the parameterized test.
This parameter is not used in the test, but if it is present, the <a href="https://junit.org/junit5/" target="_blank" rel="noopener">JUnit 5</a> framework automatically passes the method name to it.
Thus, in the execution report of the parameterized test, for each iteration the method that was invoked before execution of this iteration will be specified.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-component-before-test" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-component-before-test</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="testing-rest-based-microservice-tests-section"><a class="anchor" href="#testing-rest-based-microservice-tests-section"></a><a class="link" href="#testing-rest-based-microservice-tests-section">14.6. REST-based Microservice Testing</a></h3>
<div class="paragraph">
<p>The REST-based microservice test is a standard Unit test that tests only the source code of a microservice.
If the current microservice depends on external services (e.g. database, other REST-based microservices, etc.), then it is allowed to use mocks for these external services during its testing.
If several REST-based microservices need to be tested, it is recommended to use the <a href="#testing-integration-tests-section">REST-based microservice integration testing</a>.</p>
</div>
<div class="paragraph">
<p>For easy writing of microservice tests, the RxMicro framework provides:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The additional <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/RxMicroRestBasedMicroServiceTest.java" target="_blank" rel="noopener"><code>@RxMicroRestBasedMicroServiceTest</code></a> annotation, that informs the RxMicro framework about the need to start the tested REST-based microservice and prepare the environment to execute test HTTP requests.</p>
</li>
<li>
<p>A special <strong>blocking</strong> HTTP client to execute HTTP requests during testing:
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a>.</p>
</li>
<li>
<p>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/SystemOut.java" target="_blank" rel="noopener"><code>SystemOut</code></a> interface for easy console access.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For each microservice test, the RxMicro framework performs the following actions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Before starting all the test methods in the class:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>checks the test class for compliance with the rules of REST-based microservice testing defined by the RxMicro framework;</p>
</li>
<li>
<p>starts an HTTP server on a random free port;</p>
</li>
<li>
<p>creates an instance of the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a> type;</p>
</li>
<li>
<p>connects the created <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a> to the running HTTP server.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Before starting each test method:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>if necessary, invokes the methods defined using the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/BeforeThisTest.java" target="_blank" rel="noopener"><code>@BeforeThisTest</code></a>
or <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/BeforeIterationMethodSource.java" target="_blank" rel="noopener"><code>@BeforeIterationMethodSource</code></a> annotations;</p>
</li>
<li>
<p>if necessary, registers the RxMicro component alternatives in the RxMicro container;</p>
</li>
<li>
<p>registers the tested REST-based microservice on the running HTTP server;</p>
</li>
<li>
<p>if necessary, injects the custom component alternatives to the REST-based microservice;</p>
</li>
<li>
<p>injects a reference to the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a> instance into the test class;</p>
</li>
<li>
<p>if necessary, creates the <code>System.out</code> mock, and injects it into the test class.</p>
</li>
</ol>
</div>
</li>
<li>
<p>After performing each test method:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>deletes all registered components from the RxMicro container;</p>
</li>
<li>
<p>deletes all registered REST-based microservices on the running HTTP server;</p>
</li>
<li>
<p>if necessary, restores the <code>System.out</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>After performing all the tests in the class:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>clears the resources of the <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a> component;</p>
</li>
<li>
<p>stops the HTTP server and releases the selected resources.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="basic_principles"><a class="anchor" href="#basic_principles"></a><a class="link" href="#basic_principles">14.6.1. Basic Principles</a></h4>
<div class="paragraph">
<p>To understand the REST-based microservice testing principles, let&#8217;s create the simplest microservice that returns the <code>"Hello World!"</code> message.</p>
</div>
<div class="paragraph">
<p>Since the microservice will return a JSON object, it is necessary to create a response model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Response {

    final String message;

    public Response(final String message) {
        this.message = requireNonNull(message);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When there is the <code>GET</code> request to the microservice, it should return the <code>"Hello World!"</code> message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class MicroService {

    @GET("/")
    CompletableFuture&lt;Response&gt; get() {
        return completedFuture(new Response("Hello World!"));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The testing process of the REST-based microservice is to perform an HTTP request after the RxMicro framework starts the tested microservice on the HTTP server.
After receiving a response from the microservice, this response is compared to the expected response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@RxMicroRestBasedMicroServiceTest(MicroService.class)
class MicroServiceTest {

    private BlockingHttpClient blockingHttpClient; <i class="conum" data-value="2"></i><b>(2)</b>

    @Test
    void Should_handle_GET_request() {
        final ClientHttpResponse response = blockingHttpClient.get("/");

        assertEquals(jsonObject("message", "Hello World!"), response.getBody()); <i class="conum" data-value="3"></i><b>(3)</b>
        assertEquals(200, response.getStatusCode());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To start the HTTP server and register the tested REST-based microservice, it is necessary to annotate the test class by the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/RxMicroRestBasedMicroServiceTest.java" target="_blank" rel="noopener"><code>@RxMicroRestBasedMicroServiceTest</code></a> annotation.
In the parameter of this annotation it is specified which REST-based microservice class will be tested in the current test.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>To execute <strong>blocking</strong> HTTP requests, the RxMicro framework supports the special
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a> component.
The developer must declare a reference to this component, and while starting the test, the RxMicro framework will automatically inject the created
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a> class instance, using the <code>reflection</code> mechanism.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Upon receiving the HTTP response from the microservice, the developer should compare the response body with the expected result in the test.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To get additional info about writing tests that require JSON object comparison, please read <a href="#core-json-rxmicro-json-module-usage"><code>rxmicro.json</code> Module Usage</a> section.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-microservice-basic" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-microservice-basic</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="testing-rest-based-microservice-tests-complex-alternative-usage-section"><a class="anchor" href="#testing-rest-based-microservice-tests-complex-alternative-usage-section"></a><a class="link" href="#testing-rest-based-microservice-tests-complex-alternative-usage-section">14.6.2. Features of Testing Complex Microservices that use Alternatives</a></h4>
<div class="sect4">
<h5 id="features_of_rest_client_testing"><a class="anchor" href="#features_of_rest_client_testing"></a><a class="link" href="#features_of_rest_client_testing">14.6.2.1. Features of REST Client Testing</a></h5>
<div class="paragraph">
<p>This section will cover the features of testing REST-based microservices that use REST clients.</p>
</div>
<div class="paragraph">
<p>The source code of such REST-based microservice consists of the <code>Response</code> model class, <code>ExternalMicroService</code> REST client and <code>ConsumeMicroService</code> HTTP request handler:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Response {

    String message;

    public Response(final String message) {
        this.message = requireNonNull(message);
    }

    public Response() {
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestClient
public interface ExternalMicroService {

    @GET("/")
    CompletableFuture&lt;Response&gt; get();
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class MicroService {

    private final ExternalMicroService externalMicroService =
            getRestClient(ExternalMicroService.class);

    @GET("/")
    CompletableFuture&lt;Response&gt; get() {
        return externalMicroService.get();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The most logical way to test such microservice is to create a mock alternative for the <code>ExternalMicroService</code> component:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceBusinessLogicOnlyTest {

    private BlockingHttpClient blockingHttpClient;

    @Mock
    @Alternative
    private ExternalMicroService externalMicroService;

    @Test
    void Should_delegate_call_to_ExternalMicroService() {
        when(externalMicroService.get()).thenReturn(completedFuture(new Response("mock")));

        final ClientHttpResponse response = blockingHttpClient.get("/");

        assertEquals(jsonObject("message", "mock"), response.getBody());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To get additional info about writing tests that require JSON object comparison, please read <a href="#core-json-rxmicro-json-module-usage"><code>rxmicro.json</code> Module Usage</a> section.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>But if on the basis of such test we build the source code coverage report, this report will show a low degree of coverage:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/microservice/alternative/rest-client/jacoco-business-logic-only.jpg" alt="jacoco business logic only">
</div>
<div class="title">Figure 17. The test coverage report when using a mock alternative for REST client.</div>
</div>
<div class="paragraph">
<p>Such a result is caused by the fact that after creating a mock alternative for the <code>ExternalMicroService</code> component, the classes generated by the RxMicro framework are not used in the testing process for the REST client work.</p>
</div>
<div class="paragraph">
<p>If such a result is not acceptable, it is necessary to:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>create a mock alternative to the <code>HttpClientFactory</code> RxMicro component;</p>
</li>
<li>
<p>use the static methods of the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-mockito/src/main/java/io/rxmicro/test/mockito/httpclient/HttpClientMockFactory.java" target="_blank" rel="noopener"><code>HttpClientMockFactory</code></a> class to program the mock behavior.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceWithAllGeneratedCodeTest {

    private BlockingHttpClient blockingHttpClient;

    @Mock
    @Alternative
    private HttpClientFactory httpClientFactory;

    void prepareExternalMicroServiceHttpClient() {
        prepareHttpClientMock(
                httpClientFactory,
                new HttpRequestMock.Builder()
                        .setMethod(GET)
                        .setPath("/")
                        .build(),
                jsonObject("message", "mock")
        );
    }

    @Test
    @BeforeThisTest(method = "prepareExternalMicroServiceHttpClient")
    void Should_delegate_call_to_ExternalMicroService() {
        final ClientHttpResponse response = blockingHttpClient.get("/");

        assertEquals(jsonObject("message", "mock"), response.getBody());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The modified test shows a coverage rate of 100%:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/microservice/alternative/rest-client/jacoco-all-generated.jpg" alt="jacoco all generated">
</div>
<div class="title">Figure 18. The test coverage report when using the <code>HttpClientFactory</code> mock alternative.</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-microservice-alternatives-rest-client" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-microservice-alternatives-rest-client</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="features_of_testing_mongo_repositories"><a class="anchor" href="#features_of_testing_mongo_repositories"></a><a class="link" href="#features_of_testing_mongo_repositories">14.6.2.2. Features of Testing Mongo Repositories</a></h5>
<div class="paragraph">
<p>This section will cover the features of testing REST-based microservices that use mongo repositories.</p>
</div>
<div class="paragraph">
<p>The source code of such REST-based microservice consists of the <code>Entity</code> entity model, <code>Response</code> model class, <code>DataRepository</code> mongo repository and <code>ConsumeMicroService</code> HTTP request handler:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Response {

    final String message;

    public Response(final String message) {
        this.message = requireNonNull(message);
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Entity {

    String data;

    public String getData() {
        return data;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@MongoRepository(collection = "collection")
public interface DataRepository {

    @Find(query = "{_id: ?}")
    CompletableFuture&lt;Optional&lt;Entity&gt;&gt; findById(long id);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class MicroService {

    private final DataRepository dataRepository =
            getRepository(DataRepository.class);

    @GET("/")
    CompletableFuture&lt;Optional&lt;Response&gt;&gt; get(final Long id) {
        return dataRepository.findById(id).thenApply(optionalEntity -&gt;
                optionalEntity.map(entity -&gt;
                        new Response(entity.getData())));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The most logical way to test such microservice is to create a mock alternative for the <code>DataRepository</code> component:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceBusinessLogicOnlyTest {

    private BlockingHttpClient blockingHttpClient;

    @Mock
    @Alternative
    private DataRepository dataRepository;

    @Mock
    private Entity entity;

    @Test
    void Should_return_Entity_data() {
        when(entity.getData())
                .thenReturn("data");
        when(dataRepository.findById(1))
                .thenReturn(completedFuture(Optional.of(entity)));

        final ClientHttpResponse response = blockingHttpClient.get("/?id=1");

        assertEquals(jsonObject("message", "data"), response.getBody());
        assertEquals(200, response.getStatusCode());
    }

    @Test
    void Should_return_Not_Found_error() {
        when(dataRepository.findById(1))
                .thenReturn(completedFuture(Optional.empty()));

        final ClientHttpResponse response = blockingHttpClient.get("/?id=1");

        assertEquals(jsonObject("message", "Not Found"), response.getBody());
        assertEquals(404, response.getStatusCode());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To get additional info about writing tests that require JSON object comparison, please read <a href="#core-json-rxmicro-json-module-usage"><code>rxmicro.json</code> Module Usage</a> section.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>But if on the basis of such test we build the source code coverage report, this report will show a low degree of coverage:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/microservice/alternative/mongo-repo/jacoco-business-logic-only.jpg" alt="jacoco business logic only">
</div>
<div class="title">Figure 19. The test coverage report when using a mock alternative for Mongo repository.</div>
</div>
<div class="paragraph">
<p>Such a result is caused by the fact that after creating a mock alternative for the <code>DataRepository</code> component, the classes generated by the RxMicro framework are not used in the testing process for the mongo repository work.</p>
</div>
<div class="paragraph">
<p>If such a result is not acceptable, it is necessary to:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>create a mock alternative to the <code>MongoDatabase</code> RxMicro component;</p>
</li>
<li>
<p>use the static methods of the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-mockito/src/main/java/io/rxmicro/test/mockito/mongo/MongoMockFactory.java" target="_blank" rel="noopener"><code>MongoMockFactory</code></a> class to program the mock behavior.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceWithAllGeneratedCodeTest {

    private static final FindOperationMock FIND_OPERATION_MOCK =
            new FindOperationMock.Builder()
                    .setAnyQuery()
                    //.setQuery("{_id: 1}")
                    .build();

    private BlockingHttpClient blockingHttpClient;

    @Mock
    @Alternative
    private MongoDatabase mongoDatabase;

    void prepareOneEntityFound() {
        prepareMongoOperationMocks(
                mongoDatabase,
                "collection",
                FIND_OPERATION_MOCK,
                new Document("data", "data")
        );
    }

    @Test
    @BeforeThisTest(method = "prepareOneEntityFound")
    void Should_return_Entity_data() {
        final ClientHttpResponse response = blockingHttpClient.get("/?id=1");

        assertEquals(jsonObject("message", "data"), response.getBody());
        assertEquals(200, response.getStatusCode());
    }

    void prepareNoEntityFound() {
        prepareMongoOperationMocks(
                mongoDatabase,
                "collection",
                FIND_OPERATION_MOCK
        );
    }

    @Test
    @BeforeThisTest(method = "prepareNoEntityFound")
    void Should_return_Not_Found_error() {
        final ClientHttpResponse response = blockingHttpClient.get("/?id=1");

        assertEquals(jsonObject("message", "Not Found"), response.getBody());
        assertEquals(404, response.getStatusCode());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The modified test shows a coverage rate of 100%:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/microservice/alternative/mongo-repo/jacoco-all-generated.jpg" alt="jacoco all generated">
</div>
<div class="title">Figure 20. The test coverage report when using the <code>MongoDatabase</code> mock alternative.</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-microservice-alternatives-mongo-repository" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-microservice-alternatives-mongo-repository</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="features_of_testing_postgres_repositories"><a class="anchor" href="#features_of_testing_postgres_repositories"></a><a class="link" href="#features_of_testing_postgres_repositories">14.6.2.3. Features of Testing Postgres Repositories</a></h5>
<div class="paragraph">
<p>This section will cover the features of testing REST-based microservices that use postgres repositories.</p>
</div>
<div class="paragraph">
<p>The source code of such REST-based microservice consists of the <code>Entity</code> entity model, <code>Response</code> model class, <code>DataRepository</code> mongo repository and <code>ConsumeMicroService</code> HTTP request handler:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class Response {

    final String message;

    public Response(final String message) {
        this.message = requireNonNull(message);
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Table
public final class Entity {

    @Column(length = Column.UNLIMITED_LENGTH)
    String data;

    public String getData() {
        return data;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostgreSQLRepository
public interface DataRepository {

    @Select("SELECT data FROM ${table} WHERE id=?")
    CompletableFuture&lt;Optional&lt;Entity&gt;&gt; findById(long id);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final class MicroService {

    private final DataRepository dataRepository = getRepository(DataRepository.class);

    @GET("/")
    CompletableFuture&lt;Optional&lt;Response&gt;&gt; get(final Long id) {
        return dataRepository.findById(id).thenApply(optionalEntity -&gt;
                optionalEntity.map(entity -&gt;
                        new Response(entity.getData())));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The most logical way to test such microservice is to create a mock alternative for the <code>DataRepository</code> component:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceBusinessLogicOnlyTest {

    private BlockingHttpClient blockingHttpClient;

    @Mock
    @Alternative
    private DataRepository dataRepository;

    @Mock
    private Entity entity;

    @Test
    void Should_return_Entity_data() {
        when(entity.getData())
                .thenReturn("data");
        when(dataRepository.findById(1))
                .thenReturn(completedFuture(Optional.of(entity)));

        final ClientHttpResponse response = blockingHttpClient.get("/?id=1");

        assertEquals(jsonObject("message", "data"), response.getBody());
        assertEquals(200, response.getStatusCode());
    }

    @Test
    void Should_return_Not_Found_error() {
        when(dataRepository.findById(1))
                .thenReturn(completedFuture(Optional.empty()));

        final ClientHttpResponse response = blockingHttpClient.get("/?id=1");

        assertEquals(jsonObject("message", "Not Found"), response.getBody());
        assertEquals(404, response.getStatusCode());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To get additional info about writing tests that require JSON object comparison, please read <a href="#core-json-rxmicro-json-module-usage"><code>rxmicro.json</code> Module Usage</a> section.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>But if on the basis of such test we build the source code coverage report, this report will show a low degree of coverage:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/microservice/alternative/postgresql-repo/jacoco-business-logic-only.jpg" alt="jacoco business logic only">
</div>
<div class="title">Figure 21. The test coverage report when using a mock alternative for Postgresql repository.</div>
</div>
<div class="paragraph">
<p>Such a result is caused by the fact that after creating a mock alternative for the <code>DataRepository</code> component, the classes generated by the RxMicro framework are not used in the testing process for the postgres repository work.</p>
</div>
<div class="paragraph">
<p>If such a result is not acceptable, it is necessary to:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>create a mock alternative to the <code>ConnectionPool</code> RxMicro component;</p>
</li>
<li>
<p>use the static methods of the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-mockito/src/main/java/io/rxmicro/test/mockito/r2dbc/SQLMockFactory.java" target="_blank" rel="noopener"><code>SQLMockFactory</code></a> class to program the mock behavior.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceWithAllGeneratedCodeTest {

    private static final SQLQueryWithParamsMock SQL_PARAMS_MOCK =
            new SQLQueryWithParamsMock.Builder()
                    .setAnySql()
                    //.setSql("SELECT data FROM entity WHERE id = $1")
                    //.setBindParams(1L)
                    .build();

    private BlockingHttpClient blockingHttpClient;

    @Mock
    @Alternative
    private ConnectionPool connectionPool;

    void prepareOneEntityFound() {
        prepareSQLOperationMocks(
                connectionPool,
                SQL_PARAMS_MOCK,
                "data"
        );
    }

    @Test
    @BeforeThisTest(method = "prepareOneEntityFound")
    void Should_return_Entity_data() {
        final ClientHttpResponse response = blockingHttpClient.get("/?id=1");

        assertEquals(jsonObject("message", "data"), response.getBody());
        assertEquals(200, response.getStatusCode());
    }

    void prepareNoEntityFound() {
        prepareSQLOperationMocks(
                connectionPool,
                SQL_PARAMS_MOCK,
                List.of()
        );
    }

    @Test
    @BeforeThisTest(method = "prepareNoEntityFound")
    void Should_return_Not_Found_error() {
        final ClientHttpResponse response = blockingHttpClient.get("/?id=1");

        assertEquals(jsonObject("message", "Not Found"), response.getBody());
        assertEquals(404, response.getStatusCode());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The modified test shows a coverage rate of 100%:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/microservice/alternative/postgresql-repo/jacoco-all-generated.jpg" alt="jacoco all generated">
</div>
<div class="title">Figure 22. The test coverage report when using the <code>ConnectionPool</code> mock alternative.</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-microservice-alternatives-postgres-repository" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-microservice-alternatives-postgres-repository</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="custom_and_the_rxmicro_framework_code_execution_order"><a class="anchor" href="#custom_and_the_rxmicro_framework_code_execution_order"></a><a class="link" href="#custom_and_the_rxmicro_framework_code_execution_order">14.6.3. Custom and the RxMicro Framework Code Execution Order</a></h4>
<div class="paragraph">
<p>For efficient writing of Rest-based microservice tests, it is necessary to know the execution order of user, and the RxMicro framework code.</p>
</div>
<div class="paragraph">
<p>When testing a Rest-based microservice, using the following test:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroRestBasedMicroServiceTest(MicroService.class)
final class MicroServiceTest {

    @BeforeAll
    static void beforeAll() {
    }

    private BlockingHttpClient blockingHttpClient;

    private SystemOut systemOut;

    @Mock
    @Alternative
    private BusinessService businessService;

    public MicroServiceTest() {
    }

    @BeforeEach
    void beforeEach() {
    }

    void beforeTest1UserMethod() {
    }

    @Test
    @BeforeThisTest(method = "beforeTest1UserMethod")
    void test1() {
    }

    void beforeTest2UserMethod() {
    }

    @Test
    @BeforeThisTest(method = "beforeTest2UserMethod")
    void test2() {
    }

    @AfterEach
    void afterEach() {
    }

    @AfterAll
    static void afterAll() {
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>the execution order will be as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text"><strong>RX-MICRO:</strong> Test class validated.
<strong>RX-MICRO:</strong> HTTP server started without any REST-based microservices using random free port.
<strong>RX-MICRO:</strong> Blocking HTTP client created and connected to the started HTTP server.
<strong>USER-TEST:</strong> '@org.junit.jupiter.api.BeforeAll' invoked.

<strong>USER-TEST:</strong> new instance of the REST-based microservice test class created.
<strong>MOCKITO:</strong> All mocks created and injected.
<strong>RX-MICRO:</strong> Alternatives of the RxMicro components registered in the RxMicro runtime containers.
<strong>RX-MICRO:</strong> Blocking HTTP client injected to the instance of the test class.
<strong>RX-MICRO:</strong> SystemOut instance created and injected to the instance of the test class.
<strong>USER-TEST:</strong> '@org.junit.jupiter.api.BeforeEach' invoked.
<strong>USER-TEST:</strong> 'beforeTest1UserMethod' invoked.
<strong>RX-MICRO:</strong> Current REST-based microservice instance created and registered in the HTTP server.
<strong>RX-MICRO:</strong> Alternatives of the user components injected to the REST-based microservice instance.
<strong>USER-TEST:</strong> 'test1()' invoked.
<strong>USER-TEST:</strong> '@org.junit.jupiter.api.AfterEach' invoked.
<strong>RX-MICRO:</strong> All registered alternatives removed from the RxMicro runtime containers.
<strong>RX-MICRO:</strong> Current REST-based microservice instance unregistered from the HTTP server.
<strong>RX-MICRO:</strong> System.out reset.
<strong>MOCKITO:</strong> All mocks destroyed.

<strong>USER-TEST:</strong> new instance of the REST-based microservice test class created.
<strong>MOCKITO:</strong> All mocks created and injected.
<strong>RX-MICRO:</strong> Alternatives of the RxMicro components registered in the RxMicro runtime containers.
<strong>RX-MICRO:</strong> Blocking HTTP client injected to the instance of the test class.
<strong>RX-MICRO:</strong> SystemOut instance created and injected to the instance of the test class.
<strong>USER-TEST:</strong> '@org.junit.jupiter.api.BeforeEach' invoked.
<strong>USER-TEST:</strong> 'beforeTest2UserMethod' invoked.
<strong>RX-MICRO:</strong> Current REST-based microservice instance created and registered in the HTTP server.
<strong>RX-MICRO:</strong> Alternatives of the user components injected to the REST-based microservice instance.
<strong>USER-TEST:</strong> 'test2()' invoked.
<strong>USER-TEST:</strong> '@org.junit.jupiter.api.AfterEach' invoked.
<strong>RX-MICRO:</strong> All registered alternatives removed from the RxMicro runtime containers.
<strong>RX-MICRO:</strong> Current REST-based microservice instance unregistered from the HTTP server.
<strong>RX-MICRO:</strong> System.out reset.
<strong>MOCKITO:</strong> All mocks destroyed.

<strong>USER-TEST:</strong> '@org.junit.jupiter.api.AfterAll' invoked.
<strong>RX-MICRO:</strong> Blocking HTTP client released.
<strong>RX-MICRO:</strong> HTTP server stopped.</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above execution order of user, and the RxMicro framework code the following clarifications are implied:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <code>MOCKITO</code> prefix means that the action is activated by the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-mockito-junit/src/main/java/io/rxmicro/test/mockito/junit/InitMocks.java" target="_blank" rel="noopener"><code>@InitMocks</code></a> annotation.</p>
</li>
<li>
<p>The <code>RX-MICRO</code> prefix means that the action is activated by the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/RxMicroRestBasedMicroServiceTest.java" target="_blank" rel="noopener"><code>@RxMicroRestBasedMicroServiceTest</code></a> annotation.</p>
</li>
<li>
<p>The <code>USER-TEST</code> prefix means that at this stage a custom method from the <code>MicroServiceTest</code> class is invoked.</p>
</li>
</ol>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="testing-component-tests-section"><a class="anchor" href="#testing-component-tests-section"></a><a class="link" href="#testing-component-tests-section">14.7. Testing of Microservice Components</a></h3>
<div class="sect3">
<h4 id="basic_principles_2"><a class="anchor" href="#basic_principles_2"></a><a class="link" href="#basic_principles_2">14.7.1. Basic Principles</a></h4>
<div class="paragraph">
<p>The basic principles of component testing are covered by the <a href="#testing-alternatives-usage-section">Section 14.3.3, &#8220;Alternative Usage&#8221;</a> section.</p>
</div>
</div>
<div class="sect3">
<h4 id="features_of_testing_complex_components_that_use_alternatives"><a class="anchor" href="#features_of_testing_complex_components_that_use_alternatives"></a><a class="link" href="#features_of_testing_complex_components_that_use_alternatives">14.7.2. Features of Testing Complex Components that Use Alternatives</a></h4>
<div class="paragraph">
<p>The features of testing complex components that use alternatives are the same as for <a href="#testing-rest-based-microservice-tests-complex-alternative-usage-section">REST-based microservice testing</a>.</p>
</div>
<div class="paragraph">
<p>For more information, we recommend that You familiarize yourself with the following examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Features of testing components that use REST clients:</p>
</li>
</ul>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-component-alternatives-rest-client" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-component-alternatives-rest-client</code></a>;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Features of testing components that use mongo repositories:</p>
</li>
</ul>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-component-alternatives-mongo-repository" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-component-alternatives-mongo-repository</code></a>;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Features of testing components that use postgres repositories:</p>
</li>
</ul>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-component-alternatives-postgres-repository" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-component-alternatives-postgres-repository</code></a>;</p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="custom_and_the_rxmicro_framework_execution_order"><a class="anchor" href="#custom_and_the_rxmicro_framework_execution_order"></a><a class="link" href="#custom_and_the_rxmicro_framework_execution_order">14.7.3. Custom and the RxMicro Framework Execution Order</a></h4>
<div class="paragraph">
<p>For efficient writing of component tests, it is necessary to know the execution order of user, and the RxMicro framework code.</p>
</div>
<div class="paragraph">
<p>When testing a component, using the following test:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@InitMocks
@RxMicroComponentTest(BusinessService.class)
final class BusinessServiceTest {

    @BeforeAll
    static void beforeAll() {
    }

    private BusinessService businessService;

    private SystemOut systemOut;

    @Mock
    @Alternative
    private BusinessService.ChildBusinessService childBusinessService;

    public BusinessServiceTest() {
    }

    @BeforeEach
    void beforeEach() {
    }

    void beforeTest1UserMethod() {
    }

    @Test
    @BeforeThisTest(method = "beforeTest1UserMethod")
    void test1() {
    }

    void beforeTest2UserMethod() {
    }

    @Test
    @BeforeThisTest(method = "beforeTest2UserMethod")
    void test2() {
    }

    @AfterEach
    void afterEach() {
    }

    @AfterAll
    static void afterAll() {
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>the execution order will be as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text"><strong>RX-MICRO:</strong> Test class validated.
<strong>USER-TEST:</strong> '@org.junit.jupiter.api.BeforeAll' invoked.

<strong>USER-TEST:</strong> new instance of the component test class created.
<strong>MOCKITO:</strong> All mocks created and injected.
<strong>RX-MICRO:</strong> Alternatives of the RxMicro components registered in the RxMicro runtime containers.
<strong>RX-MICRO:</strong> SystemOut instance created and injected to the instance of the test class.
<strong>USER-TEST:</strong> '@org.junit.jupiter.api.BeforeEach' invoked.
<strong>USER-TEST:</strong> 'beforeTest1UserMethod' invoked.
<strong>RX-MICRO:</strong> Tested component instance created, if it is not created by user.
<strong>RX-MICRO:</strong> Alternatives of the user components injected to the tested component instance.
<strong>USER-TEST:</strong> 'test1()' method invoked.
<strong>USER-TEST:</strong> '@org.junit.jupiter.api.AfterEach' invoked.
<strong>RX-MICRO:</strong> All registered alternatives removed from the RxMicro runtime containers.
<strong>RX-MICRO:</strong> System.out reset.
<strong>MOCKITO:</strong> All mocks destroyed.

<strong>USER-TEST:</strong> new instance of the component test class created.
<strong>MOCKITO:</strong> All mocks created and injected.
<strong>RX-MICRO:</strong> Alternatives of the RxMicro components registered in the RxMicro runtime containers.
<strong>RX-MICRO:</strong> SystemOut instance created and injected to the instance of the test class.
<strong>USER-TEST:</strong> '@org.junit.jupiter.api.BeforeEach' invoked.
<strong>USER-TEST:</strong> 'beforeTest2UserMethod' invoked.
<strong>RX-MICRO:</strong> Tested component instance created, if it is not created by user.
<strong>RX-MICRO:</strong> Alternatives of the user components injected to the tested component instance.
<strong>USER-TEST:</strong> 'test2()' method invoked.
<strong>USER-TEST:</strong> '@org.junit.jupiter.api.AfterEach' invoked.
<strong>RX-MICRO:</strong> All registered alternatives removed from the RxMicro runtime containers.
<strong>RX-MICRO:</strong> System.out reset.
<strong>MOCKITO:</strong> All mocks destroyed.

<strong>USER-TEST:</strong> '@org.junit.jupiter.api.AfterAll' invoked.</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above execution order of user, and the RxMicro framework code the following clarifications are implied:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <code>MOCKITO</code> prefix means that the action is activated by the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-mockito-junit/src/main/java/io/rxmicro/test/mockito/junit/InitMocks.java" target="_blank" rel="noopener"><code>@InitMocks</code></a> annotation.</p>
</li>
<li>
<p>The <code>RX-MICRO</code> prefix means that the action is activated by the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/RxMicroComponentTest.java" target="_blank" rel="noopener"><code>@RxMicroComponentTest</code></a> annotation.</p>
</li>
<li>
<p>The <code>USER-TEST</code> prefix means that at this stage a custom method from the <code>BusinessServiceTest</code> class is invoked.</p>
</li>
</ol>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="testing-integration-tests-section"><a class="anchor" href="#testing-integration-tests-section"></a><a class="link" href="#testing-integration-tests-section">14.8. REST-based Microservice Integration Testing</a></h3>
<div class="paragraph">
<p>The REST-based microservice integration testing allows You to test a complete system, which can consist of several REST-based microservices.</p>
</div>
<div class="paragraph">
<p>For easy writing of the REST-based microservices integration tests, the RxMicro framework provides:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The additional <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/RxMicroIntegrationTest.java" target="_blank" rel="noopener"><code>@RxMicroIntegrationTest</code></a> annotation, that informs the RxMicro framework about the need to create an HTTP client and inject it into the tested class.</p>
</li>
<li>
<p>A special <strong>blocking</strong> HTTP client to execute HTTP requests during testing:
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a>.</p>
</li>
<li>
<p>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/SystemOut.java" target="_blank" rel="noopener"><code>SystemOut</code></a> interface for easy console access.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The main differences between integration testing and REST-based microservice testing:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>for integration tests, the RxMicro framework does not run an HTTP server;</p>
</li>
<li>
<p>the developer has to start and stop the system consisting of REST-based microservices;</p>
</li>
<li>
<p>the RxMicro framework does not support alternatives and additional configuration for integration tests;</p>
</li>
</ol>
</div>
<div style="page-break-after: always;"></div>
<div class="sect3">
<h4 id="testing-integration-tests-basic-section"><a class="anchor" href="#testing-integration-tests-basic-section"></a><a class="link" href="#testing-integration-tests-basic-section">14.8.1. Basic Principles</a></h4>
<div class="paragraph">
<p>To demonstrate the features of the integration testing, let&#8217;s look at the following microservice:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public final class MicroService {

    @GET("/")
    void handle() {
        System.out.println("handle");
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The integration test for this microservice will be as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@RxMicroIntegrationTest
final class MicroServiceIntegrationTest {

    <i class="conum" data-value="2"></i><b>(2)</b>
    private static final int PORT = 55555;

    private static ServerInstance serverInstance;

    <i class="conum" data-value="5"></i><b>(5)</b>
    @BeforeAll
    static void beforeAll() {
        new Configs.Builder()
                .withConfigs(new HttpServerConfig()
                        .setPort(PORT))
                .build(); <i class="conum" data-value="4"></i><b>(4)</b>
        serverInstance = startRestServer(MicroService.class);<i class="conum" data-value="3"></i><b>(3)</b>
    }

    <i class="conum" data-value="6"></i><b>(6)</b>
    @BlockingHttpClientSettings(port = PORT)
    private BlockingHttpClient blockingHttpClient;

    <i class="conum" data-value="7"></i><b>(7)</b>
    private SystemOut systemOut;

    @Test
    void test() {
        final ClientHttpResponse response = blockingHttpClient.get("/");

        assertEquals(200, response.getStatusCode()); <i class="conum" data-value="8"></i><b>(8)</b>
        assertTrue(response.isBodyEmpty(), "Body not empty: " + response.getBody());<i class="conum" data-value="8"></i><b>(8)</b>
        assertEquals("handle", systemOut.asString()); <i class="conum" data-value="9"></i><b>(9)</b>
    }

    @AfterAll
    static void afterAll() throws InterruptedException {
        serverInstance.shutdownAndWait();
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/RxMicroIntegrationTest.java" target="_blank" rel="noopener"><code>@RxMicroIntegrationTest</code></a>
annotation informs the RxMicro framework that this test is an integration test.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The constant declares the port that will be used to start the HTTP server.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The integration test requires the developer to start the HTTP server manually.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Before running the HTTP server, You must set the necessary HTTP port.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The configuration and start of the HTTP server must be done before running the test method.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Since a port other than the standard HTTP port is used, You need to specify which port the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a> component should use for connecting to the HTTP server.
The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a>
component configuration is performed using the special
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClientSettings.java" target="_blank" rel="noopener"><code>@BlockingHttpClientSettings</code></a> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The integration test supports the possibility of creating the <code>System.out</code> mock.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>After receiving a response from the microservice, ensure that the request has been executed successfully.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>After receiving a response from the microservice, ensure that the microservice has sent the specified message to the <code>System.out</code>.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This integration test demonstrates <strong>all</strong> features of the integration test activated by the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/RxMicroIntegrationTest.java" target="_blank" rel="noopener"><code>@RxMicroIntegrationTest</code></a> annotation.</p>
</div>
<div class="paragraph">
<p>Thus, the integration test unlike the REST-based microservice test can only inject a blocking HTTP client and create a mock for the <code>System.out</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To get additional info about writing tests that require JSON object comparison, please read <a href="#core-json-rxmicro-json-module-usage"><code>rxmicro.json</code> Module Usage</a> section.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-integration-basic" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-integration-basic</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When compiling, the RxMicro framework searches for <code>RxMicro Annotations</code> in the source code and generates additional classes necessary for the integral work of the microservice.</p>
</div>
<div class="paragraph">
<p><strong>When changing the <code>RxMicro Annotations</code> in the source code, DON&#8217;T FORGET to recompile the ALL source code, not just the changed file, for the changes to take effect:</strong> <code>mvn clean compile</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="testing-BlockingHttpClient-settings-section"><a class="anchor" href="#testing-BlockingHttpClient-settings-section"></a><a class="link" href="#testing-BlockingHttpClient-settings-section">14.8.2. The <code>BlockingHttpClient</code> Settings</a></h4>
<div class="paragraph">
<p>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClient.java" target="_blank" rel="noopener"><code>BlockingHttpClient</code></a> component, which is used for writing REST-based microservices and integration tests, is configured by the
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/BlockingHttpClientSettings.java" target="_blank" rel="noopener"><code>@BlockingHttpClientSettings</code></a> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">private static final int SERVER_PORT = getRandomFreePort(); <i class="conum" data-value="4"></i><b>(4)</b>

@BlockingHttpClientSettings(
        schema = HTTPS,                     <i class="conum" data-value="1"></i><b>(1)</b>
        host = "examples.rxmicro.io",       <i class="conum" data-value="2"></i><b>(2)</b>
        port = 9876,                        <i class="conum" data-value="3"></i><b>(3)</b>
        randomPortProvider = "SERVER_PORT", <i class="conum" data-value="4"></i><b>(4)</b>
        versionValue = "v1.1",              <i class="conum" data-value="5"></i><b>(5)</b>
        versionStrategy = HEADER,           <i class="conum" data-value="6"></i><b>(6)</b>
        requestTimeout = 15,                <i class="conum" data-value="7"></i><b>(7)</b>
        followRedirects = Option.ENABLED    <i class="conum" data-value="8"></i><b>(8)</b>
)
private BlockingHttpClient blockingHttpClient;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>schema</code> parameter allows You to specify the HTTP protocol schema.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>host</code> parameter allows You to specify the remote host on which the microservice is running.<br>
<em>(This parameter allows performing integration testing for remote microservices.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>port</code> parameter allows You to specify the static connection port.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The <code>randomPortProvider</code> parameter allows You to specify the dynamic connection port.<br>
<em>(The port will be read from the static final variable of the current class with the <code>SERVER_PORT</code> name.)</em><br>
<em>(The <code>port</code> and <code>randomPortProvider</code> parameters are mutually exclusive.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The <code>versionValue</code> allows You to specify <a href="#rest-controller-versioning-section">the microservice version</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The <code>versionStrategy</code> parameter allows specifying <a href="#rest-controller-versioning-section">the versioning strategy</a>, which is used in the tested microservice.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The <code>requestTimeout</code> parameter allows specifying the request timeout.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>The <code>followRedirects</code> parameter returns follow redirect option for the blocking HTTP client</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="testing-integration-tests-docker-section"><a class="anchor" href="#testing-integration-tests-docker-section"></a><a class="link" href="#testing-integration-tests-docker-section">14.8.3. The <code>docker</code> Usage</a></h4>
<div class="paragraph">
<p>To perform the integration testing of microservices, it is convenient to use the <code>docker</code>.</p>
</div>
<div class="paragraph">
<p>This demonstration example uses the <code>docker</code> image: <a href="https://hub.docker.com/r/rxmicro/simple-hello-world" target="_blank" rel="noopener"><code>rxmicro/simple-hello-world</code></a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The source code of the project, on the basis of which this <code>docker</code> image was built, is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/docker-image-hello-world-microservice" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/docker-image-hello-world-microservice</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To start the <code>docker</code> containers in the integration test it is convenient to use the  <a href="https://www.testcontainers.org/" target="_blank" rel="noopener"><code>Testcontainers</code></a> Java library:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><i class="conum" data-value="1"></i><b>(1)</b>
@RxMicroIntegrationTest
<i class="conum" data-value="2"></i><b>(2)</b>
@Testcontainers
final class HelloWorldMicroService_IT {

    <i class="conum" data-value="3"></i><b>(3)</b>
    @Container
    private static final DockerComposeContainer&lt;?&gt; compose =
            new DockerComposeContainer&lt;&gt;(new File("docker-compose.yml").getAbsoluteFile())
                    .withLocalCompose(true)
                    .withPull(false)
                    .withTailChildContainers(true)
                    .waitingFor("rxmicro-hello-world", Wait.forHttp("/http-health-check"));

    private BlockingHttpClient blockingHttpClient;

    @Test
    void Should_return_Hello_World() {
        final ClientHttpResponse response = blockingHttpClient.get("/");

        assertEquals(jsonObject("message", "Hello World!"), response.getBody()); <i class="conum" data-value="4"></i><b>(4)</b>
        assertEquals(200, response.getStatusCode());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-junit/src/main/java/io/rxmicro/test/junit/RxMicroIntegrationTest.java" target="_blank" rel="noopener"><code>@RxMicroIntegrationTest</code></a>
annotation informs the RxMicro framework that this test is an integration test.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <a href="https://github.com/testcontainers/testcontainers-java/blob/main/modules/junit-jupiter/src/main/java/org/testcontainers/junit/jupiter/Testcontainers.java" target="_blank" rel="noopener"><code>@Testcontainers</code></a>
annotation activates the start and stop of the <code>docker</code> containers to be used in this test.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <a href="https://github.com/testcontainers/testcontainers-java/blob/main/modules/junit-jupiter/src/main/java/org/testcontainers/junit/jupiter/Container.java" target="_blank" rel="noopener"><code>@Container</code></a>
annotation indicates the <code>docker</code> container to be used in this test.
<em>(To start microservices in the <code>docker</code> containers the <code>docker-compose</code> utility is used.)</em></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>During the testing process, ensure that the tested microservice returns the <code>"Hello World!"</code> message.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To start the REST-based microservice in the <code>docker</code> container, the following configuration file for the <code>docker-compose</code> utility is used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">version: '3.7'
services:
  rxmicro-hello-world:
    image: rxmicro/simple-hello-world
    ports:
      - 8080:8080
    healthcheck:
      test: wget http://localhost:8080/http-health-check || exit 1
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To get additional info about writing tests that require JSON object comparison, please read <a href="#core-json-rxmicro-json-module-usage"><code>rxmicro.json</code> Module Usage</a> section.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-integration-docker" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-junit/testing-integration-docker</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="testing-dbunit-tests-section"><a class="anchor" href="#testing-dbunit-tests-section"></a><a class="link" href="#testing-dbunit-tests-section">14.9. Database Testing Using DBUnit</a></h3>
<div class="paragraph">
<p><a href="http://dbunit.sourceforge.net/" target="_blank" rel="noopener">DbUnit</a> is an extension targeted at database-driven projects that, among other things, puts your database into a known state between test runs.
This is an excellent way to avoid the myriad of problems that can occur when one test case corrupts the database and causes subsequent tests to fail or exacerbate the damage.</p>
</div>
<div style="page-break-after: always;"></div>
<div class="sect3">
<h4 id="testing-dbunit-test-database-config"><a class="anchor" href="#testing-dbunit-test-database-config"></a><a class="link" href="#testing-dbunit-test-database-config">14.9.1. Test Database Configuration</a></h4>
<div class="paragraph">
<p>To communicate with test database the RxMicro framework uses the predefined
<a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test-dbunit/src/main/java/io/rxmicro/test/dbunit/TestDatabaseConfig.java" target="_blank" rel="noopener"><code>TestDatabaseConfig</code></a> config class.
This class is <a href="#configuration-basic-structure-section">the usual RxMicro configuration class</a>.</p>
</div>
<div class="paragraph">
<p>It means that settings for test database can be configured using:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>test-database.properties</code> classpath resource.</p>
</li>
<li>
<p><code>./test-database.properties</code> file.</p>
</li>
<li>
<p><code>$HOME/test-database.properties</code> file.</p>
</li>
<li>
<p><code>$HOME/.rxmicro/test-database.properties</code> file.</p>
</li>
<li>
<p>environment variables.</p>
</li>
<li>
<p>Java system properties.</p>
</li>
<li>
<p><a href="#testing-annotations-WithConfig-inline"><code>@WithConfig</code></a> annotation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Besides that the settings for test database can be changed using <code>TestDatabaseConfig.getCurrentTestDatabaseConfig()</code> static method.
This approach useful if test database is working at the <a href="https://www.docker.com/" target="_blank" rel="noopener">docker</a> container:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@BeforeEach
void beforeEach() {
    getCurrentTestDatabaseConfig()
            .setHost(postgresqlTestDockerContainer.getHost())
            .setPort(postgresqlTestDockerContainer.getFirstMappedPort());
}</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="testing-dbunit-retrieve-connection-strategies"><a class="anchor" href="#testing-dbunit-retrieve-connection-strategies"></a><a class="link" href="#testing-dbunit-retrieve-connection-strategies">14.9.2. Retrieve Connection Strategies</a></h4>
<div class="paragraph">
<p>The RxMicro framework provides the following retrieve connection to the test database strategies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One connection per all test classes.</p>
</li>
<li>
<p>One connection per test class (<strong>default strategy</strong>).</p>
</li>
<li>
<p>One connection per test method.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="one_connection_per_all_test_classes"><a class="anchor" href="#one_connection_per_all_test_classes"></a><a class="link" href="#one_connection_per_all_test_classes">14.9.2.1. One connection per all test classes</a></h5>
<div class="paragraph">
<p>This strategy informs the DBUnit to use single connection per all tests for your project.<br>
The RxMicro team recommends using this strategy for external databases only.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroIntegrationTest
@Testcontainers
<i class="conum" data-value="1"></i><b>(1)</b>
@DbUnitTest(retrieveConnectionStrategy = PER_ALL_TEST_CLASSES)
@TestMethodOrder(MethodOrderer.OrderAnnotation.class)
// FIXME "org.postgresql.util.PSQLException: FATAL: the database system is starting up" and remove @Ignore
@Ignore
final class DbStateUsingPerAllTestClassesConnectionTest {

    private static final int DB_PORT = getRandomFreePort();

    @WithConfig
    private static final TestDatabaseConfig CONFIG = new TestDatabaseConfig()
            .setType(DatabaseType.POSTGRES)
            .setPort(DB_PORT)
            .setUser("rxmicro")
            .setPassword("password")
            .setDatabase("rxmicro");

    @Container
    private static final GenericContainer&lt;?&gt; POSTGRESQL_TEST_DB =
            new FixedHostPortGenericContainer&lt;&gt;("rxmicro/postgres-test-db")
                    .withExposedPorts(5432)
                    .withFixedExposedPort(DB_PORT, 5432);

    @Test
    @ExpectedDataSet("dataset/rxmicro-test-dataset.xml")
    @Order(1)
    void Should_contain_expected_dataset() {

    }

    @Test
    @InitialDataSet("dataset/rxmicro-test-dataset-two-rows-only.xml")
    @ExpectedDataSet("dataset/rxmicro-test-dataset-two-rows-only.xml")
    @Order(2)
    void Should_set_and_compare_dataset() {

    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-basic" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-basic</code></a></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="one_connection_per_test_class"><a class="anchor" href="#one_connection_per_test_class"></a><a class="link" href="#one_connection_per_test_class">14.9.2.2. One connection per test class</a></h5>
<div class="paragraph">
<p>This strategy informs the DBUnit to create a new connection before run all tests for each test class and to close after running all tests for each test class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroIntegrationTest
@Testcontainers
<i class="conum" data-value="1"></i><b>(1)</b>
@DbUnitTest
@TestMethodOrder(MethodOrderer.OrderAnnotation.class)
// FIXME "org.postgresql.util.PSQLException: FATAL: the database system is starting up" and remove @Ignore
@Ignore
final class DbStateUsingPerClassConnectionTest {

    @Container
    private static final GenericContainer&lt;?&gt; POSTGRESQL_TEST_DB =
            new GenericContainer&lt;&gt;("rxmicro/postgres-test-db")
                    .withExposedPorts(5432);

    @BeforeAll
    static void beforeAll() {
        getCurrentTestDatabaseConfig()
                .setHost(POSTGRESQL_TEST_DB.getHost())
                .setPort(POSTGRESQL_TEST_DB.getFirstMappedPort());
    }

    @Test
    @ExpectedDataSet("dataset/rxmicro-test-dataset.xml")
    @Order(1)
    void Should_contain_expected_dataset() {

    }

    @Test
    @InitialDataSet("dataset/rxmicro-test-dataset-two-rows-only.xml")
    @ExpectedDataSet("dataset/rxmicro-test-dataset-two-rows-only.xml")
    @Order(2)
    void Should_set_and_compare_dataset() {

    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-basic" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-basic</code></a></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="one_connection_per_test_method"><a class="anchor" href="#one_connection_per_test_method"></a><a class="link" href="#one_connection_per_test_method">14.9.2.3. One connection per test method</a></h5>
<div class="paragraph">
<p>This strategy informs the DBUnit to create a new connection before each test method and to close after each one.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroIntegrationTest
@Testcontainers
<i class="conum" data-value="1"></i><b>(1)</b>
@DbUnitTest(retrieveConnectionStrategy = PER_TEST_METHOD)
@TestMethodOrder(MethodOrderer.OrderAnnotation.class)
// FIXME "org.postgresql.util.PSQLException: FATAL: the database system is starting up" and remove @Ignore
@Ignore
final class DbStateUsingPerMethodConnectionTest {

    @Container
    private final GenericContainer&lt;?&gt; postgresqlTestDb =
            new GenericContainer&lt;&gt;("rxmicro/postgres-test-db")
                    .withExposedPorts(5432);

    @BeforeEach
    void beforeEach() {
        getCurrentTestDatabaseConfig()
                .setHost(postgresqlTestDb.getHost())
                .setPort(postgresqlTestDb.getFirstMappedPort());
    }

    @Test
    @ExpectedDataSet("dataset/rxmicro-test-dataset.xml")
    @Order(1)
    void Should_contain_expected_dataset() {

    }

    @Test
    @InitialDataSet("dataset/rxmicro-test-dataset-two-rows-only.xml")
    @ExpectedDataSet("dataset/rxmicro-test-dataset-two-rows-only.xml")
    @Order(2)
    void Should_set_and_compare_dataset() {

    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-basic" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-basic</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect3">
<h4 id="testing-dbunit-initial-data-set"><a class="anchor" href="#testing-dbunit-initial-data-set"></a><a class="link" href="#testing-dbunit-initial-data-set">14.9.3. <code>@InitialDataSet</code> Annotation</a></h4>
<div class="paragraph">
<p>The <code>@InitialDataSet</code> annotation inform the RxMicro framework that it is necessary to prepare the tested database using <a href="http://dbunit.sourceforge.net/" target="_blank" rel="noopener">DbUnit</a> framework before test execution.
The <code>@InitialDataSet</code> annotation contains the dataset files that must be exported to the tested database before test execution.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
<i class="conum" data-value="1"></i><b>(1)</b>
@InitialDataSet("dataset/rxmicro-test-dataset-two-rows-only.xml")
void prepare_database() {
    // do something with prepared database
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Using data from the <code>@InitialDataSet</code> annotation the RxMicro framework prepares the tested database.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The init dataset can be provided using <a href="https://dbunit.sourceforge.net/org/dbunit/dataset/xml/FlatXmlDataSet.html" target="_blank" rel="noopener"><code>flat xml</code></a> format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;!DOCTYPE dataset SYSTEM "rxmicro-test-dataset.dtd"&gt;

&lt;dataset&gt;
    &lt;account id="1"
             email="richard.hendricks@piedpiper.com"
             first_name="Richard"
             last_name="Hendricks"
             balance="70000.00"
             role="CEO"/&gt;
    &lt;account id="3"
             email="dinesh.chugtai@piedpiper.com"
             first_name="Dinesh"
             last_name="Chugtai"
             balance="10000.00"
             role="Lead_Engineer"/&gt;

    &lt;product id="24"
             name="Apple iMac 27&amp;quot; with Retina 5K Display Late (MQ2Y2)"
             price="6200.00"
             count="7"/&gt;
    &lt;product id="25"
             name="Apple iMac 27&amp;quot; 2017 5K (MNEA2)"
             price="2100.00"
             count="17"/&gt;

    &lt;order/&gt;
&lt;/dataset&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-basic" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-basic</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="testing-dbunit-expected-data-set"><a class="anchor" href="#testing-dbunit-expected-data-set"></a><a class="link" href="#testing-dbunit-expected-data-set">14.9.4. <code>@ExpectedDataSet</code> Annotation</a></h4>
<div class="paragraph">
<p>The <code>@ExpectedDataSet</code> annotation inform the RxMicro framework that it is necessary to compare the actual database state with the expected one, defined using dataset file(s) after test execution.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
<i class="conum" data-value="1"></i><b>(1)</b>
@ExpectedDataSet("dataset/rxmicro-test-dataset-two-rows-only.xml")
void verify_database_state() {
    // change database state
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Using data from the <code>@ExpectedDataSet</code> annotation the RxMicro framework compares actual database state with the expected one after test execution.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The expected dataset can be provided using <a href="https://dbunit.sourceforge.net/org/dbunit/dataset/xml/FlatXmlDataSet.html" target="_blank" rel="noopener"><code>flat xml</code></a> format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;!DOCTYPE dataset SYSTEM "rxmicro-test-dataset.dtd"&gt;

&lt;dataset&gt;
    &lt;account id="1"
             email="richard.hendricks@piedpiper.com"
             first_name="Richard"
             last_name="Hendricks"
             balance="70000.00"
             role="CEO"/&gt;
    &lt;account id="3"
             email="dinesh.chugtai@piedpiper.com"
             first_name="Dinesh"
             last_name="Chugtai"
             balance="10000.00"
             role="Lead_Engineer"/&gt;

    &lt;product id="24"
             name="Apple iMac 27&amp;quot; with Retina 5K Display Late (MQ2Y2)"
             price="6200.00"
             count="7"/&gt;
    &lt;product id="25"
             name="Apple iMac 27&amp;quot; 2017 5K (MNEA2)"
             price="2100.00"
             count="17"/&gt;

    &lt;order/&gt;
&lt;/dataset&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-basic" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-basic</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="testing-dbunit-rollback-changes"><a class="anchor" href="#testing-dbunit-rollback-changes"></a><a class="link" href="#testing-dbunit-rollback-changes">14.9.5. <code>@RollbackChanges</code> Annotation</a></h4>
<div class="paragraph">
<p>The <code>@RollbackChanges</code> annotation starts a new transaction before initialization of database by the <code>@InitialDataSet</code> annotation (if it is present) and rolls back this transaction after comparing actual database state with expected one provided by the <code>@ExpectedDataSet</code> annotation (if it is present).</p>
</div>
<div class="paragraph">
<p>The isolation level of the test transaction can be configured using <code>isolationLevel</code> parameter declared at the <code>@RollbackChanges</code> annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RxMicroIntegrationTest
@Testcontainers
<i class="conum" data-value="1"></i><b>(1)</b>
@DbUnitTest
@TestMethodOrder(MethodOrderer.OrderAnnotation.class)
// FIXME "org.postgresql.util.PSQLException: FATAL: the database system is starting up" and remove @Ignore
@Ignore
final class RollbackChangesTest {

    @Container
    private static final GenericContainer&lt;?&gt; POSTGRESQL_TEST_DB =
            new GenericContainer&lt;&gt;("rxmicro/postgres-test-db")
                    .withExposedPorts(5432);

    @BeforeAll
    static void beforeAll() {
        getCurrentTestDatabaseConfig()
                .setHost(POSTGRESQL_TEST_DB.getHost())
                .setPort(POSTGRESQL_TEST_DB.getFirstMappedPort());
    }

    @Test
    <i class="conum" data-value="2"></i><b>(2)</b>
    @RollbackChanges
    @InitialDataSet("dataset/rxmicro-test-dataset-empty.xml")
    @ExpectedDataSet("dataset/rxmicro-test-dataset-empty.xml")
    @Order(1)
    void Should_set_and_compare_dataset() {

    }

    @Test
    @ExpectedDataSet("dataset/rxmicro-test-dataset.xml")
    @Order(2)
    void Should_contain_expected_dataset() {

    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>For database testing it is necessary to inform the RxMicro framework that current test is DBUnit test.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If test method annotated by the <code>@RollbackChanges</code> annotation all changes made by this test method will be rolled back.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-basic" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-basic</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="testing-dbunit-order-by"><a class="anchor" href="#testing-dbunit-order-by"></a><a class="link" href="#testing-dbunit-order-by">14.9.6. Ordered Comparison</a></h4>
<div class="paragraph">
<p>If the expected dataset is ordered, it is necessary to inform the RxMicro framework how to compare this dataset correctly.
For this case the <code>@ExpectedDataSet</code> annotation has <code>orderBy</code> parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
@ExpectedDataSet(
        value = "dataset/rxmicro-test-dataset-products-order-by-price.xml",
        orderBy = "price" <i class="conum" data-value="1"></i><b>(1)</b>
)
@Order(1)
void Should_contain_expected_dataset() {

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>orderBy</code> parameter contains the column name(s) that must be used to sort the actual dataset before comparison.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>dataset/rxmicro-test-dataset-products-order-by-price.xml</code> dataset is the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;!DOCTYPE dataset SYSTEM "rxmicro-test-dataset.dtd"&gt;

&lt;dataset&gt;
    &lt;product id="19" name="Apple iPod Touch 6 16Ð“Ð± (MKGX2)" price="310.00" count="48"/&gt;
    &lt;product id="17" name="Apple iPod Touch 6 16Ð“Ð± (MKH62)" price="320.00" count="54"/&gt;
    &lt;product id="18" name="Apple iPod Touch 6 32Ð“Ð± (MKJ02)" price="380.00" count="52"/&gt;
    &lt;product id="20" name="Apple iPod Touch 6 32Ð“Ð± (MKHV2)" price="420.00" count="55"/&gt;
    &lt;product id="14" name="Apple iPhone 7 Plus 32GB Black" price="510.00" count="3"/&gt;
    &lt;product id="6" name="Apple iPad (2019) 10.2&amp;quot; Wi-Fi 32GB Gold (MW762)" price="540.00"
             count="32"/&gt;
    &lt;product id="7" name="Apple iPad (2019) 10.2&amp;quot; Wi-Fi 128GB Silver (MW782)" price="620.00"
             count="37"/&gt;
    &lt;product id="8" name="Apple iPad mini 5 Wi-Fi 64Gb Space Gray (MUQW2)" price="645.00"
             count="26"/&gt;
    &lt;product id="12" name="Apple iPhone Xr 64GB Black (MRY42)" price="760.00" count="14"/&gt;
    &lt;product id="10" name="Apple iPhone Xs 64GB Space Gray (MT9E2)" price="840.00" count="21"/&gt;
    &lt;product id="13" name="Apple iPhone Xs 256GB Space Gray (MT9H2)" price="910.00" count="10"/&gt;
    &lt;product id="11" name="Apple iPhone 11 128GB Black" price="980.00" count="18"/&gt;
    &lt;product id="2" name="Apple MacBook A1534 12&amp;quot; Space Gray (MNYF2)" price="985.00"
             count="12"/&gt;
    &lt;product id="9" name="Apple iPad Pro 11&amp;quot; Wi-Fi 64GB Space Gray 2018 (MTXN2)" price="1100.00"
             count="18"/&gt;
    &lt;product id="4" name="Apple MacBook Pro 13 Retina Space Gray (MPXT2) 2017" price="1345.00"
             count="17"/&gt;
    &lt;product id="15" name="Apple iPhone 11 Pro 64GB Space Gray" price="1450.00" count="42"/&gt;
    &lt;product id="16" name="Apple iPhone 11 Pro 256GB Midnight Green" price="1720.00" count="38"/&gt;
    &lt;product id="22" name="Apple iMac 21.5&amp;apos; Middle 2017 (MMQA2)" price="1740.00" count="14"/&gt;
    &lt;product id="5" name="Apple MacBook Pro 15&amp;quot; Retina Z0RF00052 (Mid 2015)" price="1860.00"
             count="11"/&gt;
    &lt;product id="23" name="Apple iMac 21&amp;quot; Retina 4K MRT32 (Early 2019)" price="1920.00"
             count="11"/&gt;
    &lt;product id="25" name="Apple iMac 27&amp;quot; 2017 5K (MNEA2)" price="2100.00" count="17"/&gt;
    &lt;product id="3" name="Apple MacBook Pro 16&amp;quot; 512GB 2019 (MVVJ2) Space Gray" price="2540.00"
             count="8"/&gt;
    &lt;product id="1" name="Apple MacBook Pro 15&amp;quot; Retina Z0WW00024 Space Gray" price="5750.00"
             count="10"/&gt;
    &lt;product id="24" name="Apple iMac 27&amp;quot; with Retina 5K Display Late (MQ2Y2)" price="6200.00"
             count="7"/&gt;
    &lt;product id="21" name="Apple iMac Pro 27&amp;quot; Z0UR000AC / Z0UR8 (Late 2017)" price="7800.00"
             count="6"/&gt;
&lt;/dataset&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-basic" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-basic</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="testing-dbunit-supported-expressions"><a class="anchor" href="#testing-dbunit-supported-expressions"></a><a class="link" href="#testing-dbunit-supported-expressions">14.9.7. Supported Expressions</a></h4>
<div class="paragraph">
<p>The RxMicro framework supports expressions for datasets.<br>
Expressions can be useful to set dynamic parameters.</p>
</div>
<div class="paragraph">
<p>The RxMicro framework supports the following expressions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>${null}</code> - null value.</p>
</li>
<li>
<p><code>${now}</code> - is <code>java.time.Instant.now()</code> value for the initial dataset;</p>
<div class="ulist">
<ul>
<li>
<p><code>${instant:now}</code> is alias for <code>${now}</code>;</p>
</li>
<li>
<p><code>${timestamp:now}</code> is alias for <code>${now}</code>;</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>${now}</code> - is <code>java.time.Instant.now()</code> value for the expected dataset;</p>
<div class="ulist">
<ul>
<li>
<p><code>${instant:now}</code> is alias for <code>${now}</code>;</p>
</li>
<li>
<p><code>${timestamp:now}</code> is alias for <code>${now}</code>;</p>
</li>
<li>
<p><code>${now:${CUSTOM-DURATION}}</code> is alias for <code>${now}</code>;</p>
</li>
<li>
<p><code>${instant:now:${CUSTOM-DURATION}}</code> is alias for <code>${now}</code>;</p>
</li>
<li>
<p><code>${timestamp:now:${CUSTOM-DURATION}}</code> is alias for <code>${now}</code>;</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>${interval:${MIN}:${MAX}}</code> - is an instant interval that can be compared with <code>java.time.Instant</code> and <code>java.sql.Timestamp</code> instances correctly.</p>
<div class="ulist">
<ul>
<li>
<p><code>${interval:${MEDIAN}:${LEFT-DELTA}:${RIGHT-DELTA}}</code> is alias for <code>${interval:${MIN}:${MAX}}</code>;</p>
</li>
<li>
<p><code>${instant:interval:${MEDIAN}:${LEFT-DELTA}:${RIGHT-DELTA}}</code> is alias for <code>${interval:${MIN}:${MAX}}</code>;</p>
</li>
<li>
<p><code>${timestamp:interval:${MEDIAN}:${LEFT-DELTA}:${RIGHT-DELTA}}</code> is alias for <code>${interval:${MIN}:${MAX}}</code>;</p>
</li>
<li>
<p><code>${instant:interval:${MIN}:${MAX}}</code> is alias for <code>${interval:${MIN}:${MAX}}</code>;</p>
</li>
<li>
<p><code>${timestamp:interval:${MIN}:${MAX}}</code> is alias for <code>${interval:${MIN}:${MAX}}</code>;</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>${int:interval:${MIN}:${MAX}}</code> - is an integer number interval that can be compared with <code>java.lang.Short</code>, <code>java.lang.Integer</code> and <code>java.lang.Long</code> instances correctly.</p>
<div class="ulist">
<ul>
<li>
<p><code>${integer:interval:${MIN}:${MAX}}</code> is alias for <code>${int:interval:${MIN}:${MAX}}</code>;</p>
</li>
<li>
<p><code>${tinyint:interval:${MIN}:${MAX}}</code> is alias for <code>${int:interval:${MIN}:${MAX}}</code>;</p>
</li>
<li>
<p><code>${short:interval:${MIN}:${MAX}}</code> is alias for <code>${int:interval:${MIN}:${MAX}}</code>;</p>
</li>
<li>
<p><code>${smallint:interval:${MIN}:${MAX}}</code> is alias for <code>${int:interval:${MIN}:${MAX}}</code>;</p>
</li>
<li>
<p><code>${long:interval:${MIN}:${MAX}}</code> is alias for <code>${int:interval:${MIN}:${MAX}}</code>;</p>
</li>
<li>
<p><code>${bigint:interval:${MIN}:${MAX}}</code> is alias for <code>${int:interval:${MIN}:${MAX}}</code>;</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
<div class="sect4">
<h5 id="testing-dbunit-supported-expressions-null"><a class="anchor" href="#testing-dbunit-supported-expressions-null"></a><a class="link" href="#testing-dbunit-supported-expressions-null">14.9.7.1. <code>${null}</code> Expression</a></h5>
<div class="paragraph">
<p>If dataset must contain <code>null</code> value, the <code>${null}</code> expression must be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;!DOCTYPE dataset SYSTEM "rxmicro-test-dataset.dtd"&gt;

&lt;dataset&gt;
    &lt;account id="1"
             email="richard.hendricks@piedpiper.com"
             first_name="Richard"
             last_name="Hendricks"
             role="CEO"
             balance="${null}"/&gt; <i class="conum" data-value="1"></i><b>(1)</b>
&lt;/dataset&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Set <code>null</code> value to the <code>balance</code> column.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
@InitialDataSet(
        <i class="conum" data-value="1"></i><b>(1)</b>
        value = "dataset/with-null-expression-dataset.xml",
        <i class="conum" data-value="2"></i><b>(2)</b>
        executeStatementsBefore = "ALTER TABLE account ALTER COLUMN balance DROP NOT NULL")
<i class="conum" data-value="4"></i><b>(4)</b>
@ExpectedDataSet("dataset/with-null-expression-dataset.xml")
void Should_set_and_compare_null_correctly() throws SQLException {
    try (Connection connection = getJDBCConnection()) {
        try (Statement st = connection.createStatement()) {
            try (ResultSet rs = st.executeQuery("SELECT balance FROM account WHERE id=1")) {
                if (rs.next()) {
                    <i class="conum" data-value="3"></i><b>(3)</b>
                    assertNull(rs.getTimestamp(1, GREGORIAN_CALENDAR_WITH_UTC_TIME_ZONE));
                } else {
                    fail("Test database does not contain account with id=1");
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The dataset with <code>${null}</code> expression.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The test database does not support <code>null</code> values for <code>account.balance</code> column.
To demonstrate how <code>${null}</code> expression is worked it is necessary to drop <code>NOT NULL</code> constraint.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The actual row contains <code>null</code> value.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>After test execution the test database must contain <code>null</code> value.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-expressions" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-expressions</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect4">
<h5 id="testing-dbunit-supported-expressions-now"><a class="anchor" href="#testing-dbunit-supported-expressions-now"></a><a class="link" href="#testing-dbunit-supported-expressions-now">14.9.7.2. <code>${now}</code> Expression</a></h5>
<div class="paragraph">
<p>The <code>${now}</code> expression useful if it is necessary to work with current instant: set and compare.</p>
</div>
<div class="paragraph">
<p>If dataset must contain <code>java.time.Instant.now()</code> value, the <code>${now}</code> expression must be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;!DOCTYPE dataset SYSTEM "rxmicro-test-dataset.dtd"&gt;

&lt;dataset&gt;
    &lt;order id="1"
           id_account="1"
           id_product="1"
           count="10"
           created="${now}"/&gt; <i class="conum" data-value="1"></i><b>(1)</b>
&lt;/dataset&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Set current instant value to the <code>created</code> column.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
@InitialDataSet(
        <i class="conum" data-value="1"></i><b>(1)</b>
        value = "dataset/with-now-expression-dataset.xml",
        <i class="conum" data-value="2"></i><b>(2)</b>
        executeStatementsBefore = {
                "ALTER TABLE \"order\" DROP CONSTRAINT IF EXISTS order_fk_account",
                "ALTER TABLE \"order\" DROP CONSTRAINT IF EXISTS order_fk_product"
        })
<i class="conum" data-value="3"></i><b>(3)</b>
@ExpectedDataSet("dataset/with-now-expression-dataset.xml")
void Should_set_and_compare_now_correctly() throws SQLException {
    try (Connection connection = getJDBCConnection()) {
        try (Statement st = connection.createStatement()) {
            try (ResultSet rs = st.executeQuery("SELECT created FROM \"order\" WHERE id=1")) {
                if (rs.next()) {
                    <i class="conum" data-value="4"></i><b>(4)</b>
                    final Instant actual =
                            rs.getTimestamp(1, GREGORIAN_CALENDAR_WITH_UTC_TIME_ZONE).toInstant();
                    <i class="conum" data-value="5"></i><b>(5)</b>
                    assertInstantEquals(Instant.now(), actual);
                } else {
                    fail("Test database does not contain order with id=1");
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The dataset with <code>${now}</code> expression.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The test database contains foreign keys.
To demonstrate how <code>${now}</code> expression is worked it is necessary to drop these foreign keys.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The expected dataset must contain current instant value too.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The actual row contains current instant value.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>To compare current instant value it is necessary to use <code>ExAssertions.assertInstantEquals</code> method.
This method verifies that instants are equal within the default <code>delta</code> configured via <a href="https://github.com/rxmicro/rxmicro/blob/v0.11/rxmicro-test/src/main/java/io/rxmicro/test/GlobalTestConfig.java" target="_blank" rel="noopener"><code>GlobalTestConfig</code></a> config class.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>${now}</code> expression can be used to verify that unit test creates <code>java.time.Instant.now()</code> value:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
@InitialDataSet(
        <i class="conum" data-value="1"></i><b>(1)</b>
        value = "dataset/empty-database.xml",
        <i class="conum" data-value="2"></i><b>(2)</b>
        executeStatementsBefore = {
                "ALTER TABLE \"order\" DROP CONSTRAINT IF EXISTS order_fk_account",
                "ALTER TABLE \"order\" DROP CONSTRAINT IF EXISTS order_fk_product"
        })
<i class="conum" data-value="4"></i><b>(4)</b>
@ExpectedDataSet("dataset/with-now-expression-dataset.xml")
void Should_compare_now_correctly() throws SQLException {
    final String sql = "INSERT INTO \"order\" VALUES(?,?,?,?,?)";
    try (Connection connection = getJDBCConnection()) {
        try (PreparedStatement st = connection.prepareStatement(sql)) {
            st.setInt(1, 1);
            st.setInt(2, 1);
            st.setInt(3, 1);
            st.setInt(4, 10);
            final Timestamp now = Timestamp.from(Instant.now()); <i class="conum" data-value="3"></i><b>(3)</b>
            st.setTimestamp(5, now, GREGORIAN_CALENDAR_WITH_UTC_TIME_ZONE);
            st.executeUpdate();
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The empty dataset.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The test database contains foreign keys.
To demonstrate how <code>${now}</code> expression is worked it is necessary to drop these foreign keys.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>java.time.Instant.now()</code> value is stored to test database.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>After test execution the test database must contain <code>java.time.Instant.now()</code> value.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>dataset/with-now-expression-dataset.xml</code> classpath resource contains the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;!DOCTYPE dataset SYSTEM "rxmicro-test-dataset.dtd"&gt;

&lt;dataset&gt;
    &lt;order id="1"
           id_account="1"
           id_product="1"
           count="10"
           created="${now}"/&gt; <i class="conum" data-value="1"></i><b>(1)</b>
&lt;/dataset&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>created</code> column must contain <code>java.time.Instant.now()</code> value.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-expressions" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-expressions</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect4">
<h5 id="testing-dbunit-supported-expressions-int-interval"><a class="anchor" href="#testing-dbunit-supported-expressions-int-interval"></a><a class="link" href="#testing-dbunit-supported-expressions-int-interval">14.9.7.3. <code>${instant:interval}</code> Expression</a></h5>
<div class="paragraph">
<p>The <code>${instant:interval}</code> expression allows comparing this expression with <code>java.time.Instant</code> and <code>java.sql.Timestamp</code> instances correctly.</p>
</div>
<div class="paragraph">
<p>This expression is useful if Your business logic generates random instant value within predefined boundaries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
@InitialDataSet(
        <i class="conum" data-value="1"></i><b>(1)</b>
        value = "dataset/empty-database.xml",
        <i class="conum" data-value="2"></i><b>(2)</b>
        executeStatementsBefore = {
                "ALTER TABLE \"order\" DROP CONSTRAINT IF EXISTS order_fk_account",
                "ALTER TABLE \"order\" DROP CONSTRAINT IF EXISTS order_fk_product"
        })
<i class="conum" data-value="4"></i><b>(4)</b>
@ExpectedDataSet("dataset/with-instant-interval-expression-dataset.xml")
void Should_compare_instant_interval_correctly() throws SQLException {
    final String sql = "INSERT INTO \"order\" VALUES(?,?,?,?,?)";
    try (Connection connection = getJDBCConnection()) {
        try (PreparedStatement st = connection.prepareStatement(sql)) {
            st.setInt(1, 1);
            st.setInt(2, 1);
            st.setInt(3, 1);
            st.setInt(4, 10);
            final Duration duration = Duration.ofSeconds(new Random().nextInt(10) + 1);
            final Timestamp now = Timestamp.from(Instant.now().plus(duration)); <i class="conum" data-value="3"></i><b>(3)</b>
            st.setTimestamp(5, now, GREGORIAN_CALENDAR_WITH_UTC_TIME_ZONE);
            st.executeUpdate();
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The empty dataset.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The test database contains foreign keys.
To demonstrate how <code>${now}</code> expression is worked it is necessary to drop these foreign keys.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>java.time.Instant.now() + [1 SECOND - 10 SECOND]</code> value is stored to test database.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>After test execution the test database must contain <code>java.time.Instant.now() + [1 SECOND - 10 SECOND]</code> value.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>dataset/with-now-expression-dataset.xml</code> classpath resource contains the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;!DOCTYPE dataset SYSTEM "rxmicro-test-dataset.dtd"&gt;

&lt;dataset&gt;
    &lt;order id="1"
           id_account="1"
           id_product="1"
           count="10"
           created="${interval:now:PT1S:PT12S}"/&gt; <i class="conum" data-value="1"></i><b>(1)</b>
&lt;/dataset&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>created</code> column must contain <code>java.time.Instant.now() + [1 SECOND - 12 SECOND]</code> value.
<code>12</code> instead of <code>10</code> is used because 2 second is compare delta!</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-expressions" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-expressions</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect4">
<h5 id="testing-dbunit-supported-expressions-instant-interval"><a class="anchor" href="#testing-dbunit-supported-expressions-instant-interval"></a><a class="link" href="#testing-dbunit-supported-expressions-instant-interval">14.9.7.4. <code>${int:interval}</code> Expression</a></h5>
<div class="paragraph">
<p>The <code>${int:interval}</code> expression allows comparing this expression with <code>java.lang.Short</code>, <code>java.lang.Integer</code> and <code>java.lang.Long</code> instances correctly.</p>
</div>
<div class="paragraph">
<p>This expression is useful if Your business logic generates random integer number value within predefined boundaries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
@InitialDataSet("dataset/empty-database.xml")
<i class="conum" data-value="2"></i><b>(2)</b>
@ExpectedDataSet("dataset/with-int-interval-expression-dataset.xml")
void Should_compare_int_interval_correctly() throws SQLException {
    final String sql = "INSERT INTO product VALUES(?,?,?,?)";
    try (Connection connection = getJDBCConnection()) {
        try (PreparedStatement st = connection.prepareStatement(sql)) {
            st.setInt(1, 1);
            st.setString(2, "name");
            st.setBigDecimal(3, new BigDecimal("6200.00"));
            st.setInt(4, new Random().nextInt(10)); <i class="conum" data-value="1"></i><b>(1)</b>
            st.executeUpdate();
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The actual product count is random value from <code>0</code> to <code>9</code>.
To compare the actual dataset it is necessary to use <code>${int:interval}</code> expression.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>After test execution the test database must contain random integer number value from <code>0</code> to <code>9</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The expected dataset with the integer number interval from <code>0</code> to <code>9</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;!DOCTYPE dataset SYSTEM "rxmicro-test-dataset.dtd"&gt;

&lt;dataset&gt;
    &lt;product id="1"
             name="name"
             price="6200.00"
             count="${int:interval:0:9}"/&gt; <i class="conum" data-value="1"></i><b>(1)</b>
&lt;/dataset&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Set integer number interval from <code>0</code> to <code>9</code>.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The project source code used in the current subsection is available at the following link:</p>
</div>
<div class="paragraph example-code-link">
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-expressions" target="_blank" rel="noopener"><code>https://github.com/rxmicro/rxmicro-usage/tree/master/examples/group-testing-dbunit/testing-dbunit-expressions</code></a></p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="appendices-section"><a class="anchor" href="#appendices-section"></a><a class="link" href="#appendices-section">15. Appendices</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="appendices-faq-section"><a class="anchor" href="#appendices-faq-section"></a><a class="link" href="#appendices-faq-section">15.1. Appendix A: FAQ</a></h3>
<div class="paragraph">
<p>This section covers a list of possible questions that You can ask yourself when You use the RxMicro framework.</p>
</div>
<div class="sect3">
<h4 id="does_the_rxmicro_framework_modify_my_byte_code"><a class="anchor" href="#does_the_rxmicro_framework_modify_my_byte_code"></a><a class="link" href="#does_the_rxmicro_framework_modify_my_byte_code">15.1.1. Does the RxMicro framework modify my byte code?</a></h4>
<div class="paragraph">
<p>No.
Your classes are Your classes.
The RxMicro framework does not transform classes or modify the Java byte code You write.
The RxMicro framework produces additional classes only.</p>
</div>
</div>
<div class="sect3">
<h4 id="can_the_rxmicro_framework_be_used_for_purposes_other_than_microservices"><a class="anchor" href="#can_the_rxmicro_framework_be_used_for_purposes_other_than_microservices"></a><a class="link" href="#can_the_rxmicro_framework_be_used_for_purposes_other_than_microservices">15.1.2. Can the RxMicro framework be used for purposes other than microservices?</a></h4>
<div class="paragraph">
<p>Yes.
The RxMicro framework is very modular and You can choose to use any module You need.</p>
</div>
</div>
<div class="sect3">
<h4 id="why_i_receive_class_not_found_error"><a class="anchor" href="#why_i_receive_class_not_found_error"></a><a class="link" href="#why_i_receive_class_not_found_error">15.1.3. Why I receive <code>class not found</code> error?</a></h4>
<div class="paragraph">
<p>When You use the RxMicro framework You can receive one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Class rxmicro.$$RestControllerAggregatorImpl not found</code>;</p>
</li>
<li>
<p><code>Class rxmicro.$$RestClientFactoryImpl not found</code>;</p>
</li>
<li>
<p><code>Class rxmicro.$$RepositoryFactoryImpl not found</code>;</p>
</li>
<li>
<p><code>Class rxmicro.$$BeanFactoryImpl not found</code>;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These errors mean that the <code>RxMicro Annotation Processor</code> does not generate the required additional classes.</p>
</div>
<div class="paragraph">
<p>To fix it, please verify that:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>pom.xml</code> for Your project contains <a href="#quick-start-maven-compiler-plugin-settings-section">the valid settings for <code>maven-compiler-plugin</code></a> and</p>
</li>
<li>
<p>You executed command: <code>mvn clean compile</code>!</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="why_i_receive_the_kotlin_standard_library_is_not_found_in_the_module_graph_error"><a class="anchor" href="#why_i_receive_the_kotlin_standard_library_is_not_found_in_the_module_graph_error"></a><a class="link" href="#why_i_receive_the_kotlin_standard_library_is_not_found_in_the_module_graph_error">15.1.4. Why I receive <code>The Kotlin standard library is not found in the module graph</code> error?</a></h4>
<div class="paragraph">
<p>Sometimes this issue occurs during the work with java code using IntelliJ IDEA.
To fix this issue it is necessary to rebuild Your project: <code>Build</code> &#8594; <code>Rebuild project</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="why_i_receive_java_lang_nullpointerexception_autorelease_couldnt_be_null_error_during_unit_testing"><a class="anchor" href="#why_i_receive_java_lang_nullpointerexception_autorelease_couldnt_be_null_error_during_unit_testing"></a><a class="link" href="#why_i_receive_java_lang_nullpointerexception_autorelease_couldnt_be_null_error_during_unit_testing">15.1.5. Why I receive <code>java.lang.NullPointerException: autoRelease couldn&#8217;t be null</code> error during unit testing?</a></h4>
<div class="paragraph">
<p>If You declare an alternative of the <code>HttpClientFactory</code> mock and don&#8217;t configure it this error can happen.</p>
</div>
<div class="paragraph">
<p>To fix this issue it is necessary to configure the <code>@Mock</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Alternative
@Mock(answer = Answers.RETURNS_DEEP_STUBS) <i class="conum" data-value="1"></i><b>(1)</b>
private HttpClientFactory httpClientFactory;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Set <code>Answers.RETURNS_DEEP_STUBS</code> as answer value.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="why_i_receive_java_lang_reflect_inaccessibleobjectexception_unable_to_make_microservicetest_accessible_module_module_name_does_not_opens_test_package_to_unnamed_module_error_during_unit_testing"><a class="anchor" href="#why_i_receive_java_lang_reflect_inaccessibleobjectexception_unable_to_make_microservicetest_accessible_module_module_name_does_not_opens_test_package_to_unnamed_module_error_during_unit_testing"></a><a class="link" href="#why_i_receive_java_lang_reflect_inaccessibleobjectexception_unable_to_make_microservicetest_accessible_module_module_name_does_not_opens_test_package_to_unnamed_module_error_during_unit_testing">15.1.6. Why I receive <code>java.lang.reflect.InaccessibleObjectException: Unable to make MicroServiceTest() accessible: module module.name does not "opens test.package" to unnamed module</code> error during unit testing?</a></h4>
<div class="paragraph">
<p>If <code>test.package</code> name matches to the <code>production.package</code> name, then You need just to add <code>io.rxmicro.annotation.processor.RxMicroTestsAnnotationProcessor</code> annotation processor.
(Read more at <a href="#testing-prepare-maven-compiler-plugin-settings-section">Section 14.1.3, &#8220;Configuring the <code>maven-compiler-plugin</code>:&#8221;</a>).</p>
</div>
<div class="paragraph">
<p>If <code>test.package</code> name does not match to the <code>production.package</code> name, then You need configure the <code>maven-surefire-plugin</code> manually:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
    &lt;version&gt;${maven-surefire-plugin.version}&lt;/version&gt;
    &lt;configuration&gt;
        &lt;argLine&gt;
            @{argLine}
            --add-opens module.name/test.package=ALL-UNNAMED <i class="conum" data-value="1"></i><b>(1)</b>
        &lt;/argLine&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Opens all classes from <code>test.package</code> package defined at the <code>module.name</code> module to all unnamed modules!</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="appendices-links-section"><a class="anchor" href="#appendices-links-section"></a><a class="link" href="#appendices-links-section">15.2. Appendix B: Useful Links</a></h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rxmicro/rxmicro" target="_blank" rel="noopener">RxMicro Source Code Repository</a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/documentation" target="_blank" rel="noopener">RxMicro Documentation Repository</a>;</p>
</li>
<li>
<p><a href="https://github.com/rxmicro/rxmicro-usage/tree/master/examples/" target="_blank" rel="noopener">RxMicro Examples Repository</a>;</p>
</li>
<li>
<p><a href="https://hub.docker.com/u/rxmicro" target="_blank" rel="noopener">RxMicro Docker Repository</a>;</p>
</li>
<li>
<p><a href="https://mvnrepository.com/artifact/io.rxmicro">RxMicro on Maven Central</a></p>
</li>
</ul>
</div>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-166298262-2"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-166298262-2');
</script>
</div>
</div>
</div>
</div>
</body>
</html>